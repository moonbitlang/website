"use strict";var module=module||{};module.exports=(()=>{var ce=Object.create;var w=Object.defineProperty;var xe=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var he=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var Ge=(t,e,r)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var T=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var We=(t,e)=>{for(var r in e)w(t,r,{get:e[r],enumerable:!0})},L=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of be(e))!Ze.call(t,a)&&a!==r&&w(t,a,{get:()=>e[a],enumerable:!(o=xe(e,a))||o.enumerable});return t};var U=(t,e,r)=>(r=t!=null?ce(he(t)):{},L(e||!t||!t.__esModule?w(r,"default",{value:t,enumerable:!0}):r,t)),ye=t=>L(w({},"__esModule",{value:!0}),t);var I=(t,e,r)=>(Ge(t,typeof e!="symbol"?e+"":e,r),r);var ct={};We(ct,{activate:()=>At});var f=U(T("vscode"));var i=T("vscode");var c=U(T("vscode"));function J(t){t.createDirectory(c.default.Uri.parse("memfs:/app/main")),t.writeFile(c.default.Uri.parse("memfs:/app/index.html"),Uint8Array.from(atob("PGh0bWwgbGFuZz0iZW4iPgogIDxoZWFkPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuL3N0eWxlLmNzcyIgLz4KICA8L2hlYWQ+CiAgPGJvZHk+CiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPjwvZGl2PgogICAgPGNhbnZhcyBpZD0iY2FudmFzIj48L2NhbnZhcz4KICAgIDxkaXYgY2xhc3M9ImluZm9ybWF0aW9uIj4KICAgICAgPGRpdj4KICAgICAgICA8cD51cDogZ28gdXA8L3A+CiAgICAgICAgPHA+bGVmdDogZ28gbGVmdDwvcD4KICAgICAgICA8cD5yaWdodDogZ28gcmlnaHQ8L3A+CiAgICAgICAgPHA+ZG93bjogZ28gZG93bjwvcD4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8L2JvZHk+CiAgPHNjcmlwdD4KICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsKICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIGNvbnN0IFdJRFRIID0gNDgwOwogICAgY29uc3QgSEVJR0hUID0gV0lEVEg7CgogICAgY2FudmFzLndpZHRoID0gV0lEVEg7CiAgICBjYW52YXMuaGVpZ2h0ID0gSEVJR0hUOwoKICAgIGNvbnRleHQuc2NhbGUoMjQsIDI0KTsKICAgIGNvbnN0IEdSSURfQ09MID0gV0lEVEggLyAyNDsKICAgIGNvbnN0IEdSSURfUk9XID0gSEVJR0hUIC8gMjQ7CgogICAgY29uc3QgY29sb3JzID0gWwogICAgICAiI2RjZGNkYyIsCiAgICAgICIjMDAyNjNmIiwKICAgICAgIiNmZmI5MDAiLAogICAgICAiIzI3NTNmMSIsCiAgICAgICIjZjdmZjAwIiwKICAgICAgIiNmZjY3MjgiLAogICAgICAiIzExYzViZiIsCiAgICAgICIjYWU4MWZmIiwKICAgICAgIiNlOTQ2NTkiLAogICAgXTsKCiAgICBsZXQgcmVxdWVzdEFuaW1hdGlvbkZyYW1lSWQgPSBudWxsOwogICAgbGV0IGxhc3RUaW1lID0gMDsKICAgIGxldCBkcm9wQ291bnRlciA9IDA7CiAgICBsZXQgZHJvcEludGVydmFsID0gNTAwOwogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCAoZSkgPT4gewogICAgICBpZiAoIXJlcXVlc3RBbmltYXRpb25GcmFtZUlkKSByZXR1cm47CiAgICAgIHN3aXRjaCAoZS5rZXkpIHsKICAgICAgICBjYXNlICJBcnJvd0xlZnQiOiB7CiAgICAgICAgICBzbmFrZV9zdGVwKHNuYWtlLCAzKTsKICAgICAgICAgIHNuYWtlX2RyYXcoY29udGV4dCwgc25ha2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgIkFycm93UmlnaHQiOiB7CiAgICAgICAgICBzbmFrZV9zdGVwKHNuYWtlLCA0KTsKICAgICAgICAgIHNuYWtlX2RyYXcoY29udGV4dCwgc25ha2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgIkFycm93RG93biI6IHsKICAgICAgICAgIHNuYWtlX3N0ZXAoc25ha2UsIDIpOwogICAgICAgICAgc25ha2VfZHJhdyhjb250ZXh0LCBzbmFrZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAiQXJyb3dVcCI6IHsKICAgICAgICAgIHNuYWtlX3N0ZXAoc25ha2UsIDEpOwogICAgICAgICAgc25ha2VfZHJhdyhjb250ZXh0LCBzbmFrZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgbGV0IHNuYWtlX2RyYXcgPSBudWxsOwogICAgbGV0IHNuYWtlX25ldyA9IG51bGw7CiAgICBsZXQgc25ha2Vfc3RlcCA9IG51bGw7CiAgICBsZXQgc25ha2UgPSBudWxsOwoKICAgIGNvbnN0IGltcG9ydE9iamVjdCA9IHsKICAgICAgY2FudmFzOiB7CiAgICAgICAgc3Ryb2tlX3JlY3Q6IChjdHgsIHgsIHksIHdpZHRoLCBoZWlnaHQpID0+CiAgICAgICAgICBjdHguc3Ryb2tlUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KSwKICAgICAgICBzZXRfbGluZV93aWR0aDogKGN0eCwgd2lkdGgpID0+IChjdHgubGluZVdpZHRoID0gd2lkdGgpLAogICAgICAgIGZpbGxfcmVjdDogKGN0eCwgeCwgeSwgd2lkdGgsIGhlaWdodCkgPT4KICAgICAgICAgIGN0eC5maWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KSwKICAgICAgICBzZXRfc3Ryb2tlX2NvbG9yOiAoY3R4LCBjb2xvcikgPT4gKGN0eC5zdHJva2VTdHlsZSA9IGNvbG9yc1tjb2xvcl0pLAogICAgICAgIHNldF9maWxsX3N0eWxlOiAoY3R4LCBjb2xvcikgPT4gKGN0eC5maWxsU3R5bGUgPSBjb2xvcnNbY29sb3JdKSwKICAgICAgfSwKICAgICAgc3BlY3Rlc3Q6IHsKICAgICAgICBwcmludF9pMzI6ICh4KSA9PiBjb25zb2xlLmxvZyhTdHJpbmcoeCkpLAogICAgICAgIHByaW50X2Y2NDogKHgpID0+IGNvbnNvbGUubG9nKFN0cmluZyh4KSksCiAgICAgICAgcHJpbnRfY2hhcjogKHgpID0+IGNvbnNvbGUubG9nKFN0cmluZy5mcm9tQ2hhckNvZGUoeCkpLAogICAgICB9LAogICAgICBNYXRoOiB7CiAgICAgICAgcmFuZG9tOiBNYXRoLnJhbmRvbSwKICAgICAgICBmbG9vcjogTWF0aC5mbG9vciwKICAgICAgfSwKICAgIH07CgogICAgZnVuY3Rpb24gdXBkYXRlKHRpbWUgPSAwKSB7CiAgICAgIGNvbnN0IGRlbHRhVGltZSA9IHRpbWUgLSBsYXN0VGltZTsKICAgICAgZHJvcENvdW50ZXIgKz0gZGVsdGFUaW1lOwogICAgICBpZiAoZHJvcENvdW50ZXIgPiBkcm9wSW50ZXJ2YWwpIHsKICAgICAgICBzbmFrZV9zdGVwKHNuYWtlLCA1KTsKICAgICAgICBkcm9wQ291bnRlciA9IDA7CiAgICAgIH0KICAgICAgbGFzdFRpbWUgPSB0aW1lOwogICAgICBzbmFrZV9kcmF3KGNvbnRleHQsIHNuYWtlKTsKICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTsKICAgIH0KCiAgICBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZygKICAgICAgZmV0Y2goInRhcmdldC93YXNtL3JlbGVhc2UvYnVpbGQvbWFpbi9tYWluLndhc20iKSwKICAgICAgaW1wb3J0T2JqZWN0CiAgICApLnRoZW4oKG9iaikgPT4gewogICAgICBvYmouaW5zdGFuY2UuZXhwb3J0cy5fc3RhcnQoKTsKICAgICAgc25ha2VfZHJhdyA9IG9iai5pbnN0YW5jZS5leHBvcnRzWyJzbmFrZS9tYWluOjptYWluX2RyYXciXTsKICAgICAgc25ha2VfbmV3ID0gb2JqLmluc3RhbmNlLmV4cG9ydHNbInNuYWtlL21haW46Om1haW5fbmV3Il07CiAgICAgIHNuYWtlX3N0ZXAgPSBvYmouaW5zdGFuY2UuZXhwb3J0c1sic25ha2UvbWFpbjo6bWFpbl9zdGVwIl07CiAgICAgIHNuYWtlID0gc25ha2VfbmV3KCk7CiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZSk7CiAgICB9KTsKICA8L3NjcmlwdD4KPC9odG1sPgo="),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/style.css"),Uint8Array.from(atob("Ym9keSB7CiAgICBtYXJnaW46IDA7CiAgICBkaXNwbGF5OiBncmlkOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgbWFyZ2luLXRvcDogMTB2aDsKICAKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig1NCwgNDQsIDQ0KTsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICB9CiAgCiAgY2FudmFzIHsKICAgIGJvcmRlcjogMnB4IHNvbGlkIHJnYigxMDksIDEwOSwgMTA5KTsKICB9CiAgCiAgLmluZm9ybWF0aW9uIHsKICAgIGNvbG9yOiAjZmZmOwogICAgbWFyZ2luLWxlZnQ6IDVyZW07CiAgfQogIAogIA=="),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/main/draw.mbt"),Uint8Array.from(atob("Ly8gZm4gbmV3Q2FudmFzKHc6IEludCwgaDogSW50KSAtPiBJbnQ9ICJjYW52YXMiIm5ld0NhbnZhcyIKCi8vIGZuIHVwZGF0ZUNhbnZhcyhpZDogSW50LCApCgp0eXBlIENhbnZhc19jdHgKCmZuIHNldF9zdHJva2VfY29sb3Ioc2VsZiA6IENhbnZhc19jdHgsIGNvbG9yIDogSW50KSA9ICJjYW52YXMiICJzZXRfc3Ryb2tlX2NvbG9yIgoKZm4gc2V0X2xpbmVfd2lkdGgoc2VsZiA6IENhbnZhc19jdHgsIHdpZHRoIDogRG91YmxlKSA9ICJjYW52YXMiICJzZXRfbGluZV93aWR0aCIKCmZuIHN0cm9rZV9yZWN0KHNlbGYgOiBDYW52YXNfY3R4LCB4IDogSW50LCB5IDogSW50LCB3aWR0aCA6IEludCwgaGVpZ2h0IDogSW50KSA9ICJjYW52YXMiICJzdHJva2VfcmVjdCIKCmZuIGZpbGxfcmVjdChzZWxmIDogQ2FudmFzX2N0eCwgeCA6IEludCwgeSA6IEludCwgd2lkdGggOiBJbnQsIGhlaWdodCA6IEludCkgPSAiY2FudmFzIiAiZmlsbF9yZWN0IgoKZm4gc2V0X2ZpbGxfc3R5bGUoc2VsZiA6IENhbnZhc19jdHgsIGNvbG9yIDogSW50KSA9ICJjYW52YXMiICJzZXRfZmlsbF9zdHlsZSIKCgpwdWIgZm4gZHJhdyhjYW52YXMgOiBDYW52YXNfY3R4LCBzbmFrZSA6IEdhbWVTdGF0ZSkgewogIGxldCBtdXQgYyA9IDAKCiAgLy8gZHJhdyBiYWNrZ3JvdWQKICB3aGlsZSBjIDwgZ3JpZF9jb2xfY291bnQgewogICAgY2FudmFzLnNldF9maWxsX3N0eWxlKDApCiAgICBjYW52YXMuZmlsbF9yZWN0KGMsIDAsIDEsIGdyaWRfcm93X2NvdW50KQogICAgYyA9IGMgKyAxCiAgfQogIAogIGRyYXdfcGllY2UoY2FudmFzLCBzbmFrZS5ncmlkLCAoMCwgMCkpCn0KCnB1YiBmbiBkcmF3X3BpZWNlKGNhbnZhcyA6IENhbnZhc19jdHgsIG1hdHJpeCA6IEFycmF5W0ludF0sCiAgICAgICAgb2Zmc2V0IDogKEludCwgSW50KSkgewoKICBsZXQgbXV0IHIgPSAwCiAgbGV0IG11dCBjID0gMAogIGxldCBtdXQgYzAgPSAwCiAgd2hpbGUgYyA8IG1hdHJpeC5sZW5ndGgoKSB7CiAgICBpZiBtYXRyaXhbY10gPT0gMCB7CiAgICAgIGMgPSBjICsgMQogICAgICBjb250aW51ZQogICAgfQogICAgYzAgPSBjICUgZ3JpZF9jb2xfY291bnQKICAgIHIgPSBjIC8gZ3JpZF9jb2xfY291bnQKICAgIGNhbnZhcy5zZXRfZmlsbF9zdHlsZShtYXRyaXhbY10gKyAxKQogICAgY2FudmFzLmZpbGxfcmVjdCggb2Zmc2V0LjAgKyBjMCwgciwgMSwgMSkKICAgIGNhbnZhcy5zZXRfc3Ryb2tlX2NvbG9yKDEpCiAgICBjYW52YXMuc2V0X2xpbmVfd2lkdGgoMC4xKQogICAgY2FudmFzLnN0cm9rZV9yZWN0KCBjMCwgciwgMSwgMSkKICAgIGMgPSBjICsgMQogIH0KfQoK"),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/main/main.mbt"),Uint8Array.from(atob("cHViIGZuIG1haW5fbmV3KCkgLT4gR2FtZVN0YXRlewogIHJldHVybiBuZXcoKQp9CgpwdWIgZm4gbWFpbl9zdGVwKGdhbWU6IEdhbWVTdGF0ZSwgYTogSW50KXsKICB0cmFuX3N0ZXAoZ2FtZSwgYSkKfQoKcHViIGZuIG1haW5fZHJhdyhjYW52YXMgOiBDYW52YXNfY3R4LCBnYW1lIDogR2FtZVN0YXRlKXsKICBkcmF3KGNhbnZhcywgZ2FtZSkKfQoKZm4gaW5pdCB7CiAgKCkKfQo="),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/main/moon.pkg.json"),Uint8Array.from(atob("ewogICJpc19tYWluIjogdHJ1ZQp9Cg=="),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/main/snake.mbt"),Uint8Array.from(atob("bGV0IGdyaWRfcm93X2NvdW50ID0gMjAKCmxldCBncmlkX2NvbF9jb3VudCA9IDIwCgplbnVtIERpcmVjdGlvbnsKICBVcAogIERvd24KICBMZWZ0CiAgUmlnaHQKICBEZWZhdWx0Cn0KCmVudW0gR3JpZFR5cGV7CiAgQm9keQogIEZvb2QKICBEZWZhdWx0Cn0KCi8vIGVudW0gQWN0aW9uewovLyAgIDEKLy8gICAyCi8vICAgMwovLyAgIDQKLy8gICA1Ci8vIH0KCnB1YiBmbiBncmlkX251bShzZWxmOiBHcmlkVHlwZSkgLT4gSW50ewogIG1hdGNoIHNlbGZ7CiAgICBCb2R5ID0+IDEKICAgIEZvb2QgPT4gMgogICAgRGVmYXVsdCA9PiAwCiAgfQp9CgpwdWIgZm4gZGlyX3Bvc2koc2VsZjogRGlyZWN0aW9uKSAtPiBQb3NpdGlvbnsKICBtYXRjaCBzZWxmewogICAgVXAgPT4ge3g6IDAsIHk6IC0xfQogICAgRG93biA9PiB7eDogMCwgeTogMX0KICAgIExlZnQgPT4ge3g6IC0xLCB5OiAwfQogICAgUmlnaHQgPT4ge3g6IDEsIHk6IDB9CiAgICBEZWZhdWx0ID0+IHt4OiAwLCB5OiAwfQogIH0KfQoKZm4gRGlyZWN0aW9uOjpvcF9lcXVhbCh4OiBEaXJlY3Rpb24sIHk6IERpcmVjdGlvbikgLT4gQm9vbHsKICBsZXQgeDA6IFBvc2l0aW9uID0gZGlyX3Bvc2koeCkKICBsZXQgeTA6IFBvc2l0aW9uID0gZGlyX3Bvc2koeSkKICBpZiAoeDAueCA9PSB5MC54ICYmIHgwLnkgPT0geTAueSl7CiAgICB0cnVlCiAgfWVsc2V7CiAgICBmYWxzZQogIH0KfQoKc3RydWN0IFBvc2l0aW9uewoJbXV0IHg6IEludAoJbXV0IHk6IEludAp9CgpzdHJ1Y3QgR2FtZVN0YXRlewoJbXV0IGdyaWQ6ICBBcnJheVtJbnRdCgltdXQgYm9keTogIExpc3RbUG9zaXRpb25dCgltdXQgZGlyOiAgIERpcmVjdGlvbgp9CgpwdWIgZm4gaW5pdGlhbGl6ZShzZWxmOiBHYW1lU3RhdGUpewogIHNlbGYuZ3JpZCA9IEFycmF5OjptYWtlKGdyaWRfcm93X2NvdW50KmdyaWRfY29sX2NvdW50LCAwKQogIHNlbGYuZGlyID0gVXAKCiAgc2VsZi5ib2R5ID0gQ29ucyh7eDogZ3JpZF9jb2xfY291bnQvMiwgeTogZ3JpZF9jb2xfY291bnQvMn0sIE5pbCkKICBzZWxmLmdyaWRbZ3JpZF9jb2xfY291bnQvMiAqIGdyaWRfY29sX2NvdW50ICsgZ3JpZF9jb2xfY291bnQvMl0gPSAxCgogIHNlbGYuZ2VuZXJhdGVfRm9vZCgpCgp9CgpmbiBzZXRHcmlkVHlwZShzZWxmOiBHYW1lU3RhdGUsIHA6IFBvc2l0aW9uLCB0OiBHcmlkVHlwZSl7CiAgc2VsZi5ncmlkW3AueSAqIGdyaWRfY29sX2NvdW50ICsgcC54XSA9IGdyaWRfbnVtKHQpCgp9CgpmbiByYW5kb20oKSAtPiBEb3VibGUgPSAiTWF0aCIgInJhbmRvbSIKZm4gZmxvb3IoaTogRG91YmxlKSAtPiBJbnQgPSAiTWF0aCIgImZsb29yIgoKZm4gZ2VuZXJhdGVfRm9vZChzZWxmOiBHYW1lU3RhdGUpewogIHdoaWxlIHRydWUgewogICAgbGV0IGkgOiBJbnQgPSBmbG9vcihyYW5kb20oKSAqIDIwLjApCiAgICBsZXQgaiA6IEludCA9IGZsb29yKHJhbmRvbSgpICogMjAuMCkKICAgIAogICAgaWYoc2VsZi5ncmlkW2ogKiBncmlkX2NvbF9jb3VudCArIGldID09IGdyaWRfbnVtKERlZmF1bHQpKXsKICAgICAgc2VsZi5zZXRHcmlkVHlwZSh7eDogaSwgeTogan0sIEZvb2QpCiAgICAgIHJldHVybgogICAgfQogIH0KfQoKZm4gZ29fc3RlcChzZWxmOiBHYW1lU3RhdGUpewogIC8vIGlmIChwcmV2ID09IFVwICYmIHNlbGYuZGlyID09IERvd24pIHx8ICAocHJldiA9PSBEb3duICYmIHNlbGYuZGlyID09IFVwKSB8fCAocHJldiA9PSBMZWZ0ICYmIHNlbGYuZGlyID09IFJpZ2h0KSB8fCAocHJldiA9PSBSaWdodCAmJiBzZWxmLmRpciA9PSBMZWZ0KXsKICAvLyAgIHNlbGYuZGlyID0gcHJldgogIC8vIH0KICBsZXQgaGVhZCA6IFBvc2l0aW9uID0gZ2V0X2hlYWQoc2VsZi5ib2R5KQogIGxldCBuZXdIZWFkIDogUG9zaXRpb24gPSB7eDogaGVhZC54ICwgeTogaGVhZC55IH0KCiAgbmV3SGVhZC54ID0gZGlyX3Bvc2koc2VsZi5kaXIpLnggKyBuZXdIZWFkLnggCiAgbmV3SGVhZC55ID0gZGlyX3Bvc2koc2VsZi5kaXIpLnkgKyBuZXdIZWFkLnkKCiAgbmV3SGVhZC54ID0gKG5ld0hlYWQueCArIGdyaWRfY29sX2NvdW50KSAlIGdyaWRfY29sX2NvdW50CiAgbmV3SGVhZC55ID0gKG5ld0hlYWQueSArIGdyaWRfY29sX2NvdW50KSAlIGdyaWRfY29sX2NvdW50CgogIGlmIHNlbGYuZ3JpZFtuZXdIZWFkLnkgKiBncmlkX2NvbF9jb3VudCArIG5ld0hlYWQueF0gPT0gMXsKCiAgICBpbml0aWFsaXplKHNlbGYpCiAgICByZXR1cm4KICB9ZWxzZSBpZiBzZWxmLmdyaWRbbmV3SGVhZC55ICogZ3JpZF9jb2xfY291bnQgKyBuZXdIZWFkLnhdID09IDJ7CiAgICAKICAgIHNlbGYuc2V0R3JpZFR5cGUobmV3SGVhZCwgQm9keSkKICAgIHNlbGYuYm9keSA9IENvbnMobmV3SGVhZCwgc2VsZi5ib2R5KQogICAgZ2VuZXJhdGVfRm9vZChzZWxmKQogIH1lbHNlIHsKCiAgICBzZWxmLnNldEdyaWRUeXBlKG5ld0hlYWQsIEJvZHkpCiAgICBzZWxmLmJvZHkgPSBDb25zKG5ld0hlYWQsIHNlbGYuYm9keSkKICAgIHNlbGYuc2V0R3JpZFR5cGUoZ2V0X3RhaWwoc2VsZi5ib2R5KSwgRGVmYXVsdCkKICAgIHNlbGYuYm9keSA9IGRlbGV0ZV90YWlsKHNlbGYuYm9keSkKICB9Cgp9CgpwdWIgZm4gc3RlcChzZWxmIDogR2FtZVN0YXRlLCBhY3Rpb24gOiBEaXJlY3Rpb24pIHsKCiAgbWF0Y2ggYWN0aW9uIHsKICAgIC8vIG1vdmUgdXAKICAgIFVwID0+ewogICAgICBpZiBsZW5ndGgoc2VsZi5ib2R5KSA9PSAxewogICAgICAgIHNlbGYuZGlyID0gVXAKICAgICAgfWVsc2V7CiAgICAgICAgaWYgc2VsZi5kaXIgPT0gTGVmdCB8fCBzZWxmLmRpciA9PSBSaWdodCB8fCBzZWxmLmRpciA9PSBVcHsKICAgICAgICAgIHNlbGYuZGlyID0gVXAKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHNlbGYuZGlyID0gc2VsZi5kaXIKICAgICAgICB9CiAgICAgIH0KICAgICAgIAogICAgICB9CiAgICAgIAogICAgLy8gbW92ZSBkb3duCiAgICBEb3duID0+ewogICAgICBpZiBsZW5ndGgoc2VsZi5ib2R5KSA9PSAxewogICAgICAgIHNlbGYuZGlyID0gRG93bgogICAgICB9ZWxzZXsKICAgICAgICBpZiBzZWxmLmRpciA9PSBMZWZ0IHx8IHNlbGYuZGlyID09IFJpZ2h0IHx8IHNlbGYuZGlyID09IERvd257CiAgICAgICAgICBzZWxmLmRpciA9IERvd24KICAgICAgICB9ZWxzZXsKICAgICAgICAgIHNlbGYuZGlyID0gc2VsZi5kaXIKICAgICAgICB9CiAgICAgIH0KICAgICAgIAogICAgICB9CiAgICAgIAogICAgLy8gbW92ZSBsZWZ0CiAgICBMZWZ0ID0+ewogICAgICBpZiBsZW5ndGgoc2VsZi5ib2R5KSA9PSAxewogICAgICAgIHNlbGYuZGlyID0gTGVmdAogICAgICB9ZWxzZXsKICAgICAgICBpZiBzZWxmLmRpciA9PSBVcCB8fCBzZWxmLmRpciA9PSBMZWZ0IHx8IHNlbGYuZGlyID09IERvd257CiAgICAgICAgICBzZWxmLmRpciA9IExlZnQKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHNlbGYuZGlyID0gc2VsZi5kaXIKICAgICAgICB9ICAKICAgICAgfQogCiAgICAgIH0KICAgICAgCiAgICAvLyBtb3ZlIHJpZ2h0CiAgICBSaWdodCA9PnsKICAgICAgaWYgbGVuZ3RoKHNlbGYuYm9keSkgPT0gMXsKICAgICAgICBzZWxmLmRpciA9IFJpZ2h0CiAgICAgIH1lbHNlewogICAgICAgIGlmIHNlbGYuZGlyID09IFVwIHx8IHNlbGYuZGlyID09IFJpZ2h0IHx8IHNlbGYuZGlyID09IERvd257CiAgICAgICAgICBzZWxmLmRpciA9IFJpZ2h0CiAgICAgICAgfWVsc2V7CiAgICAgICAgICBzZWxmLmRpciA9IHNlbGYuZGlyCiAgICAgICAgfQogICAgICB9CiAgICAgIH0KICAgICAgIAogICAgXyA9PnsKICAgICAgc2VsZi5kaXIgPSBzZWxmLmRpcgogICAgICB9CiAgICAgICAKICB9CgogIHNlbGYuZ29fc3RlcCgpCn0KCnB1YiBmbiB0cmFuX3N0ZXAoc2VsZiA6IEdhbWVTdGF0ZSwgYSA6IEludCl7CiAgbGV0IG11dCBhY3Rpb24gOiBEaXJlY3Rpb24gPSBEZWZhdWx0CiAgbWF0Y2ggYSB7CiAgICAxID0+IGFjdGlvbiA9IFVwCiAgICAyID0+IGFjdGlvbiA9IERvd24KICAgIDMgPT4gYWN0aW9uID0gTGVmdAogICAgNCA9PiBhY3Rpb24gPSBSaWdodAogICAgXyA9PiBhY3Rpb24gPSBEZWZhdWx0CiAgfQoKICBzZWxmLnN0ZXAoYWN0aW9uKSAgCn0KCnB1YiBmbiBuZXcoKSAtPiBHYW1lU3RhdGV7CiAgbGV0IGdhbWU6IEdhbWVTdGF0ZSA9IHsKICAgIGdyaWQ6ICBbXSwKCSAgYm9keTogIE5pbCwKCSAgZGlyOiAgIFVwCiAgfQogIGdhbWUuaW5pdGlhbGl6ZSgpCiAgZ2FtZQp9"),e=>e.charCodeAt(0)),{create:!0,overwrite:!0}),t.writeFile(c.default.Uri.parse("memfs:/app/main/utils.mbt"),Uint8Array.from(atob("cHViIGZuIGdldF9oZWFkKGN1cjogTGlzdFtQb3NpdGlvbl0pIC0+IFBvc2l0aW9uewogIG1hdGNoIGN1cnsKICAgIE5pbCA9PiB7eDogMCwgeTogMH0KICAgIENvbnMoeCwgXykgPT4geAogIH0KfQoKcHViIGZuIGdldF90YWlsKGN1cjogTGlzdFtQb3NpdGlvbl0pIC0+IFBvc2l0aW9uewogIGZuIGdvKGxpc3Q6IExpc3RbUG9zaXRpb25dKSAtPiBQb3NpdGlvbnsKICAgIG1hdGNoIGxpc3R7CiAgICAgIE5pbCA9PiB7eDogMCwgeTowfQogICAgICBDb25zKHgsIE5pbCkgPT4geAogICAgICBDb25zKF8sIHhzKSA9PiBnbyh4cykKICAgIH0KICB9CgogIGdvKGN1cikKfQoKcHViIGZuIGRlbGV0ZV90YWlsKGN1cjogTGlzdFtQb3NpdGlvbl0pIC0+IExpc3RbUG9zaXRpb25dewogIGZuIGdvKGxpc3Q6IExpc3RbUG9zaXRpb25dKSAtPiBMaXN0W1Bvc2l0aW9uXXsKICAgIG1hdGNoIGxpc3R7CiAgICAgIE5pbCA9PiBOaWwKICAgICAgQ29ucyhfLCBOaWwpID0+IE5pbAogICAgICBDb25zKHgsIHhzKSA9PiBDb25zKHgsIGdvKHhzKSkKICAgIH0KICB9CgogIGdvKGN1cikKfQoKcHViIGZuIGxlbmd0aFtUXShub3cgOiBMaXN0W1RdKSAtPiBJbnQgewogIG1hdGNoIG5vdyB7CiAgICBOaWwgPT4gMAogICAgQ29ucyhfLCBuKSA9PiAxICsgbGVuZ3RoKG4pCiAgfQp9"),e=>e.charCodeAt(0)),{create:!0,overwrite:!0})}var v=class{constructor(e,r){this.uri=e;I(this,"type");I(this,"ctime");I(this,"mtime");I(this,"size");I(this,"name");I(this,"data");this.type=i.FileType.File,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=r}},Z=class{constructor(e,r){this.uri=e;I(this,"type");I(this,"ctime");I(this,"mtime");I(this,"size");I(this,"name");I(this,"entries");this.type=i.FileType.Directory,this.ctime=Date.now(),this.mtime=Date.now(),this.size=0,this.name=r,this.entries=new Map}},Zt=new TextEncoder,y=class y{constructor(){I(this,"disposable");I(this,"root",new Z(i.Uri.parse("memfs:/"),""));I(this,"_emitter",new i.EventEmitter);I(this,"_bufferedEvents",[]);I(this,"_fireSoonHandle");I(this,"onDidChangeFile",this._emitter.event);I(this,"_textDecoder",new TextDecoder);this.disposable=i.Disposable.from(i.workspace.registerFileSystemProvider(y.scheme,this,{isCaseSensitive:!0}),i.workspace.registerFileSearchProvider(y.scheme,this),i.workspace.registerTextSearchProvider(y.scheme,this))}dispose(){this.disposable?.dispose()}initFolder(){console.log("create dir: sample-folder"),this.createDirectory(i.Uri.parse("memfs:/app/")),J(this)}stat(e){return this._lookup(e,!1)}readDirectory(e){let r=this._lookupAsDirectory(e,!1),o=[];for(let[a,l]of r.entries)o.push([a,l.type]);return o}readFile(e){let r=this._lookupAsFile(e,!1).data;if(r)return r;throw i.FileSystemError.FileNotFound()}writeFile(e,r,o){let a=this._basename(e.path),l=this._lookupParentDirectory(e),s=l.entries.get(a);if(s instanceof Z)throw i.FileSystemError.FileIsADirectory(e);if(!s&&!o.create)throw i.FileSystemError.FileNotFound(e);if(s&&o.create&&!o.overwrite)throw i.FileSystemError.FileExists(e);s||(s=new v(e,a),l.entries.set(a,s),this._fireSoon({type:i.FileChangeType.Created,uri:e})),s.mtime=Date.now(),s.size=r.byteLength,s.data=r,this._fireSoon({type:i.FileChangeType.Changed,uri:e})}rename(e,r,o){if(!o.overwrite&&this._lookup(r,!0))throw i.FileSystemError.FileExists(r);let a=this._lookup(e,!1),l=this._lookupParentDirectory(e),s=this._lookupParentDirectory(r),g=this._basename(r.path);l.entries.delete(a.name),a.name=g,s.entries.set(g,a),this._fireSoon({type:i.FileChangeType.Deleted,uri:e},{type:i.FileChangeType.Created,uri:r})}delete(e){let r=e.with({path:this._dirname(e.path)}),o=this._basename(e.path),a=this._lookupAsDirectory(r,!1);if(!a.entries.has(o))throw i.FileSystemError.FileNotFound(e);a.entries.delete(o),a.mtime=Date.now(),a.size-=1,this._fireSoon({type:i.FileChangeType.Changed,uri:r},{uri:e,type:i.FileChangeType.Deleted})}createDirectory(e){let r=this._basename(e.path),o=e.with({path:this._dirname(e.path)}),a=this._lookupAsDirectory(o,!1),l=new Z(e,r);a.entries.set(l.name,l),a.mtime=Date.now(),a.size+=1,this._fireSoon({type:i.FileChangeType.Changed,uri:o},{type:i.FileChangeType.Created,uri:e})}_lookup(e,r){let o=e.path.split("/"),a=this.root;for(let l of o){if(!l)continue;let s;if(a instanceof Z&&(s=a.entries.get(l)),!s){if(r)return;throw i.FileSystemError.FileNotFound(e)}a=s}return a}_lookupAsDirectory(e,r){let o=this._lookup(e,r);if(o instanceof Z)return o;throw i.FileSystemError.FileNotADirectory(e)}_lookupAsFile(e,r){let o=this._lookup(e,r);if(o instanceof v)return o;throw i.FileSystemError.FileIsADirectory(e)}_lookupParentDirectory(e){let r=e.with({path:this._dirname(e.path)});return this._lookupAsDirectory(r,!1)}watch(e){return new i.Disposable(()=>{})}_fireSoon(...e){this._bufferedEvents.push(...e),this._fireSoonHandle&&clearTimeout(this._fireSoonHandle),this._fireSoonHandle=setTimeout(()=>{this._emitter.fire(this._bufferedEvents),this._bufferedEvents.length=0},5)}_basename(e){return e=this._rtrim(e,"/"),e?e.substr(e.lastIndexOf("/")+1):""}_dirname(e){return e=this._rtrim(e,"/"),e?e.substr(0,e.lastIndexOf("/")):"/"}_rtrim(e,r){if(!e||!r)return e;let o=r.length,a=e.length;if(o===0||a===0)return e;let l=a,s=-1;for(;s=e.lastIndexOf(r,l-1),!(s===-1||s+o!==l);){if(s===0)return"";l=s}return e.substring(0,l)}_getFiles(){let e=new Set;return this._doGetFiles(this.root,e),e}_doGetFiles(e,r){e.entries.forEach(o=>{o instanceof v?r.add(o):this._doGetFiles(o,r)})}_convertSimple2RegExpPattern(e){return e.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}provideFileSearchResults(e,r,o){return this._findFiles(e.pattern)}_findFiles(e){let r=this._getFiles(),o=[],a=e?new RegExp(this._convertSimple2RegExpPattern(e)):null;for(let l of r)(!a||a.exec(l.name))&&o.push(l.uri);return o}provideTextSearchResults(e,r,o,a){let l={limitHit:!1},s=this._findFiles(r.includes[0]);if(s)for(let g of s){let p=this._textDecoder.decode(this.readFile(g)).split(`
`);for(let d=0;d<p.length;d++){let n=p[d],u=n.indexOf(e.pattern);u!==-1&&o.report({uri:g,ranges:new i.Range(new i.Position(d,u),new i.Position(d,u+e.pattern.length)),preview:{text:n,matches:new i.Range(new i.Position(0,u),new i.Position(0,u+e.pattern.length))}})}}return l}};I(y,"scheme","memfs");var P=y,N=new P;var Be=typeof global=="object"&&global&&global.Object===Object&&global,O=Be;var Ke=typeof self=="object"&&self&&self.Object===Object&&self,we=O||Ke||Function("return this")(),F=we;var ve=F.Symbol,x=ve;var M=Object.prototype,Se=M.hasOwnProperty,Re=M.toString,S=x?x.toStringTag:void 0;function Ye(t){var e=Se.call(t,S),r=t[S];try{t[S]=void 0;var o=!0}catch{}var a=Re.call(t);return o&&(e?t[S]=r:delete t[S]),a}var _=Ye;var Ne=Object.prototype,Fe=Ne.toString;function Ve(t){return Fe.call(t)}var q=Ve;var He="[object Null]",Xe="[object Undefined]",$=x?x.toStringTag:void 0;function ke(t){return t==null?t===void 0?Xe:He:$&&$ in Object(t)?_(t):q(t)}var ee=ke;function De(t){return t!=null&&typeof t=="object"}var te=De;var Ee="[object Symbol]";function Te(t){return typeof t=="symbol"||te(t)&&ee(t)==Ee}var V=Te;function Pe(t,e){for(var r=-1,o=t==null?0:t.length,a=Array(o);++r<o;)a[r]=e(t[r],r,t);return a}var re=Pe;var je=Array.isArray,oe=je;var Qe=1/0,ae=x?x.prototype:void 0,ie=ae?ae.toString:void 0;function se(t){if(typeof t=="string")return t;if(oe(t))return re(t,se)+"";if(V(t))return ie?ie.call(t):"";var e=t+"";return e=="0"&&1/t==-Qe?"-0":e}var le=se;var ze=/\s/;function Le(t){for(var e=t.length;e--&&ze.test(t.charAt(e)););return e}var fe=Le;var Ue=/^\s+/;function Je(t){return t&&t.slice(0,fe(t)+1).replace(Ue,"")}var ge=Je;function Oe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var G=Oe;var Ie=NaN,Me=/^[-+]0x[0-9a-f]+$/i,_e=/^0b[01]+$/i,qe=/^0o[0-7]+$/i,$e=parseInt;function et(t){if(typeof t=="number")return t;if(V(t))return Ie;if(G(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=G(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ge(t);var r=_e.test(t);return r||qe.test(t)?$e(t.slice(2),r?2:8):Me.test(t)?Ie:+t}var j=et;function tt(t){return t==null?"":le(t)}var H=tt;function rt(t){return function(e){return t?.[e]}}var de=rt;var ot=function(){return F.Date.now()},X=ot;var at="Expected a function",it=Math.max,st=Math.min;function lt(t,e,r){var o,a,l,s,g,C,p=0,d=!1,n=!1,u=!0;if(typeof t!="function")throw new TypeError(at);e=j(e)||0,G(r)&&(d=!!r.leading,n="maxWait"in r,l=n?it(j(r.maxWait)||0,e):l,u="trailing"in r?!!r.trailing:u);function A(m){var b=o,K=a;return o=a=void 0,p=m,s=t.apply(K,b),s}function h(m){return p=m,g=setTimeout(Y,e),d?A(m):s}function W(m){var b=m-C,K=m-p,z=e-b;return n?st(z,l-K):z}function R(m){var b=m-C,K=m-p;return C===void 0||b>=e||b<0||n&&K>=l}function Y(){var m=X();if(R(m))return Q(m);g=setTimeout(Y,W(m))}function Q(m){return g=void 0,u&&o?A(m):(o=a=void 0,s)}function Ce(){g!==void 0&&clearTimeout(g),p=0,o=C=a=g=void 0}function Ae(){return g===void 0?s:Q(X())}function E(){var m=X(),b=R(m);if(o=arguments,a=this,C=m,b){if(g===void 0)return h(C);if(n)return clearTimeout(g),g=setTimeout(Y,e),A(C)}return g===void 0&&(g=setTimeout(Y,e)),s}return E.cancel=Ce,E.flush=Ae,E}var me=lt;var ft={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gt=de(ft),pe=gt;var ne=/[&<>"']/g,It=RegExp(ne.source);function dt(t){return t=H(t),t&&It.test(t)?t.replace(ne,pe):t}var k=dt;var ue=/[\\^$.*+?()[\]{}|]/g,mt=RegExp(ue.source);function pt(t){return t=H(t),t&&mt.test(t)?t.replace(ue,"\\$&"):t}var B=pt;var nt="Expected a function";function ut(t,e,r){var o=!0,a=!0;if(typeof t!="function")throw new TypeError(nt);return G(r)&&(o="leading"in r?!!r.leading:o,a="trailing"in r?!!r.trailing:a),me(t,e,{leading:o,maxWait:e,trailing:a})}var D=ut;async function At(t){t.subscriptions.push(N),N.initFolder();let e=null,r=p=>{let d=Math.random(),n=f.Uri.parse("memfs:/app/index.html"),u=N.readFile(n),A=`"${k(p.asWebviewUri(f.Uri.parse("memfs:/app/main/moon.wasm")).toString(!0))}"`,h=new TextDecoder().decode(u);return h=h.replace(/<head>/,`<head><base href="${k(p.asWebviewUri(n).toString(!0))}" /><meta name="nonce" content="${d}" />`).replace(new RegExp(B('"target/wasm/debug/build/main/main.wasm"')),A).replace(new RegExp(B('"target/wasm/release/build/main/main.wasm"')),A).replace(new RegExp(B('"target/wasm-gc/debug/build/main/main.wasm"')),A).replace(new RegExp(B('"target/wasm-gc/release/build/main/main.wasm"')),A).replace(/\"(?:.*?)\/main::/g,'"'),h},o=()=>{if(f.workspace.workspaceFolders?.[0]!=null){if(e==null){let d=f.window.createWebviewPanel("canvas","Preview",{viewColumn:f.ViewColumn.Two},{enableScripts:!0,localResourceRoots:[f.Uri.parse("memfs:/")]});d.webview.html=r(d.webview),d.onDidDispose(()=>{e===d&&(e=null)}),e=d}e.reveal(),f.commands.executeCommand("workbench.action.lockEditorGroup")}};t.subscriptions.push(f.commands.registerCommand("moonfiddle.open-preview",()=>{o()})),o();let a=!1,l=D(async()=>{if(a)return;a=!0;let p=performance.now(),d=f.workspace.workspaceFolders?.[0];if(d==null)return;let n=f.Uri.joinPath(d.uri,"main"),u=await f.workspace.fs.readDirectory(n),A=[];for(let[W,R]of u)R===f.FileType.File&&W.endsWith(".mbt")&&A.push(f.Uri.joinPath(n,W).toString(!1));if(e!=null)try{await f.commands.executeCommand("moonbit.compile-to-wasm",f.Uri.parse("memfs:/app/main/moon.pkg.json"),{silent:!0}),e.webview.html=r(e.webview)}catch(W){console.error(W)}let h=performance.now()-p;console.log(`live reload in ${h}ms`),a=!1},100),s=D(async()=>{a||e!=null&&(e.webview.html=r(e.webview))},100),g=f.workspace.createFileSystemWatcher("**/*.mbt");g.onDidCreate(l),g.onDidChange(l),t.subscriptions.push(g);let C=f.workspace.createFileSystemWatcher("**/*");C.onDidChange(s),t.subscriptions.push(C)}return ye(ct);})();
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
