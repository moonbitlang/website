"use strict";var Qy=Object.create;var Qr=Object.defineProperty;var Yy=Object.getOwnPropertyDescriptor;var ev=Object.getOwnPropertyNames;var tv=Object.getPrototypeOf,nv=Object.prototype.hasOwnProperty;var rv=(n,e,t)=>e in n?Qr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var iv=(n,e)=>()=>(n&&(e=n(n=0)),e);var P=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),tf=(n,e)=>{for(var t in e)Qr(n,t,{get:e[t],enumerable:!0})},nf=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ev(e))!nv.call(n,i)&&i!==t&&Qr(n,i,{get:()=>e[i],enumerable:!(r=Yy(e,i))||r.enumerable});return n};var Un=(n,e,t)=>(t=n!=null?Qy(tv(n)):{},nf(e||!n||!n.__esModule?Qr(t,"default",{value:n,enumerable:!0}):t,n)),ji=n=>nf(Qr({},"__esModule",{value:!0}),n);var Ae=(n,e,t)=>(rv(n,typeof e!="symbol"?e+"":e,t),t);var ur=P(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:!0});at.stringArray=at.array=at.func=at.error=at.number=at.string=at.boolean=void 0;function _v(n){return n===!0||n===!1}at.boolean=_v;function df(n){return typeof n=="string"||n instanceof String}at.string=df;function bv(n){return typeof n=="number"||n instanceof Number}at.number=bv;function wv(n){return n instanceof Error}at.error=wv;function Cv(n){return typeof n=="function"}at.func=Cv;function ff(n){return Array.isArray(n)}at.array=ff;function Dv(n){return ff(n)&&n.every(e=>df(e))}at.stringArray=Dv});var aa=P(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.Message=U.NotificationType9=U.NotificationType8=U.NotificationType7=U.NotificationType6=U.NotificationType5=U.NotificationType4=U.NotificationType3=U.NotificationType2=U.NotificationType1=U.NotificationType0=U.NotificationType=U.RequestType9=U.RequestType8=U.RequestType7=U.RequestType6=U.RequestType5=U.RequestType4=U.RequestType3=U.RequestType2=U.RequestType1=U.RequestType=U.RequestType0=U.AbstractMessageSignature=U.ParameterStructures=U.ResponseError=U.ErrorCodes=void 0;var Bn=ur(),As;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(As||(U.ErrorCodes=As={}));var Yr=class extends Error{constructor(e,t,r){super(t),this.code=Bn.number(e)?e:As.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,Yr.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};U.ResponseError=Yr;var Xe=class{constructor(e){this.kind=e}static is(e){return e===Xe.auto||e===Xe.byName||e===Xe.byPosition}toString(){return this.kind}};U.ParameterStructures=Xe;Xe.auto=new Xe("auto");Xe.byPosition=new Xe("byPosition");Xe.byName=new Xe("byName");var ke=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Xe.auto}};U.AbstractMessageSignature=ke;var js=class extends ke{constructor(e){super(e,0)}};U.RequestType0=js;var Hs=class extends ke{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.RequestType=Hs;var Us=class extends ke{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.RequestType1=Us;var Ws=class extends ke{constructor(e){super(e,2)}};U.RequestType2=Ws;var Bs=class extends ke{constructor(e){super(e,3)}};U.RequestType3=Bs;var zs=class extends ke{constructor(e){super(e,4)}};U.RequestType4=zs;var Ks=class extends ke{constructor(e){super(e,5)}};U.RequestType5=Ks;var $s=class extends ke{constructor(e){super(e,6)}};U.RequestType6=$s;var Vs=class extends ke{constructor(e){super(e,7)}};U.RequestType7=Vs;var Xs=class extends ke{constructor(e){super(e,8)}};U.RequestType8=Xs;var Js=class extends ke{constructor(e){super(e,9)}};U.RequestType9=Js;var Gs=class extends ke{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.NotificationType=Gs;var Zs=class extends ke{constructor(e){super(e,0)}};U.NotificationType0=Zs;var Qs=class extends ke{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.NotificationType1=Qs;var Ys=class extends ke{constructor(e){super(e,2)}};U.NotificationType2=Ys;var ea=class extends ke{constructor(e){super(e,3)}};U.NotificationType3=ea;var ta=class extends ke{constructor(e){super(e,4)}};U.NotificationType4=ta;var na=class extends ke{constructor(e){super(e,5)}};U.NotificationType5=na;var ra=class extends ke{constructor(e){super(e,6)}};U.NotificationType6=ra;var ia=class extends ke{constructor(e){super(e,7)}};U.NotificationType7=ia;var oa=class extends ke{constructor(e){super(e,8)}};U.NotificationType8=oa;var sa=class extends ke{constructor(e){super(e,9)}};U.NotificationType9=sa;var pf;(function(n){function e(i){let o=i;return o&&Bn.string(o.method)&&(Bn.string(o.id)||Bn.number(o.id))}n.isRequest=e;function t(i){let o=i;return o&&Bn.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Bn.string(o.id)||Bn.number(o.id)||o.id===null)}n.isResponse=r})(pf||(U.Message=pf={}))});var ua=P(_n=>{"use strict";var hf;Object.defineProperty(_n,"__esModule",{value:!0});_n.LRUCache=_n.LinkedMap=_n.Touch=void 0;var ct;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(ct||(_n.Touch=ct={}));var $i=class{constructor(){this[hf]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=ct.None){let r=this._map.get(e);if(r)return t!==ct.None&&this.touch(r,t),r.value}set(e,t,r=ct.None){let i=this._map.get(e);if(i)i.value=t,r!==ct.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case ct.None:this.addItemLast(i);break;case ct.First:this.addItemFirst(i);break;case ct.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(hf=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==ct.First&&t!==ct.Last)){if(t===ct.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===ct.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};_n.LinkedMap=$i;var ca=class extends $i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=ct.AsNew){return super.get(e,t)}peek(e){return super.get(e,ct.None)}set(e,t){return super.set(e,t,ct.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};_n.LRUCache=ca});var mf=P(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.Disposable=void 0;var gf;(function(n){function e(t){return{dispose:t}}n.create=e})(gf||(Vi.Disposable=gf={}))});var bn=P(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});var la;function da(){if(la===void 0)throw new Error("No runtime abstraction layer installed");return la}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");la=t}n.install=e})(da||(da={}));fa.default=da});var fr=P(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.Emitter=dr.Event=void 0;var Sv=bn(),yf;(function(n){let e={dispose(){}};n.None=function(){return e}})(yf||(dr.Event=yf={}));var pa=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,Sv.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},lr=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new pa),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=lr._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};dr.Emitter=lr;lr._noop=function(){}});var Gi=P(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.CancellationTokenSource=pr.CancellationToken=void 0;var Tv=bn(),Rv=ur(),ha=fr(),Xi;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ha.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ha.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||Rv.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Xi||(pr.CancellationToken=Xi={}));var xv=Object.freeze(function(n,e){let t=(0,Tv.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Ji=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?xv:(this._emitter||(this._emitter=new ha.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},ga=class{get token(){return this._token||(this._token=new Ji),this._token}cancel(){this._token?this._token.cancel():this._token=Xi.Cancelled}dispose(){this._token?this._token instanceof Ji&&this._token.dispose():this._token=Xi.None}};pr.CancellationTokenSource=ga});var vf=P(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.SharedArrayReceiverStrategy=hr.SharedArraySenderStrategy=void 0;var Pv=Gi(),ei;(function(n){n.Continue=0,n.Cancelled=1})(ei||(ei={}));var ma=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=ei.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,ei.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};hr.SharedArraySenderStrategy=ma;var ya=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===ei.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},va=class{constructor(e){this.token=new ya(e)}cancel(){}dispose(){}},_a=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new Pv.CancellationTokenSource:new va(t)}};hr.SharedArrayReceiverStrategy=_a});var wa=P(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.Semaphore=void 0;var kv=bn(),ba=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,kv.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Zi.Semaphore=ba});var bf=P(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.ReadableStreamMessageReader=wn.AbstractMessageReader=wn.MessageReader=void 0;var Da=bn(),gr=ur(),Ca=fr(),qv=wa(),_f;(function(n){function e(t){let r=t;return r&&gr.func(r.listen)&&gr.func(r.dispose)&&gr.func(r.onError)&&gr.func(r.onClose)&&gr.func(r.onPartialMessage)}n.is=e})(_f||(wn.MessageReader=_f={}));var Qi=class{constructor(){this.errorEmitter=new Ca.Emitter,this.closeEmitter=new Ca.Emitter,this.partialMessageEmitter=new Ca.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${gr.string(e.message)?e.message:"unknown"}`)}};wn.AbstractMessageReader=Qi;var Sa;(function(n){function e(t){let r,i,o,s=new Map,a,u=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,s.set(o.name,o)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)s.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,u.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)u.set(l.name,l)}return a===void 0&&(a=(0,Da.default)().applicationJson.decoder,u.set(a.name,a)),{charset:r,contentDecoder:o,contentDecoders:s,contentTypeDecoder:a,contentTypeDecoders:u}}n.fromOptions=e})(Sa||(Sa={}));var Ta=class extends Qi{constructor(e,t){super(),this.readable=e,this.options=Sa.fromOptions(t),this.buffer=(0,Da.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new qv.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Da.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};wn.ReadableStreamMessageReader=Ta});var Tf=P(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.WriteableStreamMessageWriter=Cn.AbstractMessageWriter=Cn.MessageWriter=void 0;var wf=bn(),ti=ur(),Iv=wa(),Cf=fr(),Ev="Content-Length: ",Df=`\r
`,Sf;(function(n){function e(t){let r=t;return r&&ti.func(r.dispose)&&ti.func(r.onClose)&&ti.func(r.onError)&&ti.func(r.write)}n.is=e})(Sf||(Cn.MessageWriter=Sf={}));var Yi=class{constructor(){this.errorEmitter=new Cf.Emitter,this.closeEmitter=new Cf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${ti.string(e.message)?e.message:"unknown"}`)}};Cn.AbstractMessageWriter=Yi;var Ra;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,wf.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,wf.default)().applicationJson.encoder}}n.fromOptions=e})(Ra||(Ra={}));var xa=class extends Yi{constructor(e,t){super(),this.writable=e,this.options=Ra.fromOptions(t),this.errorCount=0,this.writeSemaphore=new Iv.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(Ev,r.byteLength.toString(),Df),i.push(Df),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Cn.WriteableStreamMessageWriter=xa});var Rf=P(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.AbstractMessageBuffer=void 0;var Ov=13,Fv=10,Lv=`\r
`,Pa=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){let l=this._chunks[r];i=0;t:for(;i<l.length;){switch(l[i]){case Ov:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case Fv:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=l.byteLength,r++}if(t!==4)return;let s=this._read(o+i),a=new Map,u=this.toString(s,"ascii").split(Lv);if(u.length<2)return a;for(let l=0;l<u.length-2;l++){let f=u[l],h=f.indexOf(":");if(h===-1)throw new Error(`Message header must separate key and value using ':'
${f}`);let p=f.substr(0,h),m=f.substr(h+1).trim();a.set(e?p.toLowerCase():p,m)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}};eo.AbstractMessageBuffer=Pa});var If=P(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.createMessageConnection=Q.ConnectionOptions=Q.MessageStrategy=Q.CancellationStrategy=Q.CancellationSenderStrategy=Q.CancellationReceiverStrategy=Q.RequestCancellationReceiverStrategy=Q.IdCancellationReceiverStrategy=Q.ConnectionStrategy=Q.ConnectionError=Q.ConnectionErrors=Q.LogTraceNotification=Q.SetTraceNotification=Q.TraceFormat=Q.TraceValues=Q.Trace=Q.NullLogger=Q.ProgressType=Q.ProgressToken=void 0;var xf=bn(),Ee=ur(),$=aa(),Pf=ua(),ni=fr(),ka=Gi(),oi;(function(n){n.type=new $.NotificationType("$/cancelRequest")})(oi||(oi={}));var qa;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(qa||(Q.ProgressToken=qa={}));var ri;(function(n){n.type=new $.NotificationType("$/progress")})(ri||(ri={}));var Ia=class{constructor(){}};Q.ProgressType=Ia;var Ea;(function(n){function e(t){return Ee.func(t)}n.is=e})(Ea||(Ea={}));Q.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var ge;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(ge||(Q.Trace=ge={}));var kf;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(kf||(Q.TraceValues=kf={}));(function(n){function e(r){if(!Ee.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(ge||(Q.Trace=ge={}));var Dt;(function(n){n.Text="text",n.JSON="json"})(Dt||(Q.TraceFormat=Dt={}));(function(n){function e(t){return Ee.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Dt||(Q.TraceFormat=Dt={}));var Oa;(function(n){n.type=new $.NotificationType("$/setTrace")})(Oa||(Q.SetTraceNotification=Oa={}));var to;(function(n){n.type=new $.NotificationType("$/logTrace")})(to||(Q.LogTraceNotification=to={}));var ii;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(ii||(Q.ConnectionErrors=ii={}));var Dn=class extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,Dn.prototype)}};Q.ConnectionError=Dn;var Fa;(function(n){function e(t){let r=t;return r&&Ee.func(r.cancelUndispatched)}n.is=e})(Fa||(Q.ConnectionStrategy=Fa={}));var no;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&Ee.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ee.func(r.dispose))}n.is=e})(no||(Q.IdCancellationReceiverStrategy=no={}));var La;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&Ee.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ee.func(r.dispose))}n.is=e})(La||(Q.RequestCancellationReceiverStrategy=La={}));var ro;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new ka.CancellationTokenSource}});function e(t){return no.is(t)||La.is(t)}n.is=e})(ro||(Q.CancellationReceiverStrategy=ro={}));var io;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(oi.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&Ee.func(r.sendCancellation)&&Ee.func(r.cleanup)}n.is=e})(io||(Q.CancellationSenderStrategy=io={}));var oo;(function(n){n.Message=Object.freeze({receiver:ro.Message,sender:io.Message});function e(t){let r=t;return r&&ro.is(r.receiver)&&io.is(r.sender)}n.is=e})(oo||(Q.CancellationStrategy=oo={}));var so;(function(n){function e(t){let r=t;return r&&Ee.func(r.handleMessage)}n.is=e})(so||(Q.MessageStrategy=so={}));var qf;(function(n){function e(t){let r=t;return r&&(oo.is(r.cancellationStrategy)||Fa.is(r.connectionStrategy)||so.is(r.messageStrategy))}n.is=e})(qf||(Q.ConnectionOptions=qf={}));var At;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(At||(At={}));function Mv(n,e,t,r){let i=t!==void 0?t:Q.NullLogger,o=0,s=0,a=0,u="2.0",l,f=new Map,h,p=new Map,m=new Map,g,b=new Pf.LinkedMap,D=new Map,k=new Set,z=new Map,j=ge.Off,fe=Dt.Text,K,ae=At.New,W=new ni.Emitter,G=new ni.Emitter,ne=new ni.Emitter,Ue=new ni.Emitter,O=new ni.Emitter,x=r&&r.cancellationStrategy?r.cancellationStrategy:oo.Message;function L(v){if(v===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+v.toString()}function N(v){return v===null?"res-unknown-"+(++a).toString():"res-"+v.toString()}function ee(){return"not-"+(++s).toString()}function B(v,T){$.Message.isRequest(T)?v.set(L(T.id),T):$.Message.isResponse(T)?v.set(N(T.id),T):v.set(ee(),T)}function X(v){}function ze(){return ae===At.Listening}function ce(){return ae===At.Closed}function pe(){return ae===At.Disposed}function st(){(ae===At.New||ae===At.Listening)&&(ae=At.Closed,G.fire(void 0))}function Nt(v){W.fire([v,void 0,void 0])}function $r(v){W.fire(v)}n.onClose(st),n.onError(Nt),e.onClose(st),e.onError($r);function Mn(){g||b.size===0||(g=(0,xf.default)().timer.setImmediate(()=>{g=void 0,ir()}))}function Nn(v){$.Message.isRequest(v)?An(v):$.Message.isNotification(v)?mn(v):$.Message.isResponse(v)?gn(v):Xr(v)}function ir(){if(b.size===0)return;let v=b.shift();try{let T=r?.messageStrategy;so.is(T)?T.handleMessage(v,Nn):Nn(v)}finally{Mn()}}let Vr=v=>{try{if($.Message.isNotification(v)&&v.method===oi.type.method){let T=v.params.id,E=L(T),M=b.get(E);if($.Message.isRequest(M)){let he=r?.connectionStrategy,De=he&&he.cancelUndispatched?he.cancelUndispatched(M,X):void 0;if(De&&(De.error!==void 0||De.result!==void 0)){b.delete(E),z.delete(T),De.id=M.id,tn(De,v.method,Date.now()),e.write(De).catch(()=>i.error("Sending response for canceled message failed."));return}}let ye=z.get(T);if(ye!==void 0){ye.cancel(),nn(v);return}else k.add(T)}B(b,v)}finally{Mn()}};function An(v){if(pe())return;function T(re,we,le){let Pe={jsonrpc:u,id:v.id};re instanceof $.ResponseError?Pe.error=re.toJson():Pe.result=re===void 0?null:re,tn(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}function E(re,we,le){let Pe={jsonrpc:u,id:v.id,error:re.toJson()};tn(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}function M(re,we,le){re===void 0&&(re=null);let Pe={jsonrpc:u,id:v.id,result:re};tn(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}Jr(v);let ye=f.get(v.method),he,De;ye&&(he=ye.type,De=ye.handler);let xe=Date.now();if(De||l){let re=v.id??String(Date.now()),we=no.is(x.receiver)?x.receiver.createCancellationTokenSource(re):x.receiver.createCancellationTokenSource(v);v.id!==null&&k.has(v.id)&&we.cancel(),v.id!==null&&z.set(re,we);try{let le;if(De)if(v.params===void 0){if(he!==void 0&&he.numberOfParams!==0){E(new $.ResponseError($.ErrorCodes.InvalidParams,`Request ${v.method} defines ${he.numberOfParams} params but received none.`),v.method,xe);return}le=De(we.token)}else if(Array.isArray(v.params)){if(he!==void 0&&he.parameterStructures===$.ParameterStructures.byName){E(new $.ResponseError($.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by name but received parameters by position`),v.method,xe);return}le=De(...v.params,we.token)}else{if(he!==void 0&&he.parameterStructures===$.ParameterStructures.byPosition){E(new $.ResponseError($.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by position but received parameters by name`),v.method,xe);return}le=De(v.params,we.token)}else l&&(le=l(v.method,v.params,we.token));let Pe=le;le?Pe.then?Pe.then(We=>{z.delete(re),T(We,v.method,xe)},We=>{z.delete(re),We instanceof $.ResponseError?E(We,v.method,xe):We&&Ee.string(We.message)?E(new $.ResponseError($.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${We.message}`),v.method,xe):E(new $.ResponseError($.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,xe)}):(z.delete(re),T(le,v.method,xe)):(z.delete(re),M(le,v.method,xe))}catch(le){z.delete(re),le instanceof $.ResponseError?T(le,v.method,xe):le&&Ee.string(le.message)?E(new $.ResponseError($.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${le.message}`),v.method,xe):E(new $.ResponseError($.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,xe)}}else E(new $.ResponseError($.ErrorCodes.MethodNotFound,`Unhandled method ${v.method}`),v.method,xe)}function gn(v){if(!pe())if(v.id===null)v.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(v.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let T=v.id,E=D.get(T);if(jn(v,E),E!==void 0){D.delete(T);try{if(v.error){let M=v.error;E.reject(new $.ResponseError(M.code,M.message,M.data))}else if(v.result!==void 0)E.resolve(v.result);else throw new Error("Should never happen.")}catch(M){M.message?i.error(`Response handler '${E.method}' failed with message: ${M.message}`):i.error(`Response handler '${E.method}' failed unexpectedly.`)}}}}function mn(v){if(pe())return;let T,E;if(v.method===oi.type.method){let M=v.params.id;k.delete(M),nn(v);return}else{let M=p.get(v.method);M&&(E=M.handler,T=M.type)}if(E||h)try{if(nn(v),E)if(v.params===void 0)T!==void 0&&T.numberOfParams!==0&&T.parameterStructures!==$.ParameterStructures.byName&&i.error(`Notification ${v.method} defines ${T.numberOfParams} params but received none.`),E();else if(Array.isArray(v.params)){let M=v.params;v.method===ri.type.method&&M.length===2&&qa.is(M[0])?E({token:M[0],value:M[1]}):(T!==void 0&&(T.parameterStructures===$.ParameterStructures.byName&&i.error(`Notification ${v.method} defines parameters by name but received parameters by position`),T.numberOfParams!==v.params.length&&i.error(`Notification ${v.method} defines ${T.numberOfParams} params but received ${M.length} arguments`)),E(...M))}else T!==void 0&&T.parameterStructures===$.ParameterStructures.byPosition&&i.error(`Notification ${v.method} defines parameters by position but received parameters by name`),E(v.params);else h&&h(v.method,v.params)}catch(M){M.message?i.error(`Notification handler '${v.method}' failed with message: ${M.message}`):i.error(`Notification handler '${v.method}' failed unexpectedly.`)}else ne.fire(v)}function Xr(v){if(!v){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(v,null,4)}`);let T=v;if(Ee.string(T.id)||Ee.number(T.id)){let E=T.id,M=D.get(E);M&&M.reject(new Error("The received response has neither a result nor an error property."))}}function et(v){if(v!=null)switch(j){case ge.Verbose:return JSON.stringify(v,null,4);case ge.Compact:return JSON.stringify(v);default:return}}function or(v){if(!(j===ge.Off||!K))if(fe===Dt.Text){let T;(j===ge.Verbose||j===ge.Compact)&&v.params&&(T=`Params: ${et(v.params)}

`),K.log(`Sending request '${v.method} - (${v.id})'.`,T)}else Ke("send-request",v)}function yn(v){if(!(j===ge.Off||!K))if(fe===Dt.Text){let T;(j===ge.Verbose||j===ge.Compact)&&(v.params?T=`Params: ${et(v.params)}

`:T=`No parameters provided.

`),K.log(`Sending notification '${v.method}'.`,T)}else Ke("send-notification",v)}function tn(v,T,E){if(!(j===ge.Off||!K))if(fe===Dt.Text){let M;(j===ge.Verbose||j===ge.Compact)&&(v.error&&v.error.data?M=`Error data: ${et(v.error.data)}

`:v.result?M=`Result: ${et(v.result)}

`:v.error===void 0&&(M=`No result returned.

`)),K.log(`Sending response '${T} - (${v.id})'. Processing request took ${Date.now()-E}ms`,M)}else Ke("send-response",v)}function Jr(v){if(!(j===ge.Off||!K))if(fe===Dt.Text){let T;(j===ge.Verbose||j===ge.Compact)&&v.params&&(T=`Params: ${et(v.params)}

`),K.log(`Received request '${v.method} - (${v.id})'.`,T)}else Ke("receive-request",v)}function nn(v){if(!(j===ge.Off||!K||v.method===to.type.method))if(fe===Dt.Text){let T;(j===ge.Verbose||j===ge.Compact)&&(v.params?T=`Params: ${et(v.params)}

`:T=`No parameters provided.

`),K.log(`Received notification '${v.method}'.`,T)}else Ke("receive-notification",v)}function jn(v,T){if(!(j===ge.Off||!K))if(fe===Dt.Text){let E;if((j===ge.Verbose||j===ge.Compact)&&(v.error&&v.error.data?E=`Error data: ${et(v.error.data)}

`:v.result?E=`Result: ${et(v.result)}

`:v.error===void 0&&(E=`No result returned.

`)),T){let M=v.error?` Request failed: ${v.error.message} (${v.error.code}).`:"";K.log(`Received response '${T.method} - (${v.id})' in ${Date.now()-T.timerStart}ms.${M}`,E)}else K.log(`Received response ${v.id} without active response promise.`,E)}else Ke("receive-response",v)}function Ke(v,T){if(!K||j===ge.Off)return;let E={isLSPMessage:!0,type:v,message:T,timestamp:Date.now()};K.log(E)}function wt(){if(ce())throw new Dn(ii.Closed,"Connection is closed.");if(pe())throw new Dn(ii.Disposed,"Connection is disposed.")}function gt(){if(ze())throw new Dn(ii.AlreadyListening,"Connection is already listening")}function Kt(){if(!ze())throw new Error("Call listen() first.")}function rn(v){return v===void 0?null:v}function Hn(v){if(v!==null)return v}function sr(v){return v!=null&&!Array.isArray(v)&&typeof v=="object"}function vn(v,T){switch(v){case $.ParameterStructures.auto:return sr(T)?Hn(T):[rn(T)];case $.ParameterStructures.byName:if(!sr(T))throw new Error("Received parameters by name but param is not an object literal.");return Hn(T);case $.ParameterStructures.byPosition:return[rn(T)];default:throw new Error(`Unknown parameter structure ${v.toString()}`)}}function ar(v,T){let E,M=v.numberOfParams;switch(M){case 0:E=void 0;break;case 1:E=vn(v.parameterStructures,T[0]);break;default:E=[];for(let ye=0;ye<T.length&&ye<M;ye++)E.push(rn(T[ye]));if(T.length<M)for(let ye=T.length;ye<M;ye++)E.push(null);break}return E}let kt={sendNotification:(v,...T)=>{wt();let E,M;if(Ee.string(v)){E=v;let he=T[0],De=0,xe=$.ParameterStructures.auto;$.ParameterStructures.is(he)&&(De=1,xe=he);let re=T.length,we=re-De;switch(we){case 0:M=void 0;break;case 1:M=vn(xe,T[De]);break;default:if(xe===$.ParameterStructures.byName)throw new Error(`Received ${we} parameters for 'by Name' notification parameter structure.`);M=T.slice(De,re).map(le=>rn(le));break}}else{let he=T;E=v.method,M=ar(v,he)}let ye={jsonrpc:u,method:E,params:M};return yn(ye),e.write(ye).catch(he=>{throw i.error("Sending notification failed."),he})},onNotification:(v,T)=>{wt();let E;return Ee.func(v)?h=v:T&&(Ee.string(v)?(E=v,p.set(v,{type:void 0,handler:T})):(E=v.method,p.set(v.method,{type:v,handler:T}))),{dispose:()=>{E!==void 0?p.delete(E):h=void 0}}},onProgress:(v,T,E)=>{if(m.has(T))throw new Error(`Progress handler for token ${T} already registered`);return m.set(T,E),{dispose:()=>{m.delete(T)}}},sendProgress:(v,T,E)=>kt.sendNotification(ri.type,{token:T,value:E}),onUnhandledProgress:Ue.event,sendRequest:(v,...T)=>{wt(),Kt();let E,M,ye;if(Ee.string(v)){E=v;let re=T[0],we=T[T.length-1],le=0,Pe=$.ParameterStructures.auto;$.ParameterStructures.is(re)&&(le=1,Pe=re);let We=T.length;ka.CancellationToken.is(we)&&(We=We-1,ye=we);let pt=We-le;switch(pt){case 0:M=void 0;break;case 1:M=vn(Pe,T[le]);break;default:if(Pe===$.ParameterStructures.byName)throw new Error(`Received ${pt} parameters for 'by Name' request parameter structure.`);M=T.slice(le,We).map(Gr=>rn(Gr));break}}else{let re=T;E=v.method,M=ar(v,re);let we=v.numberOfParams;ye=ka.CancellationToken.is(re[we])?re[we]:void 0}let he=o++,De;ye&&(De=ye.onCancellationRequested(()=>{let re=x.sender.sendCancellation(kt,he);return re===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${he}`),Promise.resolve()):re.catch(()=>{i.log(`Sending cancellation messages for id ${he} failed`)})}));let xe={jsonrpc:u,id:he,method:E,params:M};return or(xe),typeof x.sender.enableCancellation=="function"&&x.sender.enableCancellation(xe),new Promise(async(re,we)=>{let le=pt=>{re(pt),x.sender.cleanup(he),De?.dispose()},Pe=pt=>{we(pt),x.sender.cleanup(he),De?.dispose()},We={method:E,timerStart:Date.now(),resolve:le,reject:Pe};try{await e.write(xe),D.set(he,We)}catch(pt){throw i.error("Sending request failed."),We.reject(new $.ResponseError($.ErrorCodes.MessageWriteError,pt.message?pt.message:"Unknown reason")),pt}})},onRequest:(v,T)=>{wt();let E=null;return Ea.is(v)?(E=void 0,l=v):Ee.string(v)?(E=null,T!==void 0&&(E=v,f.set(v,{handler:T,type:void 0}))):T!==void 0&&(E=v.method,f.set(v.method,{type:v,handler:T})),{dispose:()=>{E!==null&&(E!==void 0?f.delete(E):l=void 0)}}},hasPendingResponse:()=>D.size>0,trace:async(v,T,E)=>{let M=!1,ye=Dt.Text;E!==void 0&&(Ee.boolean(E)?M=E:(M=E.sendNotification||!1,ye=E.traceFormat||Dt.Text)),j=v,fe=ye,j===ge.Off?K=void 0:K=T,M&&!ce()&&!pe()&&await kt.sendNotification(Oa.type,{value:ge.toString(v)})},onError:W.event,onClose:G.event,onUnhandledNotification:ne.event,onDispose:O.event,end:()=>{e.end()},dispose:()=>{if(pe())return;ae=At.Disposed,O.fire(void 0);let v=new $.ResponseError($.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let T of D.values())T.reject(v);D=new Map,z=new Map,k=new Set,b=new Pf.LinkedMap,Ee.func(e.dispose)&&e.dispose(),Ee.func(n.dispose)&&n.dispose()},listen:()=>{wt(),gt(),ae=At.Listening,n.listen(Vr)},inspect:()=>{(0,xf.default)().console.log("inspect")}};return kt.onNotification(to.type,v=>{if(j===ge.Off||!K)return;let T=j===ge.Verbose||j===ge.Compact;K.log(v.message,T?v.verbose:void 0)}),kt.onNotification(ri.type,v=>{let T=m.get(v.token);T?T(v.value):Ue.fire(v)}),kt}Q.createMessageConnection=Mv});var ao=P(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.ProgressType=S.ProgressToken=S.createMessageConnection=S.NullLogger=S.ConnectionOptions=S.ConnectionStrategy=S.AbstractMessageBuffer=S.WriteableStreamMessageWriter=S.AbstractMessageWriter=S.MessageWriter=S.ReadableStreamMessageReader=S.AbstractMessageReader=S.MessageReader=S.SharedArrayReceiverStrategy=S.SharedArraySenderStrategy=S.CancellationToken=S.CancellationTokenSource=S.Emitter=S.Event=S.Disposable=S.LRUCache=S.Touch=S.LinkedMap=S.ParameterStructures=S.NotificationType9=S.NotificationType8=S.NotificationType7=S.NotificationType6=S.NotificationType5=S.NotificationType4=S.NotificationType3=S.NotificationType2=S.NotificationType1=S.NotificationType0=S.NotificationType=S.ErrorCodes=S.ResponseError=S.RequestType9=S.RequestType8=S.RequestType7=S.RequestType6=S.RequestType5=S.RequestType4=S.RequestType3=S.RequestType2=S.RequestType1=S.RequestType0=S.RequestType=S.Message=S.RAL=void 0;S.MessageStrategy=S.CancellationStrategy=S.CancellationSenderStrategy=S.CancellationReceiverStrategy=S.ConnectionError=S.ConnectionErrors=S.LogTraceNotification=S.SetTraceNotification=S.TraceFormat=S.TraceValues=S.Trace=void 0;var Re=aa();Object.defineProperty(S,"Message",{enumerable:!0,get:function(){return Re.Message}});Object.defineProperty(S,"RequestType",{enumerable:!0,get:function(){return Re.RequestType}});Object.defineProperty(S,"RequestType0",{enumerable:!0,get:function(){return Re.RequestType0}});Object.defineProperty(S,"RequestType1",{enumerable:!0,get:function(){return Re.RequestType1}});Object.defineProperty(S,"RequestType2",{enumerable:!0,get:function(){return Re.RequestType2}});Object.defineProperty(S,"RequestType3",{enumerable:!0,get:function(){return Re.RequestType3}});Object.defineProperty(S,"RequestType4",{enumerable:!0,get:function(){return Re.RequestType4}});Object.defineProperty(S,"RequestType5",{enumerable:!0,get:function(){return Re.RequestType5}});Object.defineProperty(S,"RequestType6",{enumerable:!0,get:function(){return Re.RequestType6}});Object.defineProperty(S,"RequestType7",{enumerable:!0,get:function(){return Re.RequestType7}});Object.defineProperty(S,"RequestType8",{enumerable:!0,get:function(){return Re.RequestType8}});Object.defineProperty(S,"RequestType9",{enumerable:!0,get:function(){return Re.RequestType9}});Object.defineProperty(S,"ResponseError",{enumerable:!0,get:function(){return Re.ResponseError}});Object.defineProperty(S,"ErrorCodes",{enumerable:!0,get:function(){return Re.ErrorCodes}});Object.defineProperty(S,"NotificationType",{enumerable:!0,get:function(){return Re.NotificationType}});Object.defineProperty(S,"NotificationType0",{enumerable:!0,get:function(){return Re.NotificationType0}});Object.defineProperty(S,"NotificationType1",{enumerable:!0,get:function(){return Re.NotificationType1}});Object.defineProperty(S,"NotificationType2",{enumerable:!0,get:function(){return Re.NotificationType2}});Object.defineProperty(S,"NotificationType3",{enumerable:!0,get:function(){return Re.NotificationType3}});Object.defineProperty(S,"NotificationType4",{enumerable:!0,get:function(){return Re.NotificationType4}});Object.defineProperty(S,"NotificationType5",{enumerable:!0,get:function(){return Re.NotificationType5}});Object.defineProperty(S,"NotificationType6",{enumerable:!0,get:function(){return Re.NotificationType6}});Object.defineProperty(S,"NotificationType7",{enumerable:!0,get:function(){return Re.NotificationType7}});Object.defineProperty(S,"NotificationType8",{enumerable:!0,get:function(){return Re.NotificationType8}});Object.defineProperty(S,"NotificationType9",{enumerable:!0,get:function(){return Re.NotificationType9}});Object.defineProperty(S,"ParameterStructures",{enumerable:!0,get:function(){return Re.ParameterStructures}});var Ma=ua();Object.defineProperty(S,"LinkedMap",{enumerable:!0,get:function(){return Ma.LinkedMap}});Object.defineProperty(S,"LRUCache",{enumerable:!0,get:function(){return Ma.LRUCache}});Object.defineProperty(S,"Touch",{enumerable:!0,get:function(){return Ma.Touch}});var Nv=mf();Object.defineProperty(S,"Disposable",{enumerable:!0,get:function(){return Nv.Disposable}});var Ef=fr();Object.defineProperty(S,"Event",{enumerable:!0,get:function(){return Ef.Event}});Object.defineProperty(S,"Emitter",{enumerable:!0,get:function(){return Ef.Emitter}});var Of=Gi();Object.defineProperty(S,"CancellationTokenSource",{enumerable:!0,get:function(){return Of.CancellationTokenSource}});Object.defineProperty(S,"CancellationToken",{enumerable:!0,get:function(){return Of.CancellationToken}});var Ff=vf();Object.defineProperty(S,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Ff.SharedArraySenderStrategy}});Object.defineProperty(S,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Ff.SharedArrayReceiverStrategy}});var Na=bf();Object.defineProperty(S,"MessageReader",{enumerable:!0,get:function(){return Na.MessageReader}});Object.defineProperty(S,"AbstractMessageReader",{enumerable:!0,get:function(){return Na.AbstractMessageReader}});Object.defineProperty(S,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Na.ReadableStreamMessageReader}});var Aa=Tf();Object.defineProperty(S,"MessageWriter",{enumerable:!0,get:function(){return Aa.MessageWriter}});Object.defineProperty(S,"AbstractMessageWriter",{enumerable:!0,get:function(){return Aa.AbstractMessageWriter}});Object.defineProperty(S,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Aa.WriteableStreamMessageWriter}});var Av=Rf();Object.defineProperty(S,"AbstractMessageBuffer",{enumerable:!0,get:function(){return Av.AbstractMessageBuffer}});var nt=If();Object.defineProperty(S,"ConnectionStrategy",{enumerable:!0,get:function(){return nt.ConnectionStrategy}});Object.defineProperty(S,"ConnectionOptions",{enumerable:!0,get:function(){return nt.ConnectionOptions}});Object.defineProperty(S,"NullLogger",{enumerable:!0,get:function(){return nt.NullLogger}});Object.defineProperty(S,"createMessageConnection",{enumerable:!0,get:function(){return nt.createMessageConnection}});Object.defineProperty(S,"ProgressToken",{enumerable:!0,get:function(){return nt.ProgressToken}});Object.defineProperty(S,"ProgressType",{enumerable:!0,get:function(){return nt.ProgressType}});Object.defineProperty(S,"Trace",{enumerable:!0,get:function(){return nt.Trace}});Object.defineProperty(S,"TraceValues",{enumerable:!0,get:function(){return nt.TraceValues}});Object.defineProperty(S,"TraceFormat",{enumerable:!0,get:function(){return nt.TraceFormat}});Object.defineProperty(S,"SetTraceNotification",{enumerable:!0,get:function(){return nt.SetTraceNotification}});Object.defineProperty(S,"LogTraceNotification",{enumerable:!0,get:function(){return nt.LogTraceNotification}});Object.defineProperty(S,"ConnectionErrors",{enumerable:!0,get:function(){return nt.ConnectionErrors}});Object.defineProperty(S,"ConnectionError",{enumerable:!0,get:function(){return nt.ConnectionError}});Object.defineProperty(S,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return nt.CancellationReceiverStrategy}});Object.defineProperty(S,"CancellationSenderStrategy",{enumerable:!0,get:function(){return nt.CancellationSenderStrategy}});Object.defineProperty(S,"CancellationStrategy",{enumerable:!0,get:function(){return nt.CancellationStrategy}});Object.defineProperty(S,"MessageStrategy",{enumerable:!0,get:function(){return nt.MessageStrategy}});var jv=bn();S.RAL=jv.default});var Mf=P(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});var Xt=ao(),mr=class extends Xt.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return mr.emptyBuffer}fromString(e,t){return new TextEncoder().encode(e)}toString(e,t){return t==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}};mr.emptyBuffer=new Uint8Array(0);var ja=class{constructor(e){this.socket=e,this._onData=new Xt.Emitter,this._messageListener=t=>{t.data.arrayBuffer().then(i=>{this._onData.fire(new Uint8Array(i))},()=>{(0,Xt.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),Xt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Xt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Xt.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}},Ha=class{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),Xt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Xt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Xt.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,t){if(typeof e=="string"){if(t!==void 0&&t!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}},Hv=new TextEncoder,Lf=Object.freeze({messageBuffer:Object.freeze({create:n=>new mr(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(Hv.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new ja(n),asWritableStream:n=>new Ha(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setTimeout(n,0,...e);return{dispose:()=>clearTimeout(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function Ua(){return Lf}(function(n){function e(){Xt.RAL.install(Lf)}n.install=e})(Ua||(Ua={}));Wa.default=Ua});var zn=P(St=>{"use strict";var Uv=St&&St.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Wv=St&&St.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Uv(e,n,t)};Object.defineProperty(St,"__esModule",{value:!0});St.createMessageConnection=St.BrowserMessageWriter=St.BrowserMessageReader=void 0;var Bv=Mf();Bv.default.install();var yr=ao();Wv(ao(),St);var Ba=class extends yr.AbstractMessageReader{constructor(e){super(),this._onData=new yr.Emitter,this._messageListener=t=>{this._onData.fire(t.data)},e.addEventListener("error",t=>this.fireError(t)),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}};St.BrowserMessageReader=Ba;var za=class extends yr.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};St.BrowserMessageWriter=za;function zv(n,e,t,r){return t===void 0&&(t=yr.NullLogger),yr.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,yr.createMessageConnection)(n,e,t,r)}St.createMessageConnection=zv});var Ka=P((wC,Nf)=>{"use strict";Nf.exports=zn()});var yo={};tf(yo,{AnnotatedTextEdit:()=>on,ChangeAnnotation:()=>Kn,ChangeAnnotationIdentifier:()=>rt,CodeAction:()=>Rc,CodeActionContext:()=>Tc,CodeActionKind:()=>Sc,CodeActionTriggerKind:()=>fi,CodeDescription:()=>tc,CodeLens:()=>xc,Color:()=>uo,ColorInformation:()=>Ja,ColorPresentation:()=>Ga,Command:()=>$n,CompletionItem:()=>fc,CompletionItemKind:()=>sc,CompletionItemLabelDetails:()=>dc,CompletionItemTag:()=>cc,CompletionList:()=>pc,CreateFile:()=>_r,DeleteFile:()=>wr,Diagnostic:()=>ci,DiagnosticRelatedInformation:()=>lo,DiagnosticSeverity:()=>Ya,DiagnosticTag:()=>ec,DocumentHighlight:()=>vc,DocumentHighlightKind:()=>yc,DocumentLink:()=>kc,DocumentSymbol:()=>Dc,DocumentUri:()=>$a,EOL:()=>Kv,FoldingRange:()=>Qa,FoldingRangeKind:()=>Za,FormattingOptions:()=>Pc,Hover:()=>hc,InlayHint:()=>Ac,InlayHintKind:()=>go,InlayHintLabelPart:()=>mo,InlineCompletionContext:()=>zc,InlineCompletionItem:()=>Hc,InlineCompletionList:()=>Uc,InlineCompletionTriggerKind:()=>Wc,InlineValueContext:()=>Nc,InlineValueEvaluatableExpression:()=>Mc,InlineValueText:()=>Fc,InlineValueVariableLookup:()=>Lc,InsertReplaceEdit:()=>uc,InsertTextFormat:()=>ac,InsertTextMode:()=>lc,Location:()=>ai,LocationLink:()=>Xa,MarkedString:()=>di,MarkupContent:()=>Cr,MarkupKind:()=>ho,OptionalVersionedTextDocumentIdentifier:()=>li,ParameterInformation:()=>gc,Position:()=>qt,Range:()=>Fe,RenameFile:()=>br,SelectedCompletionInfo:()=>Bc,SelectionRange:()=>qc,SemanticTokenModifiers:()=>Ec,SemanticTokenTypes:()=>Ic,SemanticTokens:()=>Oc,SignatureInformation:()=>mc,StringValue:()=>jc,SymbolInformation:()=>wc,SymbolKind:()=>_c,SymbolTag:()=>bc,TextDocument:()=>$c,TextDocumentEdit:()=>ui,TextDocumentIdentifier:()=>rc,TextDocumentItem:()=>oc,TextEdit:()=>Jt,URI:()=>co,VersionedTextDocumentIdentifier:()=>ic,WorkspaceChange:()=>nc,WorkspaceEdit:()=>fo,WorkspaceFolder:()=>Kc,WorkspaceSymbol:()=>Cc,integer:()=>Va,uinteger:()=>si});var $a,co,Va,si,qt,Fe,ai,Xa,uo,Ja,Ga,Za,Qa,lo,Ya,ec,tc,ci,$n,Jt,Kn,rt,on,ui,_r,br,wr,fo,vr,po,nc,rc,ic,li,oc,ho,Cr,sc,ac,cc,uc,lc,dc,fc,pc,di,hc,gc,mc,yc,vc,_c,bc,wc,Cc,Dc,Sc,fi,Tc,Rc,xc,Pc,kc,qc,Ic,Ec,Oc,Fc,Lc,Mc,Nc,go,mo,Ac,jc,Hc,Uc,Wc,Bc,zc,Kc,Kv,$c,Vc,w,vo=iv(()=>{"use strict";(function(n){function e(t){return typeof t=="string"}n.is=e})($a||($a={}));(function(n){function e(t){return typeof t=="string"}n.is=e})(co||(co={}));(function(n){n.MIN_VALUE=-2147483648,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(Va||(Va={}));(function(n){n.MIN_VALUE=0,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(si||(si={}));(function(n){function e(r,i){return r===Number.MAX_VALUE&&(r=si.MAX_VALUE),i===Number.MAX_VALUE&&(i=si.MAX_VALUE),{line:r,character:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.uinteger(i.line)&&w.uinteger(i.character)}n.is=t})(qt||(qt={}));(function(n){function e(r,i,o,s){if(w.uinteger(r)&&w.uinteger(i)&&w.uinteger(o)&&w.uinteger(s))return{start:qt.create(r,i),end:qt.create(o,s)};if(qt.is(r)&&qt.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${o}, ${s}]`)}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&qt.is(i.start)&&qt.is(i.end)}n.is=t})(Fe||(Fe={}));(function(n){function e(r,i){return{uri:r,range:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Fe.is(i.range)&&(w.string(i.uri)||w.undefined(i.uri))}n.is=t})(ai||(ai={}));(function(n){function e(r,i,o,s){return{targetUri:r,targetRange:i,targetSelectionRange:o,originSelectionRange:s}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Fe.is(i.targetRange)&&w.string(i.targetUri)&&Fe.is(i.targetSelectionRange)&&(Fe.is(i.originSelectionRange)||w.undefined(i.originSelectionRange))}n.is=t})(Xa||(Xa={}));(function(n){function e(r,i,o,s){return{red:r,green:i,blue:o,alpha:s}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.numberRange(i.red,0,1)&&w.numberRange(i.green,0,1)&&w.numberRange(i.blue,0,1)&&w.numberRange(i.alpha,0,1)}n.is=t})(uo||(uo={}));(function(n){function e(r,i){return{range:r,color:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Fe.is(i.range)&&uo.is(i.color)}n.is=t})(Ja||(Ja={}));(function(n){function e(r,i,o){return{label:r,textEdit:i,additionalTextEdits:o}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.string(i.label)&&(w.undefined(i.textEdit)||Jt.is(i))&&(w.undefined(i.additionalTextEdits)||w.typedArray(i.additionalTextEdits,Jt.is))}n.is=t})(Ga||(Ga={}));(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(Za||(Za={}));(function(n){function e(r,i,o,s,a,u){let l={startLine:r,endLine:i};return w.defined(o)&&(l.startCharacter=o),w.defined(s)&&(l.endCharacter=s),w.defined(a)&&(l.kind=a),w.defined(u)&&(l.collapsedText=u),l}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.uinteger(i.startLine)&&w.uinteger(i.startLine)&&(w.undefined(i.startCharacter)||w.uinteger(i.startCharacter))&&(w.undefined(i.endCharacter)||w.uinteger(i.endCharacter))&&(w.undefined(i.kind)||w.string(i.kind))}n.is=t})(Qa||(Qa={}));(function(n){function e(r,i){return{location:r,message:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&ai.is(i.location)&&w.string(i.message)}n.is=t})(lo||(lo={}));(function(n){n.Error=1,n.Warning=2,n.Information=3,n.Hint=4})(Ya||(Ya={}));(function(n){n.Unnecessary=1,n.Deprecated=2})(ec||(ec={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&w.string(r.href)}n.is=e})(tc||(tc={}));(function(n){function e(r,i,o,s,a,u){let l={range:r,message:i};return w.defined(o)&&(l.severity=o),w.defined(s)&&(l.code=s),w.defined(a)&&(l.source=a),w.defined(u)&&(l.relatedInformation=u),l}n.create=e;function t(r){var i;let o=r;return w.defined(o)&&Fe.is(o.range)&&w.string(o.message)&&(w.number(o.severity)||w.undefined(o.severity))&&(w.integer(o.code)||w.string(o.code)||w.undefined(o.code))&&(w.undefined(o.codeDescription)||w.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(w.string(o.source)||w.undefined(o.source))&&(w.undefined(o.relatedInformation)||w.typedArray(o.relatedInformation,lo.is))}n.is=t})(ci||(ci={}));(function(n){function e(r,i,...o){let s={title:r,command:i};return w.defined(o)&&o.length>0&&(s.arguments=o),s}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.title)&&w.string(i.command)}n.is=t})($n||($n={}));(function(n){function e(o,s){return{range:o,newText:s}}n.replace=e;function t(o,s){return{range:{start:o,end:o},newText:s}}n.insert=t;function r(o){return{range:o,newText:""}}n.del=r;function i(o){let s=o;return w.objectLiteral(s)&&w.string(s.newText)&&Fe.is(s.range)}n.is=i})(Jt||(Jt={}));(function(n){function e(r,i,o){let s={label:r};return i!==void 0&&(s.needsConfirmation=i),o!==void 0&&(s.description=o),s}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.string(i.label)&&(w.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(w.string(i.description)||i.description===void 0)}n.is=t})(Kn||(Kn={}));(function(n){function e(t){let r=t;return w.string(r)}n.is=e})(rt||(rt={}));(function(n){function e(o,s,a){return{range:o,newText:s,annotationId:a}}n.replace=e;function t(o,s,a){return{range:{start:o,end:o},newText:s,annotationId:a}}n.insert=t;function r(o,s){return{range:o,newText:"",annotationId:s}}n.del=r;function i(o){let s=o;return Jt.is(s)&&(Kn.is(s.annotationId)||rt.is(s.annotationId))}n.is=i})(on||(on={}));(function(n){function e(r,i){return{textDocument:r,edits:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&li.is(i.textDocument)&&Array.isArray(i.edits)}n.is=t})(ui||(ui={}));(function(n){function e(r,i,o){let s={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="create"&&w.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||w.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||w.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||rt.is(i.annotationId))}n.is=t})(_r||(_r={}));(function(n){function e(r,i,o,s){let a={kind:"rename",oldUri:r,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(a.options=o),s!==void 0&&(a.annotationId=s),a}n.create=e;function t(r){let i=r;return i&&i.kind==="rename"&&w.string(i.oldUri)&&w.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||w.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||w.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||rt.is(i.annotationId))}n.is=t})(br||(br={}));(function(n){function e(r,i,o){let s={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="delete"&&w.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||w.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||w.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||rt.is(i.annotationId))}n.is=t})(wr||(wr={}));(function(n){function e(t){let r=t;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>w.string(i.kind)?_r.is(i)||br.is(i)||wr.is(i):ui.is(i)))}n.is=e})(fo||(fo={}));vr=class{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,r){let i,o;if(r===void 0?i=Jt.insert(e,t):rt.is(r)?(o=r,i=on.insert(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=on.insert(e,t,o)),this.edits.push(i),o!==void 0)return o}replace(e,t,r){let i,o;if(r===void 0?i=Jt.replace(e,t):rt.is(r)?(o=r,i=on.replace(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=on.replace(e,t,o)),this.edits.push(i),o!==void 0)return o}delete(e,t){let r,i;if(t===void 0?r=Jt.del(e):rt.is(t)?(i=t,r=on.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),r=on.del(e,i)),this.edits.push(r),i!==void 0)return i}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}},po=class{constructor(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let r;if(rt.is(e)?r=e:(r=this.nextId(),t=e),this._annotations[r]!==void 0)throw new Error(`Id ${r} is already in use.`);if(t===void 0)throw new Error(`No annotation provided for id ${r}`);return this._annotations[r]=t,this._size++,r}nextId(){return this._counter++,this._counter.toString()}},nc=class{constructor(e){this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new po(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(t=>{if(ui.is(t)){let r=new vr(t.edits,this._changeAnnotations);this._textEditChanges[t.textDocument.uri]=r}})):e.changes&&Object.keys(e.changes).forEach(t=>{let r=new vr(e.changes[t]);this._textEditChanges[t]=r})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(li.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let t={uri:e.uri,version:e.version},r=this._textEditChanges[t.uri];if(!r){let i=[],o={textDocument:t,edits:i};this._workspaceEdit.documentChanges.push(o),r=new vr(i,this._changeAnnotations),this._textEditChanges[t.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let r=[];this._workspaceEdit.changes[e]=r,t=new vr(r),this._textEditChanges[e]=t}return t}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new po,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Kn.is(t)||rt.is(t)?i=t:r=t;let o,s;if(i===void 0?o=_r.create(e,r):(s=rt.is(i)?i:this._changeAnnotations.manage(i),o=_r.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}renameFile(e,t,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let o;Kn.is(r)||rt.is(r)?o=r:i=r;let s,a;if(o===void 0?s=br.create(e,t,i):(a=rt.is(o)?o:this._changeAnnotations.manage(o),s=br.create(e,t,i,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}deleteFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Kn.is(t)||rt.is(t)?i=t:r=t;let o,s;if(i===void 0?o=wr.create(e,r):(s=rt.is(i)?i:this._changeAnnotations.manage(i),o=wr.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}};(function(n){function e(r){return{uri:r}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)}n.is=t})(rc||(rc={}));(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&w.integer(i.version)}n.is=t})(ic||(ic={}));(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&(i.version===null||w.integer(i.version))}n.is=t})(li||(li={}));(function(n){function e(r,i,o,s){return{uri:r,languageId:i,version:o,text:s}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&w.string(i.languageId)&&w.integer(i.version)&&w.string(i.text)}n.is=t})(oc||(oc={}));(function(n){n.PlainText="plaintext",n.Markdown="markdown";function e(t){let r=t;return r===n.PlainText||r===n.Markdown}n.is=e})(ho||(ho={}));(function(n){function e(t){let r=t;return w.objectLiteral(t)&&ho.is(r.kind)&&w.string(r.value)}n.is=e})(Cr||(Cr={}));(function(n){n.Text=1,n.Method=2,n.Function=3,n.Constructor=4,n.Field=5,n.Variable=6,n.Class=7,n.Interface=8,n.Module=9,n.Property=10,n.Unit=11,n.Value=12,n.Enum=13,n.Keyword=14,n.Snippet=15,n.Color=16,n.File=17,n.Reference=18,n.Folder=19,n.EnumMember=20,n.Constant=21,n.Struct=22,n.Event=23,n.Operator=24,n.TypeParameter=25})(sc||(sc={}));(function(n){n.PlainText=1,n.Snippet=2})(ac||(ac={}));(function(n){n.Deprecated=1})(cc||(cc={}));(function(n){function e(r,i,o){return{newText:r,insert:i,replace:o}}n.create=e;function t(r){let i=r;return i&&w.string(i.newText)&&Fe.is(i.insert)&&Fe.is(i.replace)}n.is=t})(uc||(uc={}));(function(n){n.asIs=1,n.adjustIndentation=2})(lc||(lc={}));(function(n){function e(t){let r=t;return r&&(w.string(r.detail)||r.detail===void 0)&&(w.string(r.description)||r.description===void 0)}n.is=e})(dc||(dc={}));(function(n){function e(t){return{label:t}}n.create=e})(fc||(fc={}));(function(n){function e(t,r){return{items:t||[],isIncomplete:!!r}}n.create=e})(pc||(pc={}));(function(n){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}n.fromPlainText=e;function t(r){let i=r;return w.string(i)||w.objectLiteral(i)&&w.string(i.language)&&w.string(i.value)}n.is=t})(di||(di={}));(function(n){function e(t){let r=t;return!!r&&w.objectLiteral(r)&&(Cr.is(r.contents)||di.is(r.contents)||w.typedArray(r.contents,di.is))&&(t.range===void 0||Fe.is(t.range))}n.is=e})(hc||(hc={}));(function(n){function e(t,r){return r?{label:t,documentation:r}:{label:t}}n.create=e})(gc||(gc={}));(function(n){function e(t,r,...i){let o={label:t};return w.defined(r)&&(o.documentation=r),w.defined(i)?o.parameters=i:o.parameters=[],o}n.create=e})(mc||(mc={}));(function(n){n.Text=1,n.Read=2,n.Write=3})(yc||(yc={}));(function(n){function e(t,r){let i={range:t};return w.number(r)&&(i.kind=r),i}n.create=e})(vc||(vc={}));(function(n){n.File=1,n.Module=2,n.Namespace=3,n.Package=4,n.Class=5,n.Method=6,n.Property=7,n.Field=8,n.Constructor=9,n.Enum=10,n.Interface=11,n.Function=12,n.Variable=13,n.Constant=14,n.String=15,n.Number=16,n.Boolean=17,n.Array=18,n.Object=19,n.Key=20,n.Null=21,n.EnumMember=22,n.Struct=23,n.Event=24,n.Operator=25,n.TypeParameter=26})(_c||(_c={}));(function(n){n.Deprecated=1})(bc||(bc={}));(function(n){function e(t,r,i,o,s){let a={name:t,kind:r,location:{uri:o,range:i}};return s&&(a.containerName=s),a}n.create=e})(wc||(wc={}));(function(n){function e(t,r,i,o){return o!==void 0?{name:t,kind:r,location:{uri:i,range:o}}:{name:t,kind:r,location:{uri:i}}}n.create=e})(Cc||(Cc={}));(function(n){function e(r,i,o,s,a,u){let l={name:r,detail:i,kind:o,range:s,selectionRange:a};return u!==void 0&&(l.children=u),l}n.create=e;function t(r){let i=r;return i&&w.string(i.name)&&w.number(i.kind)&&Fe.is(i.range)&&Fe.is(i.selectionRange)&&(i.detail===void 0||w.string(i.detail))&&(i.deprecated===void 0||w.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}n.is=t})(Dc||(Dc={}));(function(n){n.Empty="",n.QuickFix="quickfix",n.Refactor="refactor",n.RefactorExtract="refactor.extract",n.RefactorInline="refactor.inline",n.RefactorRewrite="refactor.rewrite",n.Source="source",n.SourceOrganizeImports="source.organizeImports",n.SourceFixAll="source.fixAll"})(Sc||(Sc={}));(function(n){n.Invoked=1,n.Automatic=2})(fi||(fi={}));(function(n){function e(r,i,o){let s={diagnostics:r};return i!=null&&(s.only=i),o!=null&&(s.triggerKind=o),s}n.create=e;function t(r){let i=r;return w.defined(i)&&w.typedArray(i.diagnostics,ci.is)&&(i.only===void 0||w.typedArray(i.only,w.string))&&(i.triggerKind===void 0||i.triggerKind===fi.Invoked||i.triggerKind===fi.Automatic)}n.is=t})(Tc||(Tc={}));(function(n){function e(r,i,o){let s={title:r},a=!0;return typeof i=="string"?(a=!1,s.kind=i):$n.is(i)?s.command=i:s.edit=i,a&&o!==void 0&&(s.kind=o),s}n.create=e;function t(r){let i=r;return i&&w.string(i.title)&&(i.diagnostics===void 0||w.typedArray(i.diagnostics,ci.is))&&(i.kind===void 0||w.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||$n.is(i.command))&&(i.isPreferred===void 0||w.boolean(i.isPreferred))&&(i.edit===void 0||fo.is(i.edit))}n.is=t})(Rc||(Rc={}));(function(n){function e(r,i){let o={range:r};return w.defined(i)&&(o.data=i),o}n.create=e;function t(r){let i=r;return w.defined(i)&&Fe.is(i.range)&&(w.undefined(i.command)||$n.is(i.command))}n.is=t})(xc||(xc={}));(function(n){function e(r,i){return{tabSize:r,insertSpaces:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.uinteger(i.tabSize)&&w.boolean(i.insertSpaces)}n.is=t})(Pc||(Pc={}));(function(n){function e(r,i,o){return{range:r,target:i,data:o}}n.create=e;function t(r){let i=r;return w.defined(i)&&Fe.is(i.range)&&(w.undefined(i.target)||w.string(i.target))}n.is=t})(kc||(kc={}));(function(n){function e(r,i){return{range:r,parent:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Fe.is(i.range)&&(i.parent===void 0||n.is(i.parent))}n.is=t})(qc||(qc={}));(function(n){n.namespace="namespace",n.type="type",n.class="class",n.enum="enum",n.interface="interface",n.struct="struct",n.typeParameter="typeParameter",n.parameter="parameter",n.variable="variable",n.property="property",n.enumMember="enumMember",n.event="event",n.function="function",n.method="method",n.macro="macro",n.keyword="keyword",n.modifier="modifier",n.comment="comment",n.string="string",n.number="number",n.regexp="regexp",n.operator="operator",n.decorator="decorator"})(Ic||(Ic={}));(function(n){n.declaration="declaration",n.definition="definition",n.readonly="readonly",n.static="static",n.deprecated="deprecated",n.abstract="abstract",n.async="async",n.modification="modification",n.documentation="documentation",n.defaultLibrary="defaultLibrary"})(Ec||(Ec={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}n.is=e})(Oc||(Oc={}));(function(n){function e(r,i){return{range:r,text:i}}n.create=e;function t(r){let i=r;return i!=null&&Fe.is(i.range)&&w.string(i.text)}n.is=t})(Fc||(Fc={}));(function(n){function e(r,i,o){return{range:r,variableName:i,caseSensitiveLookup:o}}n.create=e;function t(r){let i=r;return i!=null&&Fe.is(i.range)&&w.boolean(i.caseSensitiveLookup)&&(w.string(i.variableName)||i.variableName===void 0)}n.is=t})(Lc||(Lc={}));(function(n){function e(r,i){return{range:r,expression:i}}n.create=e;function t(r){let i=r;return i!=null&&Fe.is(i.range)&&(w.string(i.expression)||i.expression===void 0)}n.is=t})(Mc||(Mc={}));(function(n){function e(r,i){return{frameId:r,stoppedLocation:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&Fe.is(r.stoppedLocation)}n.is=t})(Nc||(Nc={}));(function(n){n.Type=1,n.Parameter=2;function e(t){return t===1||t===2}n.is=e})(go||(go={}));(function(n){function e(r){return{value:r}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&(i.tooltip===void 0||w.string(i.tooltip)||Cr.is(i.tooltip))&&(i.location===void 0||ai.is(i.location))&&(i.command===void 0||$n.is(i.command))}n.is=t})(mo||(mo={}));(function(n){function e(r,i,o){let s={position:r,label:i};return o!==void 0&&(s.kind=o),s}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&qt.is(i.position)&&(w.string(i.label)||w.typedArray(i.label,mo.is))&&(i.kind===void 0||go.is(i.kind))&&i.textEdits===void 0||w.typedArray(i.textEdits,Jt.is)&&(i.tooltip===void 0||w.string(i.tooltip)||Cr.is(i.tooltip))&&(i.paddingLeft===void 0||w.boolean(i.paddingLeft))&&(i.paddingRight===void 0||w.boolean(i.paddingRight))}n.is=t})(Ac||(Ac={}));(function(n){function e(t){return{kind:"snippet",value:t}}n.createSnippet=e})(jc||(jc={}));(function(n){function e(t,r,i,o){return{insertText:t,filterText:r,range:i,command:o}}n.create=e})(Hc||(Hc={}));(function(n){function e(t){return{items:t}}n.create=e})(Uc||(Uc={}));(function(n){n.Invoked=0,n.Automatic=1})(Wc||(Wc={}));(function(n){function e(t,r){return{range:t,text:r}}n.create=e})(Bc||(Bc={}));(function(n){function e(t,r){return{triggerKind:t,selectedCompletionInfo:r}}n.create=e})(zc||(zc={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&co.is(r.uri)&&w.string(r.name)}n.is=e})(Kc||(Kc={}));Kv=[`
`,`\r
`,"\r"];(function(n){function e(o,s,a,u){return new Vc(o,s,a,u)}n.create=e;function t(o){let s=o;return!!(w.defined(s)&&w.string(s.uri)&&(w.undefined(s.languageId)||w.string(s.languageId))&&w.uinteger(s.lineCount)&&w.func(s.getText)&&w.func(s.positionAt)&&w.func(s.offsetAt))}n.is=t;function r(o,s){let a=o.getText(),u=i(s,(f,h)=>{let p=f.range.start.line-h.range.start.line;return p===0?f.range.start.character-h.range.start.character:p}),l=a.length;for(let f=u.length-1;f>=0;f--){let h=u[f],p=o.offsetAt(h.range.start),m=o.offsetAt(h.range.end);if(m<=l)a=a.substring(0,p)+h.newText+a.substring(m,a.length);else throw new Error("Overlapping edit");l=p}return a}n.applyEdits=r;function i(o,s){if(o.length<=1)return o;let a=o.length/2|0,u=o.slice(0,a),l=o.slice(a);i(u,s),i(l,s);let f=0,h=0,p=0;for(;f<u.length&&h<l.length;)s(u[f],l[h])<=0?o[p++]=u[f++]:o[p++]=l[h++];for(;f<u.length;)o[p++]=u[f++];for(;h<l.length;)o[p++]=l[h++];return o}})($c||($c={}));Vc=class{constructor(e,t,r,i){this._uri=e,this._languageId=t,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(t,r)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],t=this._content,r=!0;for(let i=0;i<t.length;i++){r&&(e.push(i),r=!1);let o=t.charAt(i);r=o==="\r"||o===`
`,o==="\r"&&i+1<t.length&&t.charAt(i+1)===`
`&&i++}r&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),r=0,i=t.length;if(i===0)return qt.create(0,e);for(;r<i;){let s=Math.floor((r+i)/2);t[s]>e?i=s:r=s+1}let o=r-1;return qt.create(o,e-t[o])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let r=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};(function(n){let e=Object.prototype.toString;function t(m){return typeof m<"u"}n.defined=t;function r(m){return typeof m>"u"}n.undefined=r;function i(m){return m===!0||m===!1}n.boolean=i;function o(m){return e.call(m)==="[object String]"}n.string=o;function s(m){return e.call(m)==="[object Number]"}n.number=s;function a(m,g,b){return e.call(m)==="[object Number]"&&g<=m&&m<=b}n.numberRange=a;function u(m){return e.call(m)==="[object Number]"&&-2147483648<=m&&m<=2147483647}n.integer=u;function l(m){return e.call(m)==="[object Number]"&&0<=m&&m<=2147483647}n.uinteger=l;function f(m){return e.call(m)==="[object Function]"}n.func=f;function h(m){return m!==null&&typeof m=="object"}n.objectLiteral=h;function p(m,g){return Array.isArray(m)&&m.every(g)}n.typedArray=p})(w||(w={}))});var qe=P(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ProtocolNotificationType=mt.ProtocolNotificationType0=mt.ProtocolRequestType=mt.ProtocolRequestType0=mt.RegistrationType=mt.MessageDirection=void 0;var Dr=zn(),Af;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(Af||(mt.MessageDirection=Af={}));var Xc=class{constructor(e){this.method=e}};mt.RegistrationType=Xc;var Jc=class extends Dr.RequestType0{constructor(e){super(e)}};mt.ProtocolRequestType0=Jc;var Gc=class extends Dr.RequestType{constructor(e){super(e,Dr.ParameterStructures.byName)}};mt.ProtocolRequestType=Gc;var Zc=class extends Dr.NotificationType0{constructor(e){super(e)}};mt.ProtocolNotificationType0=Zc;var Qc=class extends Dr.NotificationType{constructor(e){super(e,Dr.ParameterStructures.byName)}};mt.ProtocolNotificationType=Qc});var _o=P(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.objectLiteral=je.typedArray=je.stringArray=je.array=je.func=je.error=je.number=je.string=je.boolean=void 0;function $v(n){return n===!0||n===!1}je.boolean=$v;function jf(n){return typeof n=="string"||n instanceof String}je.string=jf;function Vv(n){return typeof n=="number"||n instanceof Number}je.number=Vv;function Xv(n){return n instanceof Error}je.error=Xv;function Jv(n){return typeof n=="function"}je.func=Jv;function Hf(n){return Array.isArray(n)}je.array=Hf;function Gv(n){return Hf(n)&&n.every(e=>jf(e))}je.stringArray=Gv;function Zv(n,e){return Array.isArray(n)&&n.every(e)}je.typedArray=Zv;function Qv(n){return n!==null&&typeof n=="object"}je.objectLiteral=Qv});var Bf=P(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.ImplementationRequest=void 0;var Uf=qe(),Wf;(function(n){n.method="textDocument/implementation",n.messageDirection=Uf.MessageDirection.clientToServer,n.type=new Uf.ProtocolRequestType(n.method)})(Wf||(bo.ImplementationRequest=Wf={}))});var $f=P(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.TypeDefinitionRequest=void 0;var zf=qe(),Kf;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=zf.MessageDirection.clientToServer,n.type=new zf.ProtocolRequestType(n.method)})(Kf||(wo.TypeDefinitionRequest=Kf={}))});var Jf=P(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.DidChangeWorkspaceFoldersNotification=Sr.WorkspaceFoldersRequest=void 0;var Co=qe(),Vf;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=Co.MessageDirection.serverToClient,n.type=new Co.ProtocolRequestType0(n.method)})(Vf||(Sr.WorkspaceFoldersRequest=Vf={}));var Xf;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=Co.MessageDirection.clientToServer,n.type=new Co.ProtocolNotificationType(n.method)})(Xf||(Sr.DidChangeWorkspaceFoldersNotification=Xf={}))});var Qf=P(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.ConfigurationRequest=void 0;var Gf=qe(),Zf;(function(n){n.method="workspace/configuration",n.messageDirection=Gf.MessageDirection.serverToClient,n.type=new Gf.ProtocolRequestType(n.method)})(Zf||(Do.ConfigurationRequest=Zf={}))});var tp=P(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.ColorPresentationRequest=Tr.DocumentColorRequest=void 0;var So=qe(),Yf;(function(n){n.method="textDocument/documentColor",n.messageDirection=So.MessageDirection.clientToServer,n.type=new So.ProtocolRequestType(n.method)})(Yf||(Tr.DocumentColorRequest=Yf={}));var ep;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=So.MessageDirection.clientToServer,n.type=new So.ProtocolRequestType(n.method)})(ep||(Tr.ColorPresentationRequest=ep={}))});var ip=P(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.FoldingRangeRefreshRequest=Rr.FoldingRangeRequest=void 0;var To=qe(),np;(function(n){n.method="textDocument/foldingRange",n.messageDirection=To.MessageDirection.clientToServer,n.type=new To.ProtocolRequestType(n.method)})(np||(Rr.FoldingRangeRequest=np={}));var rp;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=To.MessageDirection.serverToClient,n.type=new To.ProtocolRequestType0(n.method)})(rp||(Rr.FoldingRangeRefreshRequest=rp={}))});var ap=P(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.DeclarationRequest=void 0;var op=qe(),sp;(function(n){n.method="textDocument/declaration",n.messageDirection=op.MessageDirection.clientToServer,n.type=new op.ProtocolRequestType(n.method)})(sp||(Ro.DeclarationRequest=sp={}))});var lp=P(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.SelectionRangeRequest=void 0;var cp=qe(),up;(function(n){n.method="textDocument/selectionRange",n.messageDirection=cp.MessageDirection.clientToServer,n.type=new cp.ProtocolRequestType(n.method)})(up||(xo.SelectionRangeRequest=up={}))});var hp=P(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.WorkDoneProgressCancelNotification=Sn.WorkDoneProgressCreateRequest=Sn.WorkDoneProgress=void 0;var Yv=zn(),Po=qe(),dp;(function(n){n.type=new Yv.ProgressType;function e(t){return t===n.type}n.is=e})(dp||(Sn.WorkDoneProgress=dp={}));var fp;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Po.MessageDirection.serverToClient,n.type=new Po.ProtocolRequestType(n.method)})(fp||(Sn.WorkDoneProgressCreateRequest=fp={}));var pp;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Po.MessageDirection.clientToServer,n.type=new Po.ProtocolNotificationType(n.method)})(pp||(Sn.WorkDoneProgressCancelNotification=pp={}))});var vp=P(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.CallHierarchyOutgoingCallsRequest=Tn.CallHierarchyIncomingCallsRequest=Tn.CallHierarchyPrepareRequest=void 0;var xr=qe(),gp;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=xr.MessageDirection.clientToServer,n.type=new xr.ProtocolRequestType(n.method)})(gp||(Tn.CallHierarchyPrepareRequest=gp={}));var mp;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=xr.MessageDirection.clientToServer,n.type=new xr.ProtocolRequestType(n.method)})(mp||(Tn.CallHierarchyIncomingCallsRequest=mp={}));var yp;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=xr.MessageDirection.clientToServer,n.type=new xr.ProtocolRequestType(n.method)})(yp||(Tn.CallHierarchyOutgoingCallsRequest=yp={}))});var Sp=P(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.SemanticTokensRefreshRequest=yt.SemanticTokensRangeRequest=yt.SemanticTokensDeltaRequest=yt.SemanticTokensRequest=yt.SemanticTokensRegistrationType=yt.TokenFormat=void 0;var sn=qe(),_p;(function(n){n.Relative="relative"})(_p||(yt.TokenFormat=_p={}));var pi;(function(n){n.method="textDocument/semanticTokens",n.type=new sn.RegistrationType(n.method)})(pi||(yt.SemanticTokensRegistrationType=pi={}));var bp;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=sn.MessageDirection.clientToServer,n.type=new sn.ProtocolRequestType(n.method),n.registrationMethod=pi.method})(bp||(yt.SemanticTokensRequest=bp={}));var wp;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=sn.MessageDirection.clientToServer,n.type=new sn.ProtocolRequestType(n.method),n.registrationMethod=pi.method})(wp||(yt.SemanticTokensDeltaRequest=wp={}));var Cp;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=sn.MessageDirection.clientToServer,n.type=new sn.ProtocolRequestType(n.method),n.registrationMethod=pi.method})(Cp||(yt.SemanticTokensRangeRequest=Cp={}));var Dp;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=sn.MessageDirection.serverToClient,n.type=new sn.ProtocolRequestType0(n.method)})(Dp||(yt.SemanticTokensRefreshRequest=Dp={}))});var xp=P(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.ShowDocumentRequest=void 0;var Tp=qe(),Rp;(function(n){n.method="window/showDocument",n.messageDirection=Tp.MessageDirection.serverToClient,n.type=new Tp.ProtocolRequestType(n.method)})(Rp||(ko.ShowDocumentRequest=Rp={}))});var qp=P(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.LinkedEditingRangeRequest=void 0;var Pp=qe(),kp;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=Pp.MessageDirection.clientToServer,n.type=new Pp.ProtocolRequestType(n.method)})(kp||(qo.LinkedEditingRangeRequest=kp={}))});var Ap=P(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.WillDeleteFilesRequest=ut.DidDeleteFilesNotification=ut.DidRenameFilesNotification=ut.WillRenameFilesRequest=ut.DidCreateFilesNotification=ut.WillCreateFilesRequest=ut.FileOperationPatternKind=void 0;var It=qe(),Ip;(function(n){n.file="file",n.folder="folder"})(Ip||(ut.FileOperationPatternKind=Ip={}));var Ep;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolRequestType(n.method)})(Ep||(ut.WillCreateFilesRequest=Ep={}));var Op;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolNotificationType(n.method)})(Op||(ut.DidCreateFilesNotification=Op={}));var Fp;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolRequestType(n.method)})(Fp||(ut.WillRenameFilesRequest=Fp={}));var Lp;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolNotificationType(n.method)})(Lp||(ut.DidRenameFilesNotification=Lp={}));var Mp;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolNotificationType(n.method)})(Mp||(ut.DidDeleteFilesNotification=Mp={}));var Np;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=It.MessageDirection.clientToServer,n.type=new It.ProtocolRequestType(n.method)})(Np||(ut.WillDeleteFilesRequest=Np={}))});var Bp=P(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.MonikerRequest=Rn.MonikerKind=Rn.UniquenessLevel=void 0;var jp=qe(),Hp;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(Hp||(Rn.UniquenessLevel=Hp={}));var Up;(function(n){n.$import="import",n.$export="export",n.local="local"})(Up||(Rn.MonikerKind=Up={}));var Wp;(function(n){n.method="textDocument/moniker",n.messageDirection=jp.MessageDirection.clientToServer,n.type=new jp.ProtocolRequestType(n.method)})(Wp||(Rn.MonikerRequest=Wp={}))});var Vp=P(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.TypeHierarchySubtypesRequest=xn.TypeHierarchySupertypesRequest=xn.TypeHierarchyPrepareRequest=void 0;var Pr=qe(),zp;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=Pr.MessageDirection.clientToServer,n.type=new Pr.ProtocolRequestType(n.method)})(zp||(xn.TypeHierarchyPrepareRequest=zp={}));var Kp;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=Pr.MessageDirection.clientToServer,n.type=new Pr.ProtocolRequestType(n.method)})(Kp||(xn.TypeHierarchySupertypesRequest=Kp={}));var $p;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=Pr.MessageDirection.clientToServer,n.type=new Pr.ProtocolRequestType(n.method)})($p||(xn.TypeHierarchySubtypesRequest=$p={}))});var Gp=P(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.InlineValueRefreshRequest=kr.InlineValueRequest=void 0;var Io=qe(),Xp;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Io.MessageDirection.clientToServer,n.type=new Io.ProtocolRequestType(n.method)})(Xp||(kr.InlineValueRequest=Xp={}));var Jp;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Io.MessageDirection.serverToClient,n.type=new Io.ProtocolRequestType0(n.method)})(Jp||(kr.InlineValueRefreshRequest=Jp={}))});var eh=P(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.InlayHintRefreshRequest=Pn.InlayHintResolveRequest=Pn.InlayHintRequest=void 0;var qr=qe(),Zp;(function(n){n.method="textDocument/inlayHint",n.messageDirection=qr.MessageDirection.clientToServer,n.type=new qr.ProtocolRequestType(n.method)})(Zp||(Pn.InlayHintRequest=Zp={}));var Qp;(function(n){n.method="inlayHint/resolve",n.messageDirection=qr.MessageDirection.clientToServer,n.type=new qr.ProtocolRequestType(n.method)})(Qp||(Pn.InlayHintResolveRequest=Qp={}));var Yp;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=qr.MessageDirection.serverToClient,n.type=new qr.ProtocolRequestType0(n.method)})(Yp||(Pn.InlayHintRefreshRequest=Yp={}))});var ah=P(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.DiagnosticRefreshRequest=Et.WorkspaceDiagnosticRequest=Et.DocumentDiagnosticRequest=Et.DocumentDiagnosticReportKind=Et.DiagnosticServerCancellationData=void 0;var sh=zn(),e_=_o(),Ir=qe(),th;(function(n){function e(t){let r=t;return r&&e_.boolean(r.retriggerRequest)}n.is=e})(th||(Et.DiagnosticServerCancellationData=th={}));var nh;(function(n){n.Full="full",n.Unchanged="unchanged"})(nh||(Et.DocumentDiagnosticReportKind=nh={}));var rh;(function(n){n.method="textDocument/diagnostic",n.messageDirection=Ir.MessageDirection.clientToServer,n.type=new Ir.ProtocolRequestType(n.method),n.partialResult=new sh.ProgressType})(rh||(Et.DocumentDiagnosticRequest=rh={}));var ih;(function(n){n.method="workspace/diagnostic",n.messageDirection=Ir.MessageDirection.clientToServer,n.type=new Ir.ProtocolRequestType(n.method),n.partialResult=new sh.ProgressType})(ih||(Et.WorkspaceDiagnosticRequest=ih={}));var oh;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=Ir.MessageDirection.serverToClient,n.type=new Ir.ProtocolRequestType0(n.method)})(oh||(Et.DiagnosticRefreshRequest=oh={}))});var hh=P(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.DidCloseNotebookDocumentNotification=Le.DidSaveNotebookDocumentNotification=Le.DidChangeNotebookDocumentNotification=Le.NotebookCellArrayChange=Le.DidOpenNotebookDocumentNotification=Le.NotebookDocumentSyncRegistrationType=Le.NotebookDocument=Le.NotebookCell=Le.ExecutionSummary=Le.NotebookCellKind=void 0;var hi=(vo(),ji(yo)),jt=_o(),Gt=qe(),Yc;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Yc||(Le.NotebookCellKind=Yc={}));var eu;(function(n){function e(i,o){let s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){let o=i;return jt.objectLiteral(o)&&hi.uinteger.is(o.executionOrder)&&(o.success===void 0||jt.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(eu||(Le.ExecutionSummary=eu={}));var Eo;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){let s=o;return jt.objectLiteral(s)&&Yc.is(s.kind)&&hi.DocumentUri.is(s.document)&&(s.metadata===void 0||jt.objectLiteral(s.metadata))}n.is=t;function r(o,s){let a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!eu.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;let a=Array.isArray(o),u=Array.isArray(s);if(a!==u)return!1;if(a&&u){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(jt.objectLiteral(o)&&jt.objectLiteral(s)){let l=Object.keys(o),f=Object.keys(s);if(l.length!==f.length||(l.sort(),f.sort(),!i(l,f)))return!1;for(let h=0;h<l.length;h++){let p=l[h];if(!i(o[p],s[p]))return!1}}return!0}})(Eo||(Le.NotebookCell=Eo={}));var ch;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){let i=r;return jt.objectLiteral(i)&&jt.string(i.uri)&&hi.integer.is(i.version)&&jt.typedArray(i.cells,Eo.is)}n.is=t})(ch||(Le.NotebookDocument=ch={}));var Er;(function(n){n.method="notebookDocument/sync",n.messageDirection=Gt.MessageDirection.clientToServer,n.type=new Gt.RegistrationType(n.method)})(Er||(Le.NotebookDocumentSyncRegistrationType=Er={}));var uh;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=Gt.MessageDirection.clientToServer,n.type=new Gt.ProtocolNotificationType(n.method),n.registrationMethod=Er.method})(uh||(Le.DidOpenNotebookDocumentNotification=uh={}));var lh;(function(n){function e(r){let i=r;return jt.objectLiteral(i)&&hi.uinteger.is(i.start)&&hi.uinteger.is(i.deleteCount)&&(i.cells===void 0||jt.typedArray(i.cells,Eo.is))}n.is=e;function t(r,i,o){let s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(lh||(Le.NotebookCellArrayChange=lh={}));var dh;(function(n){n.method="notebookDocument/didChange",n.messageDirection=Gt.MessageDirection.clientToServer,n.type=new Gt.ProtocolNotificationType(n.method),n.registrationMethod=Er.method})(dh||(Le.DidChangeNotebookDocumentNotification=dh={}));var fh;(function(n){n.method="notebookDocument/didSave",n.messageDirection=Gt.MessageDirection.clientToServer,n.type=new Gt.ProtocolNotificationType(n.method),n.registrationMethod=Er.method})(fh||(Le.DidSaveNotebookDocumentNotification=fh={}));var ph;(function(n){n.method="notebookDocument/didClose",n.messageDirection=Gt.MessageDirection.clientToServer,n.type=new Gt.ProtocolNotificationType(n.method),n.registrationMethod=Er.method})(ph||(Le.DidCloseNotebookDocumentNotification=ph={}))});var yh=P(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.InlineCompletionRequest=void 0;var gh=qe(),mh;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=gh.MessageDirection.clientToServer,n.type=new gh.ProtocolRequestType(n.method)})(mh||(Oo.InlineCompletionRequest=mh={}))});var qg=P(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.WorkspaceSymbolRequest=y.CodeActionResolveRequest=y.CodeActionRequest=y.DocumentSymbolRequest=y.DocumentHighlightRequest=y.ReferencesRequest=y.DefinitionRequest=y.SignatureHelpRequest=y.SignatureHelpTriggerKind=y.HoverRequest=y.CompletionResolveRequest=y.CompletionRequest=y.CompletionTriggerKind=y.PublishDiagnosticsNotification=y.WatchKind=y.RelativePattern=y.FileChangeType=y.DidChangeWatchedFilesNotification=y.WillSaveTextDocumentWaitUntilRequest=y.WillSaveTextDocumentNotification=y.TextDocumentSaveReason=y.DidSaveTextDocumentNotification=y.DidCloseTextDocumentNotification=y.DidChangeTextDocumentNotification=y.TextDocumentContentChangeEvent=y.DidOpenTextDocumentNotification=y.TextDocumentSyncKind=y.TelemetryEventNotification=y.LogMessageNotification=y.ShowMessageRequest=y.ShowMessageNotification=y.MessageType=y.DidChangeConfigurationNotification=y.ExitNotification=y.ShutdownRequest=y.InitializedNotification=y.InitializeErrorCodes=y.InitializeRequest=y.WorkDoneProgressOptions=y.TextDocumentRegistrationOptions=y.StaticRegistrationOptions=y.PositionEncodingKind=y.FailureHandlingKind=y.ResourceOperationKind=y.UnregistrationRequest=y.RegistrationRequest=y.DocumentSelector=y.NotebookCellTextDocumentFilter=y.NotebookDocumentFilter=y.TextDocumentFilter=void 0;y.MonikerRequest=y.MonikerKind=y.UniquenessLevel=y.WillDeleteFilesRequest=y.DidDeleteFilesNotification=y.WillRenameFilesRequest=y.DidRenameFilesNotification=y.WillCreateFilesRequest=y.DidCreateFilesNotification=y.FileOperationPatternKind=y.LinkedEditingRangeRequest=y.ShowDocumentRequest=y.SemanticTokensRegistrationType=y.SemanticTokensRefreshRequest=y.SemanticTokensRangeRequest=y.SemanticTokensDeltaRequest=y.SemanticTokensRequest=y.TokenFormat=y.CallHierarchyPrepareRequest=y.CallHierarchyOutgoingCallsRequest=y.CallHierarchyIncomingCallsRequest=y.WorkDoneProgressCancelNotification=y.WorkDoneProgressCreateRequest=y.WorkDoneProgress=y.SelectionRangeRequest=y.DeclarationRequest=y.FoldingRangeRefreshRequest=y.FoldingRangeRequest=y.ColorPresentationRequest=y.DocumentColorRequest=y.ConfigurationRequest=y.DidChangeWorkspaceFoldersNotification=y.WorkspaceFoldersRequest=y.TypeDefinitionRequest=y.ImplementationRequest=y.ApplyWorkspaceEditRequest=y.ExecuteCommandRequest=y.PrepareRenameRequest=y.RenameRequest=y.PrepareSupportDefaultBehavior=y.DocumentOnTypeFormattingRequest=y.DocumentRangesFormattingRequest=y.DocumentRangeFormattingRequest=y.DocumentFormattingRequest=y.DocumentLinkResolveRequest=y.DocumentLinkRequest=y.CodeLensRefreshRequest=y.CodeLensResolveRequest=y.CodeLensRequest=y.WorkspaceSymbolResolveRequest=void 0;y.InlineCompletionRequest=y.DidCloseNotebookDocumentNotification=y.DidSaveNotebookDocumentNotification=y.DidChangeNotebookDocumentNotification=y.NotebookCellArrayChange=y.DidOpenNotebookDocumentNotification=y.NotebookDocumentSyncRegistrationType=y.NotebookDocument=y.NotebookCell=y.ExecutionSummary=y.NotebookCellKind=y.DiagnosticRefreshRequest=y.WorkspaceDiagnosticRequest=y.DocumentDiagnosticRequest=y.DocumentDiagnosticReportKind=y.DiagnosticServerCancellationData=y.InlayHintRefreshRequest=y.InlayHintResolveRequest=y.InlayHintRequest=y.InlineValueRefreshRequest=y.InlineValueRequest=y.TypeHierarchySupertypesRequest=y.TypeHierarchySubtypesRequest=y.TypeHierarchyPrepareRequest=void 0;var I=qe(),vh=(vo(),ji(yo)),Je=_o(),t_=Bf();Object.defineProperty(y,"ImplementationRequest",{enumerable:!0,get:function(){return t_.ImplementationRequest}});var n_=$f();Object.defineProperty(y,"TypeDefinitionRequest",{enumerable:!0,get:function(){return n_.TypeDefinitionRequest}});var Rg=Jf();Object.defineProperty(y,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Rg.WorkspaceFoldersRequest}});Object.defineProperty(y,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Rg.DidChangeWorkspaceFoldersNotification}});var r_=Qf();Object.defineProperty(y,"ConfigurationRequest",{enumerable:!0,get:function(){return r_.ConfigurationRequest}});var xg=tp();Object.defineProperty(y,"DocumentColorRequest",{enumerable:!0,get:function(){return xg.DocumentColorRequest}});Object.defineProperty(y,"ColorPresentationRequest",{enumerable:!0,get:function(){return xg.ColorPresentationRequest}});var Pg=ip();Object.defineProperty(y,"FoldingRangeRequest",{enumerable:!0,get:function(){return Pg.FoldingRangeRequest}});Object.defineProperty(y,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Pg.FoldingRangeRefreshRequest}});var i_=ap();Object.defineProperty(y,"DeclarationRequest",{enumerable:!0,get:function(){return i_.DeclarationRequest}});var o_=lp();Object.defineProperty(y,"SelectionRangeRequest",{enumerable:!0,get:function(){return o_.SelectionRangeRequest}});var ou=hp();Object.defineProperty(y,"WorkDoneProgress",{enumerable:!0,get:function(){return ou.WorkDoneProgress}});Object.defineProperty(y,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return ou.WorkDoneProgressCreateRequest}});Object.defineProperty(y,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return ou.WorkDoneProgressCancelNotification}});var su=vp();Object.defineProperty(y,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return su.CallHierarchyIncomingCallsRequest}});Object.defineProperty(y,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return su.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(y,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return su.CallHierarchyPrepareRequest}});var Or=Sp();Object.defineProperty(y,"TokenFormat",{enumerable:!0,get:function(){return Or.TokenFormat}});Object.defineProperty(y,"SemanticTokensRequest",{enumerable:!0,get:function(){return Or.SemanticTokensRequest}});Object.defineProperty(y,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Or.SemanticTokensDeltaRequest}});Object.defineProperty(y,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Or.SemanticTokensRangeRequest}});Object.defineProperty(y,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Or.SemanticTokensRefreshRequest}});Object.defineProperty(y,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Or.SemanticTokensRegistrationType}});var s_=xp();Object.defineProperty(y,"ShowDocumentRequest",{enumerable:!0,get:function(){return s_.ShowDocumentRequest}});var a_=qp();Object.defineProperty(y,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return a_.LinkedEditingRangeRequest}});var Vn=Ap();Object.defineProperty(y,"FileOperationPatternKind",{enumerable:!0,get:function(){return Vn.FileOperationPatternKind}});Object.defineProperty(y,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Vn.DidCreateFilesNotification}});Object.defineProperty(y,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Vn.WillCreateFilesRequest}});Object.defineProperty(y,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Vn.DidRenameFilesNotification}});Object.defineProperty(y,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Vn.WillRenameFilesRequest}});Object.defineProperty(y,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Vn.DidDeleteFilesNotification}});Object.defineProperty(y,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Vn.WillDeleteFilesRequest}});var au=Bp();Object.defineProperty(y,"UniquenessLevel",{enumerable:!0,get:function(){return au.UniquenessLevel}});Object.defineProperty(y,"MonikerKind",{enumerable:!0,get:function(){return au.MonikerKind}});Object.defineProperty(y,"MonikerRequest",{enumerable:!0,get:function(){return au.MonikerRequest}});var cu=Vp();Object.defineProperty(y,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return cu.TypeHierarchyPrepareRequest}});Object.defineProperty(y,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return cu.TypeHierarchySubtypesRequest}});Object.defineProperty(y,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return cu.TypeHierarchySupertypesRequest}});var kg=Gp();Object.defineProperty(y,"InlineValueRequest",{enumerable:!0,get:function(){return kg.InlineValueRequest}});Object.defineProperty(y,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return kg.InlineValueRefreshRequest}});var uu=eh();Object.defineProperty(y,"InlayHintRequest",{enumerable:!0,get:function(){return uu.InlayHintRequest}});Object.defineProperty(y,"InlayHintResolveRequest",{enumerable:!0,get:function(){return uu.InlayHintResolveRequest}});Object.defineProperty(y,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return uu.InlayHintRefreshRequest}});var gi=ah();Object.defineProperty(y,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return gi.DiagnosticServerCancellationData}});Object.defineProperty(y,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return gi.DocumentDiagnosticReportKind}});Object.defineProperty(y,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return gi.DocumentDiagnosticRequest}});Object.defineProperty(y,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return gi.WorkspaceDiagnosticRequest}});Object.defineProperty(y,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return gi.DiagnosticRefreshRequest}});var Zt=hh();Object.defineProperty(y,"NotebookCellKind",{enumerable:!0,get:function(){return Zt.NotebookCellKind}});Object.defineProperty(y,"ExecutionSummary",{enumerable:!0,get:function(){return Zt.ExecutionSummary}});Object.defineProperty(y,"NotebookCell",{enumerable:!0,get:function(){return Zt.NotebookCell}});Object.defineProperty(y,"NotebookDocument",{enumerable:!0,get:function(){return Zt.NotebookDocument}});Object.defineProperty(y,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Zt.NotebookDocumentSyncRegistrationType}});Object.defineProperty(y,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidOpenNotebookDocumentNotification}});Object.defineProperty(y,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Zt.NotebookCellArrayChange}});Object.defineProperty(y,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidChangeNotebookDocumentNotification}});Object.defineProperty(y,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidSaveNotebookDocumentNotification}});Object.defineProperty(y,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidCloseNotebookDocumentNotification}});var c_=yh();Object.defineProperty(y,"InlineCompletionRequest",{enumerable:!0,get:function(){return c_.InlineCompletionRequest}});var tu;(function(n){function e(t){let r=t;return Je.string(r)||Je.string(r.language)||Je.string(r.scheme)||Je.string(r.pattern)}n.is=e})(tu||(y.TextDocumentFilter=tu={}));var nu;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(Je.string(r.notebookType)||Je.string(r.scheme)||Je.string(r.pattern))}n.is=e})(nu||(y.NotebookDocumentFilter=nu={}));var ru;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(Je.string(r.notebook)||nu.is(r.notebook))&&(r.language===void 0||Je.string(r.language))}n.is=e})(ru||(y.NotebookCellTextDocumentFilter=ru={}));var iu;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!Je.string(r)&&!tu.is(r)&&!ru.is(r))return!1;return!0}n.is=e})(iu||(y.DocumentSelector=iu={}));var _h;(function(n){n.method="client/registerCapability",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(_h||(y.RegistrationRequest=_h={}));var bh;(function(n){n.method="client/unregisterCapability",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(bh||(y.UnregistrationRequest=bh={}));var wh;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(wh||(y.ResourceOperationKind=wh={}));var Ch;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(Ch||(y.FailureHandlingKind=Ch={}));var Dh;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(Dh||(y.PositionEncodingKind=Dh={}));var Sh;(function(n){function e(t){let r=t;return r&&Je.string(r.id)&&r.id.length>0}n.hasId=e})(Sh||(y.StaticRegistrationOptions=Sh={}));var Th;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||iu.is(r.documentSelector))}n.is=e})(Th||(y.TextDocumentRegistrationOptions=Th={}));var Rh;(function(n){function e(r){let i=r;return Je.objectLiteral(i)&&(i.workDoneProgress===void 0||Je.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&Je.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(Rh||(y.WorkDoneProgressOptions=Rh={}));var xh;(function(n){n.method="initialize",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(xh||(y.InitializeRequest=xh={}));var Ph;(function(n){n.unknownProtocolVersion=1})(Ph||(y.InitializeErrorCodes=Ph={}));var kh;(function(n){n.method="initialized",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(kh||(y.InitializedNotification=kh={}));var qh;(function(n){n.method="shutdown",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType0(n.method)})(qh||(y.ShutdownRequest=qh={}));var Ih;(function(n){n.method="exit",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType0(n.method)})(Ih||(y.ExitNotification=Ih={}));var Eh;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Eh||(y.DidChangeConfigurationNotification=Eh={}));var Oh;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(Oh||(y.MessageType=Oh={}));var Fh;(function(n){n.method="window/showMessage",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(Fh||(y.ShowMessageNotification=Fh={}));var Lh;(function(n){n.method="window/showMessageRequest",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(Lh||(y.ShowMessageRequest=Lh={}));var Mh;(function(n){n.method="window/logMessage",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(Mh||(y.LogMessageNotification=Mh={}));var Nh;(function(n){n.method="telemetry/event",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(Nh||(y.TelemetryEventNotification=Nh={}));var Ah;(function(n){n.None=0,n.Full=1,n.Incremental=2})(Ah||(y.TextDocumentSyncKind=Ah={}));var jh;(function(n){n.method="textDocument/didOpen",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(jh||(y.DidOpenTextDocumentNotification=jh={}));var Hh;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(Hh||(y.TextDocumentContentChangeEvent=Hh={}));var Uh;(function(n){n.method="textDocument/didChange",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Uh||(y.DidChangeTextDocumentNotification=Uh={}));var Wh;(function(n){n.method="textDocument/didClose",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Wh||(y.DidCloseTextDocumentNotification=Wh={}));var Bh;(function(n){n.method="textDocument/didSave",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Bh||(y.DidSaveTextDocumentNotification=Bh={}));var zh;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(zh||(y.TextDocumentSaveReason=zh={}));var Kh;(function(n){n.method="textDocument/willSave",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Kh||(y.WillSaveTextDocumentNotification=Kh={}));var $h;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})($h||(y.WillSaveTextDocumentWaitUntilRequest=$h={}));var Vh;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Vh||(y.DidChangeWatchedFilesNotification=Vh={}));var Xh;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(Xh||(y.FileChangeType=Xh={}));var Jh;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(vh.URI.is(r.baseUri)||vh.WorkspaceFolder.is(r.baseUri))&&Je.string(r.pattern)}n.is=e})(Jh||(y.RelativePattern=Jh={}));var Gh;(function(n){n.Create=1,n.Change=2,n.Delete=4})(Gh||(y.WatchKind=Gh={}));var Zh;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(Zh||(y.PublishDiagnosticsNotification=Zh={}));var Qh;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(Qh||(y.CompletionTriggerKind=Qh={}));var Yh;(function(n){n.method="textDocument/completion",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Yh||(y.CompletionRequest=Yh={}));var eg;(function(n){n.method="completionItem/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(eg||(y.CompletionResolveRequest=eg={}));var tg;(function(n){n.method="textDocument/hover",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(tg||(y.HoverRequest=tg={}));var ng;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(ng||(y.SignatureHelpTriggerKind=ng={}));var rg;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(rg||(y.SignatureHelpRequest=rg={}));var ig;(function(n){n.method="textDocument/definition",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(ig||(y.DefinitionRequest=ig={}));var og;(function(n){n.method="textDocument/references",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(og||(y.ReferencesRequest=og={}));var sg;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(sg||(y.DocumentHighlightRequest=sg={}));var ag;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(ag||(y.DocumentSymbolRequest=ag={}));var cg;(function(n){n.method="textDocument/codeAction",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(cg||(y.CodeActionRequest=cg={}));var ug;(function(n){n.method="codeAction/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(ug||(y.CodeActionResolveRequest=ug={}));var lg;(function(n){n.method="workspace/symbol",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(lg||(y.WorkspaceSymbolRequest=lg={}));var dg;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(dg||(y.WorkspaceSymbolResolveRequest=dg={}));var fg;(function(n){n.method="textDocument/codeLens",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(fg||(y.CodeLensRequest=fg={}));var pg;(function(n){n.method="codeLens/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(pg||(y.CodeLensResolveRequest=pg={}));var hg;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType0(n.method)})(hg||(y.CodeLensRefreshRequest=hg={}));var gg;(function(n){n.method="textDocument/documentLink",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(gg||(y.DocumentLinkRequest=gg={}));var mg;(function(n){n.method="documentLink/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(mg||(y.DocumentLinkResolveRequest=mg={}));var yg;(function(n){n.method="textDocument/formatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(yg||(y.DocumentFormattingRequest=yg={}));var vg;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(vg||(y.DocumentRangeFormattingRequest=vg={}));var _g;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(_g||(y.DocumentRangesFormattingRequest=_g={}));var bg;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(bg||(y.DocumentOnTypeFormattingRequest=bg={}));var wg;(function(n){n.Identifier=1})(wg||(y.PrepareSupportDefaultBehavior=wg={}));var Cg;(function(n){n.method="textDocument/rename",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Cg||(y.RenameRequest=Cg={}));var Dg;(function(n){n.method="textDocument/prepareRename",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Dg||(y.PrepareRenameRequest=Dg={}));var Sg;(function(n){n.method="workspace/executeCommand",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Sg||(y.ExecuteCommandRequest=Sg={}));var Tg;(function(n){n.method="workspace/applyEdit",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType("workspace/applyEdit")})(Tg||(y.ApplyWorkspaceEditRequest=Tg={}))});var Eg=P(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.createProtocolConnection=void 0;var Ig=zn();function u_(n,e,t,r){return Ig.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ig.createMessageConnection)(n,e,t,r)}Fo.createProtocolConnection=u_});var Fg=P(vt=>{"use strict";var l_=vt&&vt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Lo=vt&&vt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&l_(e,n,t)};Object.defineProperty(vt,"__esModule",{value:!0});vt.LSPErrorCodes=vt.createProtocolConnection=void 0;Lo(zn(),vt);Lo((vo(),ji(yo)),vt);Lo(qe(),vt);Lo(qg(),vt);var d_=Eg();Object.defineProperty(vt,"createProtocolConnection",{enumerable:!0,get:function(){return d_.createProtocolConnection}});var Og;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(Og||(vt.LSPErrorCodes=Og={}))});var J=P(Qt=>{"use strict";var f_=Qt&&Qt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Lg=Qt&&Qt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&f_(e,n,t)};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.createProtocolConnection=void 0;var p_=Ka();Lg(Ka(),Qt);Lg(Fg(),Qt);function h_(n,e,t,r){return(0,p_.createMessageConnection)(n,e,t,r)}Qt.createProtocolConnection=h_});var Ht=P(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.asPromise=Me.thenable=Me.typedArray=Me.stringArray=Me.array=Me.func=Me.error=Me.number=Me.string=Me.boolean=void 0;function g_(n){return n===!0||n===!1}Me.boolean=g_;function Mg(n){return typeof n=="string"||n instanceof String}Me.string=Mg;function m_(n){return typeof n=="number"||n instanceof Number}Me.number=m_;function y_(n){return n instanceof Error}Me.error=y_;function Ng(n){return typeof n=="function"}Me.func=Ng;function Ag(n){return Array.isArray(n)}Me.array=Ag;function v_(n){return Ag(n)&&n.every(e=>Mg(e))}Me.stringArray=v_;function __(n,e){return Array.isArray(n)&&n.every(e)}Me.typedArray=__;function jg(n){return n&&Ng(n.then)}Me.thenable=jg;function b_(n){return n instanceof Promise?n:jg(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}Me.asPromise=b_});var Ie=P(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.generateUuid=Ot.parse=Ot.isUUID=Ot.v4=Ot.empty=void 0;var mi=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},te=class extends mi{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return te._oneOf(te._chars)}constructor(){super([te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),"-",te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),"-","4",te._randomHex(),te._randomHex(),te._randomHex(),"-",te._oneOf(te._timeHighBits),te._randomHex(),te._randomHex(),te._randomHex(),"-",te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex()].join(""))}};te._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];te._timeHighBits=["8","9","a","b"];Ot.empty=new mi("00000000-0000-0000-0000-000000000000");function Hg(){return new te}Ot.v4=Hg;var w_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Ug(n){return w_.test(n)}Ot.isUUID=Ug;function C_(n){if(!Ug(n))throw new Error("invalid uuid");return new mi(n)}Ot.parse=C_;function D_(){return Hg().asHex()}Ot.generateUuid=D_});var ue=P(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.WorkspaceFeature=Ge.TextDocumentLanguageFeature=Ge.TextDocumentEventFeature=Ge.DynamicDocumentFeature=Ge.DynamicFeature=Ge.StaticFeature=Ge.ensure=Ge.LSPCancellationError=void 0;var Xn=require("vscode"),lu=J(),ht=Ht(),Wg=Ie(),du=class extends Xn.CancellationError{constructor(e){super(),this.data=e}};Ge.LSPCancellationError=du;function S_(n,e){return n[e]===void 0&&(n[e]={}),n[e]}Ge.ensure=S_;var Bg;(function(n){function e(t){let r=t;return r!=null&&ht.func(r.fillClientCapabilities)&&ht.func(r.initialize)&&ht.func(r.getState)&&ht.func(r.clear)&&(r.fillInitializeParams===void 0||ht.func(r.fillInitializeParams))}n.is=e})(Bg||(Ge.StaticFeature=Bg={}));var zg;(function(n){function e(t){let r=t;return r!=null&&ht.func(r.fillClientCapabilities)&&ht.func(r.initialize)&&ht.func(r.getState)&&ht.func(r.clear)&&(r.fillInitializeParams===void 0||ht.func(r.fillInitializeParams))&&ht.func(r.register)&&ht.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(zg||(Ge.DynamicFeature=zg={}));var yi=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let o of Xn.workspace.textDocuments)if(Xn.languages.match(i,o)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};Ge.DynamicDocumentFeature=yi;var fu=class extends yi{static textDocumentFilter(e,t){for(let r of e)if(Xn.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,o,s,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Xn.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Xn.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};Ge.TextDocumentEventFeature=fu;var pu=class extends yi{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(lu.TextDocumentRegistrationOptions.is(t)){let r=lu.StaticRegistrationOptions.hasId(t)?t.id:Wg.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(ht.boolean(t)&&t===!0||lu.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=ht.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Wg.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return ht.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Xn.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Ge.TextDocumentLanguageFeature=pu;var hu=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Ge.WorkspaceFeature=hu});var $g=P((QC,Kg)=>{var T_=typeof process=="object"&&process&&process.platform==="win32";Kg.exports=T_?{sep:"\\"}:{sep:"/"}});var Zg=P((YC,Gg)=>{"use strict";Gg.exports=Xg;function Xg(n,e,t){n instanceof RegExp&&(n=Vg(n,t)),e instanceof RegExp&&(e=Vg(e,t));var r=Jg(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Vg(n,e){var t=e.match(n);return t?t[0]:null}Xg.range=Jg;function Jg(n,e,t){var r,i,o,s,a,u=t.indexOf(n),l=t.indexOf(e,u+1),f=u;if(u>=0&&l>0){if(n===e)return[u,l];for(r=[],o=t.length;f>=0&&!a;)f==u?(r.push(f),u=t.indexOf(n,f+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,f+1)),f=u<l&&u>=0?u:l;r.length&&(a=[o,s])}return a}});var om=P((eD,im)=>{var Qg=Zg();im.exports=P_;var Yg="\0SLASH"+Math.random()+"\0",em="\0OPEN"+Math.random()+"\0",mu="\0CLOSE"+Math.random()+"\0",tm="\0COMMA"+Math.random()+"\0",nm="\0PERIOD"+Math.random()+"\0";function gu(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function R_(n){return n.split("\\\\").join(Yg).split("\\{").join(em).split("\\}").join(mu).split("\\,").join(tm).split("\\.").join(nm)}function x_(n){return n.split(Yg).join("\\").split(em).join("{").split(mu).join("}").split(tm).join(",").split(nm).join(".")}function rm(n){if(!n)return[""];var e=[],t=Qg("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=rm(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function P_(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),vi(R_(n),!0).map(x_)):[]}function k_(n){return"{"+n+"}"}function q_(n){return/^-?0\d/.test(n)}function I_(n,e){return n<=e}function E_(n,e){return n>=e}function vi(n,e){var t=[],r=Qg("{","}",n);if(!r)return[n];var i=r.pre,o=r.post.length?vi(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var a=i+"{"+r.body+"}"+o[s];t.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),f=u||l,h=r.body.indexOf(",")>=0;if(!f&&!h)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+mu+r.post,vi(n)):[n];var p;if(f)p=r.body.split(/\.\./);else if(p=rm(r.body),p.length===1&&(p=vi(p[0],!1).map(k_),p.length===1))return o.map(function(Ue){return r.pre+p[0]+Ue});var m;if(f){var g=gu(p[0]),b=gu(p[1]),D=Math.max(p[0].length,p[1].length),k=p.length==3?Math.abs(gu(p[2])):1,z=I_,j=b<g;j&&(k*=-1,z=E_);var fe=p.some(q_);m=[];for(var K=g;z(K,b);K+=k){var ae;if(l)ae=String.fromCharCode(K),ae==="\\"&&(ae="");else if(ae=String(K),fe){var W=D-ae.length;if(W>0){var G=new Array(W+1).join("0");K<0?ae="-"+G+ae.slice(1):ae=G+ae}}m.push(ae)}}else{m=[];for(var ne=0;ne<p.length;ne++)m.push.apply(m,vi(p[ne],!1))}for(var ne=0;ne<m.length;ne++)for(var s=0;s<o.length;s++){var a=i+m[ne]+o[s];(!e||f||a)&&t.push(a)}}return t}});var No=P((nD,wu)=>{var Tt=wu.exports=(n,e,t={})=>(Mo(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Fr(e,t).match(n));wu.exports=Tt;var _u=$g();Tt.sep=_u.sep;var Ut=Symbol("globstar **");Tt.GLOBSTAR=Ut;var O_=om(),sm={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},bu="[^/]",yu=bu+"*?",F_="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",L_="(?:(?!(?:\\/|^)\\.).)*?",um=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),am=um("().*{}+?[]^$\\!"),M_=um("[.("),cm=/\/+/;Tt.filter=(n,e={})=>(t,r,i)=>Tt(t,n,e);var kn=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Tt.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Tt;let e=Tt,t=(r,i,o)=>e(r,i,kn(n,o));return t.Minimatch=class extends e.Minimatch{constructor(i,o){super(i,kn(n,o))}},t.Minimatch.defaults=r=>e.defaults(kn(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,kn(n,i)),t.defaults=r=>e.defaults(kn(n,r)),t.makeRe=(r,i)=>e.makeRe(r,kn(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,kn(n,i)),t.match=(r,i,o)=>e.match(r,i,kn(n,o)),t};Tt.braceExpand=(n,e)=>lm(n,e);var lm=(n,e={})=>(Mo(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:O_(n)),N_=1024*64,Mo=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>N_)throw new TypeError("pattern is too long")},vu=Symbol("subparse");Tt.makeRe=(n,e)=>new Fr(n,e||{}).makeRe();Tt.match=(n,e,t={})=>{let r=new Fr(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var A_=n=>n.replace(/\\(.)/g,"$1"),j_=n=>n.replace(/\\([^-\]])/g,"$1"),H_=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),U_=n=>n.replace(/[[\]\\]/g,"\\$&"),Fr=class{constructor(e,t){Mo(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(cm)),this.debug(this.pattern,r),r=r.map((i,o,s)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,a=e.length,u=t.length;o<a&&s<u;o++,s++){this.debug("matchOne loop");var l=t[s],f=e[o];if(this.debug(t,l,f),l===!1)return!1;if(l===Ut){this.debug("GLOBSTAR",[t,l,f]);var h=o,p=s+1;if(p===u){for(this.debug("** at the end");o<a;o++)if(e[o]==="."||e[o]===".."||!i.dot&&e[o].charAt(0)===".")return!1;return!0}for(;h<a;){var m=e[h];if(this.debug(`
globstar while`,e,h,t,p,m),this.matchOne(e.slice(h),t.slice(p),r))return this.debug("globstar found match!",h,a,m),!0;if(m==="."||m===".."||!i.dot&&m.charAt(0)==="."){this.debug("dot detected!",e,h,t,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,h,t,p),h===a))}var g;if(typeof l=="string"?(g=f===l,this.debug("string match",l,f,g)):(g=f.match(l),this.debug("pattern match",l,f,g)),!g)return!1}if(o===a&&s===u)return!0;if(o===a)return r;if(s===u)return o===a-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return lm(this.pattern,this.options)}parse(e,t){Mo(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Ut;if(e==="")return"";let i="",o=!1,s=!1,a=[],u=[],l,f=!1,h=-1,p=-1,m,g,b,D=e.charAt(0)===".",k=r.dot||D,z=()=>D?"":k?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",j=W=>W.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",fe=()=>{if(l){switch(l){case"*":i+=yu,o=!0;break;case"?":i+=bu,o=!0;break;default:i+="\\"+l;break}this.debug("clearStateChar %j %j",l,i),l=!1}};for(let W=0,G;W<e.length&&(G=e.charAt(W));W++){if(this.debug("%s	%s %s %j",e,W,i,G),s){if(G==="/")return!1;am[G]&&(i+="\\"),i+=G,s=!1;continue}switch(G){case"/":return!1;case"\\":if(f&&e.charAt(W+1)==="-"){i+=G;continue}fe(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,W,i,G),f){this.debug("  in class"),G==="!"&&W===p+1&&(G="^"),i+=G;continue}this.debug("call clearStateChar %j",l),fe(),l=G,r.noext&&fe();continue;case"(":{if(f){i+="(";continue}if(!l){i+="\\(";continue}let ne={type:l,start:W-1,reStart:i.length,open:sm[l].open,close:sm[l].close};this.debug(this.pattern,"	",ne),a.push(ne),i+=ne.open,ne.start===0&&ne.type!=="!"&&(D=!0,i+=j(e.slice(W+1))),this.debug("plType %j %j",l,i),l=!1;continue}case")":{let ne=a[a.length-1];if(f||!ne){i+="\\)";continue}a.pop(),fe(),o=!0,g=ne,i+=g.close,g.type==="!"&&u.push(Object.assign(g,{reEnd:i.length}));continue}case"|":{let ne=a[a.length-1];if(f||!ne){i+="\\|";continue}fe(),i+="|",ne.start===0&&ne.type!=="!"&&(D=!0,i+=j(e.slice(W+1)));continue}case"[":if(fe(),f){i+="\\"+G;continue}f=!0,p=W,h=i.length,i+=G;continue;case"]":if(W===p+1||!f){i+="\\"+G;continue}m=e.substring(p+1,W);try{RegExp("["+U_(j_(m))+"]"),i+=G}catch{i=i.substring(0,h)+"(?:$.)"}o=!0,f=!1;continue;default:fe(),am[G]&&!(G==="^"&&f)&&(i+="\\"),i+=G;break}}for(f&&(m=e.slice(p+1),b=this.parse(m,vu),i=i.substring(0,h)+"\\["+b[0],o=o||b[1]),g=a.pop();g;g=a.pop()){let W;W=i.slice(g.reStart+g.open.length),this.debug("setting tail",i,g),W=W.replace(/((?:\\{2}){0,64})(\\?)\|/g,(ne,Ue,O)=>(O||(O="\\"),Ue+Ue+O+"|")),this.debug(`tail=%j
   %s`,W,W,g,i);let G=g.type==="*"?yu:g.type==="?"?bu:"\\"+g.type;o=!0,i=i.slice(0,g.reStart)+G+"\\("+W}fe(),s&&(i+="\\\\");let K=M_[i.charAt(0)];for(let W=u.length-1;W>-1;W--){let G=u[W],ne=i.slice(0,G.reStart),Ue=i.slice(G.reStart,G.reEnd-8),O=i.slice(G.reEnd),x=i.slice(G.reEnd-8,G.reEnd)+O,L=ne.split(")").length,N=ne.split("(").length-L,ee=O;for(let X=0;X<N;X++)ee=ee.replace(/\)[+*?]?/,"");O=ee;let B=O===""&&t!==vu?"(?:$|\\/)":"";i=ne+Ue+O+B+x}if(i!==""&&o&&(i="(?=.)"+i),K&&(i=z()+i),t===vu)return[i,o];if(r.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return A_(e);let ae=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",ae),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?yu:t.dot?F_:L_,i=t.nocase?"i":"",o=e.map(s=>(s=s.map(a=>typeof a=="string"?H_(a):a===Ut?Ut:a._src).reduce((a,u)=>(a[a.length-1]===Ut&&u===Ut||a.push(u),a),[]),s.forEach((a,u)=>{a!==Ut||s[u-1]===Ut||(u===0?s.length>1?s[u+1]="(?:\\/|"+r+"\\/)?"+s[u+1]:s[u]=r:u===s.length-1?s[u-1]+="(?:\\/|"+r+")?":(s[u-1]+="(?:\\/|\\/"+r+"\\/)"+s[u+1],s[u+1]=Ut))}),s.filter(a=>a!==Ut).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;_u.sep!=="/"&&(e=e.split(_u.sep).join("/")),e=e.split(cm),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<i.length;s++){let a=i[s],u=e;if(r.matchBase&&a.length===1&&(u=[o]),this.matchOne(u,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Tt.defaults(e).Minimatch}};Tt.Minimatch=Fr});var Pu=P(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.DiagnosticFeature=qn.DiagnosticPullMode=qn.vsdiag=void 0;var W_=No(),oe=require("vscode"),Ne=J(),B_=Ie(),Cu=ue();function Ao(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Ft;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Ft||(qn.vsdiag=Ft={}));var jo;(function(n){n.onType="onType",n.onSave="onSave"})(jo||(qn.DiagnosticPullMode=jo={}));var lt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(lt||(lt={}));var Jn=class{constructor(){this.open=new Set,this._onOpen=new oe.EventEmitter,this._onClose=new oe.EventEmitter,Jn.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;Jn.fillTabResources(i);let o=new Set,s=new Set(i);for(let a of r.values())i.has(a)?s.delete(a):o.add(a);if(this.open=i,o.size>0){let a=new Set;for(let u of o)a.add(oe.Uri.parse(u));this._onClose.fire(a)}if(s.size>0){let a=new Set;for(let u of s)a.add(oe.Uri.parse(u));this._onOpen.fire(a)}};oe.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=oe.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof oe.Uri?oe.window.activeTextEditor?.document.uri===e:oe.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof oe.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return Jn.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of oe.window.tabGroups.all)for(let o of i.tabs){let s=o.input,a;s instanceof oe.TabInputText?a=s.uri:s instanceof oe.TabInputTextDiff?a=s.modified:s instanceof oe.TabInputCustom&&(a=s.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},Be;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Be||(Be={}));var an;(function(n){function e(t){return t instanceof oe.Uri?t.toString():t.uri.toString()}n.asKey=e})(an||(an={}));var Du=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Be.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=t instanceof oe.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],u=i.get(o);return u===void 0&&(u={document:s,pulledVersion:a,resultId:void 0},i.set(o,u)),u}update(e,t,r,i){let o=e===Be.document?this.documentPullStates:this.workspacePullStates,[s,a,u,l]=t instanceof oe.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],f=o.get(s);f===void 0?(f={document:a,pulledVersion:u,resultId:l},o.set(s,f)):(f.pulledVersion=u,f.resultId=l)}unTrack(e,t){let r=an.asKey(t);(e===Be.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=an.asKey(t);return(e===Be.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){let r=an.asKey(t);return(e===Be.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},Su=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new oe.EventEmitter,this.provider=this.createProvider(),this.diagnostics=oe.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Du,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof oe.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof oe.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof oe.Uri,i=r?e:e.uri,o=i.toString();t=r?t:e.version;let s=this.openRequests.get(o),a=r?this.documentStates.track(Be.document,e,t):this.documentStates.track(Be.document,e);if(s===void 0){let u=new oe.CancellationTokenSource;this.openRequests.set(o,{state:lt.active,document:e,version:t,tokenSource:u});let l,f;try{l=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:Ft.DocumentDiagnosticReportKind.full,items:[]}}catch(h){if(h instanceof Cu.LSPCancellationError&&Ne.DiagnosticServerCancellationData.is(h.data)&&h.data.retriggerRequest===!1&&(f={state:lt.outDated,document:e}),f===void 0&&h instanceof oe.CancellationError)f={state:lt.reschedule,document:e};else throw h}if(f=f??this.openRequests.get(o),f===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${o}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(o),!this.tabs.isVisible(e)){this.documentStates.unTrack(Be.document,e);return}if(f.state===lt.outDated)return;l!==void 0&&(l.kind===Ft.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,l.items),a.pulledVersion=t,a.resultId=l.resultId),f.state===lt.reschedule&&this.pull(e)}else s.state===lt.active?(s.tokenSource.cancel(),this.openRequests.set(o,{state:lt.reschedule,document:s.document})):s.state===lt.outDated&&this.openRequests.set(o,{state:lt.reschedule,document:s.document})}forgetDocument(e){let t=e instanceof oe.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:lt.reschedule,document:e}):this.pull(e,()=>{this.forget(Be.document,e)}):(i!==void 0&&(i.state===lt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:lt.outDated,document:e})),this.diagnostics.delete(t),this.forget(Be.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ne.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Cu.LSPCancellationError)&&!Ne.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ne.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new oe.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Ft.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Be.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Be.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let o=(a,u,l)=>{let f={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof oe.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:Ft.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Ne.DocumentDiagnosticRequest.type,f,l).then(async h=>h==null||this.isDisposed||l.isCancellationRequested?{kind:Ft.DocumentDiagnosticReportKind.full,items:[]}:h.kind===Ne.DocumentDiagnosticReportKind.Full?{kind:Ft.DocumentDiagnosticReportKind.full,resultId:h.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(h.items,l)}:{kind:Ft.DocumentDiagnosticReportKind.unChanged,resultId:h.resultId},h=>this.client.handleFailedRequest(Ne.DocumentDiagnosticRequest.type,l,h,{kind:Ft.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let o=async l=>l.kind===Ne.DocumentDiagnosticReportKind.Full?{kind:Ft.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:Ft.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{let f=[];for(let h of l)f.push({uri:this.client.code2ProtocolConverter.asUri(h.uri),value:h.value});return f},a=(l,f)=>{let h=(0,B_.generateUuid)(),p=this.client.onProgress(Ne.WorkspaceDiagnosticRequest.partialResult,h,async g=>{if(g==null){i(null);return}let b={items:[]};for(let D of g.items)try{b.items.push(await o(D))}catch(k){this.client.error("Converting workspace diagnostics failed.",k)}i(b)}),m={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:h};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Ne.WorkspaceDiagnosticRequest.type,m,f).then(async g=>{if(f.isCancellationRequested)return{items:[]};let b={items:[]};for(let D of g.items)b.items.push(await o(D));return p.dispose(),i(b),{items:[]}},g=>(p.dispose(),this.client.handleFailedRequest(Ne.DocumentDiagnosticRequest.type,f,g,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===lt.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:lt.outDated,document:t.document});this.diagnostics.dispose()}},Tu=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Ne.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=an.asKey(e);this.documents.has(t)||(this.documents.set(t,e,Ne.Touch.Last),this.trigger())}remove(e){let t=an.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ne.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=an.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,Ne.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?an.asKey(this.endDocument):void 0}},Ru=class{constructor(e,t,r){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=g=>{let b=r.documentSelector;if(i.match!==void 0)return i.match(b,g);for(let D of b)if(Ne.TextDocumentFilter.is(D)){if(typeof D=="string"||D.language!==void 0&&D.language!=="*"||D.scheme!==void 0&&D.scheme!=="*"&&D.scheme!==g.scheme)return!1;if(D.pattern!==void 0){let k=new W_.Minimatch(D.pattern,{noext:!0});if(!k.makeRe()||!k.match(g.fsPath))return!1}}return!0},u=g=>g instanceof oe.Uri?a(g):oe.languages.match(o,g)>0&&t.isVisible(g),l=g=>g instanceof oe.Uri?this.activeTextDocument?.uri.toString()===g.toString():this.activeTextDocument===g;this.diagnosticRequestor=new Su(e,t,r),this.backgroundScheduler=new Tu(this.diagnosticRequestor);let f=g=>{!u(g)||!r.interFileDependencies||l(g)||this.backgroundScheduler.add(g)};this.activeTextDocument=oe.window.activeTextEditor?.document,oe.window.onDidChangeActiveTextEditor(g=>{let b=this.activeTextDocument;this.activeTextDocument=g?.document,b!==void 0&&f(b),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let h=e.getFeature(Ne.DidOpenTextDocumentNotification.method);s.push(h.onNotificationSent(g=>{let b=g.textDocument;this.diagnosticRequestor.knows(Be.document,b)||u(b)&&this.diagnosticRequestor.pull(b,()=>{f(b)})})),s.push(t.onOpen(g=>{for(let b of g){if(this.diagnosticRequestor.knows(Be.document,b))continue;let D=b.toString(),k;for(let z of oe.workspace.textDocuments)if(D===z.uri.toString()){k=z;break}k!==void 0&&u(k)&&this.diagnosticRequestor.pull(k,()=>{f(k)})}}));let p=new Set;for(let g of oe.workspace.textDocuments)u(g)&&(this.diagnosticRequestor.pull(g,()=>{f(g)}),p.add(g.uri.toString()));if(i.onTabs===!0)for(let g of t.getTabResources())!p.has(g.toString())&&u(g)&&this.diagnosticRequestor.pull(g,()=>{f(g)});if(i.onChange===!0){let g=e.getFeature(Ne.DidChangeTextDocumentNotification.method);s.push(g.onNotificationSent(async b=>{let D=b.textDocument;(i.filter===void 0||!i.filter(D,jo.onType))&&this.diagnosticRequestor.knows(Be.document,D)&&this.diagnosticRequestor.pull(D,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let g=e.getFeature(Ne.DidSaveTextDocumentNotification.method);s.push(g.onNotificationSent(b=>{let D=b.textDocument;(i.filter===void 0||!i.filter(D,jo.onSave))&&this.diagnosticRequestor.knows(Be.document,D)&&this.diagnosticRequestor.pull(b.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let m=e.getFeature(Ne.DidCloseTextDocumentNotification.method);s.push(m.onNotificationSent(g=>{this.cleanUpDocument(g.textDocument)})),t.onClose(g=>{for(let b of g)this.cleanUpDocument(b)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let g of oe.workspace.textDocuments)u(g)&&this.diagnosticRequestor.pull(g)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=oe.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Be.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},xu=class extends Cu.TextDocumentLanguageFeature{constructor(e){super(e,Ne.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=Ao(Ao(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,Ao(Ao(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ne.DiagnosticRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Jn);let t=new Ru(this._client,this.tabs,e);return[t.disposable,t]}};qn.DiagnosticFeature=xu});var Ho=P(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.forEach=dt.mapAsync=dt.map=dt.clearTestMode=dt.setTestMode=dt.Semaphore=dt.Delayer=void 0;var bi=J(),ku=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,bi.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};dt.Delayer=ku;var qu=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,bi.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};dt.Semaphore=qu;var Iu=!1;function z_(){Iu=!0}dt.setTestMode=z_;function K_(){Iu=!1}dt.clearTestMode=K_;var dm=15,_i=class{constructor(e=dm){this.yieldAfter=Iu===!0?Math.max(e,2):Math.max(e,dm),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function $_(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new _i(r?.yieldAfter);function s(u){o.start();for(let l=u;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,bi.RAL)().timer.setImmediate(()=>{u(s(a))})});return i}dt.map=$_;async function V_(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new _i(r?.yieldAfter);async function s(u){o.start();for(let l=u;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,bi.RAL)().timer.setImmediate(()=>{u(s(a))})});return i}dt.mapAsync=V_;async function X_(n,e,t,r){if(n.length===0)return;let i=new _i(r?.yieldAfter);function o(a){i.start();for(let u=a;u<n.length;u++)if(e(n[u]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,bi.RAL)().timer.setImmediate(()=>{a(o(s))})})}dt.forEach=X_});var Fu=P(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});var J_=require("vscode"),Eu=class extends J_.CompletionItem{constructor(e){super(e)}};Ou.default=Eu});var Nu=P(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});var G_=require("vscode"),Lu=class extends G_.CodeLens{constructor(e){super(e)}};Mu.default=Lu});var Hu=P(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});var Z_=require("vscode"),Au=class extends Z_.DocumentLink{constructor(e,t){super(e,t)}};ju.default=Au});var Bu=P(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});var Q_=require("vscode"),Uu=class extends Q_.CodeAction{constructor(e,t){super(e),this.data=t}};Wu.default=Uu});var $u=P(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.ProtocolDiagnostic=Lr.DiagnosticCode=void 0;var Y_=require("vscode"),zu=Ht(),fm;(function(n){function e(t){let r=t;return r!=null&&(zu.number(r.value)||zu.string(r.value))&&zu.string(r.target)}n.is=e})(fm||(Lr.DiagnosticCode=fm={}));var Ku=class extends Y_.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};Lr.ProtocolDiagnostic=Ku});var Ju=P(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});var eb=require("vscode"),Vu=class extends eb.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};Xu.default=Vu});var Qu=P(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});var tb=require("vscode"),Gu=class extends tb.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};Zu.default=Gu});var tl=P(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var Uo=require("vscode"),Yu=class extends Uo.SymbolInformation{constructor(e,t,r,i,o){let s=!(i instanceof Uo.Uri);super(e,t,r,s?i:new Uo.Location(i,new Uo.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}};el.default=Yu});var il=P(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var nb=require("vscode"),nl=class extends nb.InlayHint{constructor(e,t,r){super(e,t,r)}};rl.default=nl});var mm=P(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.createConverter=void 0;var He=require("vscode"),Z=J(),Gn=Ht(),pm=Ho(),rb=Fu(),ib=Nu(),ob=Hu(),hm=Bu(),gm=$u(),sb=Ju(),ab=Qu(),cb=tl(),ub=il(),ol;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(ol||(ol={}));function lb(n){let t=n||(d=>d.toString());function r(d){return t(d)}function i(d){return{uri:t(d.uri)}}function o(d){return{uri:t(d.uri),languageId:d.languageId,version:d.version,text:d.getText()}}function s(d){return{uri:t(d.uri),version:d.version}}function a(d){return{textDocument:o(d)}}function u(d){let C=d;return!!C.document&&!!C.contentChanges}function l(d){let C=d;return!!C.uri&&!!C.version}function f(d,C,A){if(l(d))return{textDocument:{uri:t(d.uri),version:d.version},contentChanges:[{text:d.getText()}]};if(u(d)){let ve=C,Ce=A;return{textDocument:{uri:t(ve),version:Ce},contentChanges:d.contentChanges.map(Ct=>{let $t=Ct.range;return{range:{start:{line:$t.start.line,character:$t.start.character},end:{line:$t.end.line,character:$t.end.character}},rangeLength:Ct.rangeLength,text:Ct.text}})}}else throw Error("Unsupported text document change parameter")}function h(d){return{textDocument:i(d)}}function p(d,C=!1){let A={textDocument:i(d)};return C&&(A.text=d.getText()),A}function m(d){switch(d){case He.TextDocumentSaveReason.Manual:return Z.TextDocumentSaveReason.Manual;case He.TextDocumentSaveReason.AfterDelay:return Z.TextDocumentSaveReason.AfterDelay;case He.TextDocumentSaveReason.FocusOut:return Z.TextDocumentSaveReason.FocusOut}return Z.TextDocumentSaveReason.Manual}function g(d){return{textDocument:i(d.document),reason:m(d.reason)}}function b(d){return{files:d.files.map(C=>({uri:t(C)}))}}function D(d){return{files:d.files.map(C=>({oldUri:t(C.oldUri),newUri:t(C.newUri)}))}}function k(d){return{files:d.files.map(C=>({uri:t(C)}))}}function z(d){return{files:d.files.map(C=>({uri:t(C)}))}}function j(d){return{files:d.files.map(C=>({oldUri:t(C.oldUri),newUri:t(C.newUri)}))}}function fe(d){return{files:d.files.map(C=>({uri:t(C)}))}}function K(d,C){return{textDocument:i(d),position:ee(C)}}function ae(d){switch(d){case He.CompletionTriggerKind.TriggerCharacter:return Z.CompletionTriggerKind.TriggerCharacter;case He.CompletionTriggerKind.TriggerForIncompleteCompletions:return Z.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Z.CompletionTriggerKind.Invoked}}function W(d,C,A){return{textDocument:i(d),position:ee(C),context:{triggerKind:ae(A.triggerKind),triggerCharacter:A.triggerCharacter}}}function G(d){switch(d){case He.SignatureHelpTriggerKind.Invoke:return Z.SignatureHelpTriggerKind.Invoked;case He.SignatureHelpTriggerKind.TriggerCharacter:return Z.SignatureHelpTriggerKind.TriggerCharacter;case He.SignatureHelpTriggerKind.ContentChange:return Z.SignatureHelpTriggerKind.ContentChange}}function ne(d){return{label:d.label}}function Ue(d){return d.map(ne)}function O(d){return{label:d.label,parameters:Ue(d.parameters)}}function x(d){return d.map(O)}function L(d){return d===void 0?d:{signatures:x(d.signatures),activeSignature:d.activeSignature,activeParameter:d.activeParameter}}function N(d,C,A){return{textDocument:i(d),position:ee(C),context:{isRetrigger:A.isRetrigger,triggerCharacter:A.triggerCharacter,triggerKind:G(A.triggerKind),activeSignatureHelp:L(A.activeSignatureHelp)}}}function ee(d){return{line:d.line,character:d.character}}function B(d){return d==null?d:{line:d.line>Z.uinteger.MAX_VALUE?Z.uinteger.MAX_VALUE:d.line,character:d.character>Z.uinteger.MAX_VALUE?Z.uinteger.MAX_VALUE:d.character}}function X(d,C){return pm.map(d,B,C)}function ze(d){return d.map(B)}function ce(d){return d==null?d:{start:B(d.start),end:B(d.end)}}function pe(d){return d.map(ce)}function st(d){return d==null?d:Z.Location.create(r(d.uri),ce(d.range))}function Nt(d){switch(d){case He.DiagnosticSeverity.Error:return Z.DiagnosticSeverity.Error;case He.DiagnosticSeverity.Warning:return Z.DiagnosticSeverity.Warning;case He.DiagnosticSeverity.Information:return Z.DiagnosticSeverity.Information;case He.DiagnosticSeverity.Hint:return Z.DiagnosticSeverity.Hint}}function $r(d){if(!d)return;let C=[];for(let A of d){let ve=Mn(A);ve!==void 0&&C.push(ve)}return C.length>0?C:void 0}function Mn(d){switch(d){case He.DiagnosticTag.Unnecessary:return Z.DiagnosticTag.Unnecessary;case He.DiagnosticTag.Deprecated:return Z.DiagnosticTag.Deprecated;default:return}}function Nn(d){return{message:d.message,location:st(d.location)}}function ir(d){return d.map(Nn)}function Vr(d){if(d!=null)return Gn.number(d)||Gn.string(d)?d:{value:d.value,target:r(d.target)}}function An(d){let C=Z.Diagnostic.create(ce(d.range),d.message),A=d instanceof gm.ProtocolDiagnostic?d:void 0;A!==void 0&&A.data!==void 0&&(C.data=A.data);let ve=Vr(d.code);return gm.DiagnosticCode.is(ve)?A!==void 0&&A.hasDiagnosticCode?C.code=ve:(C.code=ve.value,C.codeDescription={href:ve.target}):C.code=ve,Gn.number(d.severity)&&(C.severity=Nt(d.severity)),Array.isArray(d.tags)&&(C.tags=$r(d.tags)),d.relatedInformation&&(C.relatedInformation=ir(d.relatedInformation)),d.source&&(C.source=d.source),C}function gn(d,C){return d==null?d:pm.map(d,An,C)}function mn(d){return d==null?d:d.map(An)}function Xr(d,C){switch(d){case"$string":return C;case Z.MarkupKind.PlainText:return{kind:d,value:C};case Z.MarkupKind.Markdown:return{kind:d,value:C.value};default:return`Unsupported Markup content received. Kind is: ${d}`}}function et(d){switch(d){case He.CompletionItemTag.Deprecated:return Z.CompletionItemTag.Deprecated}}function or(d){if(d===void 0)return d;let C=[];for(let A of d){let ve=et(A);ve!==void 0&&C.push(ve)}return C}function yn(d,C){return C!==void 0?C:d+1}function tn(d,C=!1){let A,ve;Gn.string(d.label)?A=d.label:(A=d.label.label,C&&(d.label.detail!==void 0||d.label.description!==void 0)&&(ve={detail:d.label.detail,description:d.label.description}));let Ce={label:A};ve!==void 0&&(Ce.labelDetails=ve);let $e=d instanceof rb.default?d:void 0;d.detail&&(Ce.detail=d.detail),d.documentation&&(!$e||$e.documentationFormat==="$string"?Ce.documentation=d.documentation:Ce.documentation=Xr($e.documentationFormat,d.documentation)),d.filterText&&(Ce.filterText=d.filterText),Jr(Ce,d),Gn.number(d.kind)&&(Ce.kind=yn(d.kind,$e&&$e.originalItemKind)),d.sortText&&(Ce.sortText=d.sortText),d.additionalTextEdits&&(Ce.additionalTextEdits=Ke(d.additionalTextEdits)),d.commitCharacters&&(Ce.commitCharacters=d.commitCharacters.slice()),d.command&&(Ce.command=M(d.command)),(d.preselect===!0||d.preselect===!1)&&(Ce.preselect=d.preselect);let Ct=or(d.tags);if($e){if($e.data!==void 0&&(Ce.data=$e.data),$e.deprecated===!0||$e.deprecated===!1){if($e.deprecated===!0&&Ct!==void 0&&Ct.length>0){let $t=Ct.indexOf(He.CompletionItemTag.Deprecated);$t!==-1&&Ct.splice($t,1)}Ce.deprecated=$e.deprecated}$e.insertTextMode!==void 0&&(Ce.insertTextMode=$e.insertTextMode)}return Ct!==void 0&&Ct.length>0&&(Ce.tags=Ct),Ce.insertTextMode===void 0&&d.keepWhitespace===!0&&(Ce.insertTextMode=Z.InsertTextMode.adjustIndentation),Ce}function Jr(d,C){let A=Z.InsertTextFormat.PlainText,ve,Ce;C.textEdit?(ve=C.textEdit.newText,Ce=C.textEdit.range):C.insertText instanceof He.SnippetString?(A=Z.InsertTextFormat.Snippet,ve=C.insertText.value):ve=C.insertText,C.range&&(Ce=C.range),d.insertTextFormat=A,C.fromEdit&&ve!==void 0&&Ce!==void 0?d.textEdit=nn(ve,Ce):d.insertText=ve}function nn(d,C){return ol.is(C)?Z.InsertReplaceEdit.create(d,ce(C.inserting),ce(C.replacing)):{newText:d,range:ce(C)}}function jn(d){return{range:ce(d.range),newText:d.newText}}function Ke(d){return d==null?d:d.map(jn)}function wt(d){return d<=He.SymbolKind.TypeParameter?d+1:Z.SymbolKind.Property}function gt(d){return d}function Kt(d){return d.map(gt)}function rn(d,C,A){return{textDocument:i(d),position:ee(C),context:{includeDeclaration:A.includeDeclaration}}}async function Hn(d,C){let A=Z.CodeAction.create(d.title);if(d instanceof hm.default&&d.data!==void 0&&(A.data=d.data),d.kind!==void 0&&(A.kind=v(d.kind)),d.diagnostics!==void 0&&(A.diagnostics=await gn(d.diagnostics,C)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(A.command=M(d.command)),d.isPreferred!==void 0&&(A.isPreferred=d.isPreferred),d.disabled!==void 0&&(A.disabled={reason:d.disabled.reason}),A}function sr(d){let C=Z.CodeAction.create(d.title);if(d instanceof hm.default&&d.data!==void 0&&(C.data=d.data),d.kind!==void 0&&(C.kind=v(d.kind)),d.diagnostics!==void 0&&(C.diagnostics=mn(d.diagnostics)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(C.command=M(d.command)),d.isPreferred!==void 0&&(C.isPreferred=d.isPreferred),d.disabled!==void 0&&(C.disabled={reason:d.disabled.reason}),C}async function vn(d,C){if(d==null)return d;let A;return d.only&&Gn.string(d.only.value)&&(A=[d.only.value]),Z.CodeActionContext.create(await gn(d.diagnostics,C),A,kt(d.triggerKind))}function ar(d){if(d==null)return d;let C;return d.only&&Gn.string(d.only.value)&&(C=[d.only.value]),Z.CodeActionContext.create(mn(d.diagnostics),C,kt(d.triggerKind))}function kt(d){switch(d){case He.CodeActionTriggerKind.Invoke:return Z.CodeActionTriggerKind.Invoked;case He.CodeActionTriggerKind.Automatic:return Z.CodeActionTriggerKind.Automatic;default:return}}function v(d){if(d!=null)return d.value}function T(d){return d==null?d:Z.InlineValueContext.create(d.frameId,ce(d.stoppedLocation))}function E(d,C,A){return{context:Z.InlineCompletionContext.create(A.triggerKind,A.selectedCompletionInfo),textDocument:i(d),position:B(C)}}function M(d){let C=Z.Command.create(d.title,d.command);return d.arguments&&(C.arguments=d.arguments),C}function ye(d){let C=Z.CodeLens.create(ce(d.range));return d.command&&(C.command=M(d.command)),d instanceof ib.default&&d.data&&(C.data=d.data),C}function he(d,C){let A={tabSize:d.tabSize,insertSpaces:d.insertSpaces};return C.trimTrailingWhitespace&&(A.trimTrailingWhitespace=!0),C.trimFinalNewlines&&(A.trimFinalNewlines=!0),C.insertFinalNewline&&(A.insertFinalNewline=!0),A}function De(d){return{textDocument:i(d)}}function xe(d){return{textDocument:i(d)}}function re(d){let C=Z.DocumentLink.create(ce(d.range));d.target&&(C.target=r(d.target)),d.tooltip!==void 0&&(C.tooltip=d.tooltip);let A=d instanceof ob.default?d:void 0;return A&&A.data&&(C.data=A.data),C}function we(d){return{textDocument:i(d)}}function le(d){let C={name:d.name,kind:wt(d.kind),uri:r(d.uri),range:ce(d.range),selectionRange:ce(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(C.detail=d.detail),d.tags!==void 0&&(C.tags=Kt(d.tags)),d instanceof sb.default&&d.data!==void 0&&(C.data=d.data),C}function Pe(d){let C={name:d.name,kind:wt(d.kind),uri:r(d.uri),range:ce(d.range),selectionRange:ce(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(C.detail=d.detail),d.tags!==void 0&&(C.tags=Kt(d.tags)),d instanceof ab.default&&d.data!==void 0&&(C.data=d.data),C}function We(d){let C=d instanceof cb.default?{name:d.name,kind:wt(d.kind),location:d.hasRange?st(d.location):{uri:t(d.location.uri)},data:d.data}:{name:d.name,kind:wt(d.kind),location:st(d.location)};return d.tags!==void 0&&(C.tags=Kt(d.tags)),d.containerName!==""&&(C.containerName=d.containerName),C}function pt(d){let C=typeof d.label=="string"?d.label:d.label.map(Gr),A=Z.InlayHint.create(B(d.position),C);return d.kind!==void 0&&(A.kind=d.kind),d.textEdits!==void 0&&(A.textEdits=Ke(d.textEdits)),d.tooltip!==void 0&&(A.tooltip=Zr(d.tooltip)),d.paddingLeft!==void 0&&(A.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(A.paddingRight=d.paddingRight),d instanceof ub.default&&d.data!==void 0&&(A.data=d.data),A}function Gr(d){let C=Z.InlayHintLabelPart.create(d.value);return d.location!==void 0&&(C.location=st(d.location)),d.command!==void 0&&(C.command=M(d.command)),d.tooltip!==void 0&&(C.tooltip=Zr(d.tooltip)),C}function Zr(d){return typeof d=="string"?d:{kind:Z.MarkupKind.Markdown,value:d.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:f,asCloseTextDocumentParams:h,asSaveTextDocumentParams:p,asWillSaveTextDocumentParams:g,asDidCreateFilesParams:b,asDidRenameFilesParams:D,asDidDeleteFilesParams:k,asWillCreateFilesParams:z,asWillRenameFilesParams:j,asWillDeleteFilesParams:fe,asTextDocumentPositionParams:K,asCompletionParams:W,asSignatureHelpParams:N,asWorkerPosition:ee,asRange:ce,asRanges:pe,asPosition:B,asPositions:X,asPositionsSync:ze,asLocation:st,asDiagnosticSeverity:Nt,asDiagnosticTag:Mn,asDiagnostic:An,asDiagnostics:gn,asDiagnosticsSync:mn,asCompletionItem:tn,asTextEdit:jn,asSymbolKind:wt,asSymbolTag:gt,asSymbolTags:Kt,asReferenceParams:rn,asCodeAction:Hn,asCodeActionSync:sr,asCodeActionContext:vn,asCodeActionContextSync:ar,asInlineValueContext:T,asCommand:M,asCodeLens:ye,asFormattingOptions:he,asDocumentSymbolParams:De,asCodeLensParams:xe,asDocumentLink:re,asDocumentLinkParams:we,asCallHierarchyItem:le,asTypeHierarchyItem:Pe,asInlayHint:pt,asWorkspaceSymbol:We,asInlineCompletionParams:E}}Wo.createConverter=lb});var _m=P(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.createConverter=void 0;var F=require("vscode"),V=J(),Lt=Ht(),de=Ho(),db=Fu(),fb=Nu(),pb=Hu(),hb=Bu(),ym=$u(),gb=Ju(),mb=Qu(),yb=tl(),vb=il(),vm=J(),Bo;(function(n){function e(t){let r=t;return r&&Lt.string(r.language)&&Lt.string(r.value)}n.is=e})(Bo||(Bo={}));function _b(n,e,t){let i=n||(c=>F.Uri.parse(c));function o(c){return i(c)}function s(c){let _=[];for(let R of c)if(typeof R=="string")_.push(R);else if(vm.NotebookCellTextDocumentFilter.is(R))if(typeof R.notebook=="string")_.push({notebookType:R.notebook,language:R.language});else{let H=R.notebook.notebookType??"*";_.push({notebookType:H,scheme:R.notebook.scheme,pattern:R.notebook.pattern,language:R.language})}else vm.TextDocumentFilter.is(R)&&_.push({language:R.language,scheme:R.scheme,pattern:R.pattern});return _}async function a(c,_){return de.map(c,l,_)}function u(c){let _=new Array(c.length);for(let R=0;R<c.length;R++)_[R]=l(c[R]);return _}function l(c){let _=new ym.ProtocolDiagnostic(g(c.range),c.message,D(c.severity),c.data);if(c.code!==void 0){if(typeof c.code=="string"||typeof c.code=="number")V.CodeDescription.is(c.codeDescription)?_.code={value:c.code,target:o(c.codeDescription.href)}:_.code=c.code;else if(ym.DiagnosticCode.is(c.code)){_.hasDiagnosticCode=!0;let R=c.code;_.code={value:R.value,target:o(R.target)}}}return c.source&&(_.source=c.source),c.relatedInformation&&(_.relatedInformation=f(c.relatedInformation)),Array.isArray(c.tags)&&(_.tags=h(c.tags)),_}function f(c){let _=new Array(c.length);for(let R=0;R<c.length;R++){let H=c[R];_[R]=new F.DiagnosticRelatedInformation(Nt(H.location),H.message)}return _}function h(c){if(!c)return;let _=[];for(let R of c){let H=p(R);H!==void 0&&_.push(H)}return _.length>0?_:void 0}function p(c){switch(c){case V.DiagnosticTag.Unnecessary:return F.DiagnosticTag.Unnecessary;case V.DiagnosticTag.Deprecated:return F.DiagnosticTag.Deprecated;default:return}}function m(c){return c?new F.Position(c.line,c.character):void 0}function g(c){return c?new F.Range(c.start.line,c.start.character,c.end.line,c.end.character):void 0}async function b(c,_){return de.map(c,R=>new F.Range(R.start.line,R.start.character,R.end.line,R.end.character),_)}function D(c){if(c==null)return F.DiagnosticSeverity.Error;switch(c){case V.DiagnosticSeverity.Error:return F.DiagnosticSeverity.Error;case V.DiagnosticSeverity.Warning:return F.DiagnosticSeverity.Warning;case V.DiagnosticSeverity.Information:return F.DiagnosticSeverity.Information;case V.DiagnosticSeverity.Hint:return F.DiagnosticSeverity.Hint}return F.DiagnosticSeverity.Error}function k(c){if(Lt.string(c))return j(c);if(Bo.is(c))return j().appendCodeblock(c.value,c.language);if(Array.isArray(c)){let _=[];for(let R of c){let H=j();Bo.is(R)?H.appendCodeblock(R.value,R.language):H.appendMarkdown(R),_.push(H)}return _}else return j(c)}function z(c){if(Lt.string(c))return c;switch(c.kind){case V.MarkupKind.Markdown:return j(c.value);case V.MarkupKind.PlainText:return c.value;default:return`Unsupported Markup content received. Kind is: ${c.kind}`}}function j(c){let _;if(c===void 0||typeof c=="string")_=new F.MarkdownString(c);else switch(c.kind){case V.MarkupKind.Markdown:_=new F.MarkdownString(c.value);break;case V.MarkupKind.PlainText:_=new F.MarkdownString,_.appendText(c.value);break;default:_=new F.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${c.kind}`);break}return _.isTrusted=e,_.supportHtml=t,_}function fe(c){if(c)return new F.Hover(k(c.contents),g(c.range))}async function K(c,_,R){if(!c)return;if(Array.isArray(c))return de.map(c,Vt=>Ue(Vt,_),R);let H=c,{defaultRange:Ve,commitCharacters:tt}=ae(H,_),be=await de.map(H.items,Vt=>Ue(Vt,tt,Ve,H.itemDefaults?.insertTextMode,H.itemDefaults?.insertTextFormat,H.itemDefaults?.data),R);return new F.CompletionList(be,H.isIncomplete)}function ae(c,_){let R=c.itemDefaults?.editRange,H=c.itemDefaults?.commitCharacters??_;return V.Range.is(R)?{defaultRange:g(R),commitCharacters:H}:R!==void 0?{defaultRange:{inserting:g(R.insert),replacing:g(R.replace)},commitCharacters:H}:{defaultRange:void 0,commitCharacters:H}}function W(c){return V.CompletionItemKind.Text<=c&&c<=V.CompletionItemKind.TypeParameter?[c-1,void 0]:[F.CompletionItemKind.Text,c]}function G(c){switch(c){case V.CompletionItemTag.Deprecated:return F.CompletionItemTag.Deprecated}}function ne(c){if(c==null)return[];let _=[];for(let R of c){let H=G(R);H!==void 0&&_.push(H)}return _}function Ue(c,_,R,H,Ve,tt){let be=ne(c.tags),Vt=O(c),Se=new db.default(Vt);c.detail&&(Se.detail=c.detail),c.documentation&&(Se.documentation=z(c.documentation),Se.documentationFormat=Lt.string(c.documentation)?"$string":c.documentation.kind),c.filterText&&(Se.filterText=c.filterText);let Ai=x(c,R,Ve);if(Ai&&(Se.insertText=Ai.text,Se.range=Ai.range,Se.fromEdit=Ai.fromEdit),Lt.number(c.kind)){let[Zy,ef]=W(c.kind);Se.kind=Zy,ef&&(Se.originalItemKind=ef)}c.sortText&&(Se.sortText=c.sortText),c.additionalTextEdits&&(Se.additionalTextEdits=B(c.additionalTextEdits));let Qd=c.commitCharacters!==void 0?Lt.stringArray(c.commitCharacters)?c.commitCharacters:void 0:_;Qd&&(Se.commitCharacters=Qd.slice()),c.command&&(Se.command=Ke(c.command)),(c.deprecated===!0||c.deprecated===!1)&&(Se.deprecated=c.deprecated,c.deprecated===!0&&be.push(F.CompletionItemTag.Deprecated)),(c.preselect===!0||c.preselect===!1)&&(Se.preselect=c.preselect);let Yd=c.data??tt;Yd!==void 0&&(Se.data=Yd),be.length>0&&(Se.tags=be);let Ls=c.insertTextMode??H;return Ls!==void 0&&(Se.insertTextMode=Ls,Ls===V.InsertTextMode.asIs&&(Se.keepWhitespace=!0)),Se}function O(c){return V.CompletionItemLabelDetails.is(c.labelDetails)?{label:c.label,detail:c.labelDetails.detail,description:c.labelDetails.description}:c.label}function x(c,_,R){let H=c.insertTextFormat??R;if(c.textEdit!==void 0||_!==void 0){let[Ve,tt]=c.textEdit!==void 0?L(c.textEdit):[_,c.textEditText??c.label];return H===V.InsertTextFormat.Snippet?{text:new F.SnippetString(tt),range:Ve,fromEdit:!0}:{text:tt,range:Ve,fromEdit:!0}}else return c.insertText?H===V.InsertTextFormat.Snippet?{text:new F.SnippetString(c.insertText),fromEdit:!1}:{text:c.insertText,fromEdit:!1}:void 0}function L(c){return V.InsertReplaceEdit.is(c)?[{inserting:g(c.insert),replacing:g(c.replace)},c.newText]:[g(c.range),c.newText]}function N(c){if(c)return new F.TextEdit(g(c.range),c.newText)}async function ee(c,_){if(c)return de.map(c,N,_)}function B(c){if(!c)return;let _=new Array(c.length);for(let R=0;R<c.length;R++)_[R]=N(c[R]);return _}async function X(c,_){if(!c)return;let R=new F.SignatureHelp;return Lt.number(c.activeSignature)?R.activeSignature=c.activeSignature:R.activeSignature=0,Lt.number(c.activeParameter)?R.activeParameter=c.activeParameter:R.activeParameter=0,c.signatures&&(R.signatures=await ze(c.signatures,_)),R}async function ze(c,_){return de.mapAsync(c,ce,_)}async function ce(c,_){let R=new F.SignatureInformation(c.label);return c.documentation!==void 0&&(R.documentation=z(c.documentation)),c.parameters!==void 0&&(R.parameters=await pe(c.parameters,_)),c.activeParameter!==void 0&&(R.activeParameter=c.activeParameter),R}function pe(c,_){return de.map(c,st,_)}function st(c){let _=new F.ParameterInformation(c.label);return c.documentation&&(_.documentation=z(c.documentation)),_}function Nt(c){return c?new F.Location(i(c.uri),g(c.range)):void 0}async function $r(c,_){if(c)return ir(c,_)}async function Mn(c,_){if(c)return ir(c,_)}function Nn(c){if(!c)return;let _={targetUri:i(c.targetUri),targetRange:g(c.targetRange),originSelectionRange:g(c.originSelectionRange),targetSelectionRange:g(c.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function ir(c,_){if(c)if(Lt.array(c)){if(c.length===0)return[];if(V.LocationLink.is(c[0])){let R=c;return de.map(R,Nn,_)}else{let R=c;return de.map(R,Nt,_)}}else return V.LocationLink.is(c)?[Nn(c)]:Nt(c)}async function Vr(c,_){if(c)return de.map(c,Nt,_)}async function An(c,_){if(c)return de.map(c,gn,_)}function gn(c){let _=new F.DocumentHighlight(g(c.range));return Lt.number(c.kind)&&(_.kind=mn(c.kind)),_}function mn(c){switch(c){case V.DocumentHighlightKind.Text:return F.DocumentHighlightKind.Text;case V.DocumentHighlightKind.Read:return F.DocumentHighlightKind.Read;case V.DocumentHighlightKind.Write:return F.DocumentHighlightKind.Write}return F.DocumentHighlightKind.Text}async function Xr(c,_){if(c)return de.map(c,tn,_)}function et(c){return c<=V.SymbolKind.TypeParameter?c-1:F.SymbolKind.Property}function or(c){switch(c){case V.SymbolTag.Deprecated:return F.SymbolTag.Deprecated;default:return}}function yn(c){if(c==null)return;let _=[];for(let R of c){let H=or(R);H!==void 0&&_.push(H)}return _.length===0?void 0:_}function tn(c){let _=c.data,R=c.location,H=R.range===void 0||_!==void 0?new yb.default(c.name,et(c.kind),c.containerName??"",R.range===void 0?i(R.uri):new F.Location(i(c.location.uri),g(R.range)),_):new F.SymbolInformation(c.name,et(c.kind),c.containerName??"",new F.Location(i(c.location.uri),g(R.range)));return jn(H,c),H}async function Jr(c,_){if(c!=null)return de.map(c,nn,_)}function nn(c){let _=new F.DocumentSymbol(c.name,c.detail||"",et(c.kind),g(c.range),g(c.selectionRange));if(jn(_,c),c.children!==void 0&&c.children.length>0){let R=[];for(let H of c.children)R.push(nn(H));_.children=R}return _}function jn(c,_){c.tags=yn(_.tags),_.deprecated&&(c.tags?c.tags.includes(F.SymbolTag.Deprecated)||(c.tags=c.tags.concat(F.SymbolTag.Deprecated)):c.tags=[F.SymbolTag.Deprecated])}function Ke(c){let _={title:c.title,command:c.command};return c.arguments&&(_.arguments=c.arguments),_}async function wt(c,_){if(c)return de.map(c,Ke,_)}let gt=new Map;gt.set(V.CodeActionKind.Empty,F.CodeActionKind.Empty),gt.set(V.CodeActionKind.QuickFix,F.CodeActionKind.QuickFix),gt.set(V.CodeActionKind.Refactor,F.CodeActionKind.Refactor),gt.set(V.CodeActionKind.RefactorExtract,F.CodeActionKind.RefactorExtract),gt.set(V.CodeActionKind.RefactorInline,F.CodeActionKind.RefactorInline),gt.set(V.CodeActionKind.RefactorRewrite,F.CodeActionKind.RefactorRewrite),gt.set(V.CodeActionKind.Source,F.CodeActionKind.Source),gt.set(V.CodeActionKind.SourceOrganizeImports,F.CodeActionKind.SourceOrganizeImports);function Kt(c){if(c==null)return;let _=gt.get(c);if(_)return _;let R=c.split(".");_=F.CodeActionKind.Empty;for(let H of R)_=_.append(H);return _}function rn(c){if(c!=null)return c.map(_=>Kt(_))}async function Hn(c,_){if(c==null)return;let R=new hb.default(c.title,c.data);return c.kind!==void 0&&(R.kind=Kt(c.kind)),c.diagnostics!==void 0&&(R.diagnostics=u(c.diagnostics)),c.edit!==void 0&&(R.edit=await kt(c.edit,_)),c.command!==void 0&&(R.command=Ke(c.command)),c.isPreferred!==void 0&&(R.isPreferred=c.isPreferred),c.disabled!==void 0&&(R.disabled={reason:c.disabled.reason}),R}function sr(c,_){return de.mapAsync(c,async R=>V.Command.is(R)?Ke(R):Hn(R,_),_)}function vn(c){if(!c)return;let _=new fb.default(g(c.range));return c.command&&(_.command=Ke(c.command)),c.data!==void 0&&c.data!==null&&(_.data=c.data),_}async function ar(c,_){if(c)return de.map(c,vn,_)}async function kt(c,_){if(!c)return;let R=new Map;if(c.changeAnnotations!==void 0){let tt=c.changeAnnotations;await de.forEach(Object.keys(tt),be=>{let Vt=v(tt[be]);R.set(be,Vt)},_)}let H=tt=>{if(tt!==void 0)return R.get(tt)},Ve=new F.WorkspaceEdit;if(c.documentChanges){let tt=c.documentChanges;await de.forEach(tt,be=>{if(V.CreateFile.is(be))Ve.createFile(i(be.uri),be.options,H(be.annotationId));else if(V.RenameFile.is(be))Ve.renameFile(i(be.oldUri),i(be.newUri),be.options,H(be.annotationId));else if(V.DeleteFile.is(be))Ve.deleteFile(i(be.uri),be.options,H(be.annotationId));else if(V.TextDocumentEdit.is(be)){let Vt=i(be.textDocument.uri);for(let Se of be.edits)V.AnnotatedTextEdit.is(Se)?Ve.replace(Vt,g(Se.range),Se.newText,H(Se.annotationId)):Ve.replace(Vt,g(Se.range),Se.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(be,void 0,4)}`)},_)}else if(c.changes){let tt=c.changes;await de.forEach(Object.keys(tt),be=>{Ve.set(i(be),B(tt[be]))},_)}return Ve}function v(c){if(c!==void 0)return{label:c.label,needsConfirmation:!!c.needsConfirmation,description:c.description}}function T(c){let _=g(c.range),R=c.target?o(c.target):void 0,H=new pb.default(_,R);return c.tooltip!==void 0&&(H.tooltip=c.tooltip),c.data!==void 0&&c.data!==null&&(H.data=c.data),H}async function E(c,_){if(c)return de.map(c,T,_)}function M(c){return new F.Color(c.red,c.green,c.blue,c.alpha)}function ye(c){return new F.ColorInformation(g(c.range),M(c.color))}async function he(c,_){if(c)return de.map(c,ye,_)}function De(c){let _=new F.ColorPresentation(c.label);return _.additionalTextEdits=B(c.additionalTextEdits),c.textEdit&&(_.textEdit=N(c.textEdit)),_}async function xe(c,_){if(c)return de.map(c,De,_)}function re(c){if(c)switch(c){case V.FoldingRangeKind.Comment:return F.FoldingRangeKind.Comment;case V.FoldingRangeKind.Imports:return F.FoldingRangeKind.Imports;case V.FoldingRangeKind.Region:return F.FoldingRangeKind.Region}}function we(c){return new F.FoldingRange(c.startLine,c.endLine,re(c.kind))}async function le(c,_){if(c)return de.map(c,we,_)}function Pe(c){return new F.SelectionRange(g(c.range),c.parent?Pe(c.parent):void 0)}async function We(c,_){return Array.isArray(c)?de.map(c,Pe,_):[]}function pt(c){return V.InlineValueText.is(c)?new F.InlineValueText(g(c.range),c.text):V.InlineValueVariableLookup.is(c)?new F.InlineValueVariableLookup(g(c.range),c.variableName,c.caseSensitiveLookup):new F.InlineValueEvaluatableExpression(g(c.range),c.expression)}async function Gr(c,_){return Array.isArray(c)?de.map(c,pt,_):[]}async function Zr(c,_){let R=typeof c.label=="string"?c.label:await de.map(c.label,d,_),H=new vb.default(m(c.position),R);return c.kind!==void 0&&(H.kind=c.kind),c.textEdits!==void 0&&(H.textEdits=await ee(c.textEdits,_)),c.tooltip!==void 0&&(H.tooltip=C(c.tooltip)),c.paddingLeft!==void 0&&(H.paddingLeft=c.paddingLeft),c.paddingRight!==void 0&&(H.paddingRight=c.paddingRight),c.data!==void 0&&(H.data=c.data),H}function d(c){let _=new F.InlayHintLabelPart(c.value);return c.location!==void 0&&(_.location=Nt(c.location)),c.tooltip!==void 0&&(_.tooltip=C(c.tooltip)),c.command!==void 0&&(_.command=Ke(c.command)),_}function C(c){return typeof c=="string"?c:j(c)}async function A(c,_){if(Array.isArray(c))return de.mapAsync(c,Zr,_)}function ve(c){if(c===null)return;let _=new gb.default(et(c.kind),c.name,c.detail||"",o(c.uri),g(c.range),g(c.selectionRange),c.data);return c.tags!==void 0&&(_.tags=yn(c.tags)),_}async function Ce(c,_){if(c!==null)return de.map(c,ve,_)}async function $e(c,_){return new F.CallHierarchyIncomingCall(ve(c.from),await b(c.fromRanges,_))}async function Ct(c,_){if(c!==null)return de.mapAsync(c,$e,_)}async function $t(c,_){return new F.CallHierarchyOutgoingCall(ve(c.to),await b(c.fromRanges,_))}async function Wy(c,_){if(c!==null)return de.mapAsync(c,$t,_)}async function By(c,_){if(c!=null)return new F.SemanticTokens(new Uint32Array(c.data),c.resultId)}function Gd(c){return new F.SemanticTokensEdit(c.start,c.deleteCount,c.data!==void 0?new Uint32Array(c.data):void 0)}async function zy(c,_){if(c!=null)return new F.SemanticTokensEdits(c.edits.map(Gd),c.resultId)}function Ky(c){return c}async function $y(c,_){if(c!=null)return new F.LinkedEditingRanges(await b(c.ranges,_),Vy(c.wordPattern))}function Vy(c){if(c!=null)return new RegExp(c)}function Zd(c){if(c===null)return;let _=new mb.default(et(c.kind),c.name,c.detail||"",o(c.uri),g(c.range),g(c.selectionRange),c.data);return c.tags!==void 0&&(_.tags=yn(c.tags)),_}async function Xy(c,_){if(c!==null)return de.map(c,Zd,_)}function Jy(c){if(Lt.string(c))return c;if(V.RelativePattern.is(c)){if(V.URI.is(c.baseUri))return new F.RelativePattern(o(c.baseUri),c.pattern);if(V.WorkspaceFolder.is(c.baseUri)){let _=F.workspace.getWorkspaceFolder(o(c.baseUri.uri));return _!==void 0?new F.RelativePattern(_,c.pattern):void 0}}}async function Gy(c,_){if(!c)return;if(Array.isArray(c))return de.map(c,Ve=>Fs(Ve),_);let R=c,H=await de.map(R.items,Ve=>Fs(Ve),_);return new F.InlineCompletionList(H)}function Fs(c){let _;typeof c.insertText=="string"?_=c.insertText:_=new F.SnippetString(c.insertText.value);let R;c.command&&(R=Ke(c.command));let H=new F.InlineCompletionItem(_,g(c.range),R);return c.filterText&&(H.filterText=c.filterText),H}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:g,asRanges:b,asPosition:m,asDiagnosticSeverity:D,asDiagnosticTag:p,asHover:fe,asCompletionResult:K,asCompletionItem:Ue,asTextEdit:N,asTextEdits:ee,asSignatureHelp:X,asSignatureInformations:ze,asSignatureInformation:ce,asParameterInformations:pe,asParameterInformation:st,asDeclarationResult:$r,asDefinitionResult:Mn,asLocation:Nt,asReferences:Vr,asDocumentHighlights:An,asDocumentHighlight:gn,asDocumentHighlightKind:mn,asSymbolKind:et,asSymbolTag:or,asSymbolTags:yn,asSymbolInformations:Xr,asSymbolInformation:tn,asDocumentSymbols:Jr,asDocumentSymbol:nn,asCommand:Ke,asCommands:wt,asCodeAction:Hn,asCodeActionKind:Kt,asCodeActionKinds:rn,asCodeActionResult:sr,asCodeLens:vn,asCodeLenses:ar,asWorkspaceEdit:kt,asDocumentLink:T,asDocumentLinks:E,asFoldingRangeKind:re,asFoldingRange:we,asFoldingRanges:le,asColor:M,asColorInformation:ye,asColorInformations:he,asColorPresentation:De,asColorPresentations:xe,asSelectionRange:Pe,asSelectionRanges:We,asInlineValue:pt,asInlineValues:Gr,asInlayHint:Zr,asInlayHints:A,asSemanticTokensLegend:Ky,asSemanticTokens:By,asSemanticTokensEdit:Gd,asSemanticTokensEdits:zy,asCallHierarchyItem:ve,asCallHierarchyItems:Ce,asCallHierarchyIncomingCall:$e,asCallHierarchyIncomingCalls:Ct,asCallHierarchyOutgoingCall:$t,asCallHierarchyOutgoingCalls:Wy,asLinkedEditingRanges:$y,asTypeHierarchyItem:Zd,asTypeHierarchyItems:Xy,asGlobPattern:Jy,asInlineCompletionResult:Gy,asInlineCompletionItem:Fs}}zo.createConverter=_b});var al=P(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.ProgressPart=void 0;var bm=require("vscode"),wm=J(),Cm=Ht(),sl=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(wm.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&bm.window.withProgress({location:bm.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(wm.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&Cm.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Cm.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Ko.ProgressPart=sl});var Tm=P(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.NotebookDocumentSyncFeature=void 0;var ft=require("vscode"),bb=No(),cn=J(),wb=Ie(),Dm=Ht();function Sm(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Mr;(function(n){let e;(function(t){function r(p,m){return{version:p.version,uri:m.asUri(p.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(p,m,g){let b=cn.NotebookDocument.create(g.asUri(p.uri),p.notebookType,p.version,o(m,g));return Object.keys(p.metadata).length>0&&(b.metadata=s(p.metadata)),b}t.asNotebookDocument=i;function o(p,m){return p.map(g=>a(g,m))}t.asNotebookCells=o;function s(p){return l(new Set,p)}t.asMetadata=s;function a(p,m){let g=cn.NotebookCell.create(u(p.kind),m.asUri(p.document.uri));return Object.keys(p.metadata).length>0&&(g.metadata=s(p.metadata)),p.executionSummary!==void 0&&Dm.number(p.executionSummary.executionOrder)&&Dm.boolean(p.executionSummary.success)&&(g.executionSummary={executionOrder:p.executionSummary.executionOrder,success:p.executionSummary.success}),g}t.asNotebookCell=a;function u(p){switch(p){case ft.NotebookCellKind.Markup:return cn.NotebookCellKind.Markup;case ft.NotebookCellKind.Code:return cn.NotebookCellKind.Code}}function l(p,m){if(p.has(m))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(m)){let g=[];for(let b of m)if(b!==null&&typeof b=="object"||Array.isArray(b))g.push(l(p,b));else{if(b instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");g.push(b)}return g}else{let g=Object.keys(m),b=Object.create(null);for(let D of g){let k=m[D];if(k!==null&&typeof k=="object"||Array.isArray(k))b[D]=l(p,k);else{if(k instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b[D]=k}}return b}}function f(p,m){let g=m.asChangeTextDocumentParams(p,p.document.uri,p.document.version);return{document:g.textDocument,changes:g.contentChanges}}t.asTextContentChange=f;function h(p,m){let g=Object.create(null);if(p.metadata&&(g.metadata=n.c2p.asMetadata(p.metadata)),p.cells!==void 0){let b=Object.create(null),D=p.cells;D.structure&&(b.structure={array:{start:D.structure.array.start,deleteCount:D.structure.array.deleteCount,cells:D.structure.array.cells!==void 0?D.structure.array.cells.map(k=>n.c2p.asNotebookCell(k,m)):void 0},didOpen:D.structure.didOpen!==void 0?D.structure.didOpen.map(k=>m.asOpenTextDocumentParams(k.document).textDocument):void 0,didClose:D.structure.didClose!==void 0?D.structure.didClose.map(k=>m.asCloseTextDocumentParams(k.document).textDocument):void 0}),D.data!==void 0&&(b.data=D.data.map(k=>n.c2p.asNotebookCell(k,m))),D.textContent!==void 0&&(b.textContent=D.textContent.map(k=>n.c2p.asTextContentChange(k,m))),Object.keys(b).length>0&&(g.cells=b)}return g}t.asNotebookDocumentChangeEvent=h})(e=n.c2p||(n.c2p={}))})(Mr||(Mr={}));var cl;(function(n){function e(a,u,l){let f=a.length,h=u.length,p=0;for(;p<h&&p<f&&t(a[p],u[p],l);)p++;if(p<h&&p<f){let m=f-1,g=h-1;for(;m>=0&&g>=0&&t(a[m],u[g],l);)m--,g--;let b=m+1-p,D=p===g+1?void 0:u.slice(p,g+1);return D!==void 0?{start:p,deleteCount:b,cells:D}:{start:p,deleteCount:b}}else return p<h?{start:p,deleteCount:0,cells:u.slice(p)}:p<f?{start:p,deleteCount:f-p}:void 0}n.computeDiff=e;function t(a,u,l=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!r(a.executionSummary,u.executionSummary)?!1:!l||l&&o(a.metadata,u.metadata)}function r(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&i(a.timing,u.timing)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function o(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;let l=Array.isArray(a),f=Array.isArray(u);if(l!==f)return!1;if(l&&f){if(a.length!==u.length)return!1;for(let h=0;h<a.length;h++)if(!o(a[h],u[h]))return!1}if(s(a)&&s(u)){let h=Object.keys(a),p=Object.keys(u);if(h.length!==p.length||(h.sort(),p.sort(),!o(h,p)))return!1;for(let m=0;m<h.length;m++){let g=h[m];if(!o(a[g],u[g]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(cl||(cl={}));var ul;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let o=new bb.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(ul||(ul={}));var $o;(function(n){function e(r){let i=r.notebookSelector,o=[];for(let s of i){let a=(typeof s.notebook=="string"?s.notebook:s.notebook?.notebookType)??"*",u=typeof s.notebook=="string"?void 0:s.notebook?.scheme,l=typeof s.notebook=="string"?void 0:s.notebook?.pattern;if(s.cells!==void 0)for(let f of s.cells)o.push(t(a,u,l,f.language));else o.push(t(a,u,l,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})($o||($o={}));var Vo;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(Vo||(Vo={}));var Nr=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector($o.asDocumentSelector(t)),ft.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of ft.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);ft.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&ft.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),ft.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of ft.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return ft.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(ft.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){let s=this.getMatchingCells(e);if(s!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){ft.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let r=async(o,s)=>{let a=Mr.c2p.asNotebookDocument(o,s,this.client.code2ProtocolConverter),u=s.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(cn.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Vo.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let r=async o=>{try{await this.client.sendNotification(cn.DidChangeNotebookDocumentNotification.type,{notebookDocument:Mr.c2p.asVersionedNotebookDocumentIdentifier(o.notebook,this.client.code2ProtocolConverter),change:Mr.c2p.asNotebookDocumentChangeEvent(o,this.client.code2ProtocolConverter)})}catch(s){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",s),s}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Vo.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(cn.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let r=async(o,s)=>{try{await this.client.sendNotification(cn.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:s.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let o={notebook:e};t?.metadata!==void 0&&(o.metadata=Mr.c2p.asMetadata(t.metadata));let s;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];s=new Set(i.map(u=>u.document.uri.toString()));for(let u of t.cellChanges)s.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,u=i,l=cl.computeDiff(a,u,!1),f,h;if(l!==void 0){f=l.cells===void 0?new Map:new Map(l.cells.map(g=>[g.document.uri.toString(),g])),h=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(g=>[g.document.uri.toString(),g]));for(let g of Array.from(h.keys()))f.has(g)&&(h.delete(g),f.delete(g));o.cells=o.cells??{};let p=[],m=[];if(f.size>0||h.size>0){for(let g of f.values())p.push(g);for(let g of h.values())m.push(g)}o.cells.structure={array:l,didOpen:p,didClose:m}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||ul.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){let i=r!==void 0?t.filter(o=>{let s=o.document.languageId;return r.some(a=>a.language==="*"||s===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},un=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=cn.NotebookDocumentSyncRegistrationType.type,ft.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==un.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Nr&&o.didOpenNotebookCellTextDocument(r,i)}),ft.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==un.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let o of this.registrations.values())o instanceof Nr&&o.didChangeNotebookCellTextDocument(i,t)}),ft.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==un.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Nr&&o.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Sm(Sm(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector($o.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??wb.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new Nr(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==un.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&ft.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of ft.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};Xo.NotebookDocumentSyncFeature=un;un.CellScheme="vscode-notebook-cell"});var xm=P(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.SyncConfigurationFeature=In.toJSONObject=In.ConfigurationFeature=void 0;var Ar=require("vscode"),wi=J(),Cb=Ht(),Db=Ie(),Rm=ue(),ll=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(wi.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let u of s.items){let l=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(l,u.section!==null?u.section:void 0))}return a},o=e.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Zn(Ar.workspace.getConfiguration(void 0,e).get(t));else{let o=Ar.workspace.getConfiguration(t.substr(0,i),e);o&&(r=Zn(o.get(t.substr(i+1))))}}else{let i=Ar.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=Zn(i.get(o)))}return r===void 0&&(r=null),r}clear(){}};In.ConfigurationFeature=ll;function Zn(n){if(n){if(Array.isArray(n))return n.map(Zn);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Zn(n[t]));return e}}return n}In.toJSONObject=Zn;var dl=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return wi.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,Rm.ensure)((0,Rm.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:Db.generateUuid(),registerOptions:{section:e}})}register(e){let t=Ar.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if(Cb.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async s=>s===void 0?this._client.sendNotification(wi.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(wi.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)}),o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${wi.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let u=0;u<s.length-1;u++){let l=a[s[u]];l||(l=Object.create(null),a[s[u]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),u=null;if(a>=0?u=Ar.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):u=Ar.workspace.getConfiguration(void 0,r).get(s),u){let l=e[o].split(".");t(i,l)[l[l.length-1]]=Zn(u)}}return i}};In.SyncConfigurationFeature=dl});var Pm=P(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.DidSaveTextDocumentFeature=_t.WillSaveWaitUntilFeature=_t.WillSaveFeature=_t.DidChangeTextDocumentFeature=_t.DidCloseTextDocumentFeature=_t.DidOpenTextDocumentFeature=void 0;var Rt=require("vscode"),Te=J(),Oe=ue(),jr=Ie(),fl=class extends Oe.TextDocumentEventFeature{constructor(e,t){super(e,Rt.workspace.onDidOpenTextDocument,Te.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Oe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:jr.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Te.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);Rt.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&Rt.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};_t.DidOpenTextDocumentFeature=fl;var pl=class extends Oe.TextDocumentEventFeature{constructor(e,t,r){super(e,Rt.workspace.onDidCloseTextDocument,Te.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Oe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Te.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:jr.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(Rt.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};_t.DidCloseTextDocumentFeature=pl;var hl=class extends Oe.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new Rt.EventEmitter,this._onPendingChangeAdded=new Rt.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Te.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Te.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Te.TextDocumentSyncKind.None&&this.register({id:jr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Rt.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let o of this._changeData.values())if(Rt.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let s=this._client.middleware;if(o.syncKind===Te.TextDocumentSyncKind.Incremental){let a=async u=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,r);await this._client.sendNotification(Te.DidChangeTextDocumentNotification.type,l),this.notificationSent(u.document,Te.DidChangeTextDocumentNotification.type,l)};i.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}else if(o.syncKind===Te.TextDocumentSyncKind.Full){let a=async u=>{let l=u.document.uri.toString();this._pendingTextDocumentChanges.set(l,u.document),this._onPendingChangeAdded.fire()};i.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}}return Promise.all(i).then(void 0,o=>{throw this._client.error(`Sending document notification ${Te.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Te.TextDocumentSyncKind.None;else{this._syncKind=Te.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Te.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Te.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(Rt.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Te.TextDocumentSyncKind.Full)switch(e){case Te.TextDocumentSyncKind.Full:this._syncKind=e;break;case Te.TextDocumentSyncKind.Incremental:this._syncKind===Te.TextDocumentSyncKind.None&&(this._syncKind=Te.TextDocumentSyncKind.Incremental);break}}};_t.DidChangeTextDocumentFeature=hl;var gl=class extends Oe.TextDocumentEventFeature{constructor(e){super(e,Rt.workspace.onWillSaveTextDocument,Te.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>Oe.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Te.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:jr.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};_t.WillSaveFeature=gl;var ml=class extends Oe.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Te.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:jr.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=Rt.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Oe.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Te.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};_t.WillSaveWaitUntilFeature=ml;var yl=class extends Oe.TextDocumentEventFeature{constructor(e){super(e,Rt.workspace.onDidSaveTextDocument,Te.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Oe.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Te.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Oe.ensure)((0,Oe.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:jr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};_t.DidSaveTextDocumentFeature=yl});var km=P(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.CompletionItemFeature=void 0;var Sb=require("vscode"),se=J(),vl=ue(),Tb=Ie(),Rb=[se.CompletionItemKind.Text,se.CompletionItemKind.Method,se.CompletionItemKind.Function,se.CompletionItemKind.Constructor,se.CompletionItemKind.Field,se.CompletionItemKind.Variable,se.CompletionItemKind.Class,se.CompletionItemKind.Interface,se.CompletionItemKind.Module,se.CompletionItemKind.Property,se.CompletionItemKind.Unit,se.CompletionItemKind.Value,se.CompletionItemKind.Enum,se.CompletionItemKind.Keyword,se.CompletionItemKind.Snippet,se.CompletionItemKind.Color,se.CompletionItemKind.File,se.CompletionItemKind.Reference,se.CompletionItemKind.Folder,se.CompletionItemKind.EnumMember,se.CompletionItemKind.Constant,se.CompletionItemKind.Struct,se.CompletionItemKind.Event,se.CompletionItemKind.Operator,se.CompletionItemKind.TypeParameter],_l=class extends vl.TextDocumentLanguageFeature{constructor(e){super(e,se.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,vl.ensure)((0,vl.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[se.MarkupKind.Markdown,se.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[se.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[se.InsertTextMode.asIs,se.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=se.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:Rb},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:Tb.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(a,u,l,f)=>{let h=this._client,p=this._client.middleware,m=(g,b,D,k)=>h.sendRequest(se.CompletionRequest.type,h.code2ProtocolConverter.asCompletionParams(g,b,D),k).then(z=>k.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionResult(z,i,k),z=>h.handleFailedRequest(se.CompletionRequest.type,k,z,null));return p.provideCompletionItem?p.provideCompletionItem(a,u,f,l,m):m(a,u,f,l)},resolveCompletionItem:e.resolveProvider?(a,u)=>{let l=this._client,f=this._client.middleware,h=(p,m)=>l.sendRequest(se.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(p,!!this.labelDetailsSupport.get(t)),m).then(g=>m.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(g),g=>l.handleFailedRequest(se.CompletionResolveRequest.type,m,g,p));return f.resolveCompletionItem?f.resolveCompletionItem(a,u,h):h(a,u)}:void 0};return[Sb.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}};Jo.CompletionItemFeature=_l});var qm=P(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.HoverFeature=void 0;var xb=require("vscode"),Ci=J(),bl=ue(),Pb=Ie(),wl=class extends bl.TextDocumentLanguageFeature{constructor(e){super(e,Ci.HoverRequest.type)}fillClientCapabilities(e){let t=(0,bl.ensure)((0,bl.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Ci.MarkupKind.Markdown,Ci.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:Pb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(Ci.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asHover(m),m=>a.handleFailedRequest(Ci.HoverRequest.type,p,m,null)),l=a.middleware;return l.provideHover?l.provideHover(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return xb.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Go.HoverFeature=wl});var Im=P(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.DefinitionFeature=void 0;var kb=require("vscode"),Cl=J(),Dl=ue(),qb=Ie(),Sl=class extends Dl.TextDocumentLanguageFeature{constructor(e){super(e,Cl.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Dl.ensure)((0,Dl.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:qb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(Cl.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(m,p),m=>a.handleFailedRequest(Cl.DefinitionRequest.type,p,m,null)),l=a.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return kb.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Zo.DefinitionFeature=Sl});var Om=P(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.SignatureHelpFeature=void 0;var Em=require("vscode"),Di=J(),Tl=ue(),Ib=Ie(),Rl=class extends Tl.TextDocumentLanguageFeature{constructor(e){super(e,Di.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Tl.ensure)((0,Tl.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Di.MarkupKind.Markdown,Di.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:Ib.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,o,s)=>{let a=this._client,u=(f,h,p,m)=>a.sendRequest(Di.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(f,h,p),m).then(g=>m.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(g,m),g=>a.handleFailedRequest(Di.SignatureHelpRequest.type,m,g,null)),l=a.middleware;return l.provideSignatureHelp?l.provideSignatureHelp(r,i,s,o,u):u(r,i,s,o)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return Em.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return Em.languages.registerSignatureHelpProvider(r,t,i)}}};Qo.SignatureHelpFeature=Rl});var Fm=P(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.DocumentHighlightFeature=void 0;var Eb=require("vscode"),xl=J(),Pl=ue(),Ob=Ie(),kl=class extends Pl.TextDocumentLanguageFeature{constructor(e){super(e,xl.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Pl.ensure)((0,Pl.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:Ob.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(xl.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(m,p),m=>a.handleFailedRequest(xl.DocumentHighlightRequest.type,p,m,null)),l=a.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,u):u(i,o,s)}};return[Eb.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Yo.DocumentHighlightFeature=kl});var El=P(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.DocumentSymbolFeature=Yt.SupportedSymbolTags=Yt.SupportedSymbolKinds=void 0;var Fb=require("vscode"),me=J(),ql=ue(),Lb=Ie();Yt.SupportedSymbolKinds=[me.SymbolKind.File,me.SymbolKind.Module,me.SymbolKind.Namespace,me.SymbolKind.Package,me.SymbolKind.Class,me.SymbolKind.Method,me.SymbolKind.Property,me.SymbolKind.Field,me.SymbolKind.Constructor,me.SymbolKind.Enum,me.SymbolKind.Interface,me.SymbolKind.Function,me.SymbolKind.Variable,me.SymbolKind.Constant,me.SymbolKind.String,me.SymbolKind.Number,me.SymbolKind.Boolean,me.SymbolKind.Array,me.SymbolKind.Object,me.SymbolKind.Key,me.SymbolKind.Null,me.SymbolKind.EnumMember,me.SymbolKind.Struct,me.SymbolKind.Event,me.SymbolKind.Operator,me.SymbolKind.TypeParameter];Yt.SupportedSymbolTags=[me.SymbolTag.Deprecated];var Il=class extends ql.TextDocumentLanguageFeature{constructor(e){super(e,me.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,ql.ensure)((0,ql.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Yt.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Yt.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);r&&this.register({id:Lb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(o,s)=>{let a=this._client,u=async(f,h)=>{try{let p=await a.sendRequest(me.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(f),h);if(h.isCancellationRequested||p===void 0||p===null)return null;if(p.length===0)return[];{let m=p[0];return me.DocumentSymbol.is(m)?await a.protocol2CodeConverter.asDocumentSymbols(p,h):await a.protocol2CodeConverter.asSymbolInformations(p,h)}}catch(p){return a.handleFailedRequest(me.DocumentSymbolRequest.type,h,p,null)}},l=a.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(o,s,u):u(o,s)}},i=e.label!==void 0?{label:e.label}:void 0;return[Fb.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};Yt.DocumentSymbolFeature=Il});var Mm=P(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.WorkspaceSymbolFeature=void 0;var Mb=require("vscode"),Si=J(),Ol=ue(),Lm=El(),Nb=Ie(),Fl=class extends Ol.WorkspaceFeature{constructor(e){super(e,Si.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Ol.ensure)((0,Ol.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Lm.SupportedSymbolKinds},t.tagSupport={valueSet:Lm.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:Nb.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let o=this._client,s=(u,l)=>o.sendRequest(Si.WorkspaceSymbolRequest.type,{query:u},l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(f,l),f=>o.handleFailedRequest(Si.WorkspaceSymbolRequest.type,l,f,null)),a=o.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let o=this._client,s=(u,l)=>o.sendRequest(Si.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(u),l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(f),f=>o.handleFailedRequest(Si.WorkspaceSymbolResolveRequest.type,l,f,null)),a=o.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[Mb.languages.registerWorkspaceSymbolProvider(t),t]}};es.WorkspaceSymbolFeature=Fl});var Nm=P(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.ReferencesFeature=void 0;var Ab=require("vscode"),Ll=J(),Ml=ue(),jb=Ie(),Nl=class extends Ml.TextDocumentLanguageFeature{constructor(e){super(e,Ll.ReferencesRequest.type)}fillClientCapabilities(e){(0,Ml.ensure)((0,Ml.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:jb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{let u=this._client,l=(h,p,m,g)=>u.sendRequest(Ll.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(h,p,m),g).then(b=>g.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(b,g),b=>u.handleFailedRequest(Ll.ReferencesRequest.type,g,b,null)),f=u.middleware;return f.provideReferences?f.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Ab.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ts.ReferencesFeature=Nl});var Am=P(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.CodeActionFeature=void 0;var Hb=require("vscode"),xt=J(),Ub=Ie(),Al=ue(),jl=class extends Al.TextDocumentLanguageFeature{constructor(e){super(e,xt.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Al.ensure)((0,Al.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[xt.CodeActionKind.Empty,xt.CodeActionKind.QuickFix,xt.CodeActionKind.Refactor,xt.CodeActionKind.RefactorExtract,xt.CodeActionKind.RefactorInline,xt.CodeActionKind.RefactorRewrite,xt.CodeActionKind.Source,xt.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:Ub.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{let u=this._client,l=async(h,p,m,g)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h),range:u.code2ProtocolConverter.asRange(p),context:u.code2ProtocolConverter.asCodeActionContextSync(m)};return u.sendRequest(xt.CodeActionRequest.type,b,g).then(D=>g.isCancellationRequested||D===null||D===void 0?null:u.protocol2CodeConverter.asCodeActionResult(D,g),D=>u.handleFailedRequest(xt.CodeActionRequest.type,g,D,null))},f=u.middleware;return f.provideCodeActions?f.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{let s=this._client,a=this._client.middleware,u=async(l,f)=>s.sendRequest(xt.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeActionSync(l),f).then(h=>f.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(h,f),h=>s.handleFailedRequest(xt.CodeActionResolveRequest.type,f,h,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,u):u(i,o)}:void 0};return[Hb.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};ns.CodeActionFeature=jl});var Hm=P(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.CodeLensFeature=void 0;var jm=require("vscode"),Hr=J(),Wb=Ie(),Ti=ue(),Hl=class extends Ti.TextDocumentLanguageFeature{constructor(e){super(e,Hr.CodeLensRequest.type)}fillClientCapabilities(e){(0,Ti.ensure)((0,Ti.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Ti.ensure)((0,Ti.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Hr.CodeLensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:Wb.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new jm.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{let a=this._client,u=(f,h)=>a.sendRequest(Hr.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(f),h).then(p=>h.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(p,h),p=>a.handleFailedRequest(Hr.CodeLensRequest.type,h,p,null)),l=a.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,u):u(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{let a=this._client,u=(f,h)=>a.sendRequest(Hr.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(f),h).then(p=>h.isCancellationRequested?f:a.protocol2CodeConverter.asCodeLens(p),p=>a.handleFailedRequest(Hr.CodeLensResolveRequest.type,h,p,f)),l=a.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,u):u(o,s)}:void 0};return[jm.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};rs.CodeLensFeature=Hl});var Um=P(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.DocumentOnTypeFormattingFeature=En.DocumentRangeFormattingFeature=En.DocumentFormattingFeature=void 0;var is=require("vscode"),Wt=J(),zl=Ie(),ln=ue(),Ur;(function(n){function e(t){let r=is.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Ur||(Ur={}));var Ul=class extends ln.TextDocumentLanguageFeature{constructor(e){super(e,Wt.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:zl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{let a=this._client,u=(f,h,p)=>{let m={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),options:a.code2ProtocolConverter.asFormattingOptions(h,Ur.fromConfiguration(f))};return a.sendRequest(Wt.DocumentFormattingRequest.type,m,p).then(g=>p.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(g,p),g=>a.handleFailedRequest(Wt.DocumentFormattingRequest.type,p,g,null))},l=a.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,u):u(i,o,s)}};return[is.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};En.DocumentFormattingFeature=Ul;var Wl=class extends ln.TextDocumentLanguageFeature{constructor(e){super(e,Wt.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:zl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{let u=this._client,l=(h,p,m,g)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h),range:u.code2ProtocolConverter.asRange(p),options:u.code2ProtocolConverter.asFormattingOptions(m,Ur.fromConfiguration(h))};return u.sendRequest(Wt.DocumentRangeFormattingRequest.type,b,g).then(D=>g.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(D,g),D=>u.handleFailedRequest(Wt.DocumentRangeFormattingRequest.type,g,D,null))},f=u.middleware;return f.provideDocumentRangeFormattingEdits?f.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,o,s,a)=>{let u=this._client,l=(h,p,m,g)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h),ranges:u.code2ProtocolConverter.asRanges(p),options:u.code2ProtocolConverter.asFormattingOptions(m,Ur.fromConfiguration(h))};return u.sendRequest(Wt.DocumentRangesFormattingRequest.type,b,g).then(D=>g.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(D,g),D=>u.handleFailedRequest(Wt.DocumentRangesFormattingRequest.type,g,D,null))},f=u.middleware;return f.provideDocumentRangesFormattingEdits?f.provideDocumentRangesFormattingEdits(i,o,s,a,l):l(i,o,s,a)}),[is.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};En.DocumentRangeFormattingFeature=Wl;var Bl=class extends ln.TextDocumentLanguageFeature{constructor(e){super(e,Wt.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,ln.ensure)((0,ln.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:zl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,u,l)=>{let f=this._client,h=(m,g,b,D,k)=>{let z={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(m),position:f.code2ProtocolConverter.asPosition(g),ch:b,options:f.code2ProtocolConverter.asFormattingOptions(D,Ur.fromConfiguration(m))};return f.sendRequest(Wt.DocumentOnTypeFormattingRequest.type,z,k).then(j=>k.isCancellationRequested?null:f.protocol2CodeConverter.asTextEdits(j,k),j=>f.handleFailedRequest(Wt.DocumentOnTypeFormattingRequest.type,k,j,null))},p=f.middleware;return p.provideOnTypeFormattingEdits?p.provideOnTypeFormattingEdits(o,s,a,u,l,h):h(o,s,a,u,l)}},i=e.moreTriggerCharacter||[];return[is.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};En.DocumentOnTypeFormattingFeature=Bl});var Bm=P(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.RenameFeature=void 0;var Bb=require("vscode"),Qn=J(),zb=Ie(),Wm=Ht(),Kl=ue(),$l=class extends Kl.TextDocumentLanguageFeature{constructor(e){super(e,Qn.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Kl.ensure)((0,Kl.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Qn.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);r&&(Wm.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:zb.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{let u=this._client,l=(h,p,m,g)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h),position:u.code2ProtocolConverter.asPosition(p),newName:m};return u.sendRequest(Qn.RenameRequest.type,b,g).then(D=>g.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(D,g),D=>u.handleFailedRequest(Qn.RenameRequest.type,g,D,null,!1))},f=u.middleware;return f.provideRenameEdits?f.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{let a=this._client,u=(f,h,p)=>{let m={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),position:a.code2ProtocolConverter.asPosition(h)};return a.sendRequest(Qn.PrepareRenameRequest.type,m,p).then(g=>p.isCancellationRequested?null:Qn.Range.is(g)?a.protocol2CodeConverter.asRange(g):this.isDefaultBehavior(g)?g.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):g&&Qn.Range.is(g.range)?{range:a.protocol2CodeConverter.asRange(g.range),placeholder:g.placeholder}:Promise.reject(new Error("The element can't be renamed.")),g=>{throw typeof g.message=="string"?new Error(g.message):new Error("The element can't be renamed.")})},l=a.middleware;return l.prepareRename?l.prepareRename(i,o,s,u):u(i,o,s)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Bb.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&Wm.boolean(t.defaultBehavior)}};os.RenameFeature=$l});var zm=P(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.DocumentLinkFeature=void 0;var Kb=require("vscode"),Ri=J(),Vl=ue(),$b=Ie(),Xl=class extends Vl.TextDocumentLanguageFeature{constructor(e){super(e,Ri.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Vl.ensure)((0,Vl.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:$b.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{let s=this._client,a=(l,f)=>s.sendRequest(Ri.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),f).then(h=>f.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(h,f),h=>s.handleFailedRequest(Ri.DocumentLinkRequest.type,f,h,null)),u=s.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{let s=this._client,a=(l,f)=>s.sendRequest(Ri.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),f).then(h=>f.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(h),h=>s.handleFailedRequest(Ri.DocumentLinkResolveRequest.type,f,h,l)),u=s.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[Kb.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ss.DocumentLinkFeature=Xl});var $m=P(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.ExecuteCommandFeature=void 0;var Vb=require("vscode"),Jl=J(),Xb=Ie(),Km=ue(),Gl=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Jl.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,Km.ensure)((0,Km.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:Xb.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(Jl.ExecuteCommandRequest.type,a).then(void 0,u=>t.handleFailedRequest(Jl.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){let o=[];for(let s of e.registerOptions.commands)o.push(Vb.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};as.ExecuteCommandFeature=Gl});var Vm=P(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.FileSystemWatcherFeature=void 0;var Jb=require("vscode"),Yn=J(),cs=ue(),Zl=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Yn.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,cs.ensure)((0,cs.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,cs.ensure)((0,cs.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let o=!0,s=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(o=(r.kind&Yn.WatchKind.Create)!==0,s=(r.kind&Yn.WatchKind.Change)!==0,a=(r.kind&Yn.WatchKind.Delete)!==0);let u=Jb.workspace.createFileSystemWatcher(i,!o,!s,!a);this.hookListeners(u,o,s,a,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Yn.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Yn.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Yn.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};us.FileSystemWatcherFeature=Zl});var Xm=P(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.ColorProviderFeature=void 0;var Gb=require("vscode"),xi=J(),Ql=ue(),Yl=class extends Ql.TextDocumentLanguageFeature{constructor(e){super(e,xi.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Ql.ensure)((0,Ql.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{let a=this._client,u=(f,h,p)=>{let m={color:f,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h.document),range:a.code2ProtocolConverter.asRange(h.range)};return a.sendRequest(xi.ColorPresentationRequest.type,m,p).then(g=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(g,p),g=>a.handleFailedRequest(xi.ColorPresentationRequest.type,p,g,null))},l=a.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,u):u(i,o,s)},provideDocumentColors:(i,o)=>{let s=this._client,a=(l,f)=>{let h={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(xi.DocumentColorRequest.type,h,f).then(p=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(p,f),p=>s.handleFailedRequest(xi.DocumentColorRequest.type,f,p,null))},u=s.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,o,a):a(i,o)}};return[Gb.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ls.ColorProviderFeature=Yl});var Jm=P(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.ImplementationFeature=void 0;var Zb=require("vscode"),ed=J(),td=ue(),nd=class extends td.TextDocumentLanguageFeature{constructor(e){super(e,ed.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,td.ensure)((0,td.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(ed.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(m,p),m=>a.handleFailedRequest(ed.ImplementationRequest.type,p,m,null)),l=a.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Zb.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ds.ImplementationFeature=nd});var Gm=P(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.TypeDefinitionFeature=void 0;var Qb=require("vscode"),rd=J(),Pi=ue(),id=class extends Pi.TextDocumentLanguageFeature{constructor(e){super(e,rd.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Pi.ensure)((0,Pi.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Pi.ensure)((0,Pi.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(rd.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(m,p),m=>a.handleFailedRequest(rd.TypeDefinitionRequest.type,p,m,null)),l=a.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Qb.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};fs.TypeDefinitionFeature=id});var Zm=P(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.WorkspaceFoldersFeature=Wr.arrayDiff=void 0;var Yb=Ie(),ps=require("vscode"),ki=J();function od(n,e){if(n!=null)return n[e]}function sd(n,e){return n.filter(t=>e.indexOf(t)<0)}Wr.arrayDiff=sd;var ad=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return ki.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=ps.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(ki.WorkspaceFoldersRequest.type,o=>{let s=()=>{let u=ps.workspace.workspaceFolders;return u===void 0?null:u.map(f=>this.asProtocol(f))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s(o)});let r=od(od(od(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=Yb.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=sd(this._initialFolders,e),i=sd(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(ki.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=ps.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(ps.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Wr.WorkspaceFoldersFeature=ad});var Ym=P(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.FoldingRangeFeature=void 0;var Qm=require("vscode"),er=J(),qi=ue(),cd=class extends qi.TextDocumentLanguageFeature{constructor(e){super(e,er.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,qi.ensure)((0,qi.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[er.FoldingRangeKind.Comment,er.FoldingRangeKind.Imports,er.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,qi.ensure)((0,qi.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(er.FoldingRangeRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Qm.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(o,s,a)=>{let u=this._client,l=(h,p,m)=>{let g={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h)};return u.sendRequest(er.FoldingRangeRequest.type,g,m).then(b=>m.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(b,m),b=>u.handleFailedRequest(er.FoldingRangeRequest.type,m,b,null))},f=u.middleware;return f.provideFoldingRanges?f.provideFoldingRanges(o,s,a,l):l(o,s,a)}};return[Qm.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}};hs.FoldingRangeFeature=cd});var ey=P(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.DeclarationFeature=void 0;var ew=require("vscode"),ud=J(),ld=ue(),dd=class extends ld.TextDocumentLanguageFeature{constructor(e){super(e,ud.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,ld.ensure)((0,ld.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(ud.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(m,p),m=>a.handleFailedRequest(ud.DeclarationRequest.type,p,m,null)),l=a.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return ew.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};gs.DeclarationFeature=dd});var ty=P(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.SelectionRangeFeature=void 0;var tw=require("vscode"),fd=J(),pd=ue(),hd=class extends pd.TextDocumentLanguageFeature{constructor(e){super(e,fd.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,pd.ensure)((0,pd.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{let a=this._client,u=async(f,h,p)=>{let m={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),positions:a.code2ProtocolConverter.asPositionsSync(h,p)};return a.sendRequest(fd.SelectionRangeRequest.type,m,p).then(g=>p.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(g,p),g=>a.handleFailedRequest(fd.SelectionRangeRequest.type,p,g,null))},l=a.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return tw.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ms.SelectionRangeFeature=hd});var ry=P(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});ys.ProgressFeature=void 0;var ny=J(),nw=al();function rw(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var gd=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:ny.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){rw(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new nw.ProgressPart(this._client,i.token,t))};e.onRequest(ny.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};ys.ProgressFeature=gd});var iy=P(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.CallHierarchyFeature=void 0;var iw=require("vscode"),tr=J(),md=ue(),yd=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,u,l)=>{let f=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(tr.CallHierarchyPrepareRequest.type,f,l).then(h=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(h,l),h=>i.handleFailedRequest(tr.CallHierarchyPrepareRequest.type,l,h,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(tr.CallHierarchyIncomingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(tr.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(tr.CallHierarchyOutgoingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(tr.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}},vd=class extends md.TextDocumentLanguageFeature{constructor(e){super(e,tr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,md.ensure)((0,md.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new yd(t);return[iw.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};vs.CallHierarchyFeature=vd});var oy=P(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.SemanticTokensFeature=void 0;var _s=require("vscode"),Y=J(),Ii=ue(),ow=Ht(),_d=class extends Ii.TextDocumentLanguageFeature{constructor(e){super(e,Y.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Ii.ensure)((0,Ii.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Y.SemanticTokenTypes.namespace,Y.SemanticTokenTypes.type,Y.SemanticTokenTypes.class,Y.SemanticTokenTypes.enum,Y.SemanticTokenTypes.interface,Y.SemanticTokenTypes.struct,Y.SemanticTokenTypes.typeParameter,Y.SemanticTokenTypes.parameter,Y.SemanticTokenTypes.variable,Y.SemanticTokenTypes.property,Y.SemanticTokenTypes.enumMember,Y.SemanticTokenTypes.event,Y.SemanticTokenTypes.function,Y.SemanticTokenTypes.method,Y.SemanticTokenTypes.macro,Y.SemanticTokenTypes.keyword,Y.SemanticTokenTypes.modifier,Y.SemanticTokenTypes.comment,Y.SemanticTokenTypes.string,Y.SemanticTokenTypes.number,Y.SemanticTokenTypes.regexp,Y.SemanticTokenTypes.operator,Y.SemanticTokenTypes.decorator],t.tokenModifiers=[Y.SemanticTokenModifiers.declaration,Y.SemanticTokenModifiers.definition,Y.SemanticTokenModifiers.readonly,Y.SemanticTokenModifiers.static,Y.SemanticTokenModifiers.deprecated,Y.SemanticTokenModifiers.abstract,Y.SemanticTokenModifiers.async,Y.SemanticTokenModifiers.modification,Y.SemanticTokenModifiers.documentation,Y.SemanticTokenModifiers.defaultLibrary],t.formats=[Y.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Ii.ensure)((0,Ii.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Y.SemanticTokensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});let[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){let t=e.documentSelector,r=ow.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new _s.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(m,g)=>{let b=this._client,D=b.middleware,k=(z,j)=>{let fe={textDocument:b.code2ProtocolConverter.asTextDocumentIdentifier(z)};return b.sendRequest(Y.SemanticTokensRequest.type,fe,j).then(K=>j.isCancellationRequested?null:b.protocol2CodeConverter.asSemanticTokens(K,j),K=>b.handleFailedRequest(Y.SemanticTokensRequest.type,j,K,null))};return D.provideDocumentSemanticTokens?D.provideDocumentSemanticTokens(m,g,k):k(m,g)},provideDocumentSemanticTokensEdits:i?(m,g,b)=>{let D=this._client,k=D.middleware,z=(j,fe,K)=>{let ae={textDocument:D.code2ProtocolConverter.asTextDocumentIdentifier(j),previousResultId:fe};return D.sendRequest(Y.SemanticTokensDeltaRequest.type,ae,K).then(async W=>K.isCancellationRequested?null:Y.SemanticTokens.is(W)?await D.protocol2CodeConverter.asSemanticTokens(W,K):await D.protocol2CodeConverter.asSemanticTokensEdits(W,K),W=>D.handleFailedRequest(Y.SemanticTokensDeltaRequest.type,K,W,null))};return k.provideDocumentSemanticTokensEdits?k.provideDocumentSemanticTokensEdits(m,g,b,z):z(m,g,b)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(m,g,b)=>{let D=this._client,k=D.middleware,z=(j,fe,K)=>{let ae={textDocument:D.code2ProtocolConverter.asTextDocumentIdentifier(j),range:D.code2ProtocolConverter.asRange(fe)};return D.sendRequest(Y.SemanticTokensRangeRequest.type,ae,K).then(W=>K.isCancellationRequested?null:D.protocol2CodeConverter.asSemanticTokens(W,K),W=>D.handleFailedRequest(Y.SemanticTokensRangeRequest.type,K,W,null))};return k.provideDocumentRangeSemanticTokens?k.provideDocumentRangeSemanticTokens(m,g,b,z):z(m,g,b)}}:void 0,l=[],f=this._client,h=f.protocol2CodeConverter.asSemanticTokensLegend(e.legend),p=f.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(_s.languages.registerDocumentSemanticTokensProvider(p,s,h)),u!==void 0&&l.push(_s.languages.registerDocumentRangeSemanticTokensProvider(p,u,h)),[new _s.Disposable(()=>l.forEach(m=>m.dispose())),{range:u,full:s,onDidChangeSemanticTokensEmitter:o}]}};bs.SemanticTokensFeature=_d});var cy=P(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.WillDeleteFilesFeature=bt.WillRenameFilesFeature=bt.WillCreateFilesFeature=bt.DidDeleteFilesFeature=bt.DidRenameFilesFeature=bt.DidCreateFilesFeature=void 0;var Mt=require("vscode"),sw=No(),dn=J(),aw=Ie();function sy(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function cw(n,e){return n[e]}function ay(n,e,t){n[e]=t}var fn=class{constructor(e,t,r,i,o){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=sy(sy(e,"workspace"),"fileOperations");ay(t,"dynamicRegistration",!0),ay(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,r=t!==void 0?cw(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:aw.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new sw.Minimatch(r.pattern.glob,fn.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return fn.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async o=>{let s=t(o),a=s.fsPath.replace(/\\/g,"/");for(let u of this._filters.values())for(let l of u)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let f=await this.getFileType(s);if(f===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(f===Mt.FileType.File&&l.kind===dn.FileOperationPatternKind.file||f===Mt.FileType.Directory&&l.kind===dn.FileOperationPatternKind.folder)return!0}else if(l.kind===dn.FileOperationPatternKind.folder&&await fn.getFileType(s)===Mt.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return{...e,files:i}}static async getFileType(e){try{return(await Mt.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},ws=class extends fn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},Cs=class extends ws{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await fn.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},bd=class extends ws{constructor(e){super(e,Mt.workspace.onDidCreateFiles,dn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}};bt.DidCreateFilesFeature=bd;var wd=class extends Cs{constructor(e){super(e,Mt.workspace.onDidRenameFiles,dn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Mt.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}};bt.DidRenameFilesFeature=wd;var Cd=class extends Cs{constructor(e){super(e,Mt.workspace.onDidDeleteFiles,dn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Mt.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};bt.DidDeleteFilesFeature=Cd;var Ei=class extends fn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Dd=class extends Ei{constructor(e){super(e,Mt.workspace.onWillCreateFiles,dn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}};bt.WillCreateFilesFeature=Dd;var Sd=class extends Ei{constructor(e){super(e,Mt.workspace.onWillRenameFiles,dn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}};bt.WillRenameFilesFeature=Sd;var Td=class extends Ei{constructor(e){super(e,Mt.workspace.onWillDeleteFiles,dn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};bt.WillDeleteFilesFeature=Td});var uy=P(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.LinkedEditingFeature=void 0;var uw=require("vscode"),Rd=J(),xd=ue(),Pd=class extends xd.TextDocumentLanguageFeature{constructor(e){super(e,Rd.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,xd.ensure)((0,xd.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{let a=this._client,u=(f,h,p)=>a.sendRequest(Rd.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,h),p).then(m=>p.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(m,p),m=>a.handleFailedRequest(Rd.LinkedEditingRangeRequest.type,p,m,null)),l=a.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return uw.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ds.LinkedEditingFeature=Pd});var ly=P(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.TypeHierarchyFeature=void 0;var lw=require("vscode"),nr=J(),kd=ue(),qd=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,u,l)=>{let f=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(nr.TypeHierarchyPrepareRequest.type,f,l).then(h=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(h,l),h=>i.handleFailedRequest(nr.TypeHierarchyPrepareRequest.type,l,h,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(nr.TypeHierarchySupertypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(nr.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(nr.TypeHierarchySubtypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(nr.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}},Id=class extends kd.TextDocumentLanguageFeature{constructor(e){super(e,nr.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,kd.ensure)((0,kd.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new qd(t);return[lw.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Ss.TypeHierarchyFeature=Id});var fy=P(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.InlineValueFeature=void 0;var dy=require("vscode"),Ts=J(),Oi=ue(),Ed=class extends Oi.TextDocumentLanguageFeature{constructor(e){super(e,Ts.InlineValueRequest.type)}fillClientCapabilities(e){(0,Oi.ensure)((0,Oi.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Oi.ensure)((0,Oi.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ts.InlineValueRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new dy.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,u)=>{let l=this._client,f=(p,m,g,b)=>{let D={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),range:l.code2ProtocolConverter.asRange(m),context:l.code2ProtocolConverter.asInlineValueContext(g)};return l.sendRequest(Ts.InlineValueRequest.type,D,b).then(k=>b.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(k,b),k=>l.handleFailedRequest(Ts.InlineValueRequest.type,b,k,null))},h=l.middleware;return h.provideInlineValues?h.provideInlineValues(o,s,a,u,f):f(o,s,a,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return dy.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Rs.InlineValueFeature=Ed});var hy=P(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.InlayHintsFeature=void 0;var py=require("vscode"),Br=J(),Fi=ue(),Od=class extends Fi.TextDocumentLanguageFeature{constructor(e){super(e,Br.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,Fi.ensure)((0,Fi.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Fi.ensure)((0,Fi.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Br.InlayHintRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new py.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{let u=this._client,l=async(h,p,m)=>{let g={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(h),range:u.code2ProtocolConverter.asRange(p)};try{let b=await u.sendRequest(Br.InlayHintRequest.type,g,m);return m.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(b,m)}catch(b){return u.handleFailedRequest(Br.InlayHintRequest.type,m,b,null)}},f=u.middleware;return f.provideInlayHints?f.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{let a=this._client,u=async(f,h)=>{try{let p=await a.sendRequest(Br.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(f),h);if(h.isCancellationRequested)return null;let m=a.protocol2CodeConverter.asInlayHint(p,h);return h.isCancellationRequested?null:m}catch(p){return a.handleFailedRequest(Br.InlayHintResolveRequest.type,h,p,null)}},l=a.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,u):u(o,s)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return py.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xs.InlayHintsFeature=Od});var gy=P(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.InlineCompletionItemFeature=void 0;var dw=require("vscode"),Fd=J(),Ld=ue(),fw=Ie(),Md=class extends Ld.TextDocumentLanguageFeature{constructor(e){super(e,Fd.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Ld.ensure)((0,Ld.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:fw.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideInlineCompletionItems:(i,o,s,a)=>{let u=this._client,l=this._client.middleware,f=(h,p,m,g)=>u.sendRequest(Fd.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(h,p,m),g).then(b=>g.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(b,g),b=>u.handleFailedRequest(Fd.InlineCompletionRequest.type,g,b,null));return l.provideInlineCompletionItems?l.provideInlineCompletionItems(i,o,s,a,f):f(i,o,s,a)}};return[dw.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ps.InlineCompletionItemFeature=Md});var wy=P(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.ProposedFeatures=Ze.BaseLanguageClient=Ze.MessageTransports=Ze.SuspendMode=Ze.State=Ze.CloseAction=Ze.ErrorAction=Ze.RevealOutputChannelOn=void 0;var _e=require("vscode"),q=J(),pw=mm(),hw=_m(),zt=Ht(),ks=Ho(),my=Ie(),gw=al(),Bt=ue(),mw=Pu(),yy=Tm(),vy=xm(),zr=Pm(),yw=km(),vw=qm(),_w=Im(),bw=Om(),ww=Fm(),Cw=El(),Dw=Mm(),Sw=Nm(),Tw=Am(),Rw=Hm(),Nd=Um(),xw=Bm(),Pw=zm(),kw=$m(),qw=Vm(),Iw=Xm(),Ew=Jm(),Ow=Gm(),Fw=Zm(),Lw=Ym(),Mw=ey(),Nw=ty(),Aw=ry(),jw=iy(),Hw=oy(),Kr=cy(),Uw=uy(),Ww=ly(),Bw=fy(),zw=hy(),Kw=gy(),rr;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(rr||(Ze.RevealOutputChannelOn=rr={}));var Mi;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(Mi||(Ze.ErrorAction=Mi={}));var On;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(On||(Ze.CloseAction=On={}));var Li;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Li||(Ze.State=Li={}));var _y;(function(n){n.off="off",n.on="on"})(_y||(Ze.SuspendMode=_y={}));var Ad;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&zt.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(Ad||(Ad={}));var jd=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Mi.Continue}:{action:Mi.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:On.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:On.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:On.Restart})}},ie;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(ie||(ie={}));var by;(function(n){function e(t){return t&&q.MessageReader.is(t.reader)&&q.MessageWriter.is(t.writer)}n.is=e})(by||(Ze.MessageTransports=by={}));var pn=class{constructor(e,t,r){this._traceFormat=q.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new ks.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=Ad.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??rr.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=ie.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new ks.Semaphore(1),this._pendingChangeDelayer=new ks.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new ks.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new q.Emitter,this._stateChangeEmitter=new q.Emitter,this._trace=q.Trace.Off,this._tracer={log:(o,s)=>{zt.string(o)?this.logTrace(o,s):this.logObjectTrace(o)}},this._c2p=pw.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=hw.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=_e.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case ie.Starting:return Li.Starting;case ie.Running:return Li.Running;default:return Li.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new q.ResponseError(q.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===q.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let o,s;return t.length===1?q.CancellationToken.is(t[0])?s=t[0]:o=t[0]:t.length===2&&(o=t[0],s=t[1]),i(e,o,s,(a,u,l)=>{let f=[];return u!==void 0&&f.push(u),l!==void 0&&f.push(l),r.sendRequest(a,...f)})}else return r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),o;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),o={dispose:()=>{let s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),o={dispose:()=>{this._pendingRequestHandlers.delete(r);let s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),o.dispose()}}}async sendNotification(e,t){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new q.ResponseError(q.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===q.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===q.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let o=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(o),i!==void 0&&this._pendingOpenNotifications.delete(i);let s=this._clientOptions.middleware?.sendNotification;return s?s(e,o.sendNotification.bind(o),t):o.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),o;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),o={dispose:()=>{let s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),o={dispose:()=>{this._pendingNotificationHandlers.delete(r);let s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),o.dispose()}}}async sendProgress(e,t,r){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new q.ResponseError(q.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),o,s=this._clientOptions.middleware?.handleWorkDoneProgress,a=q.WorkDoneProgress.is(e)&&s!==void 0?u=>{s(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),o={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),o={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),o.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new jd(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof q.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?zt.string(e.stack)?e.stack:e.message:zt.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(q.MessageType.Debug,rr.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(q.MessageType.Info,rr.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(q.MessageType.Warning,rr.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(q.MessageType.Error,rr.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,o,s){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),o!=null&&this.outputChannel.appendLine(this.data2String(o)),(s==="force"||s&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===q.MessageType.Error?_e.window.showErrorMessage:e===q.MessageType.Warning?_e.window.showWarningMessage:_e.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===ie.Initial||this.$state===ie.Stopping||this.$state===ie.Stopped}needsStop(){return this.$state===ie.Starting||this.$state===ie.Running}activeConnection(){return this.$state===ie.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===ie.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===ie.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?_e.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):_e.languages.createDiagnosticCollection());for(let[i,o]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,o);for(let[i,o]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,o);for(let[i,o]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,o);this.$state=ie.Starting;try{let i=await this.createConnection();i.onNotification(q.LogMessageNotification.type,o=>{switch(o.type){case q.MessageType.Error:this.error(o.message,void 0,!1);break;case q.MessageType.Warning:this.warn(o.message,void 0,!1);break;case q.MessageType.Info:this.info(o.message,void 0,!1);break;case q.MessageType.Debug:this.debug(o.message,void 0,!1);break;default:this.outputChannel.appendLine(o.message)}}),i.onNotification(q.ShowMessageNotification.type,o=>{switch(o.type){case q.MessageType.Error:_e.window.showErrorMessage(o.message);break;case q.MessageType.Warning:_e.window.showWarningMessage(o.message);break;case q.MessageType.Info:_e.window.showInformationMessage(o.message);break;default:_e.window.showInformationMessage(o.message)}}),i.onRequest(q.ShowMessageRequest.type,o=>{let s;switch(o.type){case q.MessageType.Error:s=_e.window.showErrorMessage;break;case q.MessageType.Warning:s=_e.window.showWarningMessage;break;case q.MessageType.Info:s=_e.window.showInformationMessage;break;default:s=_e.window.showInformationMessage}let a=o.actions||[];return s(o.message,...a)}),i.onNotification(q.TelemetryEventNotification.type,o=>{this._telemetryEmitter.fire(o)}),i.onRequest(q.ShowDocumentRequest.type,async o=>{let s=async u=>{let l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await _e.env.openExternal(l)};{let f={};return u.selection!==void 0&&(f.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?f.preserveFocus=!0:u.takeFocus===!0&&(f.preserveFocus=!1),await _e.window.showTextDocument(l,f),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(o,s):s(o)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=ie.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,o)=>{e=i,t=o}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:_e.env.appName,version:_e.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(_e.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:zt.func(t)?t():t,trace:q.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let s=my.generateUuid(),a=new gw.ProgressPart(e,s);o.workDoneToken=s;try{let u=await this.doInitialize(e,o);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,o)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==q.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=ie.Running;let i;zt.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===q.TextDocumentSyncKind.None?i={openClose:!1,change:q.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(q.PublishDiagnosticsNotification.type,o=>this.handleDiagnostics(o)),e.onRequest(q.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(q.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(q.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o));for(let[o,s]of this._pendingNotificationHandlers)this._notificationDisposables.set(o,e.onNotification(o,s));this._pendingNotificationHandlers.clear();for(let[o,s]of this._pendingRequestHandlers)this._requestDisposables.set(o,e.onRequest(o,s));this._pendingRequestHandlers.clear();for(let[o,s]of this._pendingProgressHandlers)this._progressDisposables.set(o,e.onProgress(s.type,o,s.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(q.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof q.ResponseError&&r.data&&r.data.retry?_e.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&_e.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=_e.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===ie.Stopped||this.$state===ie.Initial)return;if(this.$state===ie.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==ie.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=ie.Stopping,this.cleanUp(e);let i=new Promise(s=>{(0,q.RAL)().timer.setTimeout(s,t)}),o=(async s=>(await s.shutdown(),await s.exit(),s))(r);return this._onStop=Promise.race([i,o]).then(s=>{if(s!==void 0)s.end(),s.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},s=>{throw this.error("Stopping server failed",s,!1),s}).finally(()=>{this.$state=ie.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(q.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(q.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,q.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,q.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new _e.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){let s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(u,l)=>this.setDiagnostics(u,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return _e.env.language}async $start(){if(this.$state===ie.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,o,s)=>{this.handleConnectionError(i,o,s).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=$w(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===ie.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:On.DoNotRestart};if(this.$state!==ie.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===On.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===ie.Starting?this.$state=ie.StartFailed:this.$state=ie.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===On.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=ie.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===Mi.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(_e.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=_e.workspace.getConfiguration(this._id),i=q.Trace.Off,o=q.TraceFormat.Text;if(r){let s=r.get("trace.server","off");typeof s=="string"?i=q.Trace.fromString(s):(i=q.Trace.fromString(r.get("trace.server.verbosity","off")),o=q.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(s=>{this.error("Updating trace failed with error",s,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;zt.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(q.DidChangeWatchedFilesNotification.type.method).registerRaw(my.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Bt.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(q.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof yy.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new vy.ConfigurationFeature(this)),this.registerFeature(new zr.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new zr.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new zr.WillSaveFeature(this)),this.registerFeature(new zr.WillSaveWaitUntilFeature(this)),this.registerFeature(new zr.DidSaveTextDocumentFeature(this)),this.registerFeature(new zr.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new qw.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new yw.CompletionItemFeature(this)),this.registerFeature(new vw.HoverFeature(this)),this.registerFeature(new bw.SignatureHelpFeature(this)),this.registerFeature(new _w.DefinitionFeature(this)),this.registerFeature(new Sw.ReferencesFeature(this)),this.registerFeature(new ww.DocumentHighlightFeature(this)),this.registerFeature(new Cw.DocumentSymbolFeature(this)),this.registerFeature(new Dw.WorkspaceSymbolFeature(this)),this.registerFeature(new Tw.CodeActionFeature(this)),this.registerFeature(new Rw.CodeLensFeature(this)),this.registerFeature(new Nd.DocumentFormattingFeature(this)),this.registerFeature(new Nd.DocumentRangeFormattingFeature(this)),this.registerFeature(new Nd.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new xw.RenameFeature(this)),this.registerFeature(new Pw.DocumentLinkFeature(this)),this.registerFeature(new kw.ExecuteCommandFeature(this)),this.registerFeature(new vy.SyncConfigurationFeature(this)),this.registerFeature(new Ow.TypeDefinitionFeature(this)),this.registerFeature(new Ew.ImplementationFeature(this)),this.registerFeature(new Iw.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new Fw.WorkspaceFoldersFeature(this)),this.registerFeature(new Lw.FoldingRangeFeature(this)),this.registerFeature(new Mw.DeclarationFeature(this)),this.registerFeature(new Nw.SelectionRangeFeature(this)),this.registerFeature(new Aw.ProgressFeature(this)),this.registerFeature(new jw.CallHierarchyFeature(this)),this.registerFeature(new Hw.SemanticTokensFeature(this)),this.registerFeature(new Uw.LinkedEditingFeature(this)),this.registerFeature(new Kr.DidCreateFilesFeature(this)),this.registerFeature(new Kr.DidRenameFilesFeature(this)),this.registerFeature(new Kr.DidDeleteFilesFeature(this)),this.registerFeature(new Kr.WillCreateFilesFeature(this)),this.registerFeature(new Kr.WillRenameFilesFeature(this)),this.registerFeature(new Kr.WillDeleteFilesFeature(this)),this.registerFeature(new Ww.TypeHierarchyFeature(this)),this.registerFeature(new Bw.InlineValueFeature(this)),this.registerFeature(new zw.InlayHintsFeature(this)),this.registerFeature(new mw.DiagnosticFeature(this)),this.registerFeature(new yy.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Ud.createAll(this))}fillInitializeParams(e){for(let t of this._features)zt.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Bt.ensure)(e,"workspace").applyEdit=!0;let t=(0,Bt.ensure)((0,Bt.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[q.ResourceOperationKind.Create,q.ResourceOperationKind.Rename,q.ResourceOperationKind.Delete],t.failureHandling=q.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Bt.ensure)((0,Bt.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[q.DiagnosticTag.Unnecessary,q.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,Bt.ensure)(e,"window"),o=(0,Bt.ensure)(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};let s=(0,Bt.ensure)(i,"showDocument");s.support=!0;let a=(0,Bt.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(pn.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)zt.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let o={id:t.id,registerOptions:i};try{r.register(o)}catch(s){return Promise.reject(s)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;_e.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(let s of t.documentChanges)if(q.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let a=this._p2c.asUri(s.textDocument.uri).toString(),u=i.get(a);if(u&&u.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):zt.asPromise(_e.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof q.ResponseError){if(r.code===q.ErrorCodes.PendingResponseRejected||r.code===q.ErrorCodes.ConnectionInactive)return i;if(r.code===q.LSPErrorCodes.RequestCancelled||r.code===q.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Bt.LSPCancellationError(r.data):new _e.CancellationError}else if(r.code===q.LSPErrorCodes.ContentModified){if(pn.RequestsToCancelOnContentModified.has(e.method)||pn.CancellableResolveCalls.has(e.method))throw new _e.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}};Ze.BaseLanguageClient=pn;pn.RequestsToCancelOnContentModified=new Set([q.SemanticTokensRequest.method,q.SemanticTokensRangeRequest.method,q.SemanticTokensDeltaRequest.method]);pn.CancellableResolveCalls=new Set([q.CompletionResolveRequest.method,q.CodeLensResolveRequest.method,q.CodeActionResolveRequest.method,q.InlayHintResolveRequest.method,q.DocumentLinkResolveRequest.method,q.WorkspaceSymbolResolveRequest.method]);var Hd=class{error(e){(0,q.RAL)().console.error(e)}warn(e){(0,q.RAL)().console.warn(e)}info(e){(0,q.RAL)().console.info(e)}log(e){(0,q.RAL)().console.log(e)}};function $w(n,e,t,r,i){let o=new Hd,s=(0,q.createProtocolConnection)(n,e,o,i);return s.onError(u=>{t(u[0],u[1],u[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(u,l,f)=>{let h={sendNotification:!1,traceFormat:q.TraceFormat.Text};return f===void 0?s.trace(u,l,h):(zt.boolean(f),s.trace(u,l,f))},initialize:u=>s.sendRequest(q.InitializeRequest.type,u),shutdown:()=>s.sendRequest(q.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(q.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()}}var Ud;(function(n){function e(t){return[new Kw.InlineCompletionItemFeature(t)]}n.createAll=e})(Ud||(Ze.ProposedFeatures=Ud={}))});var Bd=P(Pt=>{"use strict";var Vw=Pt&&Pt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Wd=Pt&&Pt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vw(e,n,t)};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.DiagnosticPullMode=Pt.vsdiag=void 0;Wd(J(),Pt);Wd(ue(),Pt);var Cy=Pu();Object.defineProperty(Pt,"vsdiag",{enumerable:!0,get:function(){return Cy.vsdiag}});Object.defineProperty(Pt,"DiagnosticPullMode",{enumerable:!0,get:function(){return Cy.DiagnosticPullMode}});Wd(wy(),Pt)});var zd=P((YD,Dy)=>{"use strict";Dy.exports=J()});var Ry=P(en=>{"use strict";var Xw=en&&en.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ty=en&&en.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Xw(e,n,t)};Object.defineProperty(en,"__esModule",{value:!0});en.LanguageClient=void 0;var Jw=Bd(),Sy=zd();Ty(zd(),en);Ty(Bd(),en);var Kd=class extends Jw.BaseLanguageClient{constructor(e,t,r,i){super(e,t,r),this.worker=i}createMessageTransports(e){let t=new Sy.BrowserMessageReader(this.worker),r=new Sy.BrowserMessageWriter(this.worker);return Promise.resolve({reader:t,writer:r})}};en.LanguageClient=Kd});var Py=P((tS,xy)=>{"use strict";xy.exports=Ry()});var Yw={};tf(Yw,{activate:()=>Qw});module.exports=ji(Yw);var of=Symbol("Comlink.proxy"),ov=Symbol("Comlink.endpoint"),sv=Symbol("Comlink.releaseProxy"),Ms=Symbol("Comlink.finalizer"),Ui=Symbol("Comlink.thrown"),sf=n=>typeof n=="object"&&n!==null||typeof n=="function",av={canHandle:n=>sf(n)&&n[of],serialize(n){let{port1:e,port2:t}=new MessageChannel;return Ki(n,e),[t,[t]]},deserialize(n){return n.start(),dv(n)}},cv={canHandle:n=>sf(n)&&Ui in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},af=new Map([["proxy",av],["throw",cv]]);function uv(n,e){for(let t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function Ki(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!uv(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:o,type:s,path:a}={path:[],...i.data},u=(i.data.argumentList||[]).map(Wn),l;try{let f=a.slice(0,-1).reduce((p,m)=>p[m],n),h=a.reduce((p,m)=>p[m],n);switch(s){case"GET":l=h;break;case"SET":f[a.slice(-1)[0]]=Wn(i.data.value),l=!0;break;case"APPLY":l=h.apply(f,u);break;case"CONSTRUCT":{let p=new h(...u);l=mv(p)}break;case"ENDPOINT":{let{port1:p,port2:m}=new MessageChannel;Ki(n,m),l=gv(p,[p])}break;case"RELEASE":l=void 0;break;default:return}}catch(f){l={value:f,[Ui]:0}}Promise.resolve(l).catch(f=>({value:f,[Ui]:0})).then(f=>{let[h,p]=zi(f);e.postMessage({...h,id:o},p),s==="RELEASE"&&(e.removeEventListener("message",r),cf(e),Ms in n&&typeof n[Ms]=="function"&&n[Ms]())}).catch(f=>{let[h,p]=zi({value:new TypeError("Unserializable return value"),[Ui]:0});e.postMessage({...h,id:o},p)})}),e.start&&e.start()}function lv(n){return n.constructor.name==="MessagePort"}function cf(n){lv(n)&&n.close()}function dv(n,e){return Ns(n,[],e)}function Hi(n){if(n)throw new Error("Proxy has been released and is not useable")}function uf(n){return cr(n,{type:"RELEASE"}).then(()=>{cf(n)})}var Wi=new WeakMap,Bi="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{let e=(Wi.get(n)||0)-1;Wi.set(n,e),e===0&&uf(n)});function fv(n,e){let t=(Wi.get(e)||0)+1;Wi.set(e,t),Bi&&Bi.register(n,e,n)}function pv(n){Bi&&Bi.unregister(n)}function Ns(n,e=[],t=function(){}){let r=!1,i=new Proxy(t,{get(o,s){if(Hi(r),s===sv)return()=>{pv(i),uf(n),r=!0};if(s==="then"){if(e.length===0)return{then:()=>i};let a=cr(n,{type:"GET",path:e.map(u=>u.toString())}).then(Wn);return a.then.bind(a)}return Ns(n,[...e,s])},set(o,s,a){Hi(r);let[u,l]=zi(a);return cr(n,{type:"SET",path:[...e,s].map(f=>f.toString()),value:u},l).then(Wn)},apply(o,s,a){Hi(r);let u=e[e.length-1];if(u===ov)return cr(n,{type:"ENDPOINT"}).then(Wn);if(u==="bind")return Ns(n,e.slice(0,-1));let[l,f]=rf(a);return cr(n,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:l},f).then(Wn)},construct(o,s){Hi(r);let[a,u]=rf(s);return cr(n,{type:"CONSTRUCT",path:e.map(l=>l.toString()),argumentList:a},u).then(Wn)}});return fv(i,n),i}function hv(n){return Array.prototype.concat.apply([],n)}function rf(n){let e=n.map(zi);return[e.map(t=>t[0]),hv(e.map(t=>t[1]))]}var lf=new WeakMap;function gv(n,e){return lf.set(n,e),n}function mv(n){return Object.assign(n,{[of]:!0})}function zi(n){for(let[e,t]of af)if(t.canHandle(n)){let[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},lf.get(n)||[]]}function Wn(n){switch(n.type){case"HANDLER":return af.get(n.name).deserialize(n.value);case"RAW":return n.value}}function cr(n,e,t){return new Promise(r=>{let i=yv();n.addEventListener("message",function o(s){!s.data||!s.data.id||s.data.id!==i||(n.removeEventListener("message",o),r(s.data))}),n.start&&n.start(),n.postMessage({id:i,...e},t)})}function yv(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ot=Un(require("vscode")),Uy=Un(Py());var hn=require("vscode");var Qe=new Map;Qe.set("/array.mbt",{content:`
pub fn to_string[X: Show](self: Array[X]) -> String {
  let mut acc = "["
  let mut i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      acc = acc + ", "
    }
    acc = acc + self[i].to_string()
  }
  acc + "]"
}

pub fn Array::default[X]() -> Array[X] {
  []
}
`,stat:{type:1,mtime:17071211961679717e-4,ctime:17071211961679717e-4,size:277}});Qe.set("/buffer.mbt",{content:`
/// Extensible buffer.
///
/// It provides accumulative concatenation of strings in linear time.
/// The capacity of buffer will automatically expand as necessary.
///
/// # Usage 
///
/// \`\`\`
/// let buf = Buffer::make(100)
/// buf.write_string("Tes")
/// buf.write_char("t")
/// println(buf.to_string()) // output: Test
/// \`\`\`
struct Buffer {
  mut bytes : Bytes
  mut len : Int
}

/// Expand the buffer size if capacity smaller than requried space.
fn grow_if_necessary(self : Buffer, required : Int) { 
  let mut enough_space = self.bytes.length()
  // double the enough_space until it larger than required
  while enough_space < required {
    enough_space = enough_space * 2
  }
  if enough_space != self.bytes.length() {
    let new_bytes = Bytes::make(enough_space, 0)
    blit(new_bytes, 0, self.bytes, 0, self.len)
    self.bytes = new_bytes
  }
}

/// Return a new String contains the data in buffer.
pub fn to_string(self : Buffer) -> String {
  self.bytes.sub_string(0, self.len)
}

/// Create a buffer with initial capacity.
pub fn Buffer::make(initial_capacity : Int) -> Buffer {
  let initial = if initial_capacity < 1 { 1 } else { initial_capacity }
  {
    bytes: Bytes::make(initial, 0),
    len: 0,
  }
}

/// Write a string into buffer.
pub fn write_string(self : Buffer, value : String) {
  self.grow_if_necessary(self.len + value.length())
  self.bytes.blit_from_string(self.len, value, 0, value.length())
  self.len = self.len + value.length()
}

/// Write a sub-string into buffer.
pub fn write_sub_string(self : Buffer, value : String, start: Int, len: Int) {
  if start < 0 || len < 0 || start + len > value.length() {
    abort("Buffer::write_sub_string")
  }
  self.grow_if_necessary(self.len + len)
  self.bytes.blit_from_string(self.len, value, start, len)
  self.len = self.len + len
}

/// Write a char into buffer.
pub fn write_char(self : Buffer, value : Char) {
  self.grow_if_necessary(self.len + 4)
  let inc = self.bytes.set_utf8_char(self.len, value)
  self.len = self.len + inc
}


/// Length of containing data.
pub fn length(self : Buffer) -> Int {
  self.len
}

`,stat:{type:1,mtime:17071211961680273e-4,ctime:17071211961680273e-4,size:2108}});Qe.set("/bytes.mbt",{content:`
fn unsafe_blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit"
fn unsafe_sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String = "$moonbit.unsafe_bytes_sub_string"
fn unsafe_bytes_blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit_from_string"


/// Transfer bytes.
///
/// It copies \`length\` bytes from \`src\` begin at \`src_offset\`, to destination byte sequence \`self\` begin at \`dst_offset\`. 
///
/// # Usage
/// \`\`\`
/// let b1 = Bytes::of_string("abcdef")
/// let b2 = Bytes::of_string("ABCDEF")
/// b1.blit(2, b2, 3, 2)
/// println(b1.to_string()) // output: abDEef
/// \`\`\`
pub fn blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) {
  let s1 = dst_offset
  let s2 = src_offset
  let e1 = dst_offset + length - 1
  let e2 = src_offset + length - 1
  let len1 = self.length()
  let len2 = src.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit out of bounds")    
  } else {
    unsafe_blit(self, dst_offset, src, src_offset, length)
  } 
}

/// Create a new String from byte sequence.
pub fn to_string(self : Bytes) -> String {
  self.sub_string(0, self.length())
}

/// Create byte sequence from String.
pub fn Bytes::of_string(str : String) -> Bytes {
  let bytes = Bytes::make(str.length(), 0)
  bytes.blit_from_string(0, str, 0, bytes.length())
  bytes
}

/// Return a new String, containing the subsequence of \`self\` that 
/// starts at \`byte_offset\` and has length \`byte_length\`.
pub fn sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String {
  if byte_length < 0 || byte_offset < 0 || 
       byte_offset + byte_length > self.length() {
    abort("sub_string out of bound")
  } else {
    unsafe_sub_string(self, byte_offset, byte_length)
  }
}

/// Copy \`length\` bytes from string \`str\`, starting at \`str_offset\`, 
/// into byte sequence \`self\`, starting at \`bytes_offset\`.
pub fn blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) {
  let s1 = bytes_offset
  let s2 = str_offset
  let e1 = bytes_offset + length - 1
  let e2 = str_offset + length - 1
  let len1 = self.length()
  let len2 = str.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit_from_string out of bounds")
  } else {
    unsafe_bytes_blit_from_string(self, bytes_offset, str, str_offset, length)
  }
}

/// Return a new Bytes that contains the same byte sequence.
pub fn copy(self : Bytes) -> Bytes {
  let dst = Bytes::make(self.length(), 0)
  blit(dst, 0, self, 0, self.length())
  dst
}

/// Fill utf8 encoded char \`value\` into byte sequence \`self\`, starting at \`offset\`.
/// It return the length of bytes has been written.
pub fn set_utf8_char(self : Bytes, offset : Int, value : Char) -> Int {
  let code = value.to_int()
  if (code < 0x80) {
    self[offset] = code.lsr(0).land(0x7F).lor(0x00)
    1
  } else if (code < 0x0800) {
    self[offset] = code.lsr(6).land(0x1F).lor(0xC0)
    self[offset + 1] = code.lsr(0).land(0x3F).lor(0x80)
    2
  } else if (code < 0x010000) {
    self[offset] = code.lsr(12).land(0x0F).lor(0xE0)
    self[offset + 1] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(0).land(0x3F).lor(0x80)
    3
  } else if (code < 0x110000) {
    self[offset] = code.lsr(18).land(0x07).lor(0xF0)
    self[offset + 1] = code.lsr(12).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 3] = code.lsr(0).land(0x3F).lor(0x80)
    4
  } else { 
    abort("Char out of range") 
  }
}


`,stat:{type:1,mtime:17071211961685889e-4,ctime:17071211961685889e-4,size:3700}});Qe.set("/console.mbt",{content:`pub fn println[T : Show](input : T) -> Unit {
  print_string(input.to_string())
  print_string("\\n")
}

pub fn print[T : Show](input : T) -> Unit{
  print_string(input.to_string())
}

pub fn to_string(self : Bool) -> String {
  if self { 
    "true"
  } else {
    "false"
  }
}

pub fn to_string(self : Int64) -> String {
  fn abs(n : Int64) -> Int64 {
    if n < 0L {
      0L - n
    } else {
      n
    }
  }
  
  // The min and max value of i64 are -9223372036854775808 and 9223372036854775807,
  // so max=20 is enough. 
  let max = 20
  let bytes = Bytes::make(max,0)
  let mut num = self
  let mut p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10L).to_int()
    bytes[p] = c
    num = num / 10L
    if num == 0L { break }
  }

  if self < 0L {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_string(self : Int) -> String {
  fn abs(n : Int) -> Int {
    if n < 0 {
      0 - n
    } else {
      n
    }
  }
 
  // The min and max value of i32 are -2147483648 and 2147483647,
  // so max=11 is enough.
  let max = 11
  let bytes = Bytes::make(max,0)
  let mut num = self
  let mut p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10)
    bytes[p] = c
    num = num / 10
    if num == 0 { break }
  }

  if self < 0 {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_int(self : Bool) -> Int {
  if self {
    1
  } else {
    0
  }
}

pub fn to_int64(self : Bool) -> Int64 {
  if self {
    1L
  } else {
    0L
  }
}

fn to_bool(self : Int) -> Bool {
  if self == 0 {
    false
  } else {
    true
  }
}

fn to_bool(self : Int64) -> Bool {
  if self == 0L {
    false
  } else {
    true
  }
}

pub fn to_string(self : Double) -> String {
  double_to_string(self)
}

pub fn op_lt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_neg()
}

pub fn op_gt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_pos()
}

pub fn op_le[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_pos()
}

pub fn op_ge[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_neg()
}

pub fn op_notequal[T: Eq](x: T, y: T) -> Bool {
  not(x == y)
}

/// A reference to string in host JS.
pub type Js_string

/// Create a JS string from a string in Moonbit by calling intrinsic primitive
pub fn Js_string::new(x: String) -> Js_string {
  x.to_js_string()
}

/// Call FFI to log the JS string
pub fn log(self: Js_string) = "js_string" "log"

/// Call FFI to append two JS strings
pub fn op_add(self: Js_string, other: Js_string) -> Js_string = "js_string" "append"


fn unsafe_make_string(length : Int, value : Char) -> String = "$moonbit.unsafe_make_string"

/// Create new string of \`length\`, where each character is \`value\`
/// 
/// \`\`\`
/// println(String::make(5,'S')) // Output: "SSSSS"
/// \`\`\`
pub fn String::make(length : Int, value : Char) -> String {
  if length < 0 { 
    abort("invalid length") 
  } else {
    unsafe_make_string(length, value)
  }
}

/// Convert Char to String
pub fn to_string(self : Char) -> String {
  let bytes = Bytes::make(4, 0)
  let len = bytes.set_utf8_char(0, self)
  bytes.sub_string(0, len)
}
`,stat:{type:1,mtime:17071211961686406e-4,ctime:17071211961686406e-4,size:3212}});Qe.set("/debug.mbt",{content:`
/// [Debug] indicates a type can be printed for debugging
pub trait Debug {
  debug_write(Self, Buffer)
}

/// print a value to the console using [Debug], with a tailing newline
pub fn debug[X: Debug](x: X) {
  let buf = Buffer::make(10)
  x.debug_write(buf)
  println(buf.to_string())
}


pub fn debug_write(self: Unit, buf: Buffer) {
  let _ = self
  buf.write_string("()")
}

pub fn debug_write(self: Bool, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int64, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Double, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Char, buf: Buffer) {
  buf.write_char('\\'')
  match self {
    '\\n' => buf.write_string("\\\\n")
    '\\r' => buf.write_string("\\\\r")
    '\\'' => buf.write_string("\\\\'")
    _ => buf.write_char(self)
  }
  buf.write_char('\\'')
}

pub fn debug_write[X: Debug](self: Option[X], buf: Buffer) {
  match self {
    None => buf.write_string("None")
    Some(arg) => {
      buf.write_string("Some(")
      arg.debug_write(buf)
      buf.write_string(")")
    }
  }
}

pub fn debug_write[T: Debug, E: Debug](self: Result[T, E], buf: Buffer) {
  match self {
    Ok(x) => {
      buf.write_string("Ok(")
      x.debug_write(buf)
      buf.write_string(")")
    }
    Err(e) => {
      buf.write_string("Err(")
      e.debug_write(buf)
      buf.write_string(")")
    }
  }
}

pub fn debug_write[X: Debug](self: Ref[X], buf: Buffer) {
  buf.write_string("{val: ")
  self.val.debug_write(buf)
  buf.write_string("}")
}

pub fn debug_write[X: Debug](self: Array[X], buf: Buffer) {
  buf.write_char('[')
  let mut i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      buf.write_string(", ")
    }
    self[i].debug_write(buf)
  }
  buf.write_char(']')
}

pub fn debug_write(self: String, buf: Buffer) {
  buf.write_char('"')
  let mut segment_start = 0
  let mut i = 0
  fn flush_segment() {
    if i > segment_start {
      buf.write_sub_string(self, segment_start, i - segment_start)
    }
    segment_start = i + 1
  }
  while i < self.length(), i = i + 1 {
    let c = self[i]
    match c {
      '\\n' => {
        flush_segment()
        buf.write_string("\\\\n")
      }
      '\\r' => {
        flush_segment()
        buf.write_string("\\\\r")
      }
      '"' => {
        flush_segment()
        buf.write_string("\\\\\\"")
      }
      _ => ()
    }
  }
  flush_segment()
  buf.write_char('"')
}

pub fn debug_write[X: Debug, Y: Debug](self: (X, Y), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug](self: (X, Y, Z), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug, W: Debug](
  self: (X, Y, Z, W),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X1: Debug, X2: Debug, X3: Debug, X4: Debug, X5: Debug](
  self: (X1, X2, X3, X4, X5),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_string(", ")
  self.4.debug_write(buf)
  buf.write_char(')')
}
`,stat:{type:1,mtime:17071211961686895e-4,ctime:17071211961686895e-4,size:3723}});Qe.set("/list.mbt",{content:`pub fn List::default[X]() -> List[X] {
  Nil
}

pub fn List::op_equal[X : Eq](xs : List[X], ys : List[X]) -> Bool {
  match (xs, ys) {
    (Nil, Nil) => true
    (Cons(h1, t1), Cons(h2, t2)) => h1 == h2 && t1 == t2
    (Nil, Cons(_, _)) | (Cons(_, _), Nil) => false
  }
}

pub fn debug_write[X : Debug](self : List[X], buf : Buffer) {
  match self {
    Nil => buf.write_string("Nil")
    Cons(hd, tl) => {
      buf.write_string("Cons(")
      hd.debug_write(buf)
      buf.write_string(", ")
      tl.debug_write(buf)
      buf.write_string(")")
    }
  }
}

pub fn to_string[X : Show](self : List[X]) -> String {
  match self {
    Nil => "Nil"
    Cons(hd,tl) => {
      "List::Cons(\\(hd),\\(tl))"
    }
  }
}
`,stat:{type:1,mtime:17071211961689033e-4,ctime:17071211961689033e-4,size:713}});Qe.set("/moon.pkg.json",{content:`{}
`,stat:{type:1,mtime:17071211961689456e-4,ctime:17071211961689456e-4,size:3}});Qe.set("/option.mbt",{content:`
pub fn Option::default[X]() -> Option[X] {
  None
}

pub fn op_equal[X: Eq](self: Option[X], other: Option[X]) -> Bool {
  match (self, other) {
    (None, None) => true
    (Some(x), Some(y)) => x == y
    _ => false
  }
}

pub fn compare[X: Compare](self: Option[X], other: Option[X]) -> Int {
  match self {
    None =>
      match other {
        None => 0
        Some(_) => -1
      }
    Some(x) =>
      match other {
        None => 1
        Some(y) => x.compare(y)
      }
  }
}

pub fn unwrap[X](self: Option[X]) -> X {
  match self {
    None => abort("called \`Option::unwrap()\` on a \`None\` value")
    Some(x) => x
  }
}

pub fn to_string[X: Show](self: Option[X]) -> String {
  match self {
    None => "None"
    Some(x) => "Some(" + x.to_string() + ")"
  }
}
`,stat:{type:1,mtime:17071211961689976e-4,ctime:17071211961689976e-4,size:777}});Qe.set("/ref.mbt",{content:`
pub fn to_string[X: Show](self: Ref[X]) -> String {
  "{val: " + self.val.to_string() + "}"
}
`,stat:{type:1,mtime:17071211961690435e-4,ctime:17071211961690435e-4,size:95}});Qe.set("/result.mbt",{content:`
pub fn op_equal[T: Eq, E: Eq](self: Result[T, E], other: Result[T, E]) -> Bool {
  match (self, other) {
    (Ok(x), Ok(y)) => x == y
    (Err(x), Err(y)) => x == y
    _ => false
  }
}

pub fn compare[T: Compare, E: Compare](self: Result[T, E], other: Result[T, E]) -> Int {
  match (self, other) {
    (Ok(x), Ok(y)) => x.compare(y)
    (Ok(_), Err(_)) => -1
    (Err(_), Ok(_)) => 1
    (Err(x), Err(y)) => x.compare(y)
  }
}


pub fn unwrap[T, E](self: Result[T, E]) -> T {
  match self {
    Ok(x) => x
    Err(_) => abort("called \`Result::unwrap()\` on an \`Err\` value")
  }
}`,stat:{type:1,mtime:17071211961690952e-4,ctime:17071211961690952e-4,size:581}});Qe.set("/ryu.mbt",{content:`// MoonBit implementation of Ryu, https://github.com/ulfjack/ryu

fn log10Pow5(e : Int) -> Int {
  (e * 732923).lsr(20)
}

fn pow5bits(e : Int) -> Int {
  (e * 1217359).lsr(19) + 1
}

fn log10Pow2(e : Int) -> Int {
  (e * 78913).lsr(18)
}

// TODO: this is not efficient.
fn string_from_bytes(bytes : Bytes, from : Int, to : Int) -> String {
  let mut s = ""
  let mut i = from
  while i < to, i = i + 1 {
    s = s + Char::from_int(bytes[i]).to_string()
  }
  s
}

fn copy_special_str(sign : Bool, exponent : Bool, mantissa : Bool) -> String {
  if mantissa {
    return "NaN"
  }
  let s = if sign {
    "-"
  } else {
    ""
  }
  if exponent {
    return s + "Infinity"
  }
  return s + "0.0"
}

fn u64_lt(x : Int64, y : Int64) -> Bool {
  x.compare_u(y) == -1
}

fn umul128(a : Int64, b : Int64) -> (Int64, Int64) {
  let aLo : Int = a.to_int()
  let aHi : Int = a.lsr(32L).to_int()
  let bLo : Int = b.to_int()
  let bHi : Int = b.lsr(32L).to_int()
  let b00 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bLo)
  let b01 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bHi)
  let b10 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bLo)
  let b11 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bHi)
  let b00Lo : Int = b00.to_int()
  let b00Hi : Int = b00.lsr(32L).to_int()
  let mid1 : Int64 = b10 + Int64::extend_i32_u(b00Hi)
  let mid1Lo : Int = mid1.to_int()
  let mid1Hi : Int = mid1.lsr(32L).to_int()
  let mid2 : Int64 = b01 + Int64::extend_i32_u(mid1Lo)
  let mid2Lo : Int = mid2.to_int()
  let mid2Hi : Int = mid2.lsr(32L).to_int()
  let pHi : Int64 = b11 + Int64::extend_i32_u(mid1Hi) + Int64::extend_i32_u(
      mid2Hi,
    )
  let pLo : Int64 = Int64::extend_i32_u(mid2Lo).lsl(32L).lor(
    Int64::extend_i32_u(b00Lo),
  )
  (pLo, pHi)
}

fn shiftright128(lo : Int64, hi : Int64, dist : Int) -> Int64 {
  hi.lsl(64L - Int64::extend_i32_u(dist)).lor(lo.lsr(Int64::extend_i32_u(dist)))
}

fn pow5Factor(value : Int64) -> Int {
  // We want to find the largest power of 5 that divides value.
  if value % 5L != 0L {
    return 0
  }
  if value % 25L != 0L {
    return 1
  }
  if value % 125L != 0L {
    return 2
  }
  if value % 625L != 0L {
    return 3
  }
  let mut count = 4
  let mut value = value / 625L
  while value > 0L {
    if value % 5L != 0L {
      return count
    }
    value = value / 5L
    count = count + 1
  }
  abort("IllegalArgumentException \\(value)")
}

fn multipleOfPowerOf5(value : Int64, p : Int) -> Bool {
  pow5Factor(value) >= p
}

fn multipleOfPowerOf2(value : Int64, p : Int) -> Bool {
  value.land(1L.lsl(p.to_int64()) - 1L) == 0L
}

fn mulShiftAll64(m : Int64, mul : (Int64, Int64), j : Int, mmShift : Bool) ->
     (Int64, Int64, Int64) {
  let m = m.lsl(1L)
  let (lo, tmp) = umul128(m, mul.0)
  let (lo2, hi2) = umul128(m, mul.1)
  let mid = tmp + lo2
  let hi = hi2 + u64_lt(mid, tmp).to_int64()
  let lo2 = lo + mul.0
  let mid2 = mid + mul.1 + u64_lt(lo2, lo).to_int64()
  let hi2 = hi + u64_lt(mid2, mid).to_int64()
  let vp = shiftright128(mid2, hi2, j - 64 - 1)
  let mut vm : Int64 = 0L
  if mmShift {
    let lo3 = lo - mul.0
    let mid3 = mid - mul.1 - u64_lt(lo, lo3).to_int64()
    let hi3 = hi - u64_lt(mid, mid3).to_int64()
    vm = shiftright128(mid3, hi3, j - 64 - 1)
  } else {
    let lo3 : Int64 = lo + lo
    let mid3 : Int64 = mid + mid + u64_lt(lo3, lo).to_int64()
    let hi3 : Int64 = hi + hi + u64_lt(mid3, mid).to_int64()
    let lo4 : Int64 = lo3 - mul.0
    let mid4 : Int64 = mid3 - mul.1 - u64_lt(lo3, lo4).to_int64()
    let hi4 : Int64 = hi3 - u64_lt(mid3, mid4).to_int64()
    vm = shiftright128(mid4, hi4, j - 64)
  }
  let vr = shiftright128(mid, hi, j - 64 - 1)
  (vr, vp, vm)
}

let gPOW5_TABLE_SIZE = 26

let gDOUBLE_POW5_INV_SPLIT2 : Array[Int64] = [
  1L,
  2305843009213693952L,
  5955668970331000884L,
  1784059615882449851L,
  8982663654677661702L,
  1380349269358112757L,
  7286864317269821294L,
  2135987035920910082L,
  7005857020398200553L,
  1652639921975621497L,
  -481418970354774919L,
  1278668206209430417L,
  8928596168509315048L,
  1978643211784836272L,
  -8371072500651252758L,
  1530901034580419511L,
  597001226353042382L,
  1184477304306571148L,
  1527430471115325346L,
  1832889850782397517L,
  -5913534206540532074L,
  1418129833677084982L,
  5577825024675947042L,
  2194449627517475473L,
  -7439769533505684065L,
  1697873161311732311L,
  -8133250842069730034L,
  1313665730009899186L,
  -5745727253942878843L,
  2032799256770390445L,
]

let gPOW5_INV_OFFSETS : Array[Int] = [
  1414808916,
  67458373,
  268701696,
  4195348,
  1073807360,
  1091917141,
  1108,
  65604,
  1073741824,
  1140850753,
  1346716752,
  1431634004,
  1365595476,
  1073758208,
  16777217,
  66816,
  1364284433,
  89478484,
  0,
]

let gDOUBLE_POW5_SPLIT2 : Array[Int64] = [
  0L,
  1152921504606846976L,
  0L,
  1490116119384765625L,
  1032610780636961552L,
  1925929944387235853L,
  7910200175544436838L,
  1244603055572228341L,
  -1504838264676837686L,
  1608611746708759036L,
  -5421850118411349444L,
  2079081953128979843L,
  6607496772837067824L,
  1343575221513417750L,
  -1113817083813899013L,
  1736530273035216783L,
  -5409364890226003632L,
  2244412773384604712L,
  1605989338741628675L,
  1450417759929778918L,
  -8816519005292960336L,
  1874621017369538693L,
  665883850346957067L,
  1211445438634777304L,
  -3514853404985837908L,
  1565756531257009982L,
]

let gPOW5_OFFSETS : Array[Int] = [
  0,
  0,
  0,
  0,
  1073741824,
  1500076437,
  1431590229,
  1448432917,
  1091896580,
  1079333904,
  1146442053,
  1146111296,
  1163220304,
  1073758208,
  -1773927360,
  1431721317,
  1413824581,
  1075134801,
  1431671125,
  1363170645,
  261,
]

let gDOUBLE_POW5_TABLE : Array[Int64] = [
  1L,
  5L,
  25L,
  125L,
  625L,
  3125L,
  15625L,
  78125L,
  390625L,
  1953125L,
  9765625L,
  48828125L,
  244140625L,
  1220703125L,
  6103515625L,
  30517578125L,
  152587890625L,
  762939453125L,
  3814697265625L,
  19073486328125L,
  95367431640625L,
  476837158203125L,
  2384185791015625L,
  11920928955078125L,
  59604644775390625L,
  298023223876953125L,
]

fn double_computePow5(i : Int) -> (Int64, Int64) {
  let base : Int = i / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = i - base2
  let mul0 = gDOUBLE_POW5_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum : Int64 = high0 + low1
  let mut high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(i) - pow5bits(base2)
  let a = shiftright128(low0, sum, delta) + gPOW5_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

fn double_computeInvPow5(i : Int) -> (Int64, Int64) {
  let base : Int = (i + gPOW5_TABLE_SIZE - 1) / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = base2 - i
  let mul0 = gDOUBLE_POW5_INV_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_INV_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum = high0 + low1
  let mut high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(base2) - pow5bits(i)
  let a = shiftright128(low0, sum, delta) + 1L + gPOW5_INV_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

let gDOUBLE_MANTISSA_BITS : Int = 52

let gDOUBLE_EXPONENT_BITS : Int = 11

let gDOUBLE_BIAS : Int = 1023

let gDOUBLE_POW5_INV_BITCOUNT : Int = 125

let gDOUBLE_POW5_BITCOUNT : Int = 125

fn assert(b : Bool, msg : String) -> Unit {
  if not(b) {
    abort("assert failed: \\(msg)\\n")
  }
}

fn decimalLength17(v : Int64) -> Int {
  // This is slightly faster than a loop.
  // The average output length is 16.38 digits, so we check high-to-low.
  // Function precondition: v is not an 18, 19, or 20-digit number.
  // (17 digits are sufficient for round-tripping.)
  assert(v < 100000000000000000L, "v < 100000000000000000L")
  if v >= 10000000000000000L {
    return 17
  }
  if v >= 1000000000000000L {
    return 16
  }
  if v >= 100000000000000L {
    return 15
  }
  if v >= 10000000000000L {
    return 14
  }
  if v >= 1000000000000L {
    return 13
  }
  if v >= 100000000000L {
    return 12
  }
  if v >= 10000000000L {
    return 11
  }
  if v >= 1000000000L {
    return 10
  }
  if v >= 100000000L {
    return 9
  }
  if v >= 10000000L {
    return 8
  }
  if v >= 1000000L {
    return 7
  }
  if v >= 100000L {
    return 6
  }
  if v >= 10000L {
    return 5
  }
  if v >= 1000L {
    return 4
  }
  if v >= 100L {
    return 3
  }
  if v >= 10L {
    return 2
  }
  return 1
}

// A floating decimal representing m * 10^e.
priv struct FloatingDecimal64 {
  mantissa : Int64
  // Decimal exponent's range is -324 to 308
  // inclusive, and can fit in a short if needed.
  exponent : Int
}

fn to_string(self : FloatingDecimal64) -> String {
  let m = self.mantissa
  let e = self.exponent
  "{ mantissa: \\(m), exponent: \\(e) }"
}

fn d2d(ieeeMantissa : Int64, ieeeExponent : Int) -> FloatingDecimal64 {
  let mut e2 : Int = 0
  let mut m2 : Int64 = 0L
  if ieeeExponent == 0 {
    e2 = 1 - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = ieeeMantissa
  } else {
    e2 = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  }
  let even = m2.land(1L) == 0L
  let acceptBounds = even

  // Step 2: Determine the interval of valid decimal representations.
  let mv = 4L * m2
  // Implicit bool -> int conversion. True is 1, false is 0.
  let mmShift = ieeeMantissa != 0L || ieeeExponent <= 1
  // We would compute mp and mm like this:
  // uint64_t mp = 4 * m2 + 2;
  // uint64_t mm = mv - 1 - mmShift;

  // Step 3: Convert to a decimal power base using 128-bit arithmetic.
  let mut vr : Int64 = 0L
  let mut vp : Int64 = 0L
  let mut vm : Int64 = 0L
  let mut e10 : Int = 0
  let mut vmIsTrailingZeros = false
  let mut vrIsTrailingZeros = false
  if e2 >= 0 {
    // I tried special-casing q == 0, but there was no effect on performance.
    // This expression is slightly faster than max(0, log10Pow2(e2) - 1).
    let q : Int = log10Pow2(e2) - (e2 > 3).to_int()
    e10 = q
    let k = gDOUBLE_POW5_INV_BITCOUNT + pow5bits(q) - 1
    let i = -e2 + q + k
    let pow5 = double_computeInvPow5(q)
    let vs = mulShiftAll64(m2, pow5, i, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 21 {
      // This should use q <= 22, but I think 21 is also safe. Smaller values
      // may still be safe, but it's more difficult to reason about them.
      // Only one of mp, mv, and mm can be a multiple of 5, if any.
      let mvMod5 : Int = mv.to_int() - 5 * (mv / 5L).to_int()
      if mvMod5 == 0 {
        vrIsTrailingZeros = multipleOfPowerOf5(mv, q)
      } else if acceptBounds {
        // Same as min(e2 + (~mm & 1), pow5Factor(mm)) >= q
        // <=> e2 + (~mm & 1) >= q && pow5Factor(mm) >= q
        // <=> true && pow5Factor(mm) >= q, since e2 >= q.
        vmIsTrailingZeros = multipleOfPowerOf5(mv - 1L - mmShift.to_int64(), q)
      } else {
        vp = vp - multipleOfPowerOf5(mv + 2L, q).to_int64()
      }
    }
  } else {
    // This expression is slightly faster than max(0, log10Pow5(-e2) - 1).
    let q : Int = log10Pow5(-e2) - (-e2 > 1).to_int()
    e10 = q + e2
    let i : Int = -e2 - q
    let k = pow5bits(i) - gDOUBLE_POW5_BITCOUNT
    let j = q - k
    let pow5 = double_computePow5(i)
    let vs = mulShiftAll64(m2, pow5, j, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 1 {
      // {vr,vp,vm} is trailing zeros if {mv,mp,mm} has at least q trailing 0 bits.
      // mv = 4 * m2, so it always has at least two trailing 0 bits.
      vrIsTrailingZeros = true
      if acceptBounds {
        vmIsTrailingZeros = mmShift.to_int() == 1
      } else {
        vp = vp - 1L
      }
    } else if q < 63 {
      vrIsTrailingZeros = multipleOfPowerOf2(mv, q)
    }
  }

  // Step 4: Find the shortest decimal representation in the interval of valid representations.
  let mut removed : Int = 0
  let mut lastRemovedDigit : Int = 0
  let mut output : Int64 = 0L
  // On average, we remove ~2 digits.
  if vmIsTrailingZeros || vrIsTrailingZeros {
    // General case, which happens rarely (~0.7%).
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      vmIsTrailingZeros = vmIsTrailingZeros && vmMod10 == 0
      vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
      lastRemovedDigit = vrMod10
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    if vmIsTrailingZeros {
      while true {
        let vmDiv10 : Int64 = vm / 10L
        let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
        if vmMod10 != 0 {
          break
        }
        let vpDiv10 : Int64 = vp / 10L
        let vrDiv10 : Int64 = vr / 10L
        let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
        vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
        lastRemovedDigit = vrMod10
        vr = vrDiv10
        vp = vpDiv10
        vm = vmDiv10
        removed = removed + 1
      }
    }
    if vrIsTrailingZeros && lastRemovedDigit == 5 && vr % 2L == 0L {
      lastRemovedDigit = 4
    }
    output = vr + (vr == vm && (not(acceptBounds) || not(vmIsTrailingZeros)) || lastRemovedDigit >=
    5).to_int64()
  } else {
    // Specialized for the common case (~99.3%). Percentages below are relative to this.
    let mut roundUp = false
    let vpDiv100 : Int64 = vp / 100L
    let vmDiv100 : Int64 = vm / 100L
    if vpDiv100 > vmDiv100 {
      let vrDiv100 : Int64 = vr / 100L
      let vrMod100 : Int = vr.to_int() - 100 * vrDiv100.to_int()
      roundUp = vrMod100 >= 50
      vr = vrDiv100
      vp = vpDiv100
      vm = vmDiv100
      removed = removed + 2
    }
    // Loop iterations below (approximately), without optimization above:
    // 0: 0.03%, 1: 13.8%, 2: 70.6%, 3: 14.0%, 4: 1.40%, 5: 0.14%, 6+: 0.02%
    // Loop iterations below (approximately), with optimization above:
    // 0: 70.6%, 1: 27.8%, 2: 1.40%, 3: 0.14%, 4+: 0.02%
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      roundUp = vrMod10 >= 5
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    output = vr + (vr == vm || roundUp).to_int64()
  }
  let exp : Int = e10 + removed
  let fd = { mantissa: output, exponent: exp }
  fd
}

fn to_chars(v : FloatingDecimal64, sign : Bool) -> String {
  // Step 5: Print the decimal representation.
  let result = Bytes::make(24, 0)
  let mut index : Int = 0
  if sign {
    result[index] = '-'.to_int()
    index = index + 1
  }
  let mut output : Int64 = v.mantissa
  let olength : Int = decimalLength17(output)
  let mut exp : Int = v.exponent + olength - 1
  let scientificNotation = not(exp >= -3 && exp < 7)
  if scientificNotation {
    // Print the decimal digits.
    let mut i = 0
    while i < olength - 1, i = i + 1 {
      let c = output % 10L
      output = output / 10L
      result[index + olength - i] = '0'.to_int() + c.to_int()
    }
    result[index] = '0'.to_int() + output.to_int() % 10

    // Always print point
    result[index + 1] = '.'.to_int()
    index = index + olength + 1
    if olength == 1 {
      result[index] = '0'.to_int()
      index = index + 1
    }

    // Print the exponent.
    result[index] = 'e'.to_int()
    index = index + 1
    if exp < 0 {
      result[index] = '-'.to_int()
      index = index + 1
      exp = -exp
    }
    if exp >= 100 {
      let a = exp / 100
      let b = exp / 10 % 10
      let c = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      result[index + 2] = '0'.to_int() + c
      index = index + 3
    } else if exp >= 10 {
      let a = exp / 10
      let b = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      index = index + 2
    } else {
      result[index] = '0'.to_int() + exp
      index = index + 1
    }
    string_from_bytes(result, 0, index)
  } else {
    if exp < 0 {
      // Decimal dot is before any of the digits.
      result[index] = '0'.to_int()
      index = index + 1
      result[index] = '.'.to_int()
      index = index + 1
      let mut i = -1
      while i > exp, i = i - 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      let current = index
      let mut i = 0
      while i < olength, i = i + 1 {
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
        index = index + 1
      }
    } else if exp + 1 >= olength {
      // Decimal dot is after any of the digits.
      let mut i = 0
      while i < olength, i = i + 1 {
        result[index + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength
      let mut i = olength
      while i < exp + 1, i = i + 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      result[index] = '.'.to_int()
      index = index + 1
      result[index] = '0'.to_int()
      index = index + 1
    } else {
      // Decimal dot is somewhere between the digits.
      let mut current = index + 1
      let mut i = 0
      while i < olength, i = i + 1 {
        if olength - i - 1 == exp {
          result[current + olength - i - 1] = '.'.to_int()
          current = current - 1
        }
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength + 1
    }
    return string_from_bytes(result, 0, index)
  }
}

fn d2d_small_int(ieeeMantissa : Int64, ieeeExponent : Int) ->
     Option[FloatingDecimal64] {
  let m2 : Int64 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  let e2 : Int = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS
  if e2 > 0 {
    return None
  }
  if e2 < -52 {
    return None
  }
  let mask : Int64 = 1L.lsl(-e2.to_int64()) - 1L
  let fraction : Int64 = m2.land(mask)
  if fraction != 0L {
    return None
  }
  Some({ mantissa: m2.lsr(-e2.to_int64()), exponent: 0 })
}

fn double_to_string(f : Double) -> String {
  // Step 1: Decode the floating-point number, and unify normalized and subnormal cases.
  let bits : Int64 = f.reinterpret_as_i64()

  // Decode bits into sign, mantissa, and exponent.
  let ieeeSign = bits.lsr(
      gDOUBLE_MANTISSA_BITS.to_int64() + gDOUBLE_EXPONENT_BITS.to_int64(),
    ).land(1L) != 0L
  let ieeeMantissa : Int64 = bits.land(
    1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()) - 1L,
  )
  let ieeeExponent : Int = bits.lsr(gDOUBLE_MANTISSA_BITS.to_int64()).land(
    1L.lsl(gDOUBLE_EXPONENT_BITS.to_int64()) - 1L,
  ).to_int()
  if ieeeExponent == (1).lsl(gDOUBLE_EXPONENT_BITS) - 1 || ieeeExponent == 0 && ieeeMantissa ==
  0L {
    return copy_special_str(
      ieeeSign,
      ieeeExponent.to_bool(),
      ieeeMantissa.to_bool(),
    )
  }
  let mut v : FloatingDecimal64 = { mantissa: 0L, exponent: 0 }
  let small = d2d_small_int(ieeeMantissa, ieeeExponent)
  match small {
    Some(f) => {
      let mut x = f
      while true {
        let q : Int64 = x.mantissa / 10L
        let r = x.mantissa.to_int() - 10 * q.to_int()
        if r != 0 {
          break
        }
        x = { mantissa: q, exponent: x.exponent + 1 }
      }
      v = x
    }
    None => {
      v = d2d(ieeeMantissa, ieeeExponent)
    }
  }
  to_chars(v, ieeeSign)
}

`,stat:{type:1,mtime:17071211961691667e-4,ctime:17071211961691667e-4,size:20238}});Qe.set("/string.mbt",{content:`
pub fn compare(self: String, other: String) -> Int {
  let len = self.length() 
  match len.compare(other.length()) {
    0 => {
      let mut i = 0
      while i < len, i = i + 1 {
        let order = self[i].compare(other[i])
        if order != 0 {
          return order
        }
      }
      0
    }
    order => order
  }
}

pub fn String::default() -> String { "" }
`,stat:{type:1,mtime:1707121196169349e-3,ctime:1707121196169349e-3,size:376}});Qe.set("/unit.mbt",{content:`
pub fn to_string(self: Unit) -> String {
  let _ = self  
  "()"
}

pub fn op_equal(self: Unit, _other: Unit) -> Bool {
  let _ = self    
  true
}

pub fn compare(self: Unit, _other: Unit) -> Int {
  let _ = self    
  0
}

pub fn hash(self: Unit) -> Int {
  let _ = self    
  0
}

pub fn Unit::default() -> Unit {  
  ()
}
`,stat:{type:1,mtime:17071211961695388e-4,ctime:17071211961695388e-4,size:327}});Qe.set("/xxhash.mbt",{content:`let gPRIME1 = -1640531535

let gPRIME2 = -2048144777

let gPRIME3 = -1028477379

let gPRIME4 = 668265263

let gPRIME5 = 374761393

fn xxhash32(input : Bytes, seed : Int) -> Int {
  let len = input.length()
  let h = if len >= 16 {
      h16bytes(input, 0, len, seed)
    } else {
      seed + gPRIME5
    } + len
  finalize(h, input, len.land(-16), len.land(0xF))
}

pub fn to_bytes(self : String) -> Bytes {
  let len = self.length()
  let buf = Bytes::make(len, 0)
  let mut i = 0
  while i < len, i = i + 1 {
    buf[i] = self[i].to_int()
  }
  buf
}

pub fn hash(self : Bool) -> Int {
  self.to_int()
}

pub fn hash(self : Char) -> Int {
  self.to_int()
}

pub fn hash(self : Int) -> Int {
  self
}

pub fn hash(self : Int64) -> Int {
  let lo = self.to_int()
  let hi = self.lsr(32L).to_int()
  lo.lxor(hi)
}

pub fn hash(self : Double) -> Int {
  self.reinterpret_as_i64().hash()
}

pub fn hash(self : String) -> Int {
  xxhash32(self.to_bytes(), 0)
}

pub fn hash(self : Bytes) -> Int {
  xxhash32(self, 0)
}

fn rotl(x : Int, r : Int) -> Int {
  x.lsl(r).lor(x.lsr(32 - r))
}

fn round(acc : Int, input : Int) -> Int {
  rotl(acc + input * gPRIME2, 13) * gPRIME1
}

fn avalanche_step(h : Int, rshift : Int, prime : Int) -> Int {
  h.lxor(h.lsr(rshift)) * prime
}

fn avalanche(h : Int) -> Int {
  avalanche_step(
    avalanche_step(avalanche_step(h, 15, gPRIME2), 13, gPRIME3),
    16,
    1,
  )
}

fn endian32(input : Bytes, cur : Int) -> Int {
  input[cur + 0].lor(
    input[cur + 1].lsl(8).lor(
      input[cur + 2].lsl(16).lor(input[cur + 3].lsl(24)),
    ),
  )
}

fn fetch32(input : Bytes, cur : Int, v : Int) -> Int {
  round(v, endian32(input, cur))
}

fn finalize(h : Int, input : Bytes, cur : Int, remain : Int) -> Int {
  if remain >= 4 {
    finalize(
      rotl(h + endian32(input, cur) * gPRIME3, 17) * gPRIME4,
      input,
      cur + 4,
      remain - 4,
    )
  } else if remain > 0 {
    finalize(
      rotl(h + input[cur] * gPRIME5, 11) * gPRIME1,
      input,
      cur + 1,
      remain - 1,
    )
  } else {
    avalanche(h)
  }
}

fn _h16bytes(input : Bytes, cur : Int, remain : Int, v1 : Int, v2 : Int,
        v3 : Int, v4 : Int) -> Int {
  if remain >= 16 {
    _h16bytes(
      input,
      cur + 16,
      remain - 16,
      fetch32(input, cur, v1),
      fetch32(input, cur + 4, v2),
      fetch32(input, cur + 8, v3),
      fetch32(input, cur + 12, v4),
    )
  } else {
    rotl(v1, 1) + rotl(v2, 7) + rotl(v3, 12) + rotl(v4, 18)
  }
}

fn h16bytes(input : Bytes, cur : Int, len : Int, seed : Int) -> Int {
  _h16bytes(
    input,
    cur,
    len,
    seed + gPRIME1 + gPRIME2,
    seed + gPRIME2,
    seed,
    seed - gPRIME1,
  )
}

`,stat:{type:1,mtime:17071211961695947e-4,ctime:17071211961695947e-4,size:2679}});var $d="moonbit",ky="Moonbit";var qy="moonbit-builtin";var Vd=class{constructor(){Ae(this,"_disposable");Ae(this,"_emmiter",new hn.EventEmitter);Ae(this,"onDidChangeFile",this._emmiter.event);this._disposable=hn.workspace.registerFileSystemProvider(Vd.scheme,this,{isReadonly:!0})}dispose(){this._disposable.dispose()}watch(e,t){return new hn.Disposable(()=>{})}stat(e){let t=Qe.get(e.fsPath);if(t===void 0)throw hn.FileSystemError.FileNotFound(e);return t.stat}readDirectory(e){return[...Qe.entries()].map(([t,r])=>[t,r.stat.type])}createDirectory(e){}readFile(e){let t=Qe.get(e.fsPath);if(t===void 0)throw hn.FileSystemError.FileNotFound(e);return new TextEncoder().encode(t.content)}writeFile(e,t,r){}delete(e,t){}rename(e,t,r){}},qs=Vd;Ae(qs,"scheme",qy);var Iy=new qs;var Ye=Un(require("vscode"));function Ey(n){try{return JSON.parse(n)}catch(e){console.error("parse moon.pkg.json",e);return}}function Oy(n){return JSON.stringify(n,null,2)}var Ni=Un(J()),Fy=new Ni.RequestType0("moonbit-lsp/mooncVersion"),Xd=new Ni.RequestType("moonbit-lsp/compile"),Ly=new Ni.RequestType("moonbit-lsp/watToWasm");async function Is(n){return await n.sendRequest(Fy)}async function My(n){let e=await Is(n);await Ye.window.showInformationMessage(`Current version is ${e}`,"copy hash")==="copy hash"&&await Ye.env.clipboard.writeText(e)}async function Ny(n,e,t){let r=Ye.Uri.parse(n),i=async()=>{let l=Ye.workspace.textDocuments.find(h=>h.uri.toString(!0)===r.toString(!0));if(l!==void 0)return l.getText();let f=await Ye.workspace.fs.readFile(r);return new TextDecoder().decode(f)},o=async l=>{let f=Ye.workspace.textDocuments.find(h=>h.uri.toString(!0)===r.toString(!0));if(f!==void 0){let h=new Ye.WorkspaceEdit;h.set(r,[new Ye.TextEdit(new Ye.Range(f.positionAt(0),f.positionAt(f.getText().length)),l)]),await Ye.workspace.applyEdit(h);return}await Ye.workspace.fs.writeFile(r,new TextEncoder().encode(l))},s=await i(),a=Ey(s);if(a===void 0||(a.import===void 0&&(a.import={}),a.import[e]!==void 0))return;a.import[e]=t;let u=Oy(a);await o(u)}var it=Un(require("vscode"));var Ay;(()=>{"use strict";var n={470:i=>{function o(u){if(typeof u!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(u))}function s(u,l){for(var f,h="",p=0,m=-1,g=0,b=0;b<=u.length;++b){if(b<u.length)f=u.charCodeAt(b);else{if(f===47)break;f=47}if(f===47){if(!(m===b-1||g===1))if(m!==b-1&&g===2){if(h.length<2||p!==2||h.charCodeAt(h.length-1)!==46||h.charCodeAt(h.length-2)!==46){if(h.length>2){var D=h.lastIndexOf("/");if(D!==h.length-1){D===-1?(h="",p=0):p=(h=h.slice(0,D)).length-1-h.lastIndexOf("/"),m=b,g=0;continue}}else if(h.length===2||h.length===1){h="",p=0,m=b,g=0;continue}}l&&(h.length>0?h+="/..":h="..",p=2)}else h.length>0?h+="/"+u.slice(m+1,b):h=u.slice(m+1,b),p=b-m-1;m=b,g=0}else f===46&&g!==-1?++g:g=-1}return h}var a={resolve:function(){for(var u,l="",f=!1,h=arguments.length-1;h>=-1&&!f;h--){var p;h>=0?p=arguments[h]:(u===void 0&&(u=process.cwd()),p=u),o(p),p.length!==0&&(l=p+"/"+l,f=p.charCodeAt(0)===47)}return l=s(l,!f),f?l.length>0?"/"+l:"/":l.length>0?l:"."},normalize:function(u){if(o(u),u.length===0)return".";var l=u.charCodeAt(0)===47,f=u.charCodeAt(u.length-1)===47;return(u=s(u,!l)).length!==0||l||(u="."),u.length>0&&f&&(u+="/"),l?"/"+u:u},isAbsolute:function(u){return o(u),u.length>0&&u.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var u,l=0;l<arguments.length;++l){var f=arguments[l];o(f),f.length>0&&(u===void 0?u=f:u+="/"+f)}return u===void 0?".":a.normalize(u)},relative:function(u,l){if(o(u),o(l),u===l||(u=a.resolve(u))===(l=a.resolve(l)))return"";for(var f=1;f<u.length&&u.charCodeAt(f)===47;++f);for(var h=u.length,p=h-f,m=1;m<l.length&&l.charCodeAt(m)===47;++m);for(var g=l.length-m,b=p<g?p:g,D=-1,k=0;k<=b;++k){if(k===b){if(g>b){if(l.charCodeAt(m+k)===47)return l.slice(m+k+1);if(k===0)return l.slice(m+k)}else p>b&&(u.charCodeAt(f+k)===47?D=k:k===0&&(D=0));break}var z=u.charCodeAt(f+k);if(z!==l.charCodeAt(m+k))break;z===47&&(D=k)}var j="";for(k=f+D+1;k<=h;++k)k!==h&&u.charCodeAt(k)!==47||(j.length===0?j+="..":j+="/..");return j.length>0?j+l.slice(m+D):(m+=D,l.charCodeAt(m)===47&&++m,l.slice(m))},_makeLong:function(u){return u},dirname:function(u){if(o(u),u.length===0)return".";for(var l=u.charCodeAt(0),f=l===47,h=-1,p=!0,m=u.length-1;m>=1;--m)if((l=u.charCodeAt(m))===47){if(!p){h=m;break}}else p=!1;return h===-1?f?"/":".":f&&h===1?"//":u.slice(0,h)},basename:function(u,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');o(u);var f,h=0,p=-1,m=!0;if(l!==void 0&&l.length>0&&l.length<=u.length){if(l.length===u.length&&l===u)return"";var g=l.length-1,b=-1;for(f=u.length-1;f>=0;--f){var D=u.charCodeAt(f);if(D===47){if(!m){h=f+1;break}}else b===-1&&(m=!1,b=f+1),g>=0&&(D===l.charCodeAt(g)?--g==-1&&(p=f):(g=-1,p=b))}return h===p?p=b:p===-1&&(p=u.length),u.slice(h,p)}for(f=u.length-1;f>=0;--f)if(u.charCodeAt(f)===47){if(!m){h=f+1;break}}else p===-1&&(m=!1,p=f+1);return p===-1?"":u.slice(h,p)},extname:function(u){o(u);for(var l=-1,f=0,h=-1,p=!0,m=0,g=u.length-1;g>=0;--g){var b=u.charCodeAt(g);if(b!==47)h===-1&&(p=!1,h=g+1),b===46?l===-1?l=g:m!==1&&(m=1):l!==-1&&(m=-1);else if(!p){f=g+1;break}}return l===-1||h===-1||m===0||m===1&&l===h-1&&l===f+1?"":u.slice(l,h)},format:function(u){if(u===null||typeof u!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof u);return function(l,f){var h=f.dir||f.root,p=f.base||(f.name||"")+(f.ext||"");return h?h===f.root?h+p:h+"/"+p:p}(0,u)},parse:function(u){o(u);var l={root:"",dir:"",base:"",ext:"",name:""};if(u.length===0)return l;var f,h=u.charCodeAt(0),p=h===47;p?(l.root="/",f=1):f=0;for(var m=-1,g=0,b=-1,D=!0,k=u.length-1,z=0;k>=f;--k)if((h=u.charCodeAt(k))!==47)b===-1&&(D=!1,b=k+1),h===46?m===-1?m=k:z!==1&&(z=1):m!==-1&&(z=-1);else if(!D){g=k+1;break}return m===-1||b===-1||z===0||z===1&&m===b-1&&m===g+1?b!==-1&&(l.base=l.name=g===0&&p?u.slice(1,b):u.slice(g,b)):(g===0&&p?(l.name=u.slice(1,m),l.base=u.slice(1,b)):(l.name=u.slice(g,m),l.base=u.slice(g,b)),l.ext=u.slice(m,b)),g>0?l.dir=u.slice(0,g-1):p&&(l.dir="/"),l},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,i.exports=a}},e={};function t(i){var o=e[i];if(o!==void 0)return o.exports;var s=e[i]={exports:{}};return n[i](s,s.exports,t),s.exports}t.d=(i,o)=>{for(var s in o)t.o(o,s)&&!t.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:o[s]})},t.o=(i,o)=>Object.prototype.hasOwnProperty.call(i,o),t.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var r={};(()=>{let i;t.r(r),t.d(r,{URI:()=>p,Utils:()=>Ue}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);let o=/^\w[\w\d+.-]*$/,s=/^\//,a=/^\/\//;function u(O,x){if(!O.scheme&&x)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${O.authority}", path: "${O.path}", query: "${O.query}", fragment: "${O.fragment}"}`);if(O.scheme&&!o.test(O.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(O.path){if(O.authority){if(!s.test(O.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(a.test(O.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let l="",f="/",h=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class p{constructor(x,L,N,ee,B,X=!1){Ae(this,"scheme");Ae(this,"authority");Ae(this,"path");Ae(this,"query");Ae(this,"fragment");typeof x=="object"?(this.scheme=x.scheme||l,this.authority=x.authority||l,this.path=x.path||l,this.query=x.query||l,this.fragment=x.fragment||l):(this.scheme=function(ze,ce){return ze||ce?ze:"file"}(x,X),this.authority=L||l,this.path=function(ze,ce){switch(ze){case"https":case"http":case"file":ce?ce[0]!==f&&(ce=f+ce):ce=f}return ce}(this.scheme,N||l),this.query=ee||l,this.fragment=B||l,u(this,X))}static isUri(x){return x instanceof p||!!x&&typeof x.authority=="string"&&typeof x.fragment=="string"&&typeof x.path=="string"&&typeof x.query=="string"&&typeof x.scheme=="string"&&typeof x.fsPath=="string"&&typeof x.with=="function"&&typeof x.toString=="function"}get fsPath(){return z(this,!1)}with(x){if(!x)return this;let{scheme:L,authority:N,path:ee,query:B,fragment:X}=x;return L===void 0?L=this.scheme:L===null&&(L=l),N===void 0?N=this.authority:N===null&&(N=l),ee===void 0?ee=this.path:ee===null&&(ee=l),B===void 0?B=this.query:B===null&&(B=l),X===void 0?X=this.fragment:X===null&&(X=l),L===this.scheme&&N===this.authority&&ee===this.path&&B===this.query&&X===this.fragment?this:new g(L,N,ee,B,X)}static parse(x,L=!1){let N=h.exec(x);return N?new g(N[2]||l,ae(N[4]||l),ae(N[5]||l),ae(N[7]||l),ae(N[9]||l),L):new g(l,l,l,l,l)}static file(x){let L=l;if(i&&(x=x.replace(/\\/g,f)),x[0]===f&&x[1]===f){let N=x.indexOf(f,2);N===-1?(L=x.substring(2),x=f):(L=x.substring(2,N),x=x.substring(N)||f)}return new g("file",L,x,l,l)}static from(x){let L=new g(x.scheme,x.authority,x.path,x.query,x.fragment);return u(L,!0),L}toString(x=!1){return j(this,x)}toJSON(){return this}static revive(x){if(x){if(x instanceof p)return x;{let L=new g(x);return L._formatted=x.external,L._fsPath=x._sep===m?x.fsPath:null,L}}return x}}let m=i?1:void 0;class g extends p{constructor(){super(...arguments);Ae(this,"_formatted",null);Ae(this,"_fsPath",null)}get fsPath(){return this._fsPath||(this._fsPath=z(this,!1)),this._fsPath}toString(L=!1){return L?j(this,!0):(this._formatted||(this._formatted=j(this,!1)),this._formatted)}toJSON(){let L={$mid:1};return this._fsPath&&(L.fsPath=this._fsPath,L._sep=m),this._formatted&&(L.external=this._formatted),this.path&&(L.path=this.path),this.scheme&&(L.scheme=this.scheme),this.authority&&(L.authority=this.authority),this.query&&(L.query=this.query),this.fragment&&(L.fragment=this.fragment),L}}let b={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function D(O,x,L){let N,ee=-1;for(let B=0;B<O.length;B++){let X=O.charCodeAt(B);if(X>=97&&X<=122||X>=65&&X<=90||X>=48&&X<=57||X===45||X===46||X===95||X===126||x&&X===47||L&&X===91||L&&X===93||L&&X===58)ee!==-1&&(N+=encodeURIComponent(O.substring(ee,B)),ee=-1),N!==void 0&&(N+=O.charAt(B));else{N===void 0&&(N=O.substr(0,B));let ze=b[X];ze!==void 0?(ee!==-1&&(N+=encodeURIComponent(O.substring(ee,B)),ee=-1),N+=ze):ee===-1&&(ee=B)}}return ee!==-1&&(N+=encodeURIComponent(O.substring(ee))),N!==void 0?N:O}function k(O){let x;for(let L=0;L<O.length;L++){let N=O.charCodeAt(L);N===35||N===63?(x===void 0&&(x=O.substr(0,L)),x+=b[N]):x!==void 0&&(x+=O[L])}return x!==void 0?x:O}function z(O,x){let L;return L=O.authority&&O.path.length>1&&O.scheme==="file"?`//${O.authority}${O.path}`:O.path.charCodeAt(0)===47&&(O.path.charCodeAt(1)>=65&&O.path.charCodeAt(1)<=90||O.path.charCodeAt(1)>=97&&O.path.charCodeAt(1)<=122)&&O.path.charCodeAt(2)===58?x?O.path.substr(1):O.path[1].toLowerCase()+O.path.substr(2):O.path,i&&(L=L.replace(/\//g,"\\")),L}function j(O,x){let L=x?k:D,N="",{scheme:ee,authority:B,path:X,query:ze,fragment:ce}=O;if(ee&&(N+=ee,N+=":"),(B||ee==="file")&&(N+=f,N+=f),B){let pe=B.indexOf("@");if(pe!==-1){let st=B.substr(0,pe);B=B.substr(pe+1),pe=st.lastIndexOf(":"),pe===-1?N+=L(st,!1,!1):(N+=L(st.substr(0,pe),!1,!1),N+=":",N+=L(st.substr(pe+1),!1,!0)),N+="@"}B=B.toLowerCase(),pe=B.lastIndexOf(":"),pe===-1?N+=L(B,!1,!0):(N+=L(B.substr(0,pe),!1,!0),N+=B.substr(pe))}if(X){if(X.length>=3&&X.charCodeAt(0)===47&&X.charCodeAt(2)===58){let pe=X.charCodeAt(1);pe>=65&&pe<=90&&(X=`/${String.fromCharCode(pe+32)}:${X.substr(3)}`)}else if(X.length>=2&&X.charCodeAt(1)===58){let pe=X.charCodeAt(0);pe>=65&&pe<=90&&(X=`${String.fromCharCode(pe+32)}:${X.substr(2)}`)}N+=L(X,!0,!1)}return ze&&(N+="?",N+=L(ze,!1,!1)),ce&&(N+="#",N+=x?ce:D(ce,!1,!1)),N}function fe(O){try{return decodeURIComponent(O)}catch{return O.length>3?O.substr(0,3)+fe(O.substr(3)):O}}let K=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function ae(O){return O.match(K)?O.replace(K,x=>fe(x)):O}var W=t(470);let G=W.posix||W,ne="/";var Ue;(function(O){O.joinPath=function(x,...L){return x.with({path:G.join(x.path,...L)})},O.resolvePath=function(x,...L){let N=x.path,ee=!1;N[0]!==ne&&(N=ne+N,ee=!0);let B=G.resolve(N,...L);return ee&&B[0]===ne&&!x.authority&&(B=B.substring(1)),x.with({path:B})},O.dirname=function(x){if(x.path.length===0||x.path===ne)return x;let L=G.dirname(x.path);return L.length===1&&L.charCodeAt(0)===46&&(L=""),x.with({path:L})},O.basename=function(x){return G.basename(x.path)},O.extname=function(x){return G.extname(x.path)}})(Ue||(Ue={}))})(),Ay=r})();var{URI:pS,Utils:Fn}=Ay;var Es=Un(require("vscode"));async function jy(n){try{return(await Es.workspace.fs.stat(n)).type===Es.FileType.File}catch{return!1}}var Ln=Un(require("vscode")),Gw="https://snippet.moonbitlang.com/report";async function Zw(n,e,t){return await fetch(Gw,{method:"Put",headers:{"Content-Type":"application/json"},body:JSON.stringify({snippet:n,msg:e,version:t})})}async function Jd(n,e,t,r){if(e.kind==="package"||!(n.globalState.get("isWillingUpload")??!0))return;let o=await Ln.window.showInformationMessage("Oops, there is a bug in MoonBit compiler",{modal:!0,detail:`${t}
To improve MoonBit's performance, we need your help.
By clicking "Yes", you agree to send the code and error message to our server. Your data will be used only for internal development, and we'll keep it confidential.`},"Yes"),s=await Ln.workspace.fs.readFile(e.programUri),a=new TextDecoder().decode(s);if(o==="Yes"){let u=await Ln.window.withProgress({location:Ln.ProgressLocation.Notification,title:"Uploading",cancellable:!1},async()=>await Zw(a,t,r));await Ln.window.showInformationMessage(u.ok?"Upload Success":"Upload Failed")}else await n.globalState.update("isWillingUpload",!1)}var Hy=()=>{let n=[0,97,115,109,1,0,0,0,1,5,1,95,1,120,0];return WebAssembly.validate(new Uint8Array(n))},Os=class{constructor(e,t){Ae(this,"_client");Ae(this,"_outputChannel");Ae(this,"_wasmRunnerUri");Ae(this,"_wasmRunner");Ae(this,"_startTime");Ae(this,"_endTime");Ae(this,"_context");this._context=e,this._client=t,this._outputChannel=it.window.createOutputChannel("Output","moonbit-output"),this._wasmRunnerUri=Fn.joinPath(e.extensionUri,"browser","wasm-runner.js"),this._wasmRunner=null,this._startTime=new Date,this._endTime=new Date}async _updateRunningState(){await it.commands.executeCommand("setContext","moonbit.codeRunning",this._wasmRunner!==null)}async dispose(){this._wasmRunner?.terminate(),this._wasmRunner=null,await this._updateRunningState()}async _getProgramType(e){let t=Fn.dirname(e),r=Fn.joinPath(t,"moon.pkg.json");if(await jy(r)){let o=await it.workspace.fs.readDirectory(t).then(s=>s.filter(([a,u])=>u===it.FileType.File&&a.endsWith(".mbt")).map(([a])=>Fn.joinPath(t,a).toString(!0)));return{kind:"package",pkgUri:t,uris:o}}else return{kind:"single",programUri:e}}async _compile(e){let t,r=o=>o.filter(s=>s.message.includes("Compiler Internal Error")),i=o=>o.filter(s=>s.severity==="Error").map((s,a)=>`${a+1}: ${s.message}`).join(`
`);switch(e.kind){case"package":{t=await this._client.sendRequest(Xd,{uris:e.uris,options:{wasmGc:Hy()}});break}case"single":{let o=[e.programUri.toString(!0)];t=await this._client.sendRequest(Xd,{uris:o,options:{wasmGc:Hy()}});break}}if(t.wat===null){let o=r(t.reports),s=await Is(this._client);this._error(`Compilation failed due to following errors:
${i(t.reports)}`),o.length>0&&await Jd(this._context,e,i(o),s)}return t}async _watToWasm(e){return await this._client.sendRequest(Ly,e)}async compileToFile(e,t){let{fileExt:r,silent:i=!1}=t,o=e??it.window.activeTextEditor?.document.uri;o===void 0&&await it.window.showInformationMessage("You did not open a Moonbit document"),this._outputChannel.clear();let s=await this._getProgramType(o),a=await this._compile(s);if(a.wat===null)return;let u=s.kind==="package"?Fn.joinPath(s.pkgUri,`moon.${r}`):it.Uri.parse(o.toString(!0).slice(0,-3)+r),l=r==="wat"?new TextEncoder().encode(a.wat):(await this._watToWasm({wat:a.wat})).wasm;await it.workspace.fs.writeFile(u,l),i||this._outputChannel.show(),this._info(`Compiled to ${u.toString()} in ${a.timeCost}ms`)}async _getRuntime(e){let t;switch(e.kind){case"package":t=e.pkgUri;break;case"single":t=Fn.dirname(e.programUri);break}let r=Fn.joinPath(t,"runtime.js"),i;try{i=await it.workspace.fs.readFile(r)}catch{return"export default {}"}return new TextDecoder().decode(i)}_info(e){let t=e.split(`
`).map(r=>r!==""?`[INFO] ${r}`:r);this._outputChannel.appendLine(t.join(`
`))}_error(e){let t=e.split(`
`).map(r=>r!==""?`[ERROR] ${r}`:r);this._outputChannel.show(),this._outputChannel.appendLine(t.join(`
`))}_warn(e){let t=e.split(`
`).map(r=>r!==""?`[WARN] ${r}`:r);this._outputChannel.show(),this._outputChannel.appendLine(t.join(`
`))}_log(e){this._outputChannel.show(),this._outputChannel.append(e)}async run(e){if(this._wasmRunner!==null){await it.window.showInformationMessage("One MoonBit program is running, stop it and run again");return}let t=e??it.window.activeTextEditor?.document.uri;if(t===void 0){await it.window.showInformationMessage("You did not open a Moonbit document");return}this._outputChannel.clear();let r=await this._getProgramType(t),i=await this._compile(r);if(i.wat===null)return;let{wasm:o}=await this._watToWasm({wat:i.wat});this._info(`====== Compilation Statistics ======
Wasm size: ${o.length}B
Time cost: ${i.timeCost}ms
---
`);let s=await this._getRuntime(r),a=URL.createObjectURL(new Blob([s],{type:"application/javascript"}));this._wasmRunner=new Worker(this._wasmRunnerUri.toString());let u=[],l=()=>{let h=new Uint8Array(u);u=[],this._log(new TextDecoder().decode(h))};this._wasmRunner.postMessage({runtimeURL:a,wasm:o}),await this._updateRunningState();let f=await Is(this._client);this._wasmRunner.onmessage=async h=>{if(typeof h.data=="number")u.push(h.data),h.data===10&&l();else switch(h.data.kind){case"start":this._startTime=new Date;break;case"over":l(),await this.stop();break;case"warn":this._warn(h.data.message);break;case"error":l(),this._error(h.data.message),await this.stop();break;case"internal":l(),this._error(h.data.message),await this.stop(),await Jd(this._context,r,h.data.message,f);break}}}async stop(e=!1){e&&this._info("User Action: aborted"),this._endTime=new Date;let t=(this._endTime.getTime()-this._startTime.getTime())/1e3;this._wasmRunner?.terminate(),this._wasmRunner=null,await this._updateRunningState(),this._info(`program exited in ${t}s`)}};async function Qw(n){let e=ot.Uri.joinPath(n.extensionUri,"browser","lsp-server.js").toString(!0),t=new Worker(e),r={readFile:async h=>await ot.workspace.fs.readFile(ot.Uri.parse(h)),readDirectory:async h=>await ot.workspace.fs.readDirectory(ot.Uri.parse(h)),stat:async h=>await ot.workspace.fs.stat(ot.Uri.parse(h))},i=new MessageChannel;Ki(r,i.port1),t.postMessage({},[i.port2]);let o=new Uy.LanguageClient($d,ky,{documentSelector:[{language:$d}],synchronize:{fileEvents:[ot.workspace.createFileSystemWatcher("{**/*.mbt,**/target/check/packages.json,**/target/check/**/*.mi}")]}},t);n.subscriptions.push(o);let s=new Os(n,o),a=ot.commands.registerCommand("moonbit.run",async h=>{await s.run(h)}),u=ot.commands.registerCommand("moonbit.stop",async()=>{await s.stop(!0)}),l=ot.commands.registerCommand("moonbit.compile-to-wat",async(h,p)=>{await s.compileToFile(h,{fileExt:"wat",...p})}),f=ot.commands.registerCommand("moonbit.compile-to-wasm",async(h,p)=>{await s.compileToFile(h,{fileExt:"wasm",...p})});n.subscriptions.push(a,u,l,f,s),n.subscriptions.push(ot.commands.registerCommand("moonbit.packageAddImport",Ny)),n.subscriptions.push(Iy),n.subscriptions.push(ot.commands.registerCommand("moonbit.get-extension-version",async()=>{await My(o)})),await o.start()}
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
