"use strict";var Ay=Object.create;var Qr=Object.defineProperty;var jy=Object.getOwnPropertyDescriptor;var Hy=Object.getOwnPropertyNames;var Uy=Object.getPrototypeOf,Wy=Object.prototype.hasOwnProperty;var By=(n,e,t)=>e in n?Qr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ky=(n,e)=>()=>(n&&(e=n(n=0)),e);var P=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Kd=(n,e)=>{for(var t in e)Qr(n,t,{get:e[t],enumerable:!0})},$d=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Hy(e))!Wy.call(n,i)&&i!==t&&Qr(n,i,{get:()=>e[i],enumerable:!(r=jy(e,i))||r.enumerable});return n};var Un=(n,e,t)=>(t=n!=null?Ay(Uy(n)):{},$d(e||!n||!n.__esModule?Qr(t,"default",{value:n,enumerable:!0}):t,n)),Ni=n=>$d(Qr({},"__esModule",{value:!0}),n);var vn=(n,e,t)=>(By(n,typeof e!="symbol"?e+"":e,t),t);var ar=P(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.stringArray=it.array=it.func=it.error=it.number=it.string=it.boolean=void 0;function $y(n){return n===!0||n===!1}it.boolean=$y;function zd(n){return typeof n=="string"||n instanceof String}it.string=zd;function zy(n){return typeof n=="number"||n instanceof Number}it.number=zy;function Vy(n){return n instanceof Error}it.error=Vy;function Xy(n){return typeof n=="function"}it.func=Xy;function Vd(n){return Array.isArray(n)}it.array=Vd;function Jy(n){return Vd(n)&&n.every(e=>zd(e))}it.stringArray=Jy});var Qs=P(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.Message=U.NotificationType9=U.NotificationType8=U.NotificationType7=U.NotificationType6=U.NotificationType5=U.NotificationType4=U.NotificationType3=U.NotificationType2=U.NotificationType1=U.NotificationType0=U.NotificationType=U.RequestType9=U.RequestType8=U.RequestType7=U.RequestType6=U.RequestType5=U.RequestType4=U.RequestType3=U.RequestType2=U.RequestType1=U.RequestType=U.RequestType0=U.AbstractMessageSignature=U.ParameterStructures=U.ResponseError=U.ErrorCodes=void 0;var Wn=ar(),Ps;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Ps||(U.ErrorCodes=Ps={}));var Gr=class extends Error{constructor(e,t,r){super(t),this.code=Wn.number(e)?e:Ps.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,Gr.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};U.ResponseError=Gr;var Xe=class{constructor(e){this.kind=e}static is(e){return e===Xe.auto||e===Xe.byName||e===Xe.byPosition}toString(){return this.kind}};U.ParameterStructures=Xe;Xe.auto=new Xe("auto");Xe.byPosition=new Xe("byPosition");Xe.byName=new Xe("byName");var qe=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Xe.auto}};U.AbstractMessageSignature=qe;var qs=class extends qe{constructor(e){super(e,0)}};U.RequestType0=qs;var ks=class extends qe{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.RequestType=ks;var Is=class extends qe{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.RequestType1=Is;var Es=class extends qe{constructor(e){super(e,2)}};U.RequestType2=Es;var Os=class extends qe{constructor(e){super(e,3)}};U.RequestType3=Os;var Fs=class extends qe{constructor(e){super(e,4)}};U.RequestType4=Fs;var Ls=class extends qe{constructor(e){super(e,5)}};U.RequestType5=Ls;var Ms=class extends qe{constructor(e){super(e,6)}};U.RequestType6=Ms;var Ns=class extends qe{constructor(e){super(e,7)}};U.RequestType7=Ns;var As=class extends qe{constructor(e){super(e,8)}};U.RequestType8=As;var js=class extends qe{constructor(e){super(e,9)}};U.RequestType9=js;var Hs=class extends qe{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.NotificationType=Hs;var Us=class extends qe{constructor(e){super(e,0)}};U.NotificationType0=Us;var Ws=class extends qe{constructor(e,t=Xe.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};U.NotificationType1=Ws;var Bs=class extends qe{constructor(e){super(e,2)}};U.NotificationType2=Bs;var Ks=class extends qe{constructor(e){super(e,3)}};U.NotificationType3=Ks;var $s=class extends qe{constructor(e){super(e,4)}};U.NotificationType4=$s;var zs=class extends qe{constructor(e){super(e,5)}};U.NotificationType5=zs;var Vs=class extends qe{constructor(e){super(e,6)}};U.NotificationType6=Vs;var Xs=class extends qe{constructor(e){super(e,7)}};U.NotificationType7=Xs;var Js=class extends qe{constructor(e){super(e,8)}};U.NotificationType8=Js;var Zs=class extends qe{constructor(e){super(e,9)}};U.NotificationType9=Zs;var Xd;(function(n){function e(i){let o=i;return o&&Wn.string(o.method)&&(Wn.string(o.id)||Wn.number(o.id))}n.isRequest=e;function t(i){let o=i;return o&&Wn.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Wn.string(o.id)||Wn.number(o.id)||o.id===null)}n.isResponse=r})(Xd||(U.Message=Xd={}))});var Ys=P(_n=>{"use strict";var Jd;Object.defineProperty(_n,"__esModule",{value:!0});_n.LRUCache=_n.LinkedMap=_n.Touch=void 0;var ot;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(ot||(_n.Touch=ot={}));var Ai=class{constructor(){this[Jd]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=ot.None){let r=this._map.get(e);if(r)return t!==ot.None&&this.touch(r,t),r.value}set(e,t,r=ot.None){let i=this._map.get(e);if(i)i.value=t,r!==ot.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case ot.None:this.addItemLast(i);break;case ot.First:this.addItemFirst(i);break;case ot.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Jd=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==ot.First&&t!==ot.Last)){if(t===ot.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===ot.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};_n.LinkedMap=Ai;var Gs=class extends Ai{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=ot.AsNew){return super.get(e,t)}peek(e){return super.get(e,ot.None)}set(e,t){return super.set(e,t,ot.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};_n.LRUCache=Gs});var Qd=P(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.Disposable=void 0;var Zd;(function(n){function e(t){return{dispose:t}}n.create=e})(Zd||(ji.Disposable=Zd={}))});var bn=P(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});var ea;function ta(){if(ea===void 0)throw new Error("No runtime abstraction layer installed");return ea}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");ea=t}n.install=e})(ta||(ta={}));na.default=ta});var lr=P(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.Emitter=ur.Event=void 0;var Zy=bn(),Gd;(function(n){let e={dispose(){}};n.None=function(){return e}})(Gd||(ur.Event=Gd={}));var ra=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,Zy.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},cr=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new ra),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=cr._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};ur.Emitter=cr;cr._noop=function(){}});var Wi=P(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.CancellationTokenSource=dr.CancellationToken=void 0;var Qy=bn(),Gy=ar(),ia=lr(),Hi;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ia.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ia.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||Gy.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Hi||(dr.CancellationToken=Hi={}));var Yy=Object.freeze(function(n,e){let t=(0,Qy.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Ui=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Yy:(this._emitter||(this._emitter=new ia.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},oa=class{get token(){return this._token||(this._token=new Ui),this._token}cancel(){this._token?this._token.cancel():this._token=Hi.Cancelled}dispose(){this._token?this._token instanceof Ui&&this._token.dispose():this._token=Hi.None}};dr.CancellationTokenSource=oa});var Yd=P(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.SharedArrayReceiverStrategy=fr.SharedArraySenderStrategy=void 0;var ev=Wi(),Yr;(function(n){n.Continue=0,n.Cancelled=1})(Yr||(Yr={}));var sa=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=Yr.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Yr.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};fr.SharedArraySenderStrategy=sa;var aa=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Yr.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},ca=class{constructor(e){this.token=new aa(e)}cancel(){}dispose(){}},ua=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new ev.CancellationTokenSource:new ca(t)}};fr.SharedArrayReceiverStrategy=ua});var da=P(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.Semaphore=void 0;var tv=bn(),la=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,tv.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Bi.Semaphore=la});var tf=P(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.ReadableStreamMessageReader=wn.AbstractMessageReader=wn.MessageReader=void 0;var ha=bn(),hr=ar(),fa=lr(),nv=da(),ef;(function(n){function e(t){let r=t;return r&&hr.func(r.listen)&&hr.func(r.dispose)&&hr.func(r.onError)&&hr.func(r.onClose)&&hr.func(r.onPartialMessage)}n.is=e})(ef||(wn.MessageReader=ef={}));var Ki=class{constructor(){this.errorEmitter=new fa.Emitter,this.closeEmitter=new fa.Emitter,this.partialMessageEmitter=new fa.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${hr.string(e.message)?e.message:"unknown"}`)}};wn.AbstractMessageReader=Ki;var pa;(function(n){function e(t){let r,i,o,s=new Map,a,u=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,s.set(o.name,o)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)s.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,u.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)u.set(l.name,l)}return a===void 0&&(a=(0,ha.default)().applicationJson.decoder,u.set(a.name,a)),{charset:r,contentDecoder:o,contentDecoders:s,contentTypeDecoder:a,contentTypeDecoders:u}}n.fromOptions=e})(pa||(pa={}));var ga=class extends Ki{constructor(e,t){super(),this.readable=e,this.options=pa.fromOptions(t),this.buffer=(0,ha.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new nv.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,ha.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};wn.ReadableStreamMessageReader=ga});var af=P(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.WriteableStreamMessageWriter=Cn.AbstractMessageWriter=Cn.MessageWriter=void 0;var nf=bn(),ei=ar(),rv=da(),rf=lr(),iv="Content-Length: ",of=`\r
`,sf;(function(n){function e(t){let r=t;return r&&ei.func(r.dispose)&&ei.func(r.onClose)&&ei.func(r.onError)&&ei.func(r.write)}n.is=e})(sf||(Cn.MessageWriter=sf={}));var $i=class{constructor(){this.errorEmitter=new rf.Emitter,this.closeEmitter=new rf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${ei.string(e.message)?e.message:"unknown"}`)}};Cn.AbstractMessageWriter=$i;var ma;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,nf.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,nf.default)().applicationJson.encoder}}n.fromOptions=e})(ma||(ma={}));var ya=class extends $i{constructor(e,t){super(),this.writable=e,this.options=ma.fromOptions(t),this.errorCount=0,this.writeSemaphore=new rv.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(iv,r.byteLength.toString(),of),i.push(of),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Cn.WriteableStreamMessageWriter=ya});var cf=P(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.AbstractMessageBuffer=void 0;var ov=13,sv=10,av=`\r
`,va=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){let l=this._chunks[r];i=0;t:for(;i<l.length;){switch(l[i]){case ov:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case sv:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=l.byteLength,r++}if(t!==4)return;let s=this._read(o+i),a=new Map,u=this.toString(s,"ascii").split(av);if(u.length<2)return a;for(let l=0;l<u.length-2;l++){let f=u[l],g=f.indexOf(":");if(g===-1)throw new Error(`Message header must separate key and value using ':'
${f}`);let p=f.substr(0,g),y=f.substr(g+1).trim();a.set(e?p.toLowerCase():p,y)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}};zi.AbstractMessageBuffer=va});var hf=P(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.createMessageConnection=G.ConnectionOptions=G.MessageStrategy=G.CancellationStrategy=G.CancellationSenderStrategy=G.CancellationReceiverStrategy=G.RequestCancellationReceiverStrategy=G.IdCancellationReceiverStrategy=G.ConnectionStrategy=G.ConnectionError=G.ConnectionErrors=G.LogTraceNotification=G.SetTraceNotification=G.TraceFormat=G.TraceValues=G.Trace=G.NullLogger=G.ProgressType=G.ProgressToken=void 0;var uf=bn(),Oe=ar(),z=Qs(),lf=Ys(),ti=lr(),_a=Wi(),ii;(function(n){n.type=new z.NotificationType("$/cancelRequest")})(ii||(ii={}));var ba;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(ba||(G.ProgressToken=ba={}));var ni;(function(n){n.type=new z.NotificationType("$/progress")})(ni||(ni={}));var wa=class{constructor(){}};G.ProgressType=wa;var Ca;(function(n){function e(t){return Oe.func(t)}n.is=e})(Ca||(Ca={}));G.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var ge;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(ge||(G.Trace=ge={}));var df;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(df||(G.TraceValues=df={}));(function(n){function e(r){if(!Oe.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(ge||(G.Trace=ge={}));var wt;(function(n){n.Text="text",n.JSON="json"})(wt||(G.TraceFormat=wt={}));(function(n){function e(t){return Oe.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(wt||(G.TraceFormat=wt={}));var Da;(function(n){n.type=new z.NotificationType("$/setTrace")})(Da||(G.SetTraceNotification=Da={}));var Vi;(function(n){n.type=new z.NotificationType("$/logTrace")})(Vi||(G.LogTraceNotification=Vi={}));var ri;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(ri||(G.ConnectionErrors=ri={}));var Dn=class extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,Dn.prototype)}};G.ConnectionError=Dn;var Sa;(function(n){function e(t){let r=t;return r&&Oe.func(r.cancelUndispatched)}n.is=e})(Sa||(G.ConnectionStrategy=Sa={}));var Xi;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&Oe.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Oe.func(r.dispose))}n.is=e})(Xi||(G.IdCancellationReceiverStrategy=Xi={}));var Ra;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&Oe.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Oe.func(r.dispose))}n.is=e})(Ra||(G.RequestCancellationReceiverStrategy=Ra={}));var Ji;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new _a.CancellationTokenSource}});function e(t){return Xi.is(t)||Ra.is(t)}n.is=e})(Ji||(G.CancellationReceiverStrategy=Ji={}));var Zi;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(ii.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&Oe.func(r.sendCancellation)&&Oe.func(r.cleanup)}n.is=e})(Zi||(G.CancellationSenderStrategy=Zi={}));var Qi;(function(n){n.Message=Object.freeze({receiver:Ji.Message,sender:Zi.Message});function e(t){let r=t;return r&&Ji.is(r.receiver)&&Zi.is(r.sender)}n.is=e})(Qi||(G.CancellationStrategy=Qi={}));var Gi;(function(n){function e(t){let r=t;return r&&Oe.func(r.handleMessage)}n.is=e})(Gi||(G.MessageStrategy=Gi={}));var ff;(function(n){function e(t){let r=t;return r&&(Qi.is(r.cancellationStrategy)||Sa.is(r.connectionStrategy)||Gi.is(r.messageStrategy))}n.is=e})(ff||(G.ConnectionOptions=ff={}));var Mt;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(Mt||(Mt={}));function cv(n,e,t,r){let i=t!==void 0?t:G.NullLogger,o=0,s=0,a=0,u="2.0",l,f=new Map,g,p=new Map,y=new Map,h,b=new lf.LinkedMap,D=new Map,q=new Set,K=new Map,j=ge.Off,fe=wt.Text,$,ae=Mt.New,W=new ti.Emitter,Z=new ti.Emitter,ne=new ti.Emitter,Ue=new ti.Emitter,O=new ti.Emitter,x=r&&r.cancellationStrategy?r.cancellationStrategy:Qi.Message;function L(v){if(v===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+v.toString()}function N(v){return v===null?"res-unknown-"+(++a).toString():"res-"+v.toString()}function ee(){return"not-"+(++s).toString()}function B(v,R){z.Message.isRequest(R)?v.set(L(R.id),R):z.Message.isResponse(R)?v.set(N(R.id),R):v.set(ee(),R)}function X(v){}function Ke(){return ae===Mt.Listening}function ce(){return ae===Mt.Closed}function he(){return ae===Mt.Disposed}function rt(){(ae===Mt.New||ae===Mt.Listening)&&(ae=Mt.Closed,Z.fire(void 0))}function Lt(v){W.fire([v,void 0,void 0])}function $r(v){W.fire(v)}n.onClose(rt),n.onError(Lt),e.onClose(rt),e.onError($r);function Mn(){h||b.size===0||(h=(0,uf.default)().timer.setImmediate(()=>{h=void 0,rr()}))}function Nn(v){z.Message.isRequest(v)?An(v):z.Message.isNotification(v)?gn(v):z.Message.isResponse(v)?pn(v):Vr(v)}function rr(){if(b.size===0)return;let v=b.shift();try{let R=r?.messageStrategy;Gi.is(R)?R.handleMessage(v,Nn):Nn(v)}finally{Mn()}}let zr=v=>{try{if(z.Message.isNotification(v)&&v.method===ii.type.method){let R=v.params.id,E=L(R),M=b.get(E);if(z.Message.isRequest(M)){let pe=r?.connectionStrategy,De=pe&&pe.cancelUndispatched?pe.cancelUndispatched(M,X):void 0;if(De&&(De.error!==void 0||De.result!==void 0)){b.delete(E),K.delete(R),De.id=M.id,en(De,v.method,Date.now()),e.write(De).catch(()=>i.error("Sending response for canceled message failed."));return}}let ye=K.get(R);if(ye!==void 0){ye.cancel(),tn(v);return}else q.add(R)}B(b,v)}finally{Mn()}};function An(v){if(he())return;function R(re,we,le){let Pe={jsonrpc:u,id:v.id};re instanceof z.ResponseError?Pe.error=re.toJson():Pe.result=re===void 0?null:re,en(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}function E(re,we,le){let Pe={jsonrpc:u,id:v.id,error:re.toJson()};en(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}function M(re,we,le){re===void 0&&(re=null);let Pe={jsonrpc:u,id:v.id,result:re};en(Pe,we,le),e.write(Pe).catch(()=>i.error("Sending response failed."))}Xr(v);let ye=f.get(v.method),pe,De;ye&&(pe=ye.type,De=ye.handler);let xe=Date.now();if(De||l){let re=v.id??String(Date.now()),we=Xi.is(x.receiver)?x.receiver.createCancellationTokenSource(re):x.receiver.createCancellationTokenSource(v);v.id!==null&&q.has(v.id)&&we.cancel(),v.id!==null&&K.set(re,we);try{let le;if(De)if(v.params===void 0){if(pe!==void 0&&pe.numberOfParams!==0){E(new z.ResponseError(z.ErrorCodes.InvalidParams,`Request ${v.method} defines ${pe.numberOfParams} params but received none.`),v.method,xe);return}le=De(we.token)}else if(Array.isArray(v.params)){if(pe!==void 0&&pe.parameterStructures===z.ParameterStructures.byName){E(new z.ResponseError(z.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by name but received parameters by position`),v.method,xe);return}le=De(...v.params,we.token)}else{if(pe!==void 0&&pe.parameterStructures===z.ParameterStructures.byPosition){E(new z.ResponseError(z.ErrorCodes.InvalidParams,`Request ${v.method} defines parameters by position but received parameters by name`),v.method,xe);return}le=De(v.params,we.token)}else l&&(le=l(v.method,v.params,we.token));let Pe=le;le?Pe.then?Pe.then(We=>{K.delete(re),R(We,v.method,xe)},We=>{K.delete(re),We instanceof z.ResponseError?E(We,v.method,xe):We&&Oe.string(We.message)?E(new z.ResponseError(z.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${We.message}`),v.method,xe):E(new z.ResponseError(z.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,xe)}):(K.delete(re),R(le,v.method,xe)):(K.delete(re),M(le,v.method,xe))}catch(le){K.delete(re),le instanceof z.ResponseError?R(le,v.method,xe):le&&Oe.string(le.message)?E(new z.ResponseError(z.ErrorCodes.InternalError,`Request ${v.method} failed with message: ${le.message}`),v.method,xe):E(new z.ResponseError(z.ErrorCodes.InternalError,`Request ${v.method} failed unexpectedly without providing any details.`),v.method,xe)}}else E(new z.ResponseError(z.ErrorCodes.MethodNotFound,`Unhandled method ${v.method}`),v.method,xe)}function pn(v){if(!he())if(v.id===null)v.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(v.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let R=v.id,E=D.get(R);if(jn(v,E),E!==void 0){D.delete(R);try{if(v.error){let M=v.error;E.reject(new z.ResponseError(M.code,M.message,M.data))}else if(v.result!==void 0)E.resolve(v.result);else throw new Error("Should never happen.")}catch(M){M.message?i.error(`Response handler '${E.method}' failed with message: ${M.message}`):i.error(`Response handler '${E.method}' failed unexpectedly.`)}}}}function gn(v){if(he())return;let R,E;if(v.method===ii.type.method){let M=v.params.id;q.delete(M),tn(v);return}else{let M=p.get(v.method);M&&(E=M.handler,R=M.type)}if(E||g)try{if(tn(v),E)if(v.params===void 0)R!==void 0&&R.numberOfParams!==0&&R.parameterStructures!==z.ParameterStructures.byName&&i.error(`Notification ${v.method} defines ${R.numberOfParams} params but received none.`),E();else if(Array.isArray(v.params)){let M=v.params;v.method===ni.type.method&&M.length===2&&ba.is(M[0])?E({token:M[0],value:M[1]}):(R!==void 0&&(R.parameterStructures===z.ParameterStructures.byName&&i.error(`Notification ${v.method} defines parameters by name but received parameters by position`),R.numberOfParams!==v.params.length&&i.error(`Notification ${v.method} defines ${R.numberOfParams} params but received ${M.length} arguments`)),E(...M))}else R!==void 0&&R.parameterStructures===z.ParameterStructures.byPosition&&i.error(`Notification ${v.method} defines parameters by position but received parameters by name`),E(v.params);else g&&g(v.method,v.params)}catch(M){M.message?i.error(`Notification handler '${v.method}' failed with message: ${M.message}`):i.error(`Notification handler '${v.method}' failed unexpectedly.`)}else ne.fire(v)}function Vr(v){if(!v){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(v,null,4)}`);let R=v;if(Oe.string(R.id)||Oe.number(R.id)){let E=R.id,M=D.get(E);M&&M.reject(new Error("The received response has neither a result nor an error property."))}}function Ge(v){if(v!=null)switch(j){case ge.Verbose:return JSON.stringify(v,null,4);case ge.Compact:return JSON.stringify(v);default:return}}function ir(v){if(!(j===ge.Off||!$))if(fe===wt.Text){let R;(j===ge.Verbose||j===ge.Compact)&&v.params&&(R=`Params: ${Ge(v.params)}

`),$.log(`Sending request '${v.method} - (${v.id})'.`,R)}else $e("send-request",v)}function mn(v){if(!(j===ge.Off||!$))if(fe===wt.Text){let R;(j===ge.Verbose||j===ge.Compact)&&(v.params?R=`Params: ${Ge(v.params)}

`:R=`No parameters provided.

`),$.log(`Sending notification '${v.method}'.`,R)}else $e("send-notification",v)}function en(v,R,E){if(!(j===ge.Off||!$))if(fe===wt.Text){let M;(j===ge.Verbose||j===ge.Compact)&&(v.error&&v.error.data?M=`Error data: ${Ge(v.error.data)}

`:v.result?M=`Result: ${Ge(v.result)}

`:v.error===void 0&&(M=`No result returned.

`)),$.log(`Sending response '${R} - (${v.id})'. Processing request took ${Date.now()-E}ms`,M)}else $e("send-response",v)}function Xr(v){if(!(j===ge.Off||!$))if(fe===wt.Text){let R;(j===ge.Verbose||j===ge.Compact)&&v.params&&(R=`Params: ${Ge(v.params)}

`),$.log(`Received request '${v.method} - (${v.id})'.`,R)}else $e("receive-request",v)}function tn(v){if(!(j===ge.Off||!$||v.method===Vi.type.method))if(fe===wt.Text){let R;(j===ge.Verbose||j===ge.Compact)&&(v.params?R=`Params: ${Ge(v.params)}

`:R=`No parameters provided.

`),$.log(`Received notification '${v.method}'.`,R)}else $e("receive-notification",v)}function jn(v,R){if(!(j===ge.Off||!$))if(fe===wt.Text){let E;if((j===ge.Verbose||j===ge.Compact)&&(v.error&&v.error.data?E=`Error data: ${Ge(v.error.data)}

`:v.result?E=`Result: ${Ge(v.result)}

`:v.error===void 0&&(E=`No result returned.

`)),R){let M=v.error?` Request failed: ${v.error.message} (${v.error.code}).`:"";$.log(`Received response '${R.method} - (${v.id})' in ${Date.now()-R.timerStart}ms.${M}`,E)}else $.log(`Received response ${v.id} without active response promise.`,E)}else $e("receive-response",v)}function $e(v,R){if(!$||j===ge.Off)return;let E={isLSPMessage:!0,type:v,message:R,timestamp:Date.now()};$.log(E)}function _t(){if(ce())throw new Dn(ri.Closed,"Connection is closed.");if(he())throw new Dn(ri.Disposed,"Connection is disposed.")}function ht(){if(Ke())throw new Dn(ri.AlreadyListening,"Connection is already listening")}function Kt(){if(!Ke())throw new Error("Call listen() first.")}function nn(v){return v===void 0?null:v}function Hn(v){if(v!==null)return v}function or(v){return v!=null&&!Array.isArray(v)&&typeof v=="object"}function yn(v,R){switch(v){case z.ParameterStructures.auto:return or(R)?Hn(R):[nn(R)];case z.ParameterStructures.byName:if(!or(R))throw new Error("Received parameters by name but param is not an object literal.");return Hn(R);case z.ParameterStructures.byPosition:return[nn(R)];default:throw new Error(`Unknown parameter structure ${v.toString()}`)}}function sr(v,R){let E,M=v.numberOfParams;switch(M){case 0:E=void 0;break;case 1:E=yn(v.parameterStructures,R[0]);break;default:E=[];for(let ye=0;ye<R.length&&ye<M;ye++)E.push(nn(R[ye]));if(R.length<M)for(let ye=R.length;ye<M;ye++)E.push(null);break}return E}let xt={sendNotification:(v,...R)=>{_t();let E,M;if(Oe.string(v)){E=v;let pe=R[0],De=0,xe=z.ParameterStructures.auto;z.ParameterStructures.is(pe)&&(De=1,xe=pe);let re=R.length,we=re-De;switch(we){case 0:M=void 0;break;case 1:M=yn(xe,R[De]);break;default:if(xe===z.ParameterStructures.byName)throw new Error(`Received ${we} parameters for 'by Name' notification parameter structure.`);M=R.slice(De,re).map(le=>nn(le));break}}else{let pe=R;E=v.method,M=sr(v,pe)}let ye={jsonrpc:u,method:E,params:M};return mn(ye),e.write(ye).catch(pe=>{throw i.error("Sending notification failed."),pe})},onNotification:(v,R)=>{_t();let E;return Oe.func(v)?g=v:R&&(Oe.string(v)?(E=v,p.set(v,{type:void 0,handler:R})):(E=v.method,p.set(v.method,{type:v,handler:R}))),{dispose:()=>{E!==void 0?p.delete(E):g=void 0}}},onProgress:(v,R,E)=>{if(y.has(R))throw new Error(`Progress handler for token ${R} already registered`);return y.set(R,E),{dispose:()=>{y.delete(R)}}},sendProgress:(v,R,E)=>xt.sendNotification(ni.type,{token:R,value:E}),onUnhandledProgress:Ue.event,sendRequest:(v,...R)=>{_t(),Kt();let E,M,ye;if(Oe.string(v)){E=v;let re=R[0],we=R[R.length-1],le=0,Pe=z.ParameterStructures.auto;z.ParameterStructures.is(re)&&(le=1,Pe=re);let We=R.length;_a.CancellationToken.is(we)&&(We=We-1,ye=we);let dt=We-le;switch(dt){case 0:M=void 0;break;case 1:M=yn(Pe,R[le]);break;default:if(Pe===z.ParameterStructures.byName)throw new Error(`Received ${dt} parameters for 'by Name' request parameter structure.`);M=R.slice(le,We).map(Jr=>nn(Jr));break}}else{let re=R;E=v.method,M=sr(v,re);let we=v.numberOfParams;ye=_a.CancellationToken.is(re[we])?re[we]:void 0}let pe=o++,De;ye&&(De=ye.onCancellationRequested(()=>{let re=x.sender.sendCancellation(xt,pe);return re===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${pe}`),Promise.resolve()):re.catch(()=>{i.log(`Sending cancellation messages for id ${pe} failed`)})}));let xe={jsonrpc:u,id:pe,method:E,params:M};return ir(xe),typeof x.sender.enableCancellation=="function"&&x.sender.enableCancellation(xe),new Promise(async(re,we)=>{let le=dt=>{re(dt),x.sender.cleanup(pe),De?.dispose()},Pe=dt=>{we(dt),x.sender.cleanup(pe),De?.dispose()},We={method:E,timerStart:Date.now(),resolve:le,reject:Pe};try{await e.write(xe),D.set(pe,We)}catch(dt){throw i.error("Sending request failed."),We.reject(new z.ResponseError(z.ErrorCodes.MessageWriteError,dt.message?dt.message:"Unknown reason")),dt}})},onRequest:(v,R)=>{_t();let E=null;return Ca.is(v)?(E=void 0,l=v):Oe.string(v)?(E=null,R!==void 0&&(E=v,f.set(v,{handler:R,type:void 0}))):R!==void 0&&(E=v.method,f.set(v.method,{type:v,handler:R})),{dispose:()=>{E!==null&&(E!==void 0?f.delete(E):l=void 0)}}},hasPendingResponse:()=>D.size>0,trace:async(v,R,E)=>{let M=!1,ye=wt.Text;E!==void 0&&(Oe.boolean(E)?M=E:(M=E.sendNotification||!1,ye=E.traceFormat||wt.Text)),j=v,fe=ye,j===ge.Off?$=void 0:$=R,M&&!ce()&&!he()&&await xt.sendNotification(Da.type,{value:ge.toString(v)})},onError:W.event,onClose:Z.event,onUnhandledNotification:ne.event,onDispose:O.event,end:()=>{e.end()},dispose:()=>{if(he())return;ae=Mt.Disposed,O.fire(void 0);let v=new z.ResponseError(z.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let R of D.values())R.reject(v);D=new Map,K=new Map,q=new Set,b=new lf.LinkedMap,Oe.func(e.dispose)&&e.dispose(),Oe.func(n.dispose)&&n.dispose()},listen:()=>{_t(),ht(),ae=Mt.Listening,n.listen(zr)},inspect:()=>{(0,uf.default)().console.log("inspect")}};return xt.onNotification(Vi.type,v=>{if(j===ge.Off||!$)return;let R=j===ge.Verbose||j===ge.Compact;$.log(v.message,R?v.verbose:void 0)}),xt.onNotification(ni.type,v=>{let R=y.get(v.token);R?R(v.value):Ue.fire(v)}),xt}G.createMessageConnection=cv});var Yi=P(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.ProgressType=S.ProgressToken=S.createMessageConnection=S.NullLogger=S.ConnectionOptions=S.ConnectionStrategy=S.AbstractMessageBuffer=S.WriteableStreamMessageWriter=S.AbstractMessageWriter=S.MessageWriter=S.ReadableStreamMessageReader=S.AbstractMessageReader=S.MessageReader=S.SharedArrayReceiverStrategy=S.SharedArraySenderStrategy=S.CancellationToken=S.CancellationTokenSource=S.Emitter=S.Event=S.Disposable=S.LRUCache=S.Touch=S.LinkedMap=S.ParameterStructures=S.NotificationType9=S.NotificationType8=S.NotificationType7=S.NotificationType6=S.NotificationType5=S.NotificationType4=S.NotificationType3=S.NotificationType2=S.NotificationType1=S.NotificationType0=S.NotificationType=S.ErrorCodes=S.ResponseError=S.RequestType9=S.RequestType8=S.RequestType7=S.RequestType6=S.RequestType5=S.RequestType4=S.RequestType3=S.RequestType2=S.RequestType1=S.RequestType0=S.RequestType=S.Message=S.RAL=void 0;S.MessageStrategy=S.CancellationStrategy=S.CancellationSenderStrategy=S.CancellationReceiverStrategy=S.ConnectionError=S.ConnectionErrors=S.LogTraceNotification=S.SetTraceNotification=S.TraceFormat=S.TraceValues=S.Trace=void 0;var Te=Qs();Object.defineProperty(S,"Message",{enumerable:!0,get:function(){return Te.Message}});Object.defineProperty(S,"RequestType",{enumerable:!0,get:function(){return Te.RequestType}});Object.defineProperty(S,"RequestType0",{enumerable:!0,get:function(){return Te.RequestType0}});Object.defineProperty(S,"RequestType1",{enumerable:!0,get:function(){return Te.RequestType1}});Object.defineProperty(S,"RequestType2",{enumerable:!0,get:function(){return Te.RequestType2}});Object.defineProperty(S,"RequestType3",{enumerable:!0,get:function(){return Te.RequestType3}});Object.defineProperty(S,"RequestType4",{enumerable:!0,get:function(){return Te.RequestType4}});Object.defineProperty(S,"RequestType5",{enumerable:!0,get:function(){return Te.RequestType5}});Object.defineProperty(S,"RequestType6",{enumerable:!0,get:function(){return Te.RequestType6}});Object.defineProperty(S,"RequestType7",{enumerable:!0,get:function(){return Te.RequestType7}});Object.defineProperty(S,"RequestType8",{enumerable:!0,get:function(){return Te.RequestType8}});Object.defineProperty(S,"RequestType9",{enumerable:!0,get:function(){return Te.RequestType9}});Object.defineProperty(S,"ResponseError",{enumerable:!0,get:function(){return Te.ResponseError}});Object.defineProperty(S,"ErrorCodes",{enumerable:!0,get:function(){return Te.ErrorCodes}});Object.defineProperty(S,"NotificationType",{enumerable:!0,get:function(){return Te.NotificationType}});Object.defineProperty(S,"NotificationType0",{enumerable:!0,get:function(){return Te.NotificationType0}});Object.defineProperty(S,"NotificationType1",{enumerable:!0,get:function(){return Te.NotificationType1}});Object.defineProperty(S,"NotificationType2",{enumerable:!0,get:function(){return Te.NotificationType2}});Object.defineProperty(S,"NotificationType3",{enumerable:!0,get:function(){return Te.NotificationType3}});Object.defineProperty(S,"NotificationType4",{enumerable:!0,get:function(){return Te.NotificationType4}});Object.defineProperty(S,"NotificationType5",{enumerable:!0,get:function(){return Te.NotificationType5}});Object.defineProperty(S,"NotificationType6",{enumerable:!0,get:function(){return Te.NotificationType6}});Object.defineProperty(S,"NotificationType7",{enumerable:!0,get:function(){return Te.NotificationType7}});Object.defineProperty(S,"NotificationType8",{enumerable:!0,get:function(){return Te.NotificationType8}});Object.defineProperty(S,"NotificationType9",{enumerable:!0,get:function(){return Te.NotificationType9}});Object.defineProperty(S,"ParameterStructures",{enumerable:!0,get:function(){return Te.ParameterStructures}});var Ta=Ys();Object.defineProperty(S,"LinkedMap",{enumerable:!0,get:function(){return Ta.LinkedMap}});Object.defineProperty(S,"LRUCache",{enumerable:!0,get:function(){return Ta.LRUCache}});Object.defineProperty(S,"Touch",{enumerable:!0,get:function(){return Ta.Touch}});var uv=Qd();Object.defineProperty(S,"Disposable",{enumerable:!0,get:function(){return uv.Disposable}});var pf=lr();Object.defineProperty(S,"Event",{enumerable:!0,get:function(){return pf.Event}});Object.defineProperty(S,"Emitter",{enumerable:!0,get:function(){return pf.Emitter}});var gf=Wi();Object.defineProperty(S,"CancellationTokenSource",{enumerable:!0,get:function(){return gf.CancellationTokenSource}});Object.defineProperty(S,"CancellationToken",{enumerable:!0,get:function(){return gf.CancellationToken}});var mf=Yd();Object.defineProperty(S,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return mf.SharedArraySenderStrategy}});Object.defineProperty(S,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return mf.SharedArrayReceiverStrategy}});var xa=tf();Object.defineProperty(S,"MessageReader",{enumerable:!0,get:function(){return xa.MessageReader}});Object.defineProperty(S,"AbstractMessageReader",{enumerable:!0,get:function(){return xa.AbstractMessageReader}});Object.defineProperty(S,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return xa.ReadableStreamMessageReader}});var Pa=af();Object.defineProperty(S,"MessageWriter",{enumerable:!0,get:function(){return Pa.MessageWriter}});Object.defineProperty(S,"AbstractMessageWriter",{enumerable:!0,get:function(){return Pa.AbstractMessageWriter}});Object.defineProperty(S,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Pa.WriteableStreamMessageWriter}});var lv=cf();Object.defineProperty(S,"AbstractMessageBuffer",{enumerable:!0,get:function(){return lv.AbstractMessageBuffer}});var et=hf();Object.defineProperty(S,"ConnectionStrategy",{enumerable:!0,get:function(){return et.ConnectionStrategy}});Object.defineProperty(S,"ConnectionOptions",{enumerable:!0,get:function(){return et.ConnectionOptions}});Object.defineProperty(S,"NullLogger",{enumerable:!0,get:function(){return et.NullLogger}});Object.defineProperty(S,"createMessageConnection",{enumerable:!0,get:function(){return et.createMessageConnection}});Object.defineProperty(S,"ProgressToken",{enumerable:!0,get:function(){return et.ProgressToken}});Object.defineProperty(S,"ProgressType",{enumerable:!0,get:function(){return et.ProgressType}});Object.defineProperty(S,"Trace",{enumerable:!0,get:function(){return et.Trace}});Object.defineProperty(S,"TraceValues",{enumerable:!0,get:function(){return et.TraceValues}});Object.defineProperty(S,"TraceFormat",{enumerable:!0,get:function(){return et.TraceFormat}});Object.defineProperty(S,"SetTraceNotification",{enumerable:!0,get:function(){return et.SetTraceNotification}});Object.defineProperty(S,"LogTraceNotification",{enumerable:!0,get:function(){return et.LogTraceNotification}});Object.defineProperty(S,"ConnectionErrors",{enumerable:!0,get:function(){return et.ConnectionErrors}});Object.defineProperty(S,"ConnectionError",{enumerable:!0,get:function(){return et.ConnectionError}});Object.defineProperty(S,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return et.CancellationReceiverStrategy}});Object.defineProperty(S,"CancellationSenderStrategy",{enumerable:!0,get:function(){return et.CancellationSenderStrategy}});Object.defineProperty(S,"CancellationStrategy",{enumerable:!0,get:function(){return et.CancellationStrategy}});Object.defineProperty(S,"MessageStrategy",{enumerable:!0,get:function(){return et.MessageStrategy}});var dv=bn();S.RAL=dv.default});var vf=P(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});var Vt=Yi(),pr=class extends Vt.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return pr.emptyBuffer}fromString(e,t){return new TextEncoder().encode(e)}toString(e,t){return t==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}};pr.emptyBuffer=new Uint8Array(0);var qa=class{constructor(e){this.socket=e,this._onData=new Vt.Emitter,this._messageListener=t=>{t.data.arrayBuffer().then(i=>{this._onData.fire(new Uint8Array(i))},()=>{(0,Vt.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),Vt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Vt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Vt.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}},ka=class{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),Vt.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Vt.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Vt.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,t){if(typeof e=="string"){if(t!==void 0&&t!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}},fv=new TextEncoder,yf=Object.freeze({messageBuffer:Object.freeze({create:n=>new pr(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(fv.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new qa(n),asWritableStream:n=>new ka(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setTimeout(n,0,...e);return{dispose:()=>clearTimeout(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function Ia(){return yf}(function(n){function e(){Vt.RAL.install(yf)}n.install=e})(Ia||(Ia={}));Ea.default=Ia});var Bn=P(Ct=>{"use strict";var hv=Ct&&Ct.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),pv=Ct&&Ct.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hv(e,n,t)};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.createMessageConnection=Ct.BrowserMessageWriter=Ct.BrowserMessageReader=void 0;var gv=vf();gv.default.install();var gr=Yi();pv(Yi(),Ct);var Oa=class extends gr.AbstractMessageReader{constructor(e){super(),this._onData=new gr.Emitter,this._messageListener=t=>{this._onData.fire(t.data)},e.addEventListener("error",t=>this.fireError(t)),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}};Ct.BrowserMessageReader=Oa;var Fa=class extends gr.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Ct.BrowserMessageWriter=Fa;function mv(n,e,t,r){return t===void 0&&(t=gr.NullLogger),gr.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,gr.createMessageConnection)(n,e,t,r)}Ct.createMessageConnection=mv});var La=P((Bw,_f)=>{"use strict";_f.exports=Bn()});var co={};Kd(co,{AnnotatedTextEdit:()=>rn,ChangeAnnotation:()=>Kn,ChangeAnnotationIdentifier:()=>tt,CodeAction:()=>mc,CodeActionContext:()=>gc,CodeActionKind:()=>pc,CodeActionTriggerKind:()=>di,CodeDescription:()=>$a,CodeLens:()=>yc,Color:()=>to,ColorInformation:()=>ja,ColorPresentation:()=>Ha,Command:()=>$n,CompletionItem:()=>nc,CompletionItemKind:()=>Za,CompletionItemLabelDetails:()=>tc,CompletionItemTag:()=>Ga,CompletionList:()=>rc,CreateFile:()=>yr,DeleteFile:()=>_r,Diagnostic:()=>ai,DiagnosticRelatedInformation:()=>no,DiagnosticSeverity:()=>Ba,DiagnosticTag:()=>Ka,DocumentHighlight:()=>cc,DocumentHighlightKind:()=>ac,DocumentLink:()=>_c,DocumentSymbol:()=>hc,DocumentUri:()=>Ma,EOL:()=>yv,FoldingRange:()=>Wa,FoldingRangeKind:()=>Ua,FormattingOptions:()=>vc,Hover:()=>ic,InlayHint:()=>Pc,InlayHintKind:()=>so,InlayHintLabelPart:()=>ao,InlineCompletionContext:()=>Fc,InlineCompletionItem:()=>kc,InlineCompletionList:()=>Ic,InlineCompletionTriggerKind:()=>Ec,InlineValueContext:()=>xc,InlineValueEvaluatableExpression:()=>Tc,InlineValueText:()=>Sc,InlineValueVariableLookup:()=>Rc,InsertReplaceEdit:()=>Ya,InsertTextFormat:()=>Qa,InsertTextMode:()=>ec,Location:()=>si,LocationLink:()=>Aa,MarkedString:()=>li,MarkupContent:()=>br,MarkupKind:()=>oo,OptionalVersionedTextDocumentIdentifier:()=>ui,ParameterInformation:()=>oc,Position:()=>Pt,Range:()=>Le,RenameFile:()=>vr,SelectedCompletionInfo:()=>Oc,SelectionRange:()=>bc,SemanticTokenModifiers:()=>Cc,SemanticTokenTypes:()=>wc,SemanticTokens:()=>Dc,SignatureInformation:()=>sc,StringValue:()=>qc,SymbolInformation:()=>dc,SymbolKind:()=>uc,SymbolTag:()=>lc,TextDocument:()=>Mc,TextDocumentEdit:()=>ci,TextDocumentIdentifier:()=>Va,TextDocumentItem:()=>Ja,TextEdit:()=>Xt,URI:()=>eo,VersionedTextDocumentIdentifier:()=>Xa,WorkspaceChange:()=>za,WorkspaceEdit:()=>ro,WorkspaceFolder:()=>Lc,WorkspaceSymbol:()=>fc,integer:()=>Na,uinteger:()=>oi});var Ma,eo,Na,oi,Pt,Le,si,Aa,to,ja,Ha,Ua,Wa,no,Ba,Ka,$a,ai,$n,Xt,Kn,tt,rn,ci,yr,vr,_r,ro,mr,io,za,Va,Xa,ui,Ja,oo,br,Za,Qa,Ga,Ya,ec,tc,nc,rc,li,ic,oc,sc,ac,cc,uc,lc,dc,fc,hc,pc,di,gc,mc,yc,vc,_c,bc,wc,Cc,Dc,Sc,Rc,Tc,xc,so,ao,Pc,qc,kc,Ic,Ec,Oc,Fc,Lc,yv,Mc,Nc,w,uo=Ky(()=>{"use strict";(function(n){function e(t){return typeof t=="string"}n.is=e})(Ma||(Ma={}));(function(n){function e(t){return typeof t=="string"}n.is=e})(eo||(eo={}));(function(n){n.MIN_VALUE=-2147483648,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(Na||(Na={}));(function(n){n.MIN_VALUE=0,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(oi||(oi={}));(function(n){function e(r,i){return r===Number.MAX_VALUE&&(r=oi.MAX_VALUE),i===Number.MAX_VALUE&&(i=oi.MAX_VALUE),{line:r,character:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.uinteger(i.line)&&w.uinteger(i.character)}n.is=t})(Pt||(Pt={}));(function(n){function e(r,i,o,s){if(w.uinteger(r)&&w.uinteger(i)&&w.uinteger(o)&&w.uinteger(s))return{start:Pt.create(r,i),end:Pt.create(o,s)};if(Pt.is(r)&&Pt.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${o}, ${s}]`)}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Pt.is(i.start)&&Pt.is(i.end)}n.is=t})(Le||(Le={}));(function(n){function e(r,i){return{uri:r,range:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Le.is(i.range)&&(w.string(i.uri)||w.undefined(i.uri))}n.is=t})(si||(si={}));(function(n){function e(r,i,o,s){return{targetUri:r,targetRange:i,targetSelectionRange:o,originSelectionRange:s}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Le.is(i.targetRange)&&w.string(i.targetUri)&&Le.is(i.targetSelectionRange)&&(Le.is(i.originSelectionRange)||w.undefined(i.originSelectionRange))}n.is=t})(Aa||(Aa={}));(function(n){function e(r,i,o,s){return{red:r,green:i,blue:o,alpha:s}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.numberRange(i.red,0,1)&&w.numberRange(i.green,0,1)&&w.numberRange(i.blue,0,1)&&w.numberRange(i.alpha,0,1)}n.is=t})(to||(to={}));(function(n){function e(r,i){return{range:r,color:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Le.is(i.range)&&to.is(i.color)}n.is=t})(ja||(ja={}));(function(n){function e(r,i,o){return{label:r,textEdit:i,additionalTextEdits:o}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.string(i.label)&&(w.undefined(i.textEdit)||Xt.is(i))&&(w.undefined(i.additionalTextEdits)||w.typedArray(i.additionalTextEdits,Xt.is))}n.is=t})(Ha||(Ha={}));(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(Ua||(Ua={}));(function(n){function e(r,i,o,s,a,u){let l={startLine:r,endLine:i};return w.defined(o)&&(l.startCharacter=o),w.defined(s)&&(l.endCharacter=s),w.defined(a)&&(l.kind=a),w.defined(u)&&(l.collapsedText=u),l}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.uinteger(i.startLine)&&w.uinteger(i.startLine)&&(w.undefined(i.startCharacter)||w.uinteger(i.startCharacter))&&(w.undefined(i.endCharacter)||w.uinteger(i.endCharacter))&&(w.undefined(i.kind)||w.string(i.kind))}n.is=t})(Wa||(Wa={}));(function(n){function e(r,i){return{location:r,message:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&si.is(i.location)&&w.string(i.message)}n.is=t})(no||(no={}));(function(n){n.Error=1,n.Warning=2,n.Information=3,n.Hint=4})(Ba||(Ba={}));(function(n){n.Unnecessary=1,n.Deprecated=2})(Ka||(Ka={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&w.string(r.href)}n.is=e})($a||($a={}));(function(n){function e(r,i,o,s,a,u){let l={range:r,message:i};return w.defined(o)&&(l.severity=o),w.defined(s)&&(l.code=s),w.defined(a)&&(l.source=a),w.defined(u)&&(l.relatedInformation=u),l}n.create=e;function t(r){var i;let o=r;return w.defined(o)&&Le.is(o.range)&&w.string(o.message)&&(w.number(o.severity)||w.undefined(o.severity))&&(w.integer(o.code)||w.string(o.code)||w.undefined(o.code))&&(w.undefined(o.codeDescription)||w.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(w.string(o.source)||w.undefined(o.source))&&(w.undefined(o.relatedInformation)||w.typedArray(o.relatedInformation,no.is))}n.is=t})(ai||(ai={}));(function(n){function e(r,i,...o){let s={title:r,command:i};return w.defined(o)&&o.length>0&&(s.arguments=o),s}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.title)&&w.string(i.command)}n.is=t})($n||($n={}));(function(n){function e(o,s){return{range:o,newText:s}}n.replace=e;function t(o,s){return{range:{start:o,end:o},newText:s}}n.insert=t;function r(o){return{range:o,newText:""}}n.del=r;function i(o){let s=o;return w.objectLiteral(s)&&w.string(s.newText)&&Le.is(s.range)}n.is=i})(Xt||(Xt={}));(function(n){function e(r,i,o){let s={label:r};return i!==void 0&&(s.needsConfirmation=i),o!==void 0&&(s.description=o),s}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&w.string(i.label)&&(w.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(w.string(i.description)||i.description===void 0)}n.is=t})(Kn||(Kn={}));(function(n){function e(t){let r=t;return w.string(r)}n.is=e})(tt||(tt={}));(function(n){function e(o,s,a){return{range:o,newText:s,annotationId:a}}n.replace=e;function t(o,s,a){return{range:{start:o,end:o},newText:s,annotationId:a}}n.insert=t;function r(o,s){return{range:o,newText:"",annotationId:s}}n.del=r;function i(o){let s=o;return Xt.is(s)&&(Kn.is(s.annotationId)||tt.is(s.annotationId))}n.is=i})(rn||(rn={}));(function(n){function e(r,i){return{textDocument:r,edits:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&ui.is(i.textDocument)&&Array.isArray(i.edits)}n.is=t})(ci||(ci={}));(function(n){function e(r,i,o){let s={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="create"&&w.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||w.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||w.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||tt.is(i.annotationId))}n.is=t})(yr||(yr={}));(function(n){function e(r,i,o,s){let a={kind:"rename",oldUri:r,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(a.options=o),s!==void 0&&(a.annotationId=s),a}n.create=e;function t(r){let i=r;return i&&i.kind==="rename"&&w.string(i.oldUri)&&w.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||w.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||w.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||tt.is(i.annotationId))}n.is=t})(vr||(vr={}));(function(n){function e(r,i,o){let s={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="delete"&&w.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||w.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||w.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||tt.is(i.annotationId))}n.is=t})(_r||(_r={}));(function(n){function e(t){let r=t;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>w.string(i.kind)?yr.is(i)||vr.is(i)||_r.is(i):ci.is(i)))}n.is=e})(ro||(ro={}));mr=class{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,r){let i,o;if(r===void 0?i=Xt.insert(e,t):tt.is(r)?(o=r,i=rn.insert(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=rn.insert(e,t,o)),this.edits.push(i),o!==void 0)return o}replace(e,t,r){let i,o;if(r===void 0?i=Xt.replace(e,t):tt.is(r)?(o=r,i=rn.replace(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=rn.replace(e,t,o)),this.edits.push(i),o!==void 0)return o}delete(e,t){let r,i;if(t===void 0?r=Xt.del(e):tt.is(t)?(i=t,r=rn.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),r=rn.del(e,i)),this.edits.push(r),i!==void 0)return i}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}},io=class{constructor(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let r;if(tt.is(e)?r=e:(r=this.nextId(),t=e),this._annotations[r]!==void 0)throw new Error(`Id ${r} is already in use.`);if(t===void 0)throw new Error(`No annotation provided for id ${r}`);return this._annotations[r]=t,this._size++,r}nextId(){return this._counter++,this._counter.toString()}},za=class{constructor(e){this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new io(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(t=>{if(ci.is(t)){let r=new mr(t.edits,this._changeAnnotations);this._textEditChanges[t.textDocument.uri]=r}})):e.changes&&Object.keys(e.changes).forEach(t=>{let r=new mr(e.changes[t]);this._textEditChanges[t]=r})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(ui.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let t={uri:e.uri,version:e.version},r=this._textEditChanges[t.uri];if(!r){let i=[],o={textDocument:t,edits:i};this._workspaceEdit.documentChanges.push(o),r=new mr(i,this._changeAnnotations),this._textEditChanges[t.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let r=[];this._workspaceEdit.changes[e]=r,t=new mr(r),this._textEditChanges[e]=t}return t}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new io,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Kn.is(t)||tt.is(t)?i=t:r=t;let o,s;if(i===void 0?o=yr.create(e,r):(s=tt.is(i)?i:this._changeAnnotations.manage(i),o=yr.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}renameFile(e,t,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let o;Kn.is(r)||tt.is(r)?o=r:i=r;let s,a;if(o===void 0?s=vr.create(e,t,i):(a=tt.is(o)?o:this._changeAnnotations.manage(o),s=vr.create(e,t,i,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}deleteFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Kn.is(t)||tt.is(t)?i=t:r=t;let o,s;if(i===void 0?o=_r.create(e,r):(s=tt.is(i)?i:this._changeAnnotations.manage(i),o=_r.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}};(function(n){function e(r){return{uri:r}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)}n.is=t})(Va||(Va={}));(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&w.integer(i.version)}n.is=t})(Xa||(Xa={}));(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&(i.version===null||w.integer(i.version))}n.is=t})(ui||(ui={}));(function(n){function e(r,i,o,s){return{uri:r,languageId:i,version:o,text:s}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.string(i.uri)&&w.string(i.languageId)&&w.integer(i.version)&&w.string(i.text)}n.is=t})(Ja||(Ja={}));(function(n){n.PlainText="plaintext",n.Markdown="markdown";function e(t){let r=t;return r===n.PlainText||r===n.Markdown}n.is=e})(oo||(oo={}));(function(n){function e(t){let r=t;return w.objectLiteral(t)&&oo.is(r.kind)&&w.string(r.value)}n.is=e})(br||(br={}));(function(n){n.Text=1,n.Method=2,n.Function=3,n.Constructor=4,n.Field=5,n.Variable=6,n.Class=7,n.Interface=8,n.Module=9,n.Property=10,n.Unit=11,n.Value=12,n.Enum=13,n.Keyword=14,n.Snippet=15,n.Color=16,n.File=17,n.Reference=18,n.Folder=19,n.EnumMember=20,n.Constant=21,n.Struct=22,n.Event=23,n.Operator=24,n.TypeParameter=25})(Za||(Za={}));(function(n){n.PlainText=1,n.Snippet=2})(Qa||(Qa={}));(function(n){n.Deprecated=1})(Ga||(Ga={}));(function(n){function e(r,i,o){return{newText:r,insert:i,replace:o}}n.create=e;function t(r){let i=r;return i&&w.string(i.newText)&&Le.is(i.insert)&&Le.is(i.replace)}n.is=t})(Ya||(Ya={}));(function(n){n.asIs=1,n.adjustIndentation=2})(ec||(ec={}));(function(n){function e(t){let r=t;return r&&(w.string(r.detail)||r.detail===void 0)&&(w.string(r.description)||r.description===void 0)}n.is=e})(tc||(tc={}));(function(n){function e(t){return{label:t}}n.create=e})(nc||(nc={}));(function(n){function e(t,r){return{items:t||[],isIncomplete:!!r}}n.create=e})(rc||(rc={}));(function(n){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}n.fromPlainText=e;function t(r){let i=r;return w.string(i)||w.objectLiteral(i)&&w.string(i.language)&&w.string(i.value)}n.is=t})(li||(li={}));(function(n){function e(t){let r=t;return!!r&&w.objectLiteral(r)&&(br.is(r.contents)||li.is(r.contents)||w.typedArray(r.contents,li.is))&&(t.range===void 0||Le.is(t.range))}n.is=e})(ic||(ic={}));(function(n){function e(t,r){return r?{label:t,documentation:r}:{label:t}}n.create=e})(oc||(oc={}));(function(n){function e(t,r,...i){let o={label:t};return w.defined(r)&&(o.documentation=r),w.defined(i)?o.parameters=i:o.parameters=[],o}n.create=e})(sc||(sc={}));(function(n){n.Text=1,n.Read=2,n.Write=3})(ac||(ac={}));(function(n){function e(t,r){let i={range:t};return w.number(r)&&(i.kind=r),i}n.create=e})(cc||(cc={}));(function(n){n.File=1,n.Module=2,n.Namespace=3,n.Package=4,n.Class=5,n.Method=6,n.Property=7,n.Field=8,n.Constructor=9,n.Enum=10,n.Interface=11,n.Function=12,n.Variable=13,n.Constant=14,n.String=15,n.Number=16,n.Boolean=17,n.Array=18,n.Object=19,n.Key=20,n.Null=21,n.EnumMember=22,n.Struct=23,n.Event=24,n.Operator=25,n.TypeParameter=26})(uc||(uc={}));(function(n){n.Deprecated=1})(lc||(lc={}));(function(n){function e(t,r,i,o,s){let a={name:t,kind:r,location:{uri:o,range:i}};return s&&(a.containerName=s),a}n.create=e})(dc||(dc={}));(function(n){function e(t,r,i,o){return o!==void 0?{name:t,kind:r,location:{uri:i,range:o}}:{name:t,kind:r,location:{uri:i}}}n.create=e})(fc||(fc={}));(function(n){function e(r,i,o,s,a,u){let l={name:r,detail:i,kind:o,range:s,selectionRange:a};return u!==void 0&&(l.children=u),l}n.create=e;function t(r){let i=r;return i&&w.string(i.name)&&w.number(i.kind)&&Le.is(i.range)&&Le.is(i.selectionRange)&&(i.detail===void 0||w.string(i.detail))&&(i.deprecated===void 0||w.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}n.is=t})(hc||(hc={}));(function(n){n.Empty="",n.QuickFix="quickfix",n.Refactor="refactor",n.RefactorExtract="refactor.extract",n.RefactorInline="refactor.inline",n.RefactorRewrite="refactor.rewrite",n.Source="source",n.SourceOrganizeImports="source.organizeImports",n.SourceFixAll="source.fixAll"})(pc||(pc={}));(function(n){n.Invoked=1,n.Automatic=2})(di||(di={}));(function(n){function e(r,i,o){let s={diagnostics:r};return i!=null&&(s.only=i),o!=null&&(s.triggerKind=o),s}n.create=e;function t(r){let i=r;return w.defined(i)&&w.typedArray(i.diagnostics,ai.is)&&(i.only===void 0||w.typedArray(i.only,w.string))&&(i.triggerKind===void 0||i.triggerKind===di.Invoked||i.triggerKind===di.Automatic)}n.is=t})(gc||(gc={}));(function(n){function e(r,i,o){let s={title:r},a=!0;return typeof i=="string"?(a=!1,s.kind=i):$n.is(i)?s.command=i:s.edit=i,a&&o!==void 0&&(s.kind=o),s}n.create=e;function t(r){let i=r;return i&&w.string(i.title)&&(i.diagnostics===void 0||w.typedArray(i.diagnostics,ai.is))&&(i.kind===void 0||w.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||$n.is(i.command))&&(i.isPreferred===void 0||w.boolean(i.isPreferred))&&(i.edit===void 0||ro.is(i.edit))}n.is=t})(mc||(mc={}));(function(n){function e(r,i){let o={range:r};return w.defined(i)&&(o.data=i),o}n.create=e;function t(r){let i=r;return w.defined(i)&&Le.is(i.range)&&(w.undefined(i.command)||$n.is(i.command))}n.is=t})(yc||(yc={}));(function(n){function e(r,i){return{tabSize:r,insertSpaces:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&w.uinteger(i.tabSize)&&w.boolean(i.insertSpaces)}n.is=t})(vc||(vc={}));(function(n){function e(r,i,o){return{range:r,target:i,data:o}}n.create=e;function t(r){let i=r;return w.defined(i)&&Le.is(i.range)&&(w.undefined(i.target)||w.string(i.target))}n.is=t})(_c||(_c={}));(function(n){function e(r,i){return{range:r,parent:i}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Le.is(i.range)&&(i.parent===void 0||n.is(i.parent))}n.is=t})(bc||(bc={}));(function(n){n.namespace="namespace",n.type="type",n.class="class",n.enum="enum",n.interface="interface",n.struct="struct",n.typeParameter="typeParameter",n.parameter="parameter",n.variable="variable",n.property="property",n.enumMember="enumMember",n.event="event",n.function="function",n.method="method",n.macro="macro",n.keyword="keyword",n.modifier="modifier",n.comment="comment",n.string="string",n.number="number",n.regexp="regexp",n.operator="operator",n.decorator="decorator"})(wc||(wc={}));(function(n){n.declaration="declaration",n.definition="definition",n.readonly="readonly",n.static="static",n.deprecated="deprecated",n.abstract="abstract",n.async="async",n.modification="modification",n.documentation="documentation",n.defaultLibrary="defaultLibrary"})(Cc||(Cc={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}n.is=e})(Dc||(Dc={}));(function(n){function e(r,i){return{range:r,text:i}}n.create=e;function t(r){let i=r;return i!=null&&Le.is(i.range)&&w.string(i.text)}n.is=t})(Sc||(Sc={}));(function(n){function e(r,i,o){return{range:r,variableName:i,caseSensitiveLookup:o}}n.create=e;function t(r){let i=r;return i!=null&&Le.is(i.range)&&w.boolean(i.caseSensitiveLookup)&&(w.string(i.variableName)||i.variableName===void 0)}n.is=t})(Rc||(Rc={}));(function(n){function e(r,i){return{range:r,expression:i}}n.create=e;function t(r){let i=r;return i!=null&&Le.is(i.range)&&(w.string(i.expression)||i.expression===void 0)}n.is=t})(Tc||(Tc={}));(function(n){function e(r,i){return{frameId:r,stoppedLocation:i}}n.create=e;function t(r){let i=r;return w.defined(i)&&Le.is(r.stoppedLocation)}n.is=t})(xc||(xc={}));(function(n){n.Type=1,n.Parameter=2;function e(t){return t===1||t===2}n.is=e})(so||(so={}));(function(n){function e(r){return{value:r}}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&(i.tooltip===void 0||w.string(i.tooltip)||br.is(i.tooltip))&&(i.location===void 0||si.is(i.location))&&(i.command===void 0||$n.is(i.command))}n.is=t})(ao||(ao={}));(function(n){function e(r,i,o){let s={position:r,label:i};return o!==void 0&&(s.kind=o),s}n.create=e;function t(r){let i=r;return w.objectLiteral(i)&&Pt.is(i.position)&&(w.string(i.label)||w.typedArray(i.label,ao.is))&&(i.kind===void 0||so.is(i.kind))&&i.textEdits===void 0||w.typedArray(i.textEdits,Xt.is)&&(i.tooltip===void 0||w.string(i.tooltip)||br.is(i.tooltip))&&(i.paddingLeft===void 0||w.boolean(i.paddingLeft))&&(i.paddingRight===void 0||w.boolean(i.paddingRight))}n.is=t})(Pc||(Pc={}));(function(n){function e(t){return{kind:"snippet",value:t}}n.createSnippet=e})(qc||(qc={}));(function(n){function e(t,r,i,o){return{insertText:t,filterText:r,range:i,command:o}}n.create=e})(kc||(kc={}));(function(n){function e(t){return{items:t}}n.create=e})(Ic||(Ic={}));(function(n){n.Invoked=0,n.Automatic=1})(Ec||(Ec={}));(function(n){function e(t,r){return{range:t,text:r}}n.create=e})(Oc||(Oc={}));(function(n){function e(t,r){return{triggerKind:t,selectedCompletionInfo:r}}n.create=e})(Fc||(Fc={}));(function(n){function e(t){let r=t;return w.objectLiteral(r)&&eo.is(r.uri)&&w.string(r.name)}n.is=e})(Lc||(Lc={}));yv=[`
`,`\r
`,"\r"];(function(n){function e(o,s,a,u){return new Nc(o,s,a,u)}n.create=e;function t(o){let s=o;return!!(w.defined(s)&&w.string(s.uri)&&(w.undefined(s.languageId)||w.string(s.languageId))&&w.uinteger(s.lineCount)&&w.func(s.getText)&&w.func(s.positionAt)&&w.func(s.offsetAt))}n.is=t;function r(o,s){let a=o.getText(),u=i(s,(f,g)=>{let p=f.range.start.line-g.range.start.line;return p===0?f.range.start.character-g.range.start.character:p}),l=a.length;for(let f=u.length-1;f>=0;f--){let g=u[f],p=o.offsetAt(g.range.start),y=o.offsetAt(g.range.end);if(y<=l)a=a.substring(0,p)+g.newText+a.substring(y,a.length);else throw new Error("Overlapping edit");l=p}return a}n.applyEdits=r;function i(o,s){if(o.length<=1)return o;let a=o.length/2|0,u=o.slice(0,a),l=o.slice(a);i(u,s),i(l,s);let f=0,g=0,p=0;for(;f<u.length&&g<l.length;)s(u[f],l[g])<=0?o[p++]=u[f++]:o[p++]=l[g++];for(;f<u.length;)o[p++]=u[f++];for(;g<l.length;)o[p++]=l[g++];return o}})(Mc||(Mc={}));Nc=class{constructor(e,t,r,i){this._uri=e,this._languageId=t,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(t,r)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],t=this._content,r=!0;for(let i=0;i<t.length;i++){r&&(e.push(i),r=!1);let o=t.charAt(i);r=o==="\r"||o===`
`,o==="\r"&&i+1<t.length&&t.charAt(i+1)===`
`&&i++}r&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),r=0,i=t.length;if(i===0)return Pt.create(0,e);for(;r<i;){let s=Math.floor((r+i)/2);t[s]>e?i=s:r=s+1}let o=r-1;return Pt.create(o,e-t[o])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let r=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};(function(n){let e=Object.prototype.toString;function t(y){return typeof y<"u"}n.defined=t;function r(y){return typeof y>"u"}n.undefined=r;function i(y){return y===!0||y===!1}n.boolean=i;function o(y){return e.call(y)==="[object String]"}n.string=o;function s(y){return e.call(y)==="[object Number]"}n.number=s;function a(y,h,b){return e.call(y)==="[object Number]"&&h<=y&&y<=b}n.numberRange=a;function u(y){return e.call(y)==="[object Number]"&&-2147483648<=y&&y<=2147483647}n.integer=u;function l(y){return e.call(y)==="[object Number]"&&0<=y&&y<=2147483647}n.uinteger=l;function f(y){return e.call(y)==="[object Function]"}n.func=f;function g(y){return y!==null&&typeof y=="object"}n.objectLiteral=g;function p(y,h){return Array.isArray(y)&&y.every(h)}n.typedArray=p})(w||(w={}))});var ke=P(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.ProtocolNotificationType=pt.ProtocolNotificationType0=pt.ProtocolRequestType=pt.ProtocolRequestType0=pt.RegistrationType=pt.MessageDirection=void 0;var wr=Bn(),bf;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(bf||(pt.MessageDirection=bf={}));var Ac=class{constructor(e){this.method=e}};pt.RegistrationType=Ac;var jc=class extends wr.RequestType0{constructor(e){super(e)}};pt.ProtocolRequestType0=jc;var Hc=class extends wr.RequestType{constructor(e){super(e,wr.ParameterStructures.byName)}};pt.ProtocolRequestType=Hc;var Uc=class extends wr.NotificationType0{constructor(e){super(e)}};pt.ProtocolNotificationType0=Uc;var Wc=class extends wr.NotificationType{constructor(e){super(e,wr.ParameterStructures.byName)}};pt.ProtocolNotificationType=Wc});var lo=P(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.objectLiteral=je.typedArray=je.stringArray=je.array=je.func=je.error=je.number=je.string=je.boolean=void 0;function vv(n){return n===!0||n===!1}je.boolean=vv;function wf(n){return typeof n=="string"||n instanceof String}je.string=wf;function _v(n){return typeof n=="number"||n instanceof Number}je.number=_v;function bv(n){return n instanceof Error}je.error=bv;function wv(n){return typeof n=="function"}je.func=wv;function Cf(n){return Array.isArray(n)}je.array=Cf;function Cv(n){return Cf(n)&&n.every(e=>wf(e))}je.stringArray=Cv;function Dv(n,e){return Array.isArray(n)&&n.every(e)}je.typedArray=Dv;function Sv(n){return n!==null&&typeof n=="object"}je.objectLiteral=Sv});var Rf=P(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.ImplementationRequest=void 0;var Df=ke(),Sf;(function(n){n.method="textDocument/implementation",n.messageDirection=Df.MessageDirection.clientToServer,n.type=new Df.ProtocolRequestType(n.method)})(Sf||(fo.ImplementationRequest=Sf={}))});var Pf=P(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.TypeDefinitionRequest=void 0;var Tf=ke(),xf;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=Tf.MessageDirection.clientToServer,n.type=new Tf.ProtocolRequestType(n.method)})(xf||(ho.TypeDefinitionRequest=xf={}))});var If=P(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.DidChangeWorkspaceFoldersNotification=Cr.WorkspaceFoldersRequest=void 0;var po=ke(),qf;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=po.MessageDirection.serverToClient,n.type=new po.ProtocolRequestType0(n.method)})(qf||(Cr.WorkspaceFoldersRequest=qf={}));var kf;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=po.MessageDirection.clientToServer,n.type=new po.ProtocolNotificationType(n.method)})(kf||(Cr.DidChangeWorkspaceFoldersNotification=kf={}))});var Ff=P(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.ConfigurationRequest=void 0;var Ef=ke(),Of;(function(n){n.method="workspace/configuration",n.messageDirection=Ef.MessageDirection.serverToClient,n.type=new Ef.ProtocolRequestType(n.method)})(Of||(go.ConfigurationRequest=Of={}))});var Nf=P(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.ColorPresentationRequest=Dr.DocumentColorRequest=void 0;var mo=ke(),Lf;(function(n){n.method="textDocument/documentColor",n.messageDirection=mo.MessageDirection.clientToServer,n.type=new mo.ProtocolRequestType(n.method)})(Lf||(Dr.DocumentColorRequest=Lf={}));var Mf;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=mo.MessageDirection.clientToServer,n.type=new mo.ProtocolRequestType(n.method)})(Mf||(Dr.ColorPresentationRequest=Mf={}))});var Hf=P(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.FoldingRangeRefreshRequest=Sr.FoldingRangeRequest=void 0;var yo=ke(),Af;(function(n){n.method="textDocument/foldingRange",n.messageDirection=yo.MessageDirection.clientToServer,n.type=new yo.ProtocolRequestType(n.method)})(Af||(Sr.FoldingRangeRequest=Af={}));var jf;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=yo.MessageDirection.serverToClient,n.type=new yo.ProtocolRequestType0(n.method)})(jf||(Sr.FoldingRangeRefreshRequest=jf={}))});var Bf=P(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.DeclarationRequest=void 0;var Uf=ke(),Wf;(function(n){n.method="textDocument/declaration",n.messageDirection=Uf.MessageDirection.clientToServer,n.type=new Uf.ProtocolRequestType(n.method)})(Wf||(vo.DeclarationRequest=Wf={}))});var zf=P(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.SelectionRangeRequest=void 0;var Kf=ke(),$f;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Kf.MessageDirection.clientToServer,n.type=new Kf.ProtocolRequestType(n.method)})($f||(_o.SelectionRangeRequest=$f={}))});var Zf=P(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.WorkDoneProgressCancelNotification=Sn.WorkDoneProgressCreateRequest=Sn.WorkDoneProgress=void 0;var Rv=Bn(),bo=ke(),Vf;(function(n){n.type=new Rv.ProgressType;function e(t){return t===n.type}n.is=e})(Vf||(Sn.WorkDoneProgress=Vf={}));var Xf;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=bo.MessageDirection.serverToClient,n.type=new bo.ProtocolRequestType(n.method)})(Xf||(Sn.WorkDoneProgressCreateRequest=Xf={}));var Jf;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=bo.MessageDirection.clientToServer,n.type=new bo.ProtocolNotificationType(n.method)})(Jf||(Sn.WorkDoneProgressCancelNotification=Jf={}))});var eh=P(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.CallHierarchyOutgoingCallsRequest=Rn.CallHierarchyIncomingCallsRequest=Rn.CallHierarchyPrepareRequest=void 0;var Rr=ke(),Qf;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method)})(Qf||(Rn.CallHierarchyPrepareRequest=Qf={}));var Gf;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method)})(Gf||(Rn.CallHierarchyIncomingCallsRequest=Gf={}));var Yf;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method)})(Yf||(Rn.CallHierarchyOutgoingCallsRequest=Yf={}))});var sh=P(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.SemanticTokensRefreshRequest=gt.SemanticTokensRangeRequest=gt.SemanticTokensDeltaRequest=gt.SemanticTokensRequest=gt.SemanticTokensRegistrationType=gt.TokenFormat=void 0;var on=ke(),th;(function(n){n.Relative="relative"})(th||(gt.TokenFormat=th={}));var fi;(function(n){n.method="textDocument/semanticTokens",n.type=new on.RegistrationType(n.method)})(fi||(gt.SemanticTokensRegistrationType=fi={}));var nh;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=on.MessageDirection.clientToServer,n.type=new on.ProtocolRequestType(n.method),n.registrationMethod=fi.method})(nh||(gt.SemanticTokensRequest=nh={}));var rh;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=on.MessageDirection.clientToServer,n.type=new on.ProtocolRequestType(n.method),n.registrationMethod=fi.method})(rh||(gt.SemanticTokensDeltaRequest=rh={}));var ih;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=on.MessageDirection.clientToServer,n.type=new on.ProtocolRequestType(n.method),n.registrationMethod=fi.method})(ih||(gt.SemanticTokensRangeRequest=ih={}));var oh;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=on.MessageDirection.serverToClient,n.type=new on.ProtocolRequestType0(n.method)})(oh||(gt.SemanticTokensRefreshRequest=oh={}))});var uh=P(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.ShowDocumentRequest=void 0;var ah=ke(),ch;(function(n){n.method="window/showDocument",n.messageDirection=ah.MessageDirection.serverToClient,n.type=new ah.ProtocolRequestType(n.method)})(ch||(wo.ShowDocumentRequest=ch={}))});var fh=P(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.LinkedEditingRangeRequest=void 0;var lh=ke(),dh;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=lh.MessageDirection.clientToServer,n.type=new lh.ProtocolRequestType(n.method)})(dh||(Co.LinkedEditingRangeRequest=dh={}))});var bh=P(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.WillDeleteFilesRequest=st.DidDeleteFilesNotification=st.DidRenameFilesNotification=st.WillRenameFilesRequest=st.DidCreateFilesNotification=st.WillCreateFilesRequest=st.FileOperationPatternKind=void 0;var qt=ke(),hh;(function(n){n.file="file",n.folder="folder"})(hh||(st.FileOperationPatternKind=hh={}));var ph;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolRequestType(n.method)})(ph||(st.WillCreateFilesRequest=ph={}));var gh;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolNotificationType(n.method)})(gh||(st.DidCreateFilesNotification=gh={}));var mh;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolRequestType(n.method)})(mh||(st.WillRenameFilesRequest=mh={}));var yh;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolNotificationType(n.method)})(yh||(st.DidRenameFilesNotification=yh={}));var vh;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolNotificationType(n.method)})(vh||(st.DidDeleteFilesNotification=vh={}));var _h;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=qt.MessageDirection.clientToServer,n.type=new qt.ProtocolRequestType(n.method)})(_h||(st.WillDeleteFilesRequest=_h={}))});var Rh=P(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.MonikerRequest=Tn.MonikerKind=Tn.UniquenessLevel=void 0;var wh=ke(),Ch;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(Ch||(Tn.UniquenessLevel=Ch={}));var Dh;(function(n){n.$import="import",n.$export="export",n.local="local"})(Dh||(Tn.MonikerKind=Dh={}));var Sh;(function(n){n.method="textDocument/moniker",n.messageDirection=wh.MessageDirection.clientToServer,n.type=new wh.ProtocolRequestType(n.method)})(Sh||(Tn.MonikerRequest=Sh={}))});var qh=P(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.TypeHierarchySubtypesRequest=xn.TypeHierarchySupertypesRequest=xn.TypeHierarchyPrepareRequest=void 0;var Tr=ke(),Th;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=Tr.MessageDirection.clientToServer,n.type=new Tr.ProtocolRequestType(n.method)})(Th||(xn.TypeHierarchyPrepareRequest=Th={}));var xh;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=Tr.MessageDirection.clientToServer,n.type=new Tr.ProtocolRequestType(n.method)})(xh||(xn.TypeHierarchySupertypesRequest=xh={}));var Ph;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=Tr.MessageDirection.clientToServer,n.type=new Tr.ProtocolRequestType(n.method)})(Ph||(xn.TypeHierarchySubtypesRequest=Ph={}))});var Eh=P(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.InlineValueRefreshRequest=xr.InlineValueRequest=void 0;var Do=ke(),kh;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Do.MessageDirection.clientToServer,n.type=new Do.ProtocolRequestType(n.method)})(kh||(xr.InlineValueRequest=kh={}));var Ih;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Do.MessageDirection.serverToClient,n.type=new Do.ProtocolRequestType0(n.method)})(Ih||(xr.InlineValueRefreshRequest=Ih={}))});var Mh=P(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.InlayHintRefreshRequest=Pn.InlayHintResolveRequest=Pn.InlayHintRequest=void 0;var Pr=ke(),Oh;(function(n){n.method="textDocument/inlayHint",n.messageDirection=Pr.MessageDirection.clientToServer,n.type=new Pr.ProtocolRequestType(n.method)})(Oh||(Pn.InlayHintRequest=Oh={}));var Fh;(function(n){n.method="inlayHint/resolve",n.messageDirection=Pr.MessageDirection.clientToServer,n.type=new Pr.ProtocolRequestType(n.method)})(Fh||(Pn.InlayHintResolveRequest=Fh={}));var Lh;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=Pr.MessageDirection.serverToClient,n.type=new Pr.ProtocolRequestType0(n.method)})(Lh||(Pn.InlayHintRefreshRequest=Lh={}))});var Bh=P(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.DiagnosticRefreshRequest=kt.WorkspaceDiagnosticRequest=kt.DocumentDiagnosticRequest=kt.DocumentDiagnosticReportKind=kt.DiagnosticServerCancellationData=void 0;var Wh=Bn(),Tv=lo(),qr=ke(),Nh;(function(n){function e(t){let r=t;return r&&Tv.boolean(r.retriggerRequest)}n.is=e})(Nh||(kt.DiagnosticServerCancellationData=Nh={}));var Ah;(function(n){n.Full="full",n.Unchanged="unchanged"})(Ah||(kt.DocumentDiagnosticReportKind=Ah={}));var jh;(function(n){n.method="textDocument/diagnostic",n.messageDirection=qr.MessageDirection.clientToServer,n.type=new qr.ProtocolRequestType(n.method),n.partialResult=new Wh.ProgressType})(jh||(kt.DocumentDiagnosticRequest=jh={}));var Hh;(function(n){n.method="workspace/diagnostic",n.messageDirection=qr.MessageDirection.clientToServer,n.type=new qr.ProtocolRequestType(n.method),n.partialResult=new Wh.ProgressType})(Hh||(kt.WorkspaceDiagnosticRequest=Hh={}));var Uh;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=qr.MessageDirection.serverToClient,n.type=new qr.ProtocolRequestType0(n.method)})(Uh||(kt.DiagnosticRefreshRequest=Uh={}))});var Zh=P(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.DidCloseNotebookDocumentNotification=Me.DidSaveNotebookDocumentNotification=Me.DidChangeNotebookDocumentNotification=Me.NotebookCellArrayChange=Me.DidOpenNotebookDocumentNotification=Me.NotebookDocumentSyncRegistrationType=Me.NotebookDocument=Me.NotebookCell=Me.ExecutionSummary=Me.NotebookCellKind=void 0;var hi=(uo(),Ni(co)),Nt=lo(),Jt=ke(),Bc;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Bc||(Me.NotebookCellKind=Bc={}));var Kc;(function(n){function e(i,o){let s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){let o=i;return Nt.objectLiteral(o)&&hi.uinteger.is(o.executionOrder)&&(o.success===void 0||Nt.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(Kc||(Me.ExecutionSummary=Kc={}));var So;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){let s=o;return Nt.objectLiteral(s)&&Bc.is(s.kind)&&hi.DocumentUri.is(s.document)&&(s.metadata===void 0||Nt.objectLiteral(s.metadata))}n.is=t;function r(o,s){let a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!Kc.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;let a=Array.isArray(o),u=Array.isArray(s);if(a!==u)return!1;if(a&&u){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(Nt.objectLiteral(o)&&Nt.objectLiteral(s)){let l=Object.keys(o),f=Object.keys(s);if(l.length!==f.length||(l.sort(),f.sort(),!i(l,f)))return!1;for(let g=0;g<l.length;g++){let p=l[g];if(!i(o[p],s[p]))return!1}}return!0}})(So||(Me.NotebookCell=So={}));var Kh;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){let i=r;return Nt.objectLiteral(i)&&Nt.string(i.uri)&&hi.integer.is(i.version)&&Nt.typedArray(i.cells,So.is)}n.is=t})(Kh||(Me.NotebookDocument=Kh={}));var kr;(function(n){n.method="notebookDocument/sync",n.messageDirection=Jt.MessageDirection.clientToServer,n.type=new Jt.RegistrationType(n.method)})(kr||(Me.NotebookDocumentSyncRegistrationType=kr={}));var $h;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=Jt.MessageDirection.clientToServer,n.type=new Jt.ProtocolNotificationType(n.method),n.registrationMethod=kr.method})($h||(Me.DidOpenNotebookDocumentNotification=$h={}));var zh;(function(n){function e(r){let i=r;return Nt.objectLiteral(i)&&hi.uinteger.is(i.start)&&hi.uinteger.is(i.deleteCount)&&(i.cells===void 0||Nt.typedArray(i.cells,So.is))}n.is=e;function t(r,i,o){let s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(zh||(Me.NotebookCellArrayChange=zh={}));var Vh;(function(n){n.method="notebookDocument/didChange",n.messageDirection=Jt.MessageDirection.clientToServer,n.type=new Jt.ProtocolNotificationType(n.method),n.registrationMethod=kr.method})(Vh||(Me.DidChangeNotebookDocumentNotification=Vh={}));var Xh;(function(n){n.method="notebookDocument/didSave",n.messageDirection=Jt.MessageDirection.clientToServer,n.type=new Jt.ProtocolNotificationType(n.method),n.registrationMethod=kr.method})(Xh||(Me.DidSaveNotebookDocumentNotification=Xh={}));var Jh;(function(n){n.method="notebookDocument/didClose",n.messageDirection=Jt.MessageDirection.clientToServer,n.type=new Jt.ProtocolNotificationType(n.method),n.registrationMethod=kr.method})(Jh||(Me.DidCloseNotebookDocumentNotification=Jh={}))});var Yh=P(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.InlineCompletionRequest=void 0;var Qh=ke(),Gh;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=Qh.MessageDirection.clientToServer,n.type=new Qh.ProtocolRequestType(n.method)})(Gh||(Ro.InlineCompletionRequest=Gh={}))});var fg=P(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.WorkspaceSymbolRequest=m.CodeActionResolveRequest=m.CodeActionRequest=m.DocumentSymbolRequest=m.DocumentHighlightRequest=m.ReferencesRequest=m.DefinitionRequest=m.SignatureHelpRequest=m.SignatureHelpTriggerKind=m.HoverRequest=m.CompletionResolveRequest=m.CompletionRequest=m.CompletionTriggerKind=m.PublishDiagnosticsNotification=m.WatchKind=m.RelativePattern=m.FileChangeType=m.DidChangeWatchedFilesNotification=m.WillSaveTextDocumentWaitUntilRequest=m.WillSaveTextDocumentNotification=m.TextDocumentSaveReason=m.DidSaveTextDocumentNotification=m.DidCloseTextDocumentNotification=m.DidChangeTextDocumentNotification=m.TextDocumentContentChangeEvent=m.DidOpenTextDocumentNotification=m.TextDocumentSyncKind=m.TelemetryEventNotification=m.LogMessageNotification=m.ShowMessageRequest=m.ShowMessageNotification=m.MessageType=m.DidChangeConfigurationNotification=m.ExitNotification=m.ShutdownRequest=m.InitializedNotification=m.InitializeErrorCodes=m.InitializeRequest=m.WorkDoneProgressOptions=m.TextDocumentRegistrationOptions=m.StaticRegistrationOptions=m.PositionEncodingKind=m.FailureHandlingKind=m.ResourceOperationKind=m.UnregistrationRequest=m.RegistrationRequest=m.DocumentSelector=m.NotebookCellTextDocumentFilter=m.NotebookDocumentFilter=m.TextDocumentFilter=void 0;m.MonikerRequest=m.MonikerKind=m.UniquenessLevel=m.WillDeleteFilesRequest=m.DidDeleteFilesNotification=m.WillRenameFilesRequest=m.DidRenameFilesNotification=m.WillCreateFilesRequest=m.DidCreateFilesNotification=m.FileOperationPatternKind=m.LinkedEditingRangeRequest=m.ShowDocumentRequest=m.SemanticTokensRegistrationType=m.SemanticTokensRefreshRequest=m.SemanticTokensRangeRequest=m.SemanticTokensDeltaRequest=m.SemanticTokensRequest=m.TokenFormat=m.CallHierarchyPrepareRequest=m.CallHierarchyOutgoingCallsRequest=m.CallHierarchyIncomingCallsRequest=m.WorkDoneProgressCancelNotification=m.WorkDoneProgressCreateRequest=m.WorkDoneProgress=m.SelectionRangeRequest=m.DeclarationRequest=m.FoldingRangeRefreshRequest=m.FoldingRangeRequest=m.ColorPresentationRequest=m.DocumentColorRequest=m.ConfigurationRequest=m.DidChangeWorkspaceFoldersNotification=m.WorkspaceFoldersRequest=m.TypeDefinitionRequest=m.ImplementationRequest=m.ApplyWorkspaceEditRequest=m.ExecuteCommandRequest=m.PrepareRenameRequest=m.RenameRequest=m.PrepareSupportDefaultBehavior=m.DocumentOnTypeFormattingRequest=m.DocumentRangesFormattingRequest=m.DocumentRangeFormattingRequest=m.DocumentFormattingRequest=m.DocumentLinkResolveRequest=m.DocumentLinkRequest=m.CodeLensRefreshRequest=m.CodeLensResolveRequest=m.CodeLensRequest=m.WorkspaceSymbolResolveRequest=void 0;m.InlineCompletionRequest=m.DidCloseNotebookDocumentNotification=m.DidSaveNotebookDocumentNotification=m.DidChangeNotebookDocumentNotification=m.NotebookCellArrayChange=m.DidOpenNotebookDocumentNotification=m.NotebookDocumentSyncRegistrationType=m.NotebookDocument=m.NotebookCell=m.ExecutionSummary=m.NotebookCellKind=m.DiagnosticRefreshRequest=m.WorkspaceDiagnosticRequest=m.DocumentDiagnosticRequest=m.DocumentDiagnosticReportKind=m.DiagnosticServerCancellationData=m.InlayHintRefreshRequest=m.InlayHintResolveRequest=m.InlayHintRequest=m.InlineValueRefreshRequest=m.InlineValueRequest=m.TypeHierarchySupertypesRequest=m.TypeHierarchySubtypesRequest=m.TypeHierarchyPrepareRequest=void 0;var I=ke(),ep=(uo(),Ni(co)),Je=lo(),xv=Rf();Object.defineProperty(m,"ImplementationRequest",{enumerable:!0,get:function(){return xv.ImplementationRequest}});var Pv=Pf();Object.defineProperty(m,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Pv.TypeDefinitionRequest}});var cg=If();Object.defineProperty(m,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return cg.WorkspaceFoldersRequest}});Object.defineProperty(m,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return cg.DidChangeWorkspaceFoldersNotification}});var qv=Ff();Object.defineProperty(m,"ConfigurationRequest",{enumerable:!0,get:function(){return qv.ConfigurationRequest}});var ug=Nf();Object.defineProperty(m,"DocumentColorRequest",{enumerable:!0,get:function(){return ug.DocumentColorRequest}});Object.defineProperty(m,"ColorPresentationRequest",{enumerable:!0,get:function(){return ug.ColorPresentationRequest}});var lg=Hf();Object.defineProperty(m,"FoldingRangeRequest",{enumerable:!0,get:function(){return lg.FoldingRangeRequest}});Object.defineProperty(m,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return lg.FoldingRangeRefreshRequest}});var kv=Bf();Object.defineProperty(m,"DeclarationRequest",{enumerable:!0,get:function(){return kv.DeclarationRequest}});var Iv=zf();Object.defineProperty(m,"SelectionRangeRequest",{enumerable:!0,get:function(){return Iv.SelectionRangeRequest}});var Jc=Zf();Object.defineProperty(m,"WorkDoneProgress",{enumerable:!0,get:function(){return Jc.WorkDoneProgress}});Object.defineProperty(m,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Jc.WorkDoneProgressCreateRequest}});Object.defineProperty(m,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Jc.WorkDoneProgressCancelNotification}});var Zc=eh();Object.defineProperty(m,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Zc.CallHierarchyIncomingCallsRequest}});Object.defineProperty(m,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Zc.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(m,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Zc.CallHierarchyPrepareRequest}});var Ir=sh();Object.defineProperty(m,"TokenFormat",{enumerable:!0,get:function(){return Ir.TokenFormat}});Object.defineProperty(m,"SemanticTokensRequest",{enumerable:!0,get:function(){return Ir.SemanticTokensRequest}});Object.defineProperty(m,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Ir.SemanticTokensDeltaRequest}});Object.defineProperty(m,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Ir.SemanticTokensRangeRequest}});Object.defineProperty(m,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Ir.SemanticTokensRefreshRequest}});Object.defineProperty(m,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Ir.SemanticTokensRegistrationType}});var Ev=uh();Object.defineProperty(m,"ShowDocumentRequest",{enumerable:!0,get:function(){return Ev.ShowDocumentRequest}});var Ov=fh();Object.defineProperty(m,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Ov.LinkedEditingRangeRequest}});var zn=bh();Object.defineProperty(m,"FileOperationPatternKind",{enumerable:!0,get:function(){return zn.FileOperationPatternKind}});Object.defineProperty(m,"DidCreateFilesNotification",{enumerable:!0,get:function(){return zn.DidCreateFilesNotification}});Object.defineProperty(m,"WillCreateFilesRequest",{enumerable:!0,get:function(){return zn.WillCreateFilesRequest}});Object.defineProperty(m,"DidRenameFilesNotification",{enumerable:!0,get:function(){return zn.DidRenameFilesNotification}});Object.defineProperty(m,"WillRenameFilesRequest",{enumerable:!0,get:function(){return zn.WillRenameFilesRequest}});Object.defineProperty(m,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return zn.DidDeleteFilesNotification}});Object.defineProperty(m,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return zn.WillDeleteFilesRequest}});var Qc=Rh();Object.defineProperty(m,"UniquenessLevel",{enumerable:!0,get:function(){return Qc.UniquenessLevel}});Object.defineProperty(m,"MonikerKind",{enumerable:!0,get:function(){return Qc.MonikerKind}});Object.defineProperty(m,"MonikerRequest",{enumerable:!0,get:function(){return Qc.MonikerRequest}});var Gc=qh();Object.defineProperty(m,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Gc.TypeHierarchyPrepareRequest}});Object.defineProperty(m,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Gc.TypeHierarchySubtypesRequest}});Object.defineProperty(m,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Gc.TypeHierarchySupertypesRequest}});var dg=Eh();Object.defineProperty(m,"InlineValueRequest",{enumerable:!0,get:function(){return dg.InlineValueRequest}});Object.defineProperty(m,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return dg.InlineValueRefreshRequest}});var Yc=Mh();Object.defineProperty(m,"InlayHintRequest",{enumerable:!0,get:function(){return Yc.InlayHintRequest}});Object.defineProperty(m,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Yc.InlayHintResolveRequest}});Object.defineProperty(m,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Yc.InlayHintRefreshRequest}});var pi=Bh();Object.defineProperty(m,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return pi.DiagnosticServerCancellationData}});Object.defineProperty(m,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return pi.DocumentDiagnosticReportKind}});Object.defineProperty(m,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return pi.DocumentDiagnosticRequest}});Object.defineProperty(m,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return pi.WorkspaceDiagnosticRequest}});Object.defineProperty(m,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return pi.DiagnosticRefreshRequest}});var Zt=Zh();Object.defineProperty(m,"NotebookCellKind",{enumerable:!0,get:function(){return Zt.NotebookCellKind}});Object.defineProperty(m,"ExecutionSummary",{enumerable:!0,get:function(){return Zt.ExecutionSummary}});Object.defineProperty(m,"NotebookCell",{enumerable:!0,get:function(){return Zt.NotebookCell}});Object.defineProperty(m,"NotebookDocument",{enumerable:!0,get:function(){return Zt.NotebookDocument}});Object.defineProperty(m,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Zt.NotebookDocumentSyncRegistrationType}});Object.defineProperty(m,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidOpenNotebookDocumentNotification}});Object.defineProperty(m,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Zt.NotebookCellArrayChange}});Object.defineProperty(m,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidChangeNotebookDocumentNotification}});Object.defineProperty(m,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidSaveNotebookDocumentNotification}});Object.defineProperty(m,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Zt.DidCloseNotebookDocumentNotification}});var Fv=Yh();Object.defineProperty(m,"InlineCompletionRequest",{enumerable:!0,get:function(){return Fv.InlineCompletionRequest}});var $c;(function(n){function e(t){let r=t;return Je.string(r)||Je.string(r.language)||Je.string(r.scheme)||Je.string(r.pattern)}n.is=e})($c||(m.TextDocumentFilter=$c={}));var zc;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(Je.string(r.notebookType)||Je.string(r.scheme)||Je.string(r.pattern))}n.is=e})(zc||(m.NotebookDocumentFilter=zc={}));var Vc;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(Je.string(r.notebook)||zc.is(r.notebook))&&(r.language===void 0||Je.string(r.language))}n.is=e})(Vc||(m.NotebookCellTextDocumentFilter=Vc={}));var Xc;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!Je.string(r)&&!$c.is(r)&&!Vc.is(r))return!1;return!0}n.is=e})(Xc||(m.DocumentSelector=Xc={}));var tp;(function(n){n.method="client/registerCapability",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(tp||(m.RegistrationRequest=tp={}));var np;(function(n){n.method="client/unregisterCapability",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(np||(m.UnregistrationRequest=np={}));var rp;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(rp||(m.ResourceOperationKind=rp={}));var ip;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(ip||(m.FailureHandlingKind=ip={}));var op;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(op||(m.PositionEncodingKind=op={}));var sp;(function(n){function e(t){let r=t;return r&&Je.string(r.id)&&r.id.length>0}n.hasId=e})(sp||(m.StaticRegistrationOptions=sp={}));var ap;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Xc.is(r.documentSelector))}n.is=e})(ap||(m.TextDocumentRegistrationOptions=ap={}));var cp;(function(n){function e(r){let i=r;return Je.objectLiteral(i)&&(i.workDoneProgress===void 0||Je.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&Je.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(cp||(m.WorkDoneProgressOptions=cp={}));var up;(function(n){n.method="initialize",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(up||(m.InitializeRequest=up={}));var lp;(function(n){n.unknownProtocolVersion=1})(lp||(m.InitializeErrorCodes=lp={}));var dp;(function(n){n.method="initialized",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(dp||(m.InitializedNotification=dp={}));var fp;(function(n){n.method="shutdown",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType0(n.method)})(fp||(m.ShutdownRequest=fp={}));var hp;(function(n){n.method="exit",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType0(n.method)})(hp||(m.ExitNotification=hp={}));var pp;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(pp||(m.DidChangeConfigurationNotification=pp={}));var gp;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(gp||(m.MessageType=gp={}));var mp;(function(n){n.method="window/showMessage",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(mp||(m.ShowMessageNotification=mp={}));var yp;(function(n){n.method="window/showMessageRequest",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType(n.method)})(yp||(m.ShowMessageRequest=yp={}));var vp;(function(n){n.method="window/logMessage",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(vp||(m.LogMessageNotification=vp={}));var _p;(function(n){n.method="telemetry/event",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(_p||(m.TelemetryEventNotification=_p={}));var bp;(function(n){n.None=0,n.Full=1,n.Incremental=2})(bp||(m.TextDocumentSyncKind=bp={}));var wp;(function(n){n.method="textDocument/didOpen",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(wp||(m.DidOpenTextDocumentNotification=wp={}));var Cp;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(Cp||(m.TextDocumentContentChangeEvent=Cp={}));var Dp;(function(n){n.method="textDocument/didChange",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Dp||(m.DidChangeTextDocumentNotification=Dp={}));var Sp;(function(n){n.method="textDocument/didClose",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Sp||(m.DidCloseTextDocumentNotification=Sp={}));var Rp;(function(n){n.method="textDocument/didSave",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(Rp||(m.DidSaveTextDocumentNotification=Rp={}));var Tp;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(Tp||(m.TextDocumentSaveReason=Tp={}));var xp;(function(n){n.method="textDocument/willSave",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(xp||(m.WillSaveTextDocumentNotification=xp={}));var Pp;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Pp||(m.WillSaveTextDocumentWaitUntilRequest=Pp={}));var qp;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolNotificationType(n.method)})(qp||(m.DidChangeWatchedFilesNotification=qp={}));var kp;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(kp||(m.FileChangeType=kp={}));var Ip;(function(n){function e(t){let r=t;return Je.objectLiteral(r)&&(ep.URI.is(r.baseUri)||ep.WorkspaceFolder.is(r.baseUri))&&Je.string(r.pattern)}n.is=e})(Ip||(m.RelativePattern=Ip={}));var Ep;(function(n){n.Create=1,n.Change=2,n.Delete=4})(Ep||(m.WatchKind=Ep={}));var Op;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolNotificationType(n.method)})(Op||(m.PublishDiagnosticsNotification=Op={}));var Fp;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(Fp||(m.CompletionTriggerKind=Fp={}));var Lp;(function(n){n.method="textDocument/completion",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Lp||(m.CompletionRequest=Lp={}));var Mp;(function(n){n.method="completionItem/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Mp||(m.CompletionResolveRequest=Mp={}));var Np;(function(n){n.method="textDocument/hover",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Np||(m.HoverRequest=Np={}));var Ap;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(Ap||(m.SignatureHelpTriggerKind=Ap={}));var jp;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(jp||(m.SignatureHelpRequest=jp={}));var Hp;(function(n){n.method="textDocument/definition",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Hp||(m.DefinitionRequest=Hp={}));var Up;(function(n){n.method="textDocument/references",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Up||(m.ReferencesRequest=Up={}));var Wp;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Wp||(m.DocumentHighlightRequest=Wp={}));var Bp;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Bp||(m.DocumentSymbolRequest=Bp={}));var Kp;(function(n){n.method="textDocument/codeAction",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Kp||(m.CodeActionRequest=Kp={}));var $p;(function(n){n.method="codeAction/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})($p||(m.CodeActionResolveRequest=$p={}));var zp;(function(n){n.method="workspace/symbol",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(zp||(m.WorkspaceSymbolRequest=zp={}));var Vp;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Vp||(m.WorkspaceSymbolResolveRequest=Vp={}));var Xp;(function(n){n.method="textDocument/codeLens",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Xp||(m.CodeLensRequest=Xp={}));var Jp;(function(n){n.method="codeLens/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Jp||(m.CodeLensResolveRequest=Jp={}));var Zp;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType0(n.method)})(Zp||(m.CodeLensRefreshRequest=Zp={}));var Qp;(function(n){n.method="textDocument/documentLink",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Qp||(m.DocumentLinkRequest=Qp={}));var Gp;(function(n){n.method="documentLink/resolve",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Gp||(m.DocumentLinkResolveRequest=Gp={}));var Yp;(function(n){n.method="textDocument/formatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(Yp||(m.DocumentFormattingRequest=Yp={}));var eg;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(eg||(m.DocumentRangeFormattingRequest=eg={}));var tg;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(tg||(m.DocumentRangesFormattingRequest=tg={}));var ng;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(ng||(m.DocumentOnTypeFormattingRequest=ng={}));var rg;(function(n){n.Identifier=1})(rg||(m.PrepareSupportDefaultBehavior=rg={}));var ig;(function(n){n.method="textDocument/rename",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(ig||(m.RenameRequest=ig={}));var og;(function(n){n.method="textDocument/prepareRename",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(og||(m.PrepareRenameRequest=og={}));var sg;(function(n){n.method="workspace/executeCommand",n.messageDirection=I.MessageDirection.clientToServer,n.type=new I.ProtocolRequestType(n.method)})(sg||(m.ExecuteCommandRequest=sg={}));var ag;(function(n){n.method="workspace/applyEdit",n.messageDirection=I.MessageDirection.serverToClient,n.type=new I.ProtocolRequestType("workspace/applyEdit")})(ag||(m.ApplyWorkspaceEditRequest=ag={}))});var pg=P(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.createProtocolConnection=void 0;var hg=Bn();function Lv(n,e,t,r){return hg.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,hg.createMessageConnection)(n,e,t,r)}To.createProtocolConnection=Lv});var mg=P(mt=>{"use strict";var Mv=mt&&mt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),xo=mt&&mt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Mv(e,n,t)};Object.defineProperty(mt,"__esModule",{value:!0});mt.LSPErrorCodes=mt.createProtocolConnection=void 0;xo(Bn(),mt);xo((uo(),Ni(co)),mt);xo(ke(),mt);xo(fg(),mt);var Nv=pg();Object.defineProperty(mt,"createProtocolConnection",{enumerable:!0,get:function(){return Nv.createProtocolConnection}});var gg;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(gg||(mt.LSPErrorCodes=gg={}))});var J=P(Qt=>{"use strict";var Av=Qt&&Qt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),yg=Qt&&Qt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Av(e,n,t)};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.createProtocolConnection=void 0;var jv=La();yg(La(),Qt);yg(mg(),Qt);function Hv(n,e,t,r){return(0,jv.createMessageConnection)(n,e,t,r)}Qt.createProtocolConnection=Hv});var At=P(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.asPromise=Ne.thenable=Ne.typedArray=Ne.stringArray=Ne.array=Ne.func=Ne.error=Ne.number=Ne.string=Ne.boolean=void 0;function Uv(n){return n===!0||n===!1}Ne.boolean=Uv;function vg(n){return typeof n=="string"||n instanceof String}Ne.string=vg;function Wv(n){return typeof n=="number"||n instanceof Number}Ne.number=Wv;function Bv(n){return n instanceof Error}Ne.error=Bv;function _g(n){return typeof n=="function"}Ne.func=_g;function bg(n){return Array.isArray(n)}Ne.array=bg;function Kv(n){return bg(n)&&n.every(e=>vg(e))}Ne.stringArray=Kv;function $v(n,e){return Array.isArray(n)&&n.every(e)}Ne.typedArray=$v;function wg(n){return n&&_g(n.then)}Ne.thenable=wg;function zv(n){return n instanceof Promise?n:wg(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}Ne.asPromise=zv});var Ie=P(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.generateUuid=It.parse=It.isUUID=It.v4=It.empty=void 0;var gi=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},te=class extends gi{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return te._oneOf(te._chars)}constructor(){super([te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),"-",te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),"-","4",te._randomHex(),te._randomHex(),te._randomHex(),"-",te._oneOf(te._timeHighBits),te._randomHex(),te._randomHex(),te._randomHex(),"-",te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex(),te._randomHex()].join(""))}};te._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];te._timeHighBits=["8","9","a","b"];It.empty=new gi("00000000-0000-0000-0000-000000000000");function Cg(){return new te}It.v4=Cg;var Vv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Dg(n){return Vv.test(n)}It.isUUID=Dg;function Xv(n){if(!Dg(n))throw new Error("invalid uuid");return new gi(n)}It.parse=Xv;function Jv(){return Cg().asHex()}It.generateUuid=Jv});var ue=P(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.WorkspaceFeature=Ze.TextDocumentLanguageFeature=Ze.TextDocumentEventFeature=Ze.DynamicDocumentFeature=Ze.DynamicFeature=Ze.StaticFeature=Ze.ensure=Ze.LSPCancellationError=void 0;var Vn=require("vscode"),eu=J(),ft=At(),Sg=Ie(),tu=class extends Vn.CancellationError{constructor(e){super(),this.data=e}};Ze.LSPCancellationError=tu;function Zv(n,e){return n[e]===void 0&&(n[e]={}),n[e]}Ze.ensure=Zv;var Rg;(function(n){function e(t){let r=t;return r!=null&&ft.func(r.fillClientCapabilities)&&ft.func(r.initialize)&&ft.func(r.getState)&&ft.func(r.clear)&&(r.fillInitializeParams===void 0||ft.func(r.fillInitializeParams))}n.is=e})(Rg||(Ze.StaticFeature=Rg={}));var Tg;(function(n){function e(t){let r=t;return r!=null&&ft.func(r.fillClientCapabilities)&&ft.func(r.initialize)&&ft.func(r.getState)&&ft.func(r.clear)&&(r.fillInitializeParams===void 0||ft.func(r.fillInitializeParams))&&ft.func(r.register)&&ft.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(Tg||(Ze.DynamicFeature=Tg={}));var mi=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let o of Vn.workspace.textDocuments)if(Vn.languages.match(i,o)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};Ze.DynamicDocumentFeature=mi;var nu=class extends mi{static textDocumentFilter(e,t){for(let r of e)if(Vn.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,o,s,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Vn.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Vn.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};Ze.TextDocumentEventFeature=nu;var ru=class extends mi{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(eu.TextDocumentRegistrationOptions.is(t)){let r=eu.StaticRegistrationOptions.hasId(t)?t.id:Sg.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(ft.boolean(t)&&t===!0||eu.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=ft.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Sg.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return ft.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Vn.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Ze.TextDocumentLanguageFeature=ru;var iu=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};Ze.WorkspaceFeature=iu});var Pg=P((bC,xg)=>{var Qv=typeof process=="object"&&process&&process.platform==="win32";xg.exports=Qv?{sep:"\\"}:{sep:"/"}});var Og=P((wC,Eg)=>{"use strict";Eg.exports=kg;function kg(n,e,t){n instanceof RegExp&&(n=qg(n,t)),e instanceof RegExp&&(e=qg(e,t));var r=Ig(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function qg(n,e){var t=e.match(n);return t?t[0]:null}kg.range=Ig;function Ig(n,e,t){var r,i,o,s,a,u=t.indexOf(n),l=t.indexOf(e,u+1),f=u;if(u>=0&&l>0){if(n===e)return[u,l];for(r=[],o=t.length;f>=0&&!a;)f==u?(r.push(f),u=t.indexOf(n,f+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,f+1)),f=u<l&&u>=0?u:l;r.length&&(a=[o,s])}return a}});var Ug=P((CC,Hg)=>{var Fg=Og();Hg.exports=e_;var Lg="\0SLASH"+Math.random()+"\0",Mg="\0OPEN"+Math.random()+"\0",su="\0CLOSE"+Math.random()+"\0",Ng="\0COMMA"+Math.random()+"\0",Ag="\0PERIOD"+Math.random()+"\0";function ou(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function Gv(n){return n.split("\\\\").join(Lg).split("\\{").join(Mg).split("\\}").join(su).split("\\,").join(Ng).split("\\.").join(Ag)}function Yv(n){return n.split(Lg).join("\\").split(Mg).join("{").split(su).join("}").split(Ng).join(",").split(Ag).join(".")}function jg(n){if(!n)return[""];var e=[],t=Fg("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=jg(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function e_(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),yi(Gv(n),!0).map(Yv)):[]}function t_(n){return"{"+n+"}"}function n_(n){return/^-?0\d/.test(n)}function r_(n,e){return n<=e}function i_(n,e){return n>=e}function yi(n,e){var t=[],r=Fg("{","}",n);if(!r)return[n];var i=r.pre,o=r.post.length?yi(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var a=i+"{"+r.body+"}"+o[s];t.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),f=u||l,g=r.body.indexOf(",")>=0;if(!f&&!g)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+su+r.post,yi(n)):[n];var p;if(f)p=r.body.split(/\.\./);else if(p=jg(r.body),p.length===1&&(p=yi(p[0],!1).map(t_),p.length===1))return o.map(function(Ue){return r.pre+p[0]+Ue});var y;if(f){var h=ou(p[0]),b=ou(p[1]),D=Math.max(p[0].length,p[1].length),q=p.length==3?Math.abs(ou(p[2])):1,K=r_,j=b<h;j&&(q*=-1,K=i_);var fe=p.some(n_);y=[];for(var $=h;K($,b);$+=q){var ae;if(l)ae=String.fromCharCode($),ae==="\\"&&(ae="");else if(ae=String($),fe){var W=D-ae.length;if(W>0){var Z=new Array(W+1).join("0");$<0?ae="-"+Z+ae.slice(1):ae=Z+ae}}y.push(ae)}}else{y=[];for(var ne=0;ne<p.length;ne++)y.push.apply(y,yi(p[ne],!1))}for(var ne=0;ne<y.length;ne++)for(var s=0;s<o.length;s++){var a=i+y[ne]+o[s];(!e||f||a)&&t.push(a)}}return t}});var qo=P((SC,du)=>{var Dt=du.exports=(n,e,t={})=>(Po(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Er(e,t).match(n));du.exports=Dt;var uu=Pg();Dt.sep=uu.sep;var jt=Symbol("globstar **");Dt.GLOBSTAR=jt;var o_=Ug(),Wg={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},lu="[^/]",au=lu+"*?",s_="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",a_="(?:(?!(?:\\/|^)\\.).)*?",$g=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),Bg=$g("().*{}+?[]^$\\!"),c_=$g("[.("),Kg=/\/+/;Dt.filter=(n,e={})=>(t,r,i)=>Dt(t,n,e);var qn=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Dt.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Dt;let e=Dt,t=(r,i,o)=>e(r,i,qn(n,o));return t.Minimatch=class extends e.Minimatch{constructor(i,o){super(i,qn(n,o))}},t.Minimatch.defaults=r=>e.defaults(qn(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,qn(n,i)),t.defaults=r=>e.defaults(qn(n,r)),t.makeRe=(r,i)=>e.makeRe(r,qn(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,qn(n,i)),t.match=(r,i,o)=>e.match(r,i,qn(n,o)),t};Dt.braceExpand=(n,e)=>zg(n,e);var zg=(n,e={})=>(Po(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:o_(n)),u_=1024*64,Po=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>u_)throw new TypeError("pattern is too long")},cu=Symbol("subparse");Dt.makeRe=(n,e)=>new Er(n,e||{}).makeRe();Dt.match=(n,e,t={})=>{let r=new Er(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var l_=n=>n.replace(/\\(.)/g,"$1"),d_=n=>n.replace(/\\([^-\]])/g,"$1"),f_=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),h_=n=>n.replace(/[[\]\\]/g,"\\$&"),Er=class{constructor(e,t){Po(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Kg)),this.debug(this.pattern,r),r=r.map((i,o,s)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,a=e.length,u=t.length;o<a&&s<u;o++,s++){this.debug("matchOne loop");var l=t[s],f=e[o];if(this.debug(t,l,f),l===!1)return!1;if(l===jt){this.debug("GLOBSTAR",[t,l,f]);var g=o,p=s+1;if(p===u){for(this.debug("** at the end");o<a;o++)if(e[o]==="."||e[o]===".."||!i.dot&&e[o].charAt(0)===".")return!1;return!0}for(;g<a;){var y=e[g];if(this.debug(`
globstar while`,e,g,t,p,y),this.matchOne(e.slice(g),t.slice(p),r))return this.debug("globstar found match!",g,a,y),!0;if(y==="."||y===".."||!i.dot&&y.charAt(0)==="."){this.debug("dot detected!",e,g,t,p);break}this.debug("globstar swallow a segment, and continue"),g++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,g,t,p),g===a))}var h;if(typeof l=="string"?(h=f===l,this.debug("string match",l,f,h)):(h=f.match(l),this.debug("pattern match",l,f,h)),!h)return!1}if(o===a&&s===u)return!0;if(o===a)return r;if(s===u)return o===a-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return zg(this.pattern,this.options)}parse(e,t){Po(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return jt;if(e==="")return"";let i="",o=!1,s=!1,a=[],u=[],l,f=!1,g=-1,p=-1,y,h,b,D=e.charAt(0)===".",q=r.dot||D,K=()=>D?"":q?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",j=W=>W.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",fe=()=>{if(l){switch(l){case"*":i+=au,o=!0;break;case"?":i+=lu,o=!0;break;default:i+="\\"+l;break}this.debug("clearStateChar %j %j",l,i),l=!1}};for(let W=0,Z;W<e.length&&(Z=e.charAt(W));W++){if(this.debug("%s	%s %s %j",e,W,i,Z),s){if(Z==="/")return!1;Bg[Z]&&(i+="\\"),i+=Z,s=!1;continue}switch(Z){case"/":return!1;case"\\":if(f&&e.charAt(W+1)==="-"){i+=Z;continue}fe(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,W,i,Z),f){this.debug("  in class"),Z==="!"&&W===p+1&&(Z="^"),i+=Z;continue}this.debug("call clearStateChar %j",l),fe(),l=Z,r.noext&&fe();continue;case"(":{if(f){i+="(";continue}if(!l){i+="\\(";continue}let ne={type:l,start:W-1,reStart:i.length,open:Wg[l].open,close:Wg[l].close};this.debug(this.pattern,"	",ne),a.push(ne),i+=ne.open,ne.start===0&&ne.type!=="!"&&(D=!0,i+=j(e.slice(W+1))),this.debug("plType %j %j",l,i),l=!1;continue}case")":{let ne=a[a.length-1];if(f||!ne){i+="\\)";continue}a.pop(),fe(),o=!0,h=ne,i+=h.close,h.type==="!"&&u.push(Object.assign(h,{reEnd:i.length}));continue}case"|":{let ne=a[a.length-1];if(f||!ne){i+="\\|";continue}fe(),i+="|",ne.start===0&&ne.type!=="!"&&(D=!0,i+=j(e.slice(W+1)));continue}case"[":if(fe(),f){i+="\\"+Z;continue}f=!0,p=W,g=i.length,i+=Z;continue;case"]":if(W===p+1||!f){i+="\\"+Z;continue}y=e.substring(p+1,W);try{RegExp("["+h_(d_(y))+"]"),i+=Z}catch{i=i.substring(0,g)+"(?:$.)"}o=!0,f=!1;continue;default:fe(),Bg[Z]&&!(Z==="^"&&f)&&(i+="\\"),i+=Z;break}}for(f&&(y=e.slice(p+1),b=this.parse(y,cu),i=i.substring(0,g)+"\\["+b[0],o=o||b[1]),h=a.pop();h;h=a.pop()){let W;W=i.slice(h.reStart+h.open.length),this.debug("setting tail",i,h),W=W.replace(/((?:\\{2}){0,64})(\\?)\|/g,(ne,Ue,O)=>(O||(O="\\"),Ue+Ue+O+"|")),this.debug(`tail=%j
   %s`,W,W,h,i);let Z=h.type==="*"?au:h.type==="?"?lu:"\\"+h.type;o=!0,i=i.slice(0,h.reStart)+Z+"\\("+W}fe(),s&&(i+="\\\\");let $=c_[i.charAt(0)];for(let W=u.length-1;W>-1;W--){let Z=u[W],ne=i.slice(0,Z.reStart),Ue=i.slice(Z.reStart,Z.reEnd-8),O=i.slice(Z.reEnd),x=i.slice(Z.reEnd-8,Z.reEnd)+O,L=ne.split(")").length,N=ne.split("(").length-L,ee=O;for(let X=0;X<N;X++)ee=ee.replace(/\)[+*?]?/,"");O=ee;let B=O===""&&t!==cu?"(?:$|\\/)":"";i=ne+Ue+O+B+x}if(i!==""&&o&&(i="(?=.)"+i),$&&(i=K()+i),t===cu)return[i,o];if(r.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return l_(e);let ae=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",ae),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?au:t.dot?s_:a_,i=t.nocase?"i":"",o=e.map(s=>(s=s.map(a=>typeof a=="string"?f_(a):a===jt?jt:a._src).reduce((a,u)=>(a[a.length-1]===jt&&u===jt||a.push(u),a),[]),s.forEach((a,u)=>{a!==jt||s[u-1]===jt||(u===0?s.length>1?s[u+1]="(?:\\/|"+r+"\\/)?"+s[u+1]:s[u]=r:u===s.length-1?s[u-1]+="(?:\\/|"+r+")?":(s[u-1]+="(?:\\/|\\/"+r+"\\/)"+s[u+1],s[u+1]=jt))}),s.filter(a=>a!==jt).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;uu.sep!=="/"&&(e=e.split(uu.sep).join("/")),e=e.split(Kg),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<i.length;s++){let a=i[s],u=e;if(r.matchBase&&a.length===1&&(u=[o]),this.matchOne(u,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Dt.defaults(e).Minimatch}};Dt.Minimatch=Er});var vu=P(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.DiagnosticFeature=kn.DiagnosticPullMode=kn.vsdiag=void 0;var p_=qo(),oe=require("vscode"),Ae=J(),g_=Ie(),fu=ue();function ko(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Et;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Et||(kn.vsdiag=Et={}));var Io;(function(n){n.onType="onType",n.onSave="onSave"})(Io||(kn.DiagnosticPullMode=Io={}));var at;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(at||(at={}));var Xn=class{constructor(){this.open=new Set,this._onOpen=new oe.EventEmitter,this._onClose=new oe.EventEmitter,Xn.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;Xn.fillTabResources(i);let o=new Set,s=new Set(i);for(let a of r.values())i.has(a)?s.delete(a):o.add(a);if(this.open=i,o.size>0){let a=new Set;for(let u of o)a.add(oe.Uri.parse(u));this._onClose.fire(a)}if(s.size>0){let a=new Set;for(let u of s)a.add(oe.Uri.parse(u));this._onOpen.fire(a)}};oe.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=oe.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof oe.Uri?oe.window.activeTextEditor?.document.uri===e:oe.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof oe.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return Xn.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of oe.window.tabGroups.all)for(let o of i.tabs){let s=o.input,a;s instanceof oe.TabInputText?a=s.uri:s instanceof oe.TabInputTextDiff?a=s.modified:s instanceof oe.TabInputCustom&&(a=s.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},Be;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Be||(Be={}));var sn;(function(n){function e(t){return t instanceof oe.Uri?t.toString():t.uri.toString()}n.asKey=e})(sn||(sn={}));var hu=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Be.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=t instanceof oe.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],u=i.get(o);return u===void 0&&(u={document:s,pulledVersion:a,resultId:void 0},i.set(o,u)),u}update(e,t,r,i){let o=e===Be.document?this.documentPullStates:this.workspacePullStates,[s,a,u,l]=t instanceof oe.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],f=o.get(s);f===void 0?(f={document:a,pulledVersion:u,resultId:l},o.set(s,f)):(f.pulledVersion=u,f.resultId=l)}unTrack(e,t){let r=sn.asKey(t);(e===Be.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=sn.asKey(t);return(e===Be.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){let r=sn.asKey(t);return(e===Be.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},pu=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new oe.EventEmitter,this.provider=this.createProvider(),this.diagnostics=oe.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new hu,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof oe.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof oe.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof oe.Uri,i=r?e:e.uri,o=i.toString();t=r?t:e.version;let s=this.openRequests.get(o),a=r?this.documentStates.track(Be.document,e,t):this.documentStates.track(Be.document,e);if(s===void 0){let u=new oe.CancellationTokenSource;this.openRequests.set(o,{state:at.active,document:e,version:t,tokenSource:u});let l,f;try{l=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:Et.DocumentDiagnosticReportKind.full,items:[]}}catch(g){if(g instanceof fu.LSPCancellationError&&Ae.DiagnosticServerCancellationData.is(g.data)&&g.data.retriggerRequest===!1&&(f={state:at.outDated,document:e}),f===void 0&&g instanceof oe.CancellationError)f={state:at.reschedule,document:e};else throw g}if(f=f??this.openRequests.get(o),f===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${o}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(o),!this.tabs.isVisible(e)){this.documentStates.unTrack(Be.document,e);return}if(f.state===at.outDated)return;l!==void 0&&(l.kind===Et.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,l.items),a.pulledVersion=t,a.resultId=l.resultId),f.state===at.reschedule&&this.pull(e)}else s.state===at.active?(s.tokenSource.cancel(),this.openRequests.set(o,{state:at.reschedule,document:s.document})):s.state===at.outDated&&this.openRequests.set(o,{state:at.reschedule,document:s.document})}forgetDocument(e){let t=e instanceof oe.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:at.reschedule,document:e}):this.pull(e,()=>{this.forget(Be.document,e)}):(i!==void 0&&(i.state===at.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:at.outDated,document:e})),this.diagnostics.delete(t),this.forget(Be.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ae.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof fu.LSPCancellationError)&&!Ae.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ae.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new oe.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Et.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Be.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Be.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let o=(a,u,l)=>{let f={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof oe.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:Et.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Ae.DocumentDiagnosticRequest.type,f,l).then(async g=>g==null||this.isDisposed||l.isCancellationRequested?{kind:Et.DocumentDiagnosticReportKind.full,items:[]}:g.kind===Ae.DocumentDiagnosticReportKind.Full?{kind:Et.DocumentDiagnosticReportKind.full,resultId:g.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(g.items,l)}:{kind:Et.DocumentDiagnosticReportKind.unChanged,resultId:g.resultId},g=>this.client.handleFailedRequest(Ae.DocumentDiagnosticRequest.type,l,g,{kind:Et.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let o=async l=>l.kind===Ae.DocumentDiagnosticReportKind.Full?{kind:Et.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:Et.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{let f=[];for(let g of l)f.push({uri:this.client.code2ProtocolConverter.asUri(g.uri),value:g.value});return f},a=(l,f)=>{let g=(0,g_.generateUuid)(),p=this.client.onProgress(Ae.WorkspaceDiagnosticRequest.partialResult,g,async h=>{if(h==null){i(null);return}let b={items:[]};for(let D of h.items)try{b.items.push(await o(D))}catch(q){this.client.error("Converting workspace diagnostics failed.",q)}i(b)}),y={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:g};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Ae.WorkspaceDiagnosticRequest.type,y,f).then(async h=>{if(f.isCancellationRequested)return{items:[]};let b={items:[]};for(let D of h.items)b.items.push(await o(D));return p.dispose(),i(b),{items:[]}},h=>(p.dispose(),this.client.handleFailedRequest(Ae.DocumentDiagnosticRequest.type,f,h,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===at.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:at.outDated,document:t.document});this.diagnostics.dispose()}},gu=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Ae.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=sn.asKey(e);this.documents.has(t)||(this.documents.set(t,e,Ae.Touch.Last),this.trigger())}remove(e){let t=sn.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ae.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=sn.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,Ae.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?sn.asKey(this.endDocument):void 0}},mu=class{constructor(e,t,r){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=h=>{let b=r.documentSelector;if(i.match!==void 0)return i.match(b,h);for(let D of b)if(Ae.TextDocumentFilter.is(D)){if(typeof D=="string"||D.language!==void 0&&D.language!=="*"||D.scheme!==void 0&&D.scheme!=="*"&&D.scheme!==h.scheme)return!1;if(D.pattern!==void 0){let q=new p_.Minimatch(D.pattern,{noext:!0});if(!q.makeRe()||!q.match(h.fsPath))return!1}}return!0},u=h=>h instanceof oe.Uri?a(h):oe.languages.match(o,h)>0&&t.isVisible(h),l=h=>h instanceof oe.Uri?this.activeTextDocument?.uri.toString()===h.toString():this.activeTextDocument===h;this.diagnosticRequestor=new pu(e,t,r),this.backgroundScheduler=new gu(this.diagnosticRequestor);let f=h=>{!u(h)||!r.interFileDependencies||l(h)||this.backgroundScheduler.add(h)};this.activeTextDocument=oe.window.activeTextEditor?.document,oe.window.onDidChangeActiveTextEditor(h=>{let b=this.activeTextDocument;this.activeTextDocument=h?.document,b!==void 0&&f(b),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let g=e.getFeature(Ae.DidOpenTextDocumentNotification.method);s.push(g.onNotificationSent(h=>{let b=h.textDocument;this.diagnosticRequestor.knows(Be.document,b)||u(b)&&this.diagnosticRequestor.pull(b,()=>{f(b)})})),s.push(t.onOpen(h=>{for(let b of h){if(this.diagnosticRequestor.knows(Be.document,b))continue;let D=b.toString(),q;for(let K of oe.workspace.textDocuments)if(D===K.uri.toString()){q=K;break}q!==void 0&&u(q)&&this.diagnosticRequestor.pull(q,()=>{f(q)})}}));let p=new Set;for(let h of oe.workspace.textDocuments)u(h)&&(this.diagnosticRequestor.pull(h,()=>{f(h)}),p.add(h.uri.toString()));if(i.onTabs===!0)for(let h of t.getTabResources())!p.has(h.toString())&&u(h)&&this.diagnosticRequestor.pull(h,()=>{f(h)});if(i.onChange===!0){let h=e.getFeature(Ae.DidChangeTextDocumentNotification.method);s.push(h.onNotificationSent(async b=>{let D=b.textDocument;(i.filter===void 0||!i.filter(D,Io.onType))&&this.diagnosticRequestor.knows(Be.document,D)&&this.diagnosticRequestor.pull(D,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let h=e.getFeature(Ae.DidSaveTextDocumentNotification.method);s.push(h.onNotificationSent(b=>{let D=b.textDocument;(i.filter===void 0||!i.filter(D,Io.onSave))&&this.diagnosticRequestor.knows(Be.document,D)&&this.diagnosticRequestor.pull(b.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let y=e.getFeature(Ae.DidCloseTextDocumentNotification.method);s.push(y.onNotificationSent(h=>{this.cleanUpDocument(h.textDocument)})),t.onClose(h=>{for(let b of h)this.cleanUpDocument(b)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let h of oe.workspace.textDocuments)u(h)&&this.diagnosticRequestor.pull(h)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=oe.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Be.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},yu=class extends fu.TextDocumentLanguageFeature{constructor(e){super(e,Ae.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=ko(ko(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,ko(ko(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ae.DiagnosticRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Xn);let t=new mu(this._client,this.tabs,e);return[t.disposable,t]}};kn.DiagnosticFeature=yu});var Eo=P(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.forEach=ct.mapAsync=ct.map=ct.clearTestMode=ct.setTestMode=ct.Semaphore=ct.Delayer=void 0;var _i=J(),_u=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,_i.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};ct.Delayer=_u;var bu=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,_i.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};ct.Semaphore=bu;var wu=!1;function m_(){wu=!0}ct.setTestMode=m_;function y_(){wu=!1}ct.clearTestMode=y_;var Vg=15,vi=class{constructor(e=Vg){this.yieldAfter=wu===!0?Math.max(e,2):Math.max(e,Vg),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function v_(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new vi(r?.yieldAfter);function s(u){o.start();for(let l=u;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,_i.RAL)().timer.setImmediate(()=>{u(s(a))})});return i}ct.map=v_;async function __(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new vi(r?.yieldAfter);async function s(u){o.start();for(let l=u;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r?.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,_i.RAL)().timer.setImmediate(()=>{u(s(a))})});return i}ct.mapAsync=__;async function b_(n,e,t,r){if(n.length===0)return;let i=new vi(r?.yieldAfter);function o(a){i.start();for(let u=a;u<n.length;u++)if(e(n[u]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,_i.RAL)().timer.setImmediate(()=>{a(o(s))})})}ct.forEach=b_});var Su=P(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});var w_=require("vscode"),Cu=class extends w_.CompletionItem{constructor(e){super(e)}};Du.default=Cu});var xu=P(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});var C_=require("vscode"),Ru=class extends C_.CodeLens{constructor(e){super(e)}};Tu.default=Ru});var ku=P(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});var D_=require("vscode"),Pu=class extends D_.DocumentLink{constructor(e,t){super(e,t)}};qu.default=Pu});var Ou=P(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});var S_=require("vscode"),Iu=class extends S_.CodeAction{constructor(e,t){super(e),this.data=t}};Eu.default=Iu});var Mu=P(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.ProtocolDiagnostic=Or.DiagnosticCode=void 0;var R_=require("vscode"),Fu=At(),Xg;(function(n){function e(t){let r=t;return r!=null&&(Fu.number(r.value)||Fu.string(r.value))&&Fu.string(r.target)}n.is=e})(Xg||(Or.DiagnosticCode=Xg={}));var Lu=class extends R_.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};Or.ProtocolDiagnostic=Lu});var ju=P(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});var T_=require("vscode"),Nu=class extends T_.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};Au.default=Nu});var Wu=P(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});var x_=require("vscode"),Hu=class extends x_.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}};Uu.default=Hu});var $u=P(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});var Oo=require("vscode"),Bu=class extends Oo.SymbolInformation{constructor(e,t,r,i,o){let s=!(i instanceof Oo.Uri);super(e,t,r,s?i:new Oo.Location(i,new Oo.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}};Ku.default=Bu});var Xu=P(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});var P_=require("vscode"),zu=class extends P_.InlayHint{constructor(e,t,r){super(e,t,r)}};Vu.default=zu});var Gg=P(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.createConverter=void 0;var He=require("vscode"),Q=J(),Jn=At(),Jg=Eo(),q_=Su(),k_=xu(),I_=ku(),Zg=Ou(),Qg=Mu(),E_=ju(),O_=Wu(),F_=$u(),L_=Xu(),Ju;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Ju||(Ju={}));function M_(n){let t=n||(d=>d.toString());function r(d){return t(d)}function i(d){return{uri:t(d.uri)}}function o(d){return{uri:t(d.uri),languageId:d.languageId,version:d.version,text:d.getText()}}function s(d){return{uri:t(d.uri),version:d.version}}function a(d){return{textDocument:o(d)}}function u(d){let C=d;return!!C.document&&!!C.contentChanges}function l(d){let C=d;return!!C.uri&&!!C.version}function f(d,C,A){if(l(d))return{textDocument:{uri:t(d.uri),version:d.version},contentChanges:[{text:d.getText()}]};if(u(d)){let ve=C,Ce=A;return{textDocument:{uri:t(ve),version:Ce},contentChanges:d.contentChanges.map(bt=>{let $t=bt.range;return{range:{start:{line:$t.start.line,character:$t.start.character},end:{line:$t.end.line,character:$t.end.character}},rangeLength:bt.rangeLength,text:bt.text}})}}else throw Error("Unsupported text document change parameter")}function g(d){return{textDocument:i(d)}}function p(d,C=!1){let A={textDocument:i(d)};return C&&(A.text=d.getText()),A}function y(d){switch(d){case He.TextDocumentSaveReason.Manual:return Q.TextDocumentSaveReason.Manual;case He.TextDocumentSaveReason.AfterDelay:return Q.TextDocumentSaveReason.AfterDelay;case He.TextDocumentSaveReason.FocusOut:return Q.TextDocumentSaveReason.FocusOut}return Q.TextDocumentSaveReason.Manual}function h(d){return{textDocument:i(d.document),reason:y(d.reason)}}function b(d){return{files:d.files.map(C=>({uri:t(C)}))}}function D(d){return{files:d.files.map(C=>({oldUri:t(C.oldUri),newUri:t(C.newUri)}))}}function q(d){return{files:d.files.map(C=>({uri:t(C)}))}}function K(d){return{files:d.files.map(C=>({uri:t(C)}))}}function j(d){return{files:d.files.map(C=>({oldUri:t(C.oldUri),newUri:t(C.newUri)}))}}function fe(d){return{files:d.files.map(C=>({uri:t(C)}))}}function $(d,C){return{textDocument:i(d),position:ee(C)}}function ae(d){switch(d){case He.CompletionTriggerKind.TriggerCharacter:return Q.CompletionTriggerKind.TriggerCharacter;case He.CompletionTriggerKind.TriggerForIncompleteCompletions:return Q.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Q.CompletionTriggerKind.Invoked}}function W(d,C,A){return{textDocument:i(d),position:ee(C),context:{triggerKind:ae(A.triggerKind),triggerCharacter:A.triggerCharacter}}}function Z(d){switch(d){case He.SignatureHelpTriggerKind.Invoke:return Q.SignatureHelpTriggerKind.Invoked;case He.SignatureHelpTriggerKind.TriggerCharacter:return Q.SignatureHelpTriggerKind.TriggerCharacter;case He.SignatureHelpTriggerKind.ContentChange:return Q.SignatureHelpTriggerKind.ContentChange}}function ne(d){return{label:d.label}}function Ue(d){return d.map(ne)}function O(d){return{label:d.label,parameters:Ue(d.parameters)}}function x(d){return d.map(O)}function L(d){return d===void 0?d:{signatures:x(d.signatures),activeSignature:d.activeSignature,activeParameter:d.activeParameter}}function N(d,C,A){return{textDocument:i(d),position:ee(C),context:{isRetrigger:A.isRetrigger,triggerCharacter:A.triggerCharacter,triggerKind:Z(A.triggerKind),activeSignatureHelp:L(A.activeSignatureHelp)}}}function ee(d){return{line:d.line,character:d.character}}function B(d){return d==null?d:{line:d.line>Q.uinteger.MAX_VALUE?Q.uinteger.MAX_VALUE:d.line,character:d.character>Q.uinteger.MAX_VALUE?Q.uinteger.MAX_VALUE:d.character}}function X(d,C){return Jg.map(d,B,C)}function Ke(d){return d.map(B)}function ce(d){return d==null?d:{start:B(d.start),end:B(d.end)}}function he(d){return d.map(ce)}function rt(d){return d==null?d:Q.Location.create(r(d.uri),ce(d.range))}function Lt(d){switch(d){case He.DiagnosticSeverity.Error:return Q.DiagnosticSeverity.Error;case He.DiagnosticSeverity.Warning:return Q.DiagnosticSeverity.Warning;case He.DiagnosticSeverity.Information:return Q.DiagnosticSeverity.Information;case He.DiagnosticSeverity.Hint:return Q.DiagnosticSeverity.Hint}}function $r(d){if(!d)return;let C=[];for(let A of d){let ve=Mn(A);ve!==void 0&&C.push(ve)}return C.length>0?C:void 0}function Mn(d){switch(d){case He.DiagnosticTag.Unnecessary:return Q.DiagnosticTag.Unnecessary;case He.DiagnosticTag.Deprecated:return Q.DiagnosticTag.Deprecated;default:return}}function Nn(d){return{message:d.message,location:rt(d.location)}}function rr(d){return d.map(Nn)}function zr(d){if(d!=null)return Jn.number(d)||Jn.string(d)?d:{value:d.value,target:r(d.target)}}function An(d){let C=Q.Diagnostic.create(ce(d.range),d.message),A=d instanceof Qg.ProtocolDiagnostic?d:void 0;A!==void 0&&A.data!==void 0&&(C.data=A.data);let ve=zr(d.code);return Qg.DiagnosticCode.is(ve)?A!==void 0&&A.hasDiagnosticCode?C.code=ve:(C.code=ve.value,C.codeDescription={href:ve.target}):C.code=ve,Jn.number(d.severity)&&(C.severity=Lt(d.severity)),Array.isArray(d.tags)&&(C.tags=$r(d.tags)),d.relatedInformation&&(C.relatedInformation=rr(d.relatedInformation)),d.source&&(C.source=d.source),C}function pn(d,C){return d==null?d:Jg.map(d,An,C)}function gn(d){return d==null?d:d.map(An)}function Vr(d,C){switch(d){case"$string":return C;case Q.MarkupKind.PlainText:return{kind:d,value:C};case Q.MarkupKind.Markdown:return{kind:d,value:C.value};default:return`Unsupported Markup content received. Kind is: ${d}`}}function Ge(d){switch(d){case He.CompletionItemTag.Deprecated:return Q.CompletionItemTag.Deprecated}}function ir(d){if(d===void 0)return d;let C=[];for(let A of d){let ve=Ge(A);ve!==void 0&&C.push(ve)}return C}function mn(d,C){return C!==void 0?C:d+1}function en(d,C=!1){let A,ve;Jn.string(d.label)?A=d.label:(A=d.label.label,C&&(d.label.detail!==void 0||d.label.description!==void 0)&&(ve={detail:d.label.detail,description:d.label.description}));let Ce={label:A};ve!==void 0&&(Ce.labelDetails=ve);let ze=d instanceof q_.default?d:void 0;d.detail&&(Ce.detail=d.detail),d.documentation&&(!ze||ze.documentationFormat==="$string"?Ce.documentation=d.documentation:Ce.documentation=Vr(ze.documentationFormat,d.documentation)),d.filterText&&(Ce.filterText=d.filterText),Xr(Ce,d),Jn.number(d.kind)&&(Ce.kind=mn(d.kind,ze&&ze.originalItemKind)),d.sortText&&(Ce.sortText=d.sortText),d.additionalTextEdits&&(Ce.additionalTextEdits=$e(d.additionalTextEdits)),d.commitCharacters&&(Ce.commitCharacters=d.commitCharacters.slice()),d.command&&(Ce.command=M(d.command)),(d.preselect===!0||d.preselect===!1)&&(Ce.preselect=d.preselect);let bt=ir(d.tags);if(ze){if(ze.data!==void 0&&(Ce.data=ze.data),ze.deprecated===!0||ze.deprecated===!1){if(ze.deprecated===!0&&bt!==void 0&&bt.length>0){let $t=bt.indexOf(He.CompletionItemTag.Deprecated);$t!==-1&&bt.splice($t,1)}Ce.deprecated=ze.deprecated}ze.insertTextMode!==void 0&&(Ce.insertTextMode=ze.insertTextMode)}return bt!==void 0&&bt.length>0&&(Ce.tags=bt),Ce.insertTextMode===void 0&&d.keepWhitespace===!0&&(Ce.insertTextMode=Q.InsertTextMode.adjustIndentation),Ce}function Xr(d,C){let A=Q.InsertTextFormat.PlainText,ve,Ce;C.textEdit?(ve=C.textEdit.newText,Ce=C.textEdit.range):C.insertText instanceof He.SnippetString?(A=Q.InsertTextFormat.Snippet,ve=C.insertText.value):ve=C.insertText,C.range&&(Ce=C.range),d.insertTextFormat=A,C.fromEdit&&ve!==void 0&&Ce!==void 0?d.textEdit=tn(ve,Ce):d.insertText=ve}function tn(d,C){return Ju.is(C)?Q.InsertReplaceEdit.create(d,ce(C.inserting),ce(C.replacing)):{newText:d,range:ce(C)}}function jn(d){return{range:ce(d.range),newText:d.newText}}function $e(d){return d==null?d:d.map(jn)}function _t(d){return d<=He.SymbolKind.TypeParameter?d+1:Q.SymbolKind.Property}function ht(d){return d}function Kt(d){return d.map(ht)}function nn(d,C,A){return{textDocument:i(d),position:ee(C),context:{includeDeclaration:A.includeDeclaration}}}async function Hn(d,C){let A=Q.CodeAction.create(d.title);if(d instanceof Zg.default&&d.data!==void 0&&(A.data=d.data),d.kind!==void 0&&(A.kind=v(d.kind)),d.diagnostics!==void 0&&(A.diagnostics=await pn(d.diagnostics,C)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(A.command=M(d.command)),d.isPreferred!==void 0&&(A.isPreferred=d.isPreferred),d.disabled!==void 0&&(A.disabled={reason:d.disabled.reason}),A}function or(d){let C=Q.CodeAction.create(d.title);if(d instanceof Zg.default&&d.data!==void 0&&(C.data=d.data),d.kind!==void 0&&(C.kind=v(d.kind)),d.diagnostics!==void 0&&(C.diagnostics=gn(d.diagnostics)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(C.command=M(d.command)),d.isPreferred!==void 0&&(C.isPreferred=d.isPreferred),d.disabled!==void 0&&(C.disabled={reason:d.disabled.reason}),C}async function yn(d,C){if(d==null)return d;let A;return d.only&&Jn.string(d.only.value)&&(A=[d.only.value]),Q.CodeActionContext.create(await pn(d.diagnostics,C),A,xt(d.triggerKind))}function sr(d){if(d==null)return d;let C;return d.only&&Jn.string(d.only.value)&&(C=[d.only.value]),Q.CodeActionContext.create(gn(d.diagnostics),C,xt(d.triggerKind))}function xt(d){switch(d){case He.CodeActionTriggerKind.Invoke:return Q.CodeActionTriggerKind.Invoked;case He.CodeActionTriggerKind.Automatic:return Q.CodeActionTriggerKind.Automatic;default:return}}function v(d){if(d!=null)return d.value}function R(d){return d==null?d:Q.InlineValueContext.create(d.frameId,ce(d.stoppedLocation))}function E(d,C,A){return{context:Q.InlineCompletionContext.create(A.triggerKind,A.selectedCompletionInfo),textDocument:i(d),position:B(C)}}function M(d){let C=Q.Command.create(d.title,d.command);return d.arguments&&(C.arguments=d.arguments),C}function ye(d){let C=Q.CodeLens.create(ce(d.range));return d.command&&(C.command=M(d.command)),d instanceof k_.default&&d.data&&(C.data=d.data),C}function pe(d,C){let A={tabSize:d.tabSize,insertSpaces:d.insertSpaces};return C.trimTrailingWhitespace&&(A.trimTrailingWhitespace=!0),C.trimFinalNewlines&&(A.trimFinalNewlines=!0),C.insertFinalNewline&&(A.insertFinalNewline=!0),A}function De(d){return{textDocument:i(d)}}function xe(d){return{textDocument:i(d)}}function re(d){let C=Q.DocumentLink.create(ce(d.range));d.target&&(C.target=r(d.target)),d.tooltip!==void 0&&(C.tooltip=d.tooltip);let A=d instanceof I_.default?d:void 0;return A&&A.data&&(C.data=A.data),C}function we(d){return{textDocument:i(d)}}function le(d){let C={name:d.name,kind:_t(d.kind),uri:r(d.uri),range:ce(d.range),selectionRange:ce(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(C.detail=d.detail),d.tags!==void 0&&(C.tags=Kt(d.tags)),d instanceof E_.default&&d.data!==void 0&&(C.data=d.data),C}function Pe(d){let C={name:d.name,kind:_t(d.kind),uri:r(d.uri),range:ce(d.range),selectionRange:ce(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(C.detail=d.detail),d.tags!==void 0&&(C.tags=Kt(d.tags)),d instanceof O_.default&&d.data!==void 0&&(C.data=d.data),C}function We(d){let C=d instanceof F_.default?{name:d.name,kind:_t(d.kind),location:d.hasRange?rt(d.location):{uri:t(d.location.uri)},data:d.data}:{name:d.name,kind:_t(d.kind),location:rt(d.location)};return d.tags!==void 0&&(C.tags=Kt(d.tags)),d.containerName!==""&&(C.containerName=d.containerName),C}function dt(d){let C=typeof d.label=="string"?d.label:d.label.map(Jr),A=Q.InlayHint.create(B(d.position),C);return d.kind!==void 0&&(A.kind=d.kind),d.textEdits!==void 0&&(A.textEdits=$e(d.textEdits)),d.tooltip!==void 0&&(A.tooltip=Zr(d.tooltip)),d.paddingLeft!==void 0&&(A.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(A.paddingRight=d.paddingRight),d instanceof L_.default&&d.data!==void 0&&(A.data=d.data),A}function Jr(d){let C=Q.InlayHintLabelPart.create(d.value);return d.location!==void 0&&(C.location=rt(d.location)),d.command!==void 0&&(C.command=M(d.command)),d.tooltip!==void 0&&(C.tooltip=Zr(d.tooltip)),C}function Zr(d){return typeof d=="string"?d:{kind:Q.MarkupKind.Markdown,value:d.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:f,asCloseTextDocumentParams:g,asSaveTextDocumentParams:p,asWillSaveTextDocumentParams:h,asDidCreateFilesParams:b,asDidRenameFilesParams:D,asDidDeleteFilesParams:q,asWillCreateFilesParams:K,asWillRenameFilesParams:j,asWillDeleteFilesParams:fe,asTextDocumentPositionParams:$,asCompletionParams:W,asSignatureHelpParams:N,asWorkerPosition:ee,asRange:ce,asRanges:he,asPosition:B,asPositions:X,asPositionsSync:Ke,asLocation:rt,asDiagnosticSeverity:Lt,asDiagnosticTag:Mn,asDiagnostic:An,asDiagnostics:pn,asDiagnosticsSync:gn,asCompletionItem:en,asTextEdit:jn,asSymbolKind:_t,asSymbolTag:ht,asSymbolTags:Kt,asReferenceParams:nn,asCodeAction:Hn,asCodeActionSync:or,asCodeActionContext:yn,asCodeActionContextSync:sr,asInlineValueContext:R,asCommand:M,asCodeLens:ye,asFormattingOptions:pe,asDocumentSymbolParams:De,asCodeLensParams:xe,asDocumentLink:re,asDocumentLinkParams:we,asCallHierarchyItem:le,asTypeHierarchyItem:Pe,asInlayHint:dt,asWorkspaceSymbol:We,asInlineCompletionParams:E}}Fo.createConverter=M_});var tm=P(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.createConverter=void 0;var F=require("vscode"),V=J(),Ot=At(),de=Eo(),N_=Su(),A_=xu(),j_=ku(),H_=Ou(),Yg=Mu(),U_=ju(),W_=Wu(),B_=$u(),K_=Xu(),em=J(),Lo;(function(n){function e(t){let r=t;return r&&Ot.string(r.language)&&Ot.string(r.value)}n.is=e})(Lo||(Lo={}));function $_(n,e,t){let i=n||(c=>F.Uri.parse(c));function o(c){return i(c)}function s(c){let _=[];for(let T of c)if(typeof T=="string")_.push(T);else if(em.NotebookCellTextDocumentFilter.is(T))if(typeof T.notebook=="string")_.push({notebookType:T.notebook,language:T.language});else{let H=T.notebook.notebookType??"*";_.push({notebookType:H,scheme:T.notebook.scheme,pattern:T.notebook.pattern,language:T.language})}else em.TextDocumentFilter.is(T)&&_.push({language:T.language,scheme:T.scheme,pattern:T.pattern});return _}async function a(c,_){return de.map(c,l,_)}function u(c){let _=new Array(c.length);for(let T=0;T<c.length;T++)_[T]=l(c[T]);return _}function l(c){let _=new Yg.ProtocolDiagnostic(h(c.range),c.message,D(c.severity),c.data);if(c.code!==void 0){if(typeof c.code=="string"||typeof c.code=="number")V.CodeDescription.is(c.codeDescription)?_.code={value:c.code,target:o(c.codeDescription.href)}:_.code=c.code;else if(Yg.DiagnosticCode.is(c.code)){_.hasDiagnosticCode=!0;let T=c.code;_.code={value:T.value,target:o(T.target)}}}return c.source&&(_.source=c.source),c.relatedInformation&&(_.relatedInformation=f(c.relatedInformation)),Array.isArray(c.tags)&&(_.tags=g(c.tags)),_}function f(c){let _=new Array(c.length);for(let T=0;T<c.length;T++){let H=c[T];_[T]=new F.DiagnosticRelatedInformation(Lt(H.location),H.message)}return _}function g(c){if(!c)return;let _=[];for(let T of c){let H=p(T);H!==void 0&&_.push(H)}return _.length>0?_:void 0}function p(c){switch(c){case V.DiagnosticTag.Unnecessary:return F.DiagnosticTag.Unnecessary;case V.DiagnosticTag.Deprecated:return F.DiagnosticTag.Deprecated;default:return}}function y(c){return c?new F.Position(c.line,c.character):void 0}function h(c){return c?new F.Range(c.start.line,c.start.character,c.end.line,c.end.character):void 0}async function b(c,_){return de.map(c,T=>new F.Range(T.start.line,T.start.character,T.end.line,T.end.character),_)}function D(c){if(c==null)return F.DiagnosticSeverity.Error;switch(c){case V.DiagnosticSeverity.Error:return F.DiagnosticSeverity.Error;case V.DiagnosticSeverity.Warning:return F.DiagnosticSeverity.Warning;case V.DiagnosticSeverity.Information:return F.DiagnosticSeverity.Information;case V.DiagnosticSeverity.Hint:return F.DiagnosticSeverity.Hint}return F.DiagnosticSeverity.Error}function q(c){if(Ot.string(c))return j(c);if(Lo.is(c))return j().appendCodeblock(c.value,c.language);if(Array.isArray(c)){let _=[];for(let T of c){let H=j();Lo.is(T)?H.appendCodeblock(T.value,T.language):H.appendMarkdown(T),_.push(H)}return _}else return j(c)}function K(c){if(Ot.string(c))return c;switch(c.kind){case V.MarkupKind.Markdown:return j(c.value);case V.MarkupKind.PlainText:return c.value;default:return`Unsupported Markup content received. Kind is: ${c.kind}`}}function j(c){let _;if(c===void 0||typeof c=="string")_=new F.MarkdownString(c);else switch(c.kind){case V.MarkupKind.Markdown:_=new F.MarkdownString(c.value);break;case V.MarkupKind.PlainText:_=new F.MarkdownString,_.appendText(c.value);break;default:_=new F.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${c.kind}`);break}return _.isTrusted=e,_.supportHtml=t,_}function fe(c){if(c)return new F.Hover(q(c.contents),h(c.range))}async function $(c,_,T){if(!c)return;if(Array.isArray(c))return de.map(c,zt=>Ue(zt,_),T);let H=c,{defaultRange:Ve,commitCharacters:Ye}=ae(H,_),be=await de.map(H.items,zt=>Ue(zt,Ye,Ve,H.itemDefaults?.insertTextMode,H.itemDefaults?.insertTextFormat,H.itemDefaults?.data),T);return new F.CompletionList(be,H.isIncomplete)}function ae(c,_){let T=c.itemDefaults?.editRange,H=c.itemDefaults?.commitCharacters??_;return V.Range.is(T)?{defaultRange:h(T),commitCharacters:H}:T!==void 0?{defaultRange:{inserting:h(T.insert),replacing:h(T.replace)},commitCharacters:H}:{defaultRange:void 0,commitCharacters:H}}function W(c){return V.CompletionItemKind.Text<=c&&c<=V.CompletionItemKind.TypeParameter?[c-1,void 0]:[F.CompletionItemKind.Text,c]}function Z(c){switch(c){case V.CompletionItemTag.Deprecated:return F.CompletionItemTag.Deprecated}}function ne(c){if(c==null)return[];let _=[];for(let T of c){let H=Z(T);H!==void 0&&_.push(H)}return _}function Ue(c,_,T,H,Ve,Ye){let be=ne(c.tags),zt=O(c),Se=new N_.default(zt);c.detail&&(Se.detail=c.detail),c.documentation&&(Se.documentation=K(c.documentation),Se.documentationFormat=Ot.string(c.documentation)?"$string":c.documentation.kind),c.filterText&&(Se.filterText=c.filterText);let Mi=x(c,T,Ve);if(Mi&&(Se.insertText=Mi.text,Se.range=Mi.range,Se.fromEdit=Mi.fromEdit),Ot.number(c.kind)){let[Ny,Bd]=W(c.kind);Se.kind=Ny,Bd&&(Se.originalItemKind=Bd)}c.sortText&&(Se.sortText=c.sortText),c.additionalTextEdits&&(Se.additionalTextEdits=B(c.additionalTextEdits));let Ud=c.commitCharacters!==void 0?Ot.stringArray(c.commitCharacters)?c.commitCharacters:void 0:_;Ud&&(Se.commitCharacters=Ud.slice()),c.command&&(Se.command=$e(c.command)),(c.deprecated===!0||c.deprecated===!1)&&(Se.deprecated=c.deprecated,c.deprecated===!0&&be.push(F.CompletionItemTag.Deprecated)),(c.preselect===!0||c.preselect===!1)&&(Se.preselect=c.preselect);let Wd=c.data??Ye;Wd!==void 0&&(Se.data=Wd),be.length>0&&(Se.tags=be);let xs=c.insertTextMode??H;return xs!==void 0&&(Se.insertTextMode=xs,xs===V.InsertTextMode.asIs&&(Se.keepWhitespace=!0)),Se}function O(c){return V.CompletionItemLabelDetails.is(c.labelDetails)?{label:c.label,detail:c.labelDetails.detail,description:c.labelDetails.description}:c.label}function x(c,_,T){let H=c.insertTextFormat??T;if(c.textEdit!==void 0||_!==void 0){let[Ve,Ye]=c.textEdit!==void 0?L(c.textEdit):[_,c.textEditText??c.label];return H===V.InsertTextFormat.Snippet?{text:new F.SnippetString(Ye),range:Ve,fromEdit:!0}:{text:Ye,range:Ve,fromEdit:!0}}else return c.insertText?H===V.InsertTextFormat.Snippet?{text:new F.SnippetString(c.insertText),fromEdit:!1}:{text:c.insertText,fromEdit:!1}:void 0}function L(c){return V.InsertReplaceEdit.is(c)?[{inserting:h(c.insert),replacing:h(c.replace)},c.newText]:[h(c.range),c.newText]}function N(c){if(c)return new F.TextEdit(h(c.range),c.newText)}async function ee(c,_){if(c)return de.map(c,N,_)}function B(c){if(!c)return;let _=new Array(c.length);for(let T=0;T<c.length;T++)_[T]=N(c[T]);return _}async function X(c,_){if(!c)return;let T=new F.SignatureHelp;return Ot.number(c.activeSignature)?T.activeSignature=c.activeSignature:T.activeSignature=0,Ot.number(c.activeParameter)?T.activeParameter=c.activeParameter:T.activeParameter=0,c.signatures&&(T.signatures=await Ke(c.signatures,_)),T}async function Ke(c,_){return de.mapAsync(c,ce,_)}async function ce(c,_){let T=new F.SignatureInformation(c.label);return c.documentation!==void 0&&(T.documentation=K(c.documentation)),c.parameters!==void 0&&(T.parameters=await he(c.parameters,_)),c.activeParameter!==void 0&&(T.activeParameter=c.activeParameter),T}function he(c,_){return de.map(c,rt,_)}function rt(c){let _=new F.ParameterInformation(c.label);return c.documentation&&(_.documentation=K(c.documentation)),_}function Lt(c){return c?new F.Location(i(c.uri),h(c.range)):void 0}async function $r(c,_){if(c)return rr(c,_)}async function Mn(c,_){if(c)return rr(c,_)}function Nn(c){if(!c)return;let _={targetUri:i(c.targetUri),targetRange:h(c.targetRange),originSelectionRange:h(c.originSelectionRange),targetSelectionRange:h(c.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function rr(c,_){if(c)if(Ot.array(c)){if(c.length===0)return[];if(V.LocationLink.is(c[0])){let T=c;return de.map(T,Nn,_)}else{let T=c;return de.map(T,Lt,_)}}else return V.LocationLink.is(c)?[Nn(c)]:Lt(c)}async function zr(c,_){if(c)return de.map(c,Lt,_)}async function An(c,_){if(c)return de.map(c,pn,_)}function pn(c){let _=new F.DocumentHighlight(h(c.range));return Ot.number(c.kind)&&(_.kind=gn(c.kind)),_}function gn(c){switch(c){case V.DocumentHighlightKind.Text:return F.DocumentHighlightKind.Text;case V.DocumentHighlightKind.Read:return F.DocumentHighlightKind.Read;case V.DocumentHighlightKind.Write:return F.DocumentHighlightKind.Write}return F.DocumentHighlightKind.Text}async function Vr(c,_){if(c)return de.map(c,en,_)}function Ge(c){return c<=V.SymbolKind.TypeParameter?c-1:F.SymbolKind.Property}function ir(c){switch(c){case V.SymbolTag.Deprecated:return F.SymbolTag.Deprecated;default:return}}function mn(c){if(c==null)return;let _=[];for(let T of c){let H=ir(T);H!==void 0&&_.push(H)}return _.length===0?void 0:_}function en(c){let _=c.data,T=c.location,H=T.range===void 0||_!==void 0?new B_.default(c.name,Ge(c.kind),c.containerName??"",T.range===void 0?i(T.uri):new F.Location(i(c.location.uri),h(T.range)),_):new F.SymbolInformation(c.name,Ge(c.kind),c.containerName??"",new F.Location(i(c.location.uri),h(T.range)));return jn(H,c),H}async function Xr(c,_){if(c!=null)return de.map(c,tn,_)}function tn(c){let _=new F.DocumentSymbol(c.name,c.detail||"",Ge(c.kind),h(c.range),h(c.selectionRange));if(jn(_,c),c.children!==void 0&&c.children.length>0){let T=[];for(let H of c.children)T.push(tn(H));_.children=T}return _}function jn(c,_){c.tags=mn(_.tags),_.deprecated&&(c.tags?c.tags.includes(F.SymbolTag.Deprecated)||(c.tags=c.tags.concat(F.SymbolTag.Deprecated)):c.tags=[F.SymbolTag.Deprecated])}function $e(c){let _={title:c.title,command:c.command};return c.arguments&&(_.arguments=c.arguments),_}async function _t(c,_){if(c)return de.map(c,$e,_)}let ht=new Map;ht.set(V.CodeActionKind.Empty,F.CodeActionKind.Empty),ht.set(V.CodeActionKind.QuickFix,F.CodeActionKind.QuickFix),ht.set(V.CodeActionKind.Refactor,F.CodeActionKind.Refactor),ht.set(V.CodeActionKind.RefactorExtract,F.CodeActionKind.RefactorExtract),ht.set(V.CodeActionKind.RefactorInline,F.CodeActionKind.RefactorInline),ht.set(V.CodeActionKind.RefactorRewrite,F.CodeActionKind.RefactorRewrite),ht.set(V.CodeActionKind.Source,F.CodeActionKind.Source),ht.set(V.CodeActionKind.SourceOrganizeImports,F.CodeActionKind.SourceOrganizeImports);function Kt(c){if(c==null)return;let _=ht.get(c);if(_)return _;let T=c.split(".");_=F.CodeActionKind.Empty;for(let H of T)_=_.append(H);return _}function nn(c){if(c!=null)return c.map(_=>Kt(_))}async function Hn(c,_){if(c==null)return;let T=new H_.default(c.title,c.data);return c.kind!==void 0&&(T.kind=Kt(c.kind)),c.diagnostics!==void 0&&(T.diagnostics=u(c.diagnostics)),c.edit!==void 0&&(T.edit=await xt(c.edit,_)),c.command!==void 0&&(T.command=$e(c.command)),c.isPreferred!==void 0&&(T.isPreferred=c.isPreferred),c.disabled!==void 0&&(T.disabled={reason:c.disabled.reason}),T}function or(c,_){return de.mapAsync(c,async T=>V.Command.is(T)?$e(T):Hn(T,_),_)}function yn(c){if(!c)return;let _=new A_.default(h(c.range));return c.command&&(_.command=$e(c.command)),c.data!==void 0&&c.data!==null&&(_.data=c.data),_}async function sr(c,_){if(c)return de.map(c,yn,_)}async function xt(c,_){if(!c)return;let T=new Map;if(c.changeAnnotations!==void 0){let Ye=c.changeAnnotations;await de.forEach(Object.keys(Ye),be=>{let zt=v(Ye[be]);T.set(be,zt)},_)}let H=Ye=>{if(Ye!==void 0)return T.get(Ye)},Ve=new F.WorkspaceEdit;if(c.documentChanges){let Ye=c.documentChanges;await de.forEach(Ye,be=>{if(V.CreateFile.is(be))Ve.createFile(i(be.uri),be.options,H(be.annotationId));else if(V.RenameFile.is(be))Ve.renameFile(i(be.oldUri),i(be.newUri),be.options,H(be.annotationId));else if(V.DeleteFile.is(be))Ve.deleteFile(i(be.uri),be.options,H(be.annotationId));else if(V.TextDocumentEdit.is(be)){let zt=i(be.textDocument.uri);for(let Se of be.edits)V.AnnotatedTextEdit.is(Se)?Ve.replace(zt,h(Se.range),Se.newText,H(Se.annotationId)):Ve.replace(zt,h(Se.range),Se.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(be,void 0,4)}`)},_)}else if(c.changes){let Ye=c.changes;await de.forEach(Object.keys(Ye),be=>{Ve.set(i(be),B(Ye[be]))},_)}return Ve}function v(c){if(c!==void 0)return{label:c.label,needsConfirmation:!!c.needsConfirmation,description:c.description}}function R(c){let _=h(c.range),T=c.target?o(c.target):void 0,H=new j_.default(_,T);return c.tooltip!==void 0&&(H.tooltip=c.tooltip),c.data!==void 0&&c.data!==null&&(H.data=c.data),H}async function E(c,_){if(c)return de.map(c,R,_)}function M(c){return new F.Color(c.red,c.green,c.blue,c.alpha)}function ye(c){return new F.ColorInformation(h(c.range),M(c.color))}async function pe(c,_){if(c)return de.map(c,ye,_)}function De(c){let _=new F.ColorPresentation(c.label);return _.additionalTextEdits=B(c.additionalTextEdits),c.textEdit&&(_.textEdit=N(c.textEdit)),_}async function xe(c,_){if(c)return de.map(c,De,_)}function re(c){if(c)switch(c){case V.FoldingRangeKind.Comment:return F.FoldingRangeKind.Comment;case V.FoldingRangeKind.Imports:return F.FoldingRangeKind.Imports;case V.FoldingRangeKind.Region:return F.FoldingRangeKind.Region}}function we(c){return new F.FoldingRange(c.startLine,c.endLine,re(c.kind))}async function le(c,_){if(c)return de.map(c,we,_)}function Pe(c){return new F.SelectionRange(h(c.range),c.parent?Pe(c.parent):void 0)}async function We(c,_){return Array.isArray(c)?de.map(c,Pe,_):[]}function dt(c){return V.InlineValueText.is(c)?new F.InlineValueText(h(c.range),c.text):V.InlineValueVariableLookup.is(c)?new F.InlineValueVariableLookup(h(c.range),c.variableName,c.caseSensitiveLookup):new F.InlineValueEvaluatableExpression(h(c.range),c.expression)}async function Jr(c,_){return Array.isArray(c)?de.map(c,dt,_):[]}async function Zr(c,_){let T=typeof c.label=="string"?c.label:await de.map(c.label,d,_),H=new K_.default(y(c.position),T);return c.kind!==void 0&&(H.kind=c.kind),c.textEdits!==void 0&&(H.textEdits=await ee(c.textEdits,_)),c.tooltip!==void 0&&(H.tooltip=C(c.tooltip)),c.paddingLeft!==void 0&&(H.paddingLeft=c.paddingLeft),c.paddingRight!==void 0&&(H.paddingRight=c.paddingRight),c.data!==void 0&&(H.data=c.data),H}function d(c){let _=new F.InlayHintLabelPart(c.value);return c.location!==void 0&&(_.location=Lt(c.location)),c.tooltip!==void 0&&(_.tooltip=C(c.tooltip)),c.command!==void 0&&(_.command=$e(c.command)),_}function C(c){return typeof c=="string"?c:j(c)}async function A(c,_){if(Array.isArray(c))return de.mapAsync(c,Zr,_)}function ve(c){if(c===null)return;let _=new U_.default(Ge(c.kind),c.name,c.detail||"",o(c.uri),h(c.range),h(c.selectionRange),c.data);return c.tags!==void 0&&(_.tags=mn(c.tags)),_}async function Ce(c,_){if(c!==null)return de.map(c,ve,_)}async function ze(c,_){return new F.CallHierarchyIncomingCall(ve(c.from),await b(c.fromRanges,_))}async function bt(c,_){if(c!==null)return de.mapAsync(c,ze,_)}async function $t(c,_){return new F.CallHierarchyOutgoingCall(ve(c.to),await b(c.fromRanges,_))}async function Py(c,_){if(c!==null)return de.mapAsync(c,$t,_)}async function qy(c,_){if(c!=null)return new F.SemanticTokens(new Uint32Array(c.data),c.resultId)}function jd(c){return new F.SemanticTokensEdit(c.start,c.deleteCount,c.data!==void 0?new Uint32Array(c.data):void 0)}async function ky(c,_){if(c!=null)return new F.SemanticTokensEdits(c.edits.map(jd),c.resultId)}function Iy(c){return c}async function Ey(c,_){if(c!=null)return new F.LinkedEditingRanges(await b(c.ranges,_),Oy(c.wordPattern))}function Oy(c){if(c!=null)return new RegExp(c)}function Hd(c){if(c===null)return;let _=new W_.default(Ge(c.kind),c.name,c.detail||"",o(c.uri),h(c.range),h(c.selectionRange),c.data);return c.tags!==void 0&&(_.tags=mn(c.tags)),_}async function Fy(c,_){if(c!==null)return de.map(c,Hd,_)}function Ly(c){if(Ot.string(c))return c;if(V.RelativePattern.is(c)){if(V.URI.is(c.baseUri))return new F.RelativePattern(o(c.baseUri),c.pattern);if(V.WorkspaceFolder.is(c.baseUri)){let _=F.workspace.getWorkspaceFolder(o(c.baseUri.uri));return _!==void 0?new F.RelativePattern(_,c.pattern):void 0}}}async function My(c,_){if(!c)return;if(Array.isArray(c))return de.map(c,Ve=>Ts(Ve),_);let T=c,H=await de.map(T.items,Ve=>Ts(Ve),_);return new F.InlineCompletionList(H)}function Ts(c){let _;typeof c.insertText=="string"?_=c.insertText:_=new F.SnippetString(c.insertText.value);let T;c.command&&(T=$e(c.command));let H=new F.InlineCompletionItem(_,h(c.range),T);return c.filterText&&(H.filterText=c.filterText),H}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:h,asRanges:b,asPosition:y,asDiagnosticSeverity:D,asDiagnosticTag:p,asHover:fe,asCompletionResult:$,asCompletionItem:Ue,asTextEdit:N,asTextEdits:ee,asSignatureHelp:X,asSignatureInformations:Ke,asSignatureInformation:ce,asParameterInformations:he,asParameterInformation:rt,asDeclarationResult:$r,asDefinitionResult:Mn,asLocation:Lt,asReferences:zr,asDocumentHighlights:An,asDocumentHighlight:pn,asDocumentHighlightKind:gn,asSymbolKind:Ge,asSymbolTag:ir,asSymbolTags:mn,asSymbolInformations:Vr,asSymbolInformation:en,asDocumentSymbols:Xr,asDocumentSymbol:tn,asCommand:$e,asCommands:_t,asCodeAction:Hn,asCodeActionKind:Kt,asCodeActionKinds:nn,asCodeActionResult:or,asCodeLens:yn,asCodeLenses:sr,asWorkspaceEdit:xt,asDocumentLink:R,asDocumentLinks:E,asFoldingRangeKind:re,asFoldingRange:we,asFoldingRanges:le,asColor:M,asColorInformation:ye,asColorInformations:pe,asColorPresentation:De,asColorPresentations:xe,asSelectionRange:Pe,asSelectionRanges:We,asInlineValue:dt,asInlineValues:Jr,asInlayHint:Zr,asInlayHints:A,asSemanticTokensLegend:Iy,asSemanticTokens:qy,asSemanticTokensEdit:jd,asSemanticTokensEdits:ky,asCallHierarchyItem:ve,asCallHierarchyItems:Ce,asCallHierarchyIncomingCall:ze,asCallHierarchyIncomingCalls:bt,asCallHierarchyOutgoingCall:$t,asCallHierarchyOutgoingCalls:Py,asLinkedEditingRanges:Ey,asTypeHierarchyItem:Hd,asTypeHierarchyItems:Fy,asGlobPattern:Ly,asInlineCompletionResult:My,asInlineCompletionItem:Ts}}Mo.createConverter=$_});var Qu=P(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.ProgressPart=void 0;var nm=require("vscode"),rm=J(),im=At(),Zu=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(rm.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&nm.window.withProgress({location:nm.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(rm.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&im.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(im.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};No.ProgressPart=Zu});var am=P(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.NotebookDocumentSyncFeature=void 0;var ut=require("vscode"),z_=qo(),an=J(),V_=Ie(),om=At();function sm(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Fr;(function(n){let e;(function(t){function r(p,y){return{version:p.version,uri:y.asUri(p.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(p,y,h){let b=an.NotebookDocument.create(h.asUri(p.uri),p.notebookType,p.version,o(y,h));return Object.keys(p.metadata).length>0&&(b.metadata=s(p.metadata)),b}t.asNotebookDocument=i;function o(p,y){return p.map(h=>a(h,y))}t.asNotebookCells=o;function s(p){return l(new Set,p)}t.asMetadata=s;function a(p,y){let h=an.NotebookCell.create(u(p.kind),y.asUri(p.document.uri));return Object.keys(p.metadata).length>0&&(h.metadata=s(p.metadata)),p.executionSummary!==void 0&&om.number(p.executionSummary.executionOrder)&&om.boolean(p.executionSummary.success)&&(h.executionSummary={executionOrder:p.executionSummary.executionOrder,success:p.executionSummary.success}),h}t.asNotebookCell=a;function u(p){switch(p){case ut.NotebookCellKind.Markup:return an.NotebookCellKind.Markup;case ut.NotebookCellKind.Code:return an.NotebookCellKind.Code}}function l(p,y){if(p.has(y))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(y)){let h=[];for(let b of y)if(b!==null&&typeof b=="object"||Array.isArray(b))h.push(l(p,b));else{if(b instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");h.push(b)}return h}else{let h=Object.keys(y),b=Object.create(null);for(let D of h){let q=y[D];if(q!==null&&typeof q=="object"||Array.isArray(q))b[D]=l(p,q);else{if(q instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b[D]=q}}return b}}function f(p,y){let h=y.asChangeTextDocumentParams(p,p.document.uri,p.document.version);return{document:h.textDocument,changes:h.contentChanges}}t.asTextContentChange=f;function g(p,y){let h=Object.create(null);if(p.metadata&&(h.metadata=n.c2p.asMetadata(p.metadata)),p.cells!==void 0){let b=Object.create(null),D=p.cells;D.structure&&(b.structure={array:{start:D.structure.array.start,deleteCount:D.structure.array.deleteCount,cells:D.structure.array.cells!==void 0?D.structure.array.cells.map(q=>n.c2p.asNotebookCell(q,y)):void 0},didOpen:D.structure.didOpen!==void 0?D.structure.didOpen.map(q=>y.asOpenTextDocumentParams(q.document).textDocument):void 0,didClose:D.structure.didClose!==void 0?D.structure.didClose.map(q=>y.asCloseTextDocumentParams(q.document).textDocument):void 0}),D.data!==void 0&&(b.data=D.data.map(q=>n.c2p.asNotebookCell(q,y))),D.textContent!==void 0&&(b.textContent=D.textContent.map(q=>n.c2p.asTextContentChange(q,y))),Object.keys(b).length>0&&(h.cells=b)}return h}t.asNotebookDocumentChangeEvent=g})(e=n.c2p||(n.c2p={}))})(Fr||(Fr={}));var Gu;(function(n){function e(a,u,l){let f=a.length,g=u.length,p=0;for(;p<g&&p<f&&t(a[p],u[p],l);)p++;if(p<g&&p<f){let y=f-1,h=g-1;for(;y>=0&&h>=0&&t(a[y],u[h],l);)y--,h--;let b=y+1-p,D=p===h+1?void 0:u.slice(p,h+1);return D!==void 0?{start:p,deleteCount:b,cells:D}:{start:p,deleteCount:b}}else return p<g?{start:p,deleteCount:0,cells:u.slice(p)}:p<f?{start:p,deleteCount:f-p}:void 0}n.computeDiff=e;function t(a,u,l=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!r(a.executionSummary,u.executionSummary)?!1:!l||l&&o(a.metadata,u.metadata)}function r(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&i(a.timing,u.timing)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function o(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;let l=Array.isArray(a),f=Array.isArray(u);if(l!==f)return!1;if(l&&f){if(a.length!==u.length)return!1;for(let g=0;g<a.length;g++)if(!o(a[g],u[g]))return!1}if(s(a)&&s(u)){let g=Object.keys(a),p=Object.keys(u);if(g.length!==p.length||(g.sort(),p.sort(),!o(g,p)))return!1;for(let y=0;y<g.length;y++){let h=g[y];if(!o(a[h],u[h]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(Gu||(Gu={}));var Yu;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let o=new z_.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(Yu||(Yu={}));var Ao;(function(n){function e(r){let i=r.notebookSelector,o=[];for(let s of i){let a=(typeof s.notebook=="string"?s.notebook:s.notebook?.notebookType)??"*",u=typeof s.notebook=="string"?void 0:s.notebook?.scheme,l=typeof s.notebook=="string"?void 0:s.notebook?.pattern;if(s.cells!==void 0)for(let f of s.cells)o.push(t(a,u,l,f.language));else o.push(t(a,u,l,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(Ao||(Ao={}));var jo;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(jo||(jo={}));var Lr=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(Ao.asDocumentSelector(t)),ut.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of ut.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);ut.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&ut.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),ut.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of ut.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return ut.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(ut.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){let s=this.getMatchingCells(e);if(s!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){ut.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let r=async(o,s)=>{let a=Fr.c2p.asNotebookDocument(o,s,this.client.code2ProtocolConverter),u=s.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(an.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),jo.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let r=async o=>{try{await this.client.sendNotification(an.DidChangeNotebookDocumentNotification.type,{notebookDocument:Fr.c2p.asVersionedNotebookDocumentIdentifier(o.notebook,this.client.code2ProtocolConverter),change:Fr.c2p.asNotebookDocumentChangeEvent(o,this.client.code2ProtocolConverter)})}catch(s){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",s),s}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),jo.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(an.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let r=async(o,s)=>{try{await this.client.sendNotification(an.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:s.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let o={notebook:e};t?.metadata!==void 0&&(o.metadata=Fr.c2p.asMetadata(t.metadata));let s;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];s=new Set(i.map(u=>u.document.uri.toString()));for(let u of t.cellChanges)s.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,u=i,l=Gu.computeDiff(a,u,!1),f,g;if(l!==void 0){f=l.cells===void 0?new Map:new Map(l.cells.map(h=>[h.document.uri.toString(),h])),g=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(h=>[h.document.uri.toString(),h]));for(let h of Array.from(g.keys()))f.has(h)&&(g.delete(h),f.delete(h));o.cells=o.cells??{};let p=[],y=[];if(f.size>0||g.size>0){for(let h of f.values())p.push(h);for(let h of g.values())y.push(h)}o.cells.structure={array:l,didOpen:p,didClose:y}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||Yu.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){let i=r!==void 0?t.filter(o=>{let s=o.document.languageId;return r.some(a=>a.language==="*"||s===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},cn=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=an.NotebookDocumentSyncRegistrationType.type,ut.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==cn.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Lr&&o.didOpenNotebookCellTextDocument(r,i)}),ut.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==cn.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let o of this.registrations.values())o instanceof Lr&&o.didChangeNotebookCellTextDocument(i,t)}),ut.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==cn.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Lr&&o.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=sm(sm(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(Ao.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??V_.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new Lr(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==cn.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&ut.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of ut.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};Ho.NotebookDocumentSyncFeature=cn;cn.CellScheme="vscode-notebook-cell"});var um=P(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.SyncConfigurationFeature=In.toJSONObject=In.ConfigurationFeature=void 0;var Mr=require("vscode"),bi=J(),X_=At(),J_=Ie(),cm=ue(),el=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(bi.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let u of s.items){let l=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(l,u.section!==null?u.section:void 0))}return a},o=e.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Zn(Mr.workspace.getConfiguration(void 0,e).get(t));else{let o=Mr.workspace.getConfiguration(t.substr(0,i),e);o&&(r=Zn(o.get(t.substr(i+1))))}}else{let i=Mr.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=Zn(i.get(o)))}return r===void 0&&(r=null),r}clear(){}};In.ConfigurationFeature=el;function Zn(n){if(n){if(Array.isArray(n))return n.map(Zn);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Zn(n[t]));return e}}return n}In.toJSONObject=Zn;var tl=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return bi.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,cm.ensure)((0,cm.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:J_.generateUuid(),registerOptions:{section:e}})}register(e){let t=Mr.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if(X_.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async s=>s===void 0?this._client.sendNotification(bi.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(bi.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)}),o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${bi.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let u=0;u<s.length-1;u++){let l=a[s[u]];l||(l=Object.create(null),a[s[u]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),u=null;if(a>=0?u=Mr.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):u=Mr.workspace.getConfiguration(void 0,r).get(s),u){let l=e[o].split(".");t(i,l)[l[l.length-1]]=Zn(u)}}return i}};In.SyncConfigurationFeature=tl});var lm=P(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.DidSaveTextDocumentFeature=yt.WillSaveWaitUntilFeature=yt.WillSaveFeature=yt.DidChangeTextDocumentFeature=yt.DidCloseTextDocumentFeature=yt.DidOpenTextDocumentFeature=void 0;var St=require("vscode"),Re=J(),Fe=ue(),Nr=Ie(),nl=class extends Fe.TextDocumentEventFeature{constructor(e,t){super(e,St.workspace.onDidOpenTextDocument,Re.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Fe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Nr.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Re.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);St.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&St.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};yt.DidOpenTextDocumentFeature=nl;var rl=class extends Fe.TextDocumentEventFeature{constructor(e,t,r){super(e,St.workspace.onDidCloseTextDocument,Re.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Fe.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Re.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:Nr.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(St.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};yt.DidCloseTextDocumentFeature=rl;var il=class extends Fe.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new St.EventEmitter,this._onPendingChangeAdded=new St.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Re.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Re.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Re.TextDocumentSyncKind.None&&this.register({id:Nr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=St.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let o of this._changeData.values())if(St.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let s=this._client.middleware;if(o.syncKind===Re.TextDocumentSyncKind.Incremental){let a=async u=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,r);await this._client.sendNotification(Re.DidChangeTextDocumentNotification.type,l),this.notificationSent(u.document,Re.DidChangeTextDocumentNotification.type,l)};i.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}else if(o.syncKind===Re.TextDocumentSyncKind.Full){let a=async u=>{let l=u.document.uri.toString();this._pendingTextDocumentChanges.set(l,u.document),this._onPendingChangeAdded.fire()};i.push(s.didChange?s.didChange(e,u=>a(u)):a(e))}}return Promise.all(i).then(void 0,o=>{throw this._client.error(`Sending document notification ${Re.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Re.TextDocumentSyncKind.None;else{this._syncKind=Re.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Re.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Re.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(St.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Re.TextDocumentSyncKind.Full)switch(e){case Re.TextDocumentSyncKind.Full:this._syncKind=e;break;case Re.TextDocumentSyncKind.Incremental:this._syncKind===Re.TextDocumentSyncKind.None&&(this._syncKind=Re.TextDocumentSyncKind.Incremental);break}}};yt.DidChangeTextDocumentFeature=il;var ol=class extends Fe.TextDocumentEventFeature{constructor(e){super(e,St.workspace.onWillSaveTextDocument,Re.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>Fe.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Re.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:Nr.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};yt.WillSaveFeature=ol;var sl=class extends Fe.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Re.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:Nr.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=St.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Fe.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Re.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};yt.WillSaveWaitUntilFeature=sl;var al=class extends Fe.TextDocumentEventFeature{constructor(e){super(e,St.workspace.onDidSaveTextDocument,Re.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Fe.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Re.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Fe.ensure)((0,Fe.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:Nr.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};yt.DidSaveTextDocumentFeature=al});var dm=P(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.CompletionItemFeature=void 0;var Z_=require("vscode"),se=J(),cl=ue(),Q_=Ie(),G_=[se.CompletionItemKind.Text,se.CompletionItemKind.Method,se.CompletionItemKind.Function,se.CompletionItemKind.Constructor,se.CompletionItemKind.Field,se.CompletionItemKind.Variable,se.CompletionItemKind.Class,se.CompletionItemKind.Interface,se.CompletionItemKind.Module,se.CompletionItemKind.Property,se.CompletionItemKind.Unit,se.CompletionItemKind.Value,se.CompletionItemKind.Enum,se.CompletionItemKind.Keyword,se.CompletionItemKind.Snippet,se.CompletionItemKind.Color,se.CompletionItemKind.File,se.CompletionItemKind.Reference,se.CompletionItemKind.Folder,se.CompletionItemKind.EnumMember,se.CompletionItemKind.Constant,se.CompletionItemKind.Struct,se.CompletionItemKind.Event,se.CompletionItemKind.Operator,se.CompletionItemKind.TypeParameter],ul=class extends cl.TextDocumentLanguageFeature{constructor(e){super(e,se.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,cl.ensure)((0,cl.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[se.MarkupKind.Markdown,se.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[se.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[se.InsertTextMode.asIs,se.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=se.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:G_},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:Q_.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(a,u,l,f)=>{let g=this._client,p=this._client.middleware,y=(h,b,D,q)=>g.sendRequest(se.CompletionRequest.type,g.code2ProtocolConverter.asCompletionParams(h,b,D),q).then(K=>q.isCancellationRequested?null:g.protocol2CodeConverter.asCompletionResult(K,i,q),K=>g.handleFailedRequest(se.CompletionRequest.type,q,K,null));return p.provideCompletionItem?p.provideCompletionItem(a,u,f,l,y):y(a,u,f,l)},resolveCompletionItem:e.resolveProvider?(a,u)=>{let l=this._client,f=this._client.middleware,g=(p,y)=>l.sendRequest(se.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(p,!!this.labelDetailsSupport.get(t)),y).then(h=>y.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(h),h=>l.handleFailedRequest(se.CompletionResolveRequest.type,y,h,p));return f.resolveCompletionItem?f.resolveCompletionItem(a,u,g):g(a,u)}:void 0};return[Z_.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}};Uo.CompletionItemFeature=ul});var fm=P(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.HoverFeature=void 0;var Y_=require("vscode"),wi=J(),ll=ue(),eb=Ie(),dl=class extends ll.TextDocumentLanguageFeature{constructor(e){super(e,wi.HoverRequest.type)}fillClientCapabilities(e){let t=(0,ll.ensure)((0,ll.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[wi.MarkupKind.Markdown,wi.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:eb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(wi.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asHover(y),y=>a.handleFailedRequest(wi.HoverRequest.type,p,y,null)),l=a.middleware;return l.provideHover?l.provideHover(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Y_.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Wo.HoverFeature=dl});var hm=P(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.DefinitionFeature=void 0;var tb=require("vscode"),fl=J(),hl=ue(),nb=Ie(),pl=class extends hl.TextDocumentLanguageFeature{constructor(e){super(e,fl.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,hl.ensure)((0,hl.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:nb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(fl.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(y,p),y=>a.handleFailedRequest(fl.DefinitionRequest.type,p,y,null)),l=a.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return tb.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Bo.DefinitionFeature=pl});var gm=P(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.SignatureHelpFeature=void 0;var pm=require("vscode"),Ci=J(),gl=ue(),rb=Ie(),ml=class extends gl.TextDocumentLanguageFeature{constructor(e){super(e,Ci.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,gl.ensure)((0,gl.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Ci.MarkupKind.Markdown,Ci.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:rb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,o,s)=>{let a=this._client,u=(f,g,p,y)=>a.sendRequest(Ci.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(f,g,p),y).then(h=>y.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(h,y),h=>a.handleFailedRequest(Ci.SignatureHelpRequest.type,y,h,null)),l=a.middleware;return l.provideSignatureHelp?l.provideSignatureHelp(r,i,s,o,u):u(r,i,s,o)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return pm.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return pm.languages.registerSignatureHelpProvider(r,t,i)}}};Ko.SignatureHelpFeature=ml});var mm=P($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.DocumentHighlightFeature=void 0;var ib=require("vscode"),yl=J(),vl=ue(),ob=Ie(),_l=class extends vl.TextDocumentLanguageFeature{constructor(e){super(e,yl.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,vl.ensure)((0,vl.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:ob.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(yl.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(y,p),y=>a.handleFailedRequest(yl.DocumentHighlightRequest.type,p,y,null)),l=a.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,u):u(i,o,s)}};return[ib.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};$o.DocumentHighlightFeature=_l});var Cl=P(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.DocumentSymbolFeature=Gt.SupportedSymbolTags=Gt.SupportedSymbolKinds=void 0;var sb=require("vscode"),me=J(),bl=ue(),ab=Ie();Gt.SupportedSymbolKinds=[me.SymbolKind.File,me.SymbolKind.Module,me.SymbolKind.Namespace,me.SymbolKind.Package,me.SymbolKind.Class,me.SymbolKind.Method,me.SymbolKind.Property,me.SymbolKind.Field,me.SymbolKind.Constructor,me.SymbolKind.Enum,me.SymbolKind.Interface,me.SymbolKind.Function,me.SymbolKind.Variable,me.SymbolKind.Constant,me.SymbolKind.String,me.SymbolKind.Number,me.SymbolKind.Boolean,me.SymbolKind.Array,me.SymbolKind.Object,me.SymbolKind.Key,me.SymbolKind.Null,me.SymbolKind.EnumMember,me.SymbolKind.Struct,me.SymbolKind.Event,me.SymbolKind.Operator,me.SymbolKind.TypeParameter];Gt.SupportedSymbolTags=[me.SymbolTag.Deprecated];var wl=class extends bl.TextDocumentLanguageFeature{constructor(e){super(e,me.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,bl.ensure)((0,bl.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Gt.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Gt.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);r&&this.register({id:ab.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(o,s)=>{let a=this._client,u=async(f,g)=>{try{let p=await a.sendRequest(me.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(f),g);if(g.isCancellationRequested||p===void 0||p===null)return null;if(p.length===0)return[];{let y=p[0];return me.DocumentSymbol.is(y)?await a.protocol2CodeConverter.asDocumentSymbols(p,g):await a.protocol2CodeConverter.asSymbolInformations(p,g)}}catch(p){return a.handleFailedRequest(me.DocumentSymbolRequest.type,g,p,null)}},l=a.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(o,s,u):u(o,s)}},i=e.label!==void 0?{label:e.label}:void 0;return[sb.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};Gt.DocumentSymbolFeature=wl});var vm=P(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.WorkspaceSymbolFeature=void 0;var cb=require("vscode"),Di=J(),Dl=ue(),ym=Cl(),ub=Ie(),Sl=class extends Dl.WorkspaceFeature{constructor(e){super(e,Di.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Dl.ensure)((0,Dl.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:ym.SupportedSymbolKinds},t.tagSupport={valueSet:ym.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:ub.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let o=this._client,s=(u,l)=>o.sendRequest(Di.WorkspaceSymbolRequest.type,{query:u},l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(f,l),f=>o.handleFailedRequest(Di.WorkspaceSymbolRequest.type,l,f,null)),a=o.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let o=this._client,s=(u,l)=>o.sendRequest(Di.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(u),l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(f),f=>o.handleFailedRequest(Di.WorkspaceSymbolResolveRequest.type,l,f,null)),a=o.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[cb.languages.registerWorkspaceSymbolProvider(t),t]}};zo.WorkspaceSymbolFeature=Sl});var _m=P(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.ReferencesFeature=void 0;var lb=require("vscode"),Rl=J(),Tl=ue(),db=Ie(),xl=class extends Tl.TextDocumentLanguageFeature{constructor(e){super(e,Rl.ReferencesRequest.type)}fillClientCapabilities(e){(0,Tl.ensure)((0,Tl.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:db.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{let u=this._client,l=(g,p,y,h)=>u.sendRequest(Rl.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(g,p,y),h).then(b=>h.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(b,h),b=>u.handleFailedRequest(Rl.ReferencesRequest.type,h,b,null)),f=u.middleware;return f.provideReferences?f.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return lb.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Vo.ReferencesFeature=xl});var bm=P(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.CodeActionFeature=void 0;var fb=require("vscode"),Rt=J(),hb=Ie(),Pl=ue(),ql=class extends Pl.TextDocumentLanguageFeature{constructor(e){super(e,Rt.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Pl.ensure)((0,Pl.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[Rt.CodeActionKind.Empty,Rt.CodeActionKind.QuickFix,Rt.CodeActionKind.Refactor,Rt.CodeActionKind.RefactorExtract,Rt.CodeActionKind.RefactorInline,Rt.CodeActionKind.RefactorRewrite,Rt.CodeActionKind.Source,Rt.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:hb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{let u=this._client,l=async(g,p,y,h)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g),range:u.code2ProtocolConverter.asRange(p),context:u.code2ProtocolConverter.asCodeActionContextSync(y)};return u.sendRequest(Rt.CodeActionRequest.type,b,h).then(D=>h.isCancellationRequested||D===null||D===void 0?null:u.protocol2CodeConverter.asCodeActionResult(D,h),D=>u.handleFailedRequest(Rt.CodeActionRequest.type,h,D,null))},f=u.middleware;return f.provideCodeActions?f.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{let s=this._client,a=this._client.middleware,u=async(l,f)=>s.sendRequest(Rt.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeActionSync(l),f).then(g=>f.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(g,f),g=>s.handleFailedRequest(Rt.CodeActionResolveRequest.type,f,g,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,u):u(i,o)}:void 0};return[fb.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};Xo.CodeActionFeature=ql});var Cm=P(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.CodeLensFeature=void 0;var wm=require("vscode"),Ar=J(),pb=Ie(),Si=ue(),kl=class extends Si.TextDocumentLanguageFeature{constructor(e){super(e,Ar.CodeLensRequest.type)}fillClientCapabilities(e){(0,Si.ensure)((0,Si.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Si.ensure)((0,Si.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ar.CodeLensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:pb.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new wm.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{let a=this._client,u=(f,g)=>a.sendRequest(Ar.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(f),g).then(p=>g.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(p,g),p=>a.handleFailedRequest(Ar.CodeLensRequest.type,g,p,null)),l=a.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,u):u(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{let a=this._client,u=(f,g)=>a.sendRequest(Ar.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(f),g).then(p=>g.isCancellationRequested?f:a.protocol2CodeConverter.asCodeLens(p),p=>a.handleFailedRequest(Ar.CodeLensResolveRequest.type,g,p,f)),l=a.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,u):u(o,s)}:void 0};return[wm.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};Jo.CodeLensFeature=kl});var Dm=P(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.DocumentOnTypeFormattingFeature=En.DocumentRangeFormattingFeature=En.DocumentFormattingFeature=void 0;var Zo=require("vscode"),Ht=J(),Fl=Ie(),un=ue(),jr;(function(n){function e(t){let r=Zo.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(jr||(jr={}));var Il=class extends un.TextDocumentLanguageFeature{constructor(e){super(e,Ht.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,un.ensure)((0,un.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:Fl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{let a=this._client,u=(f,g,p)=>{let y={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),options:a.code2ProtocolConverter.asFormattingOptions(g,jr.fromConfiguration(f))};return a.sendRequest(Ht.DocumentFormattingRequest.type,y,p).then(h=>p.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(h,p),h=>a.handleFailedRequest(Ht.DocumentFormattingRequest.type,p,h,null))},l=a.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,u):u(i,o,s)}};return[Zo.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};En.DocumentFormattingFeature=Il;var El=class extends un.TextDocumentLanguageFeature{constructor(e){super(e,Ht.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,un.ensure)((0,un.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:Fl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{let u=this._client,l=(g,p,y,h)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g),range:u.code2ProtocolConverter.asRange(p),options:u.code2ProtocolConverter.asFormattingOptions(y,jr.fromConfiguration(g))};return u.sendRequest(Ht.DocumentRangeFormattingRequest.type,b,h).then(D=>h.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(D,h),D=>u.handleFailedRequest(Ht.DocumentRangeFormattingRequest.type,h,D,null))},f=u.middleware;return f.provideDocumentRangeFormattingEdits?f.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,o,s,a)=>{let u=this._client,l=(g,p,y,h)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g),ranges:u.code2ProtocolConverter.asRanges(p),options:u.code2ProtocolConverter.asFormattingOptions(y,jr.fromConfiguration(g))};return u.sendRequest(Ht.DocumentRangesFormattingRequest.type,b,h).then(D=>h.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(D,h),D=>u.handleFailedRequest(Ht.DocumentRangesFormattingRequest.type,h,D,null))},f=u.middleware;return f.provideDocumentRangesFormattingEdits?f.provideDocumentRangesFormattingEdits(i,o,s,a,l):l(i,o,s,a)}),[Zo.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};En.DocumentRangeFormattingFeature=El;var Ol=class extends un.TextDocumentLanguageFeature{constructor(e){super(e,Ht.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,un.ensure)((0,un.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:Fl.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,u,l)=>{let f=this._client,g=(y,h,b,D,q)=>{let K={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(y),position:f.code2ProtocolConverter.asPosition(h),ch:b,options:f.code2ProtocolConverter.asFormattingOptions(D,jr.fromConfiguration(y))};return f.sendRequest(Ht.DocumentOnTypeFormattingRequest.type,K,q).then(j=>q.isCancellationRequested?null:f.protocol2CodeConverter.asTextEdits(j,q),j=>f.handleFailedRequest(Ht.DocumentOnTypeFormattingRequest.type,q,j,null))},p=f.middleware;return p.provideOnTypeFormattingEdits?p.provideOnTypeFormattingEdits(o,s,a,u,l,g):g(o,s,a,u,l)}},i=e.moreTriggerCharacter||[];return[Zo.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};En.DocumentOnTypeFormattingFeature=Ol});var Rm=P(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.RenameFeature=void 0;var gb=require("vscode"),Qn=J(),mb=Ie(),Sm=At(),Ll=ue(),Ml=class extends Ll.TextDocumentLanguageFeature{constructor(e){super(e,Qn.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Ll.ensure)((0,Ll.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Qn.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);r&&(Sm.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:mb.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{let u=this._client,l=(g,p,y,h)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g),position:u.code2ProtocolConverter.asPosition(p),newName:y};return u.sendRequest(Qn.RenameRequest.type,b,h).then(D=>h.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(D,h),D=>u.handleFailedRequest(Qn.RenameRequest.type,h,D,null,!1))},f=u.middleware;return f.provideRenameEdits?f.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{let a=this._client,u=(f,g,p)=>{let y={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),position:a.code2ProtocolConverter.asPosition(g)};return a.sendRequest(Qn.PrepareRenameRequest.type,y,p).then(h=>p.isCancellationRequested?null:Qn.Range.is(h)?a.protocol2CodeConverter.asRange(h):this.isDefaultBehavior(h)?h.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):h&&Qn.Range.is(h.range)?{range:a.protocol2CodeConverter.asRange(h.range),placeholder:h.placeholder}:Promise.reject(new Error("The element can't be renamed.")),h=>{throw typeof h.message=="string"?new Error(h.message):new Error("The element can't be renamed.")})},l=a.middleware;return l.prepareRename?l.prepareRename(i,o,s,u):u(i,o,s)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return gb.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&Sm.boolean(t.defaultBehavior)}};Qo.RenameFeature=Ml});var Tm=P(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.DocumentLinkFeature=void 0;var yb=require("vscode"),Ri=J(),Nl=ue(),vb=Ie(),Al=class extends Nl.TextDocumentLanguageFeature{constructor(e){super(e,Ri.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Nl.ensure)((0,Nl.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:vb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{let s=this._client,a=(l,f)=>s.sendRequest(Ri.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),f).then(g=>f.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(g,f),g=>s.handleFailedRequest(Ri.DocumentLinkRequest.type,f,g,null)),u=s.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{let s=this._client,a=(l,f)=>s.sendRequest(Ri.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),f).then(g=>f.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(g),g=>s.handleFailedRequest(Ri.DocumentLinkResolveRequest.type,f,g,l)),u=s.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[yb.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Go.DocumentLinkFeature=Al});var Pm=P(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.ExecuteCommandFeature=void 0;var _b=require("vscode"),jl=J(),bb=Ie(),xm=ue(),Hl=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return jl.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,xm.ensure)((0,xm.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:bb.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(jl.ExecuteCommandRequest.type,a).then(void 0,u=>t.handleFailedRequest(jl.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){let o=[];for(let s of e.registerOptions.commands)o.push(_b.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Yo.ExecuteCommandFeature=Hl});var qm=P(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.FileSystemWatcherFeature=void 0;var wb=require("vscode"),Gn=J(),es=ue(),Ul=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Gn.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,es.ensure)((0,es.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,es.ensure)((0,es.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let o=!0,s=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(o=(r.kind&Gn.WatchKind.Create)!==0,s=(r.kind&Gn.WatchKind.Change)!==0,a=(r.kind&Gn.WatchKind.Delete)!==0);let u=wb.workspace.createFileSystemWatcher(i,!o,!s,!a);this.hookListeners(u,o,s,a,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Gn.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Gn.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Gn.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};ts.FileSystemWatcherFeature=Ul});var km=P(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.ColorProviderFeature=void 0;var Cb=require("vscode"),Ti=J(),Wl=ue(),Bl=class extends Wl.TextDocumentLanguageFeature{constructor(e){super(e,Ti.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Wl.ensure)((0,Wl.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{let a=this._client,u=(f,g,p)=>{let y={color:f,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g.document),range:a.code2ProtocolConverter.asRange(g.range)};return a.sendRequest(Ti.ColorPresentationRequest.type,y,p).then(h=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(h,p),h=>a.handleFailedRequest(Ti.ColorPresentationRequest.type,p,h,null))},l=a.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,u):u(i,o,s)},provideDocumentColors:(i,o)=>{let s=this._client,a=(l,f)=>{let g={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(Ti.DocumentColorRequest.type,g,f).then(p=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(p,f),p=>s.handleFailedRequest(Ti.DocumentColorRequest.type,f,p,null))},u=s.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,o,a):a(i,o)}};return[Cb.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ns.ColorProviderFeature=Bl});var Im=P(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.ImplementationFeature=void 0;var Db=require("vscode"),Kl=J(),$l=ue(),zl=class extends $l.TextDocumentLanguageFeature{constructor(e){super(e,Kl.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,$l.ensure)((0,$l.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(Kl.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(y,p),y=>a.handleFailedRequest(Kl.ImplementationRequest.type,p,y,null)),l=a.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Db.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};rs.ImplementationFeature=zl});var Em=P(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.TypeDefinitionFeature=void 0;var Sb=require("vscode"),Vl=J(),xi=ue(),Xl=class extends xi.TextDocumentLanguageFeature{constructor(e){super(e,Vl.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,xi.ensure)((0,xi.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,xi.ensure)((0,xi.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(Vl.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(y,p),y=>a.handleFailedRequest(Vl.TypeDefinitionRequest.type,p,y,null)),l=a.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Sb.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};is.TypeDefinitionFeature=Xl});var Om=P(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.WorkspaceFoldersFeature=Hr.arrayDiff=void 0;var Rb=Ie(),os=require("vscode"),Pi=J();function Jl(n,e){if(n!=null)return n[e]}function Zl(n,e){return n.filter(t=>e.indexOf(t)<0)}Hr.arrayDiff=Zl;var Ql=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Pi.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=os.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Pi.WorkspaceFoldersRequest.type,o=>{let s=()=>{let u=os.workspace.workspaceFolders;return u===void 0?null:u.map(f=>this.asProtocol(f))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s(o)});let r=Jl(Jl(Jl(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=Rb.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Zl(this._initialFolders,e),i=Zl(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Pi.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Pi.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=os.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${Pi.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(os.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Hr.WorkspaceFoldersFeature=Ql});var Lm=P(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.FoldingRangeFeature=void 0;var Fm=require("vscode"),Yn=J(),qi=ue(),Gl=class extends qi.TextDocumentLanguageFeature{constructor(e){super(e,Yn.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,qi.ensure)((0,qi.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Yn.FoldingRangeKind.Comment,Yn.FoldingRangeKind.Imports,Yn.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,qi.ensure)((0,qi.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(Yn.FoldingRangeRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Fm.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(o,s,a)=>{let u=this._client,l=(g,p,y)=>{let h={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g)};return u.sendRequest(Yn.FoldingRangeRequest.type,h,y).then(b=>y.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(b,y),b=>u.handleFailedRequest(Yn.FoldingRangeRequest.type,y,b,null))},f=u.middleware;return f.provideFoldingRanges?f.provideFoldingRanges(o,s,a,l):l(o,s,a)}};return[Fm.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}};ss.FoldingRangeFeature=Gl});var Mm=P(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.DeclarationFeature=void 0;var Tb=require("vscode"),Yl=J(),ed=ue(),td=class extends ed.TextDocumentLanguageFeature{constructor(e){super(e,Yl.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,ed.ensure)((0,ed.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(Yl.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(y,p),y=>a.handleFailedRequest(Yl.DeclarationRequest.type,p,y,null)),l=a.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Tb.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};as.DeclarationFeature=td});var Nm=P(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.SelectionRangeFeature=void 0;var xb=require("vscode"),nd=J(),rd=ue(),id=class extends rd.TextDocumentLanguageFeature{constructor(e){super(e,nd.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,rd.ensure)((0,rd.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{let a=this._client,u=async(f,g,p)=>{let y={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f),positions:a.code2ProtocolConverter.asPositionsSync(g,p)};return a.sendRequest(nd.SelectionRangeRequest.type,y,p).then(h=>p.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(h,p),h=>a.handleFailedRequest(nd.SelectionRangeRequest.type,p,h,null))},l=a.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return xb.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};cs.SelectionRangeFeature=id});var jm=P(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.ProgressFeature=void 0;var Am=J(),Pb=Qu();function qb(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var od=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:Am.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){qb(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new Pb.ProgressPart(this._client,i.token,t))};e.onRequest(Am.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};us.ProgressFeature=od});var Hm=P(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.CallHierarchyFeature=void 0;var kb=require("vscode"),er=J(),sd=ue(),ad=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,u,l)=>{let f=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(er.CallHierarchyPrepareRequest.type,f,l).then(g=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(g,l),g=>i.handleFailedRequest(er.CallHierarchyPrepareRequest.type,l,g,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(er.CallHierarchyIncomingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(er.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(er.CallHierarchyOutgoingCallsRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(er.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}},cd=class extends sd.TextDocumentLanguageFeature{constructor(e){super(e,er.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,sd.ensure)((0,sd.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new ad(t);return[kb.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ls.CallHierarchyFeature=cd});var Um=P(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.SemanticTokensFeature=void 0;var ds=require("vscode"),Y=J(),ki=ue(),Ib=At(),ud=class extends ki.TextDocumentLanguageFeature{constructor(e){super(e,Y.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,ki.ensure)((0,ki.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Y.SemanticTokenTypes.namespace,Y.SemanticTokenTypes.type,Y.SemanticTokenTypes.class,Y.SemanticTokenTypes.enum,Y.SemanticTokenTypes.interface,Y.SemanticTokenTypes.struct,Y.SemanticTokenTypes.typeParameter,Y.SemanticTokenTypes.parameter,Y.SemanticTokenTypes.variable,Y.SemanticTokenTypes.property,Y.SemanticTokenTypes.enumMember,Y.SemanticTokenTypes.event,Y.SemanticTokenTypes.function,Y.SemanticTokenTypes.method,Y.SemanticTokenTypes.macro,Y.SemanticTokenTypes.keyword,Y.SemanticTokenTypes.modifier,Y.SemanticTokenTypes.comment,Y.SemanticTokenTypes.string,Y.SemanticTokenTypes.number,Y.SemanticTokenTypes.regexp,Y.SemanticTokenTypes.operator,Y.SemanticTokenTypes.decorator],t.tokenModifiers=[Y.SemanticTokenModifiers.declaration,Y.SemanticTokenModifiers.definition,Y.SemanticTokenModifiers.readonly,Y.SemanticTokenModifiers.static,Y.SemanticTokenModifiers.deprecated,Y.SemanticTokenModifiers.abstract,Y.SemanticTokenModifiers.async,Y.SemanticTokenModifiers.modification,Y.SemanticTokenModifiers.documentation,Y.SemanticTokenModifiers.defaultLibrary],t.formats=[Y.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,ki.ensure)((0,ki.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Y.SemanticTokensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});let[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){let t=e.documentSelector,r=Ib.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new ds.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(y,h)=>{let b=this._client,D=b.middleware,q=(K,j)=>{let fe={textDocument:b.code2ProtocolConverter.asTextDocumentIdentifier(K)};return b.sendRequest(Y.SemanticTokensRequest.type,fe,j).then($=>j.isCancellationRequested?null:b.protocol2CodeConverter.asSemanticTokens($,j),$=>b.handleFailedRequest(Y.SemanticTokensRequest.type,j,$,null))};return D.provideDocumentSemanticTokens?D.provideDocumentSemanticTokens(y,h,q):q(y,h)},provideDocumentSemanticTokensEdits:i?(y,h,b)=>{let D=this._client,q=D.middleware,K=(j,fe,$)=>{let ae={textDocument:D.code2ProtocolConverter.asTextDocumentIdentifier(j),previousResultId:fe};return D.sendRequest(Y.SemanticTokensDeltaRequest.type,ae,$).then(async W=>$.isCancellationRequested?null:Y.SemanticTokens.is(W)?await D.protocol2CodeConverter.asSemanticTokens(W,$):await D.protocol2CodeConverter.asSemanticTokensEdits(W,$),W=>D.handleFailedRequest(Y.SemanticTokensDeltaRequest.type,$,W,null))};return q.provideDocumentSemanticTokensEdits?q.provideDocumentSemanticTokensEdits(y,h,b,K):K(y,h,b)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(y,h,b)=>{let D=this._client,q=D.middleware,K=(j,fe,$)=>{let ae={textDocument:D.code2ProtocolConverter.asTextDocumentIdentifier(j),range:D.code2ProtocolConverter.asRange(fe)};return D.sendRequest(Y.SemanticTokensRangeRequest.type,ae,$).then(W=>$.isCancellationRequested?null:D.protocol2CodeConverter.asSemanticTokens(W,$),W=>D.handleFailedRequest(Y.SemanticTokensRangeRequest.type,$,W,null))};return q.provideDocumentRangeSemanticTokens?q.provideDocumentRangeSemanticTokens(y,h,b,K):K(y,h,b)}}:void 0,l=[],f=this._client,g=f.protocol2CodeConverter.asSemanticTokensLegend(e.legend),p=f.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(ds.languages.registerDocumentSemanticTokensProvider(p,s,g)),u!==void 0&&l.push(ds.languages.registerDocumentRangeSemanticTokensProvider(p,u,g)),[new ds.Disposable(()=>l.forEach(y=>y.dispose())),{range:u,full:s,onDidChangeSemanticTokensEmitter:o}]}};fs.SemanticTokensFeature=ud});var Km=P(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.WillDeleteFilesFeature=vt.WillRenameFilesFeature=vt.WillCreateFilesFeature=vt.DidDeleteFilesFeature=vt.DidRenameFilesFeature=vt.DidCreateFilesFeature=void 0;var Ft=require("vscode"),Eb=qo(),ln=J(),Ob=Ie();function Wm(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function Fb(n,e){return n[e]}function Bm(n,e,t){n[e]=t}var dn=class{constructor(e,t,r,i,o){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Wm(Wm(e,"workspace"),"fileOperations");Bm(t,"dynamicRegistration",!0),Bm(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,r=t!==void 0?Fb(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:Ob.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new Eb.Minimatch(r.pattern.glob,dn.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return dn.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async o=>{let s=t(o),a=s.fsPath.replace(/\\/g,"/");for(let u of this._filters.values())for(let l of u)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let f=await this.getFileType(s);if(f===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(f===Ft.FileType.File&&l.kind===ln.FileOperationPatternKind.file||f===Ft.FileType.Directory&&l.kind===ln.FileOperationPatternKind.folder)return!0}else if(l.kind===ln.FileOperationPatternKind.folder&&await dn.getFileType(s)===Ft.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return{...e,files:i}}static async getFileType(e){try{return(await Ft.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},hs=class extends dn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},ps=class extends hs{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await dn.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},ld=class extends hs{constructor(e){super(e,Ft.workspace.onDidCreateFiles,ln.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}};vt.DidCreateFilesFeature=ld;var dd=class extends ps{constructor(e){super(e,Ft.workspace.onDidRenameFiles,ln.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Ft.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}};vt.DidRenameFilesFeature=dd;var fd=class extends ps{constructor(e){super(e,Ft.workspace.onDidDeleteFiles,ln.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Ft.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};vt.DidDeleteFilesFeature=fd;var Ii=class extends dn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},hd=class extends Ii{constructor(e){super(e,Ft.workspace.onWillCreateFiles,ln.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}};vt.WillCreateFilesFeature=hd;var pd=class extends Ii{constructor(e){super(e,Ft.workspace.onWillRenameFiles,ln.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}};vt.WillRenameFilesFeature=pd;var gd=class extends Ii{constructor(e){super(e,Ft.workspace.onWillDeleteFiles,ln.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};vt.WillDeleteFilesFeature=gd});var $m=P(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.LinkedEditingFeature=void 0;var Lb=require("vscode"),md=J(),yd=ue(),vd=class extends yd.TextDocumentLanguageFeature{constructor(e){super(e,md.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,yd.ensure)((0,yd.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{let a=this._client,u=(f,g,p)=>a.sendRequest(md.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(f,g),p).then(y=>p.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(y,p),y=>a.handleFailedRequest(md.LinkedEditingRangeRequest.type,p,y,null)),l=a.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,u):u(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Lb.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};gs.LinkedEditingFeature=vd});var zm=P(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.TypeHierarchyFeature=void 0;var Mb=require("vscode"),tr=J(),_d=ue(),bd=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,u,l)=>{let f=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(tr.TypeHierarchyPrepareRequest.type,f,l).then(g=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(g,l),g=>i.handleFailedRequest(tr.TypeHierarchyPrepareRequest.type,l,g,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(tr.TypeHierarchySupertypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(tr.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(tr.TypeHierarchySubtypesRequest.type,u,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(tr.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}},wd=class extends _d.TextDocumentLanguageFeature{constructor(e){super(e,tr.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,_d.ensure)((0,_d.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new bd(t);return[Mb.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ms.TypeHierarchyFeature=wd});var Xm=P(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.InlineValueFeature=void 0;var Vm=require("vscode"),ys=J(),Ei=ue(),Cd=class extends Ei.TextDocumentLanguageFeature{constructor(e){super(e,ys.InlineValueRequest.type)}fillClientCapabilities(e){(0,Ei.ensure)((0,Ei.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Ei.ensure)((0,Ei.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(ys.InlineValueRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Vm.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,u)=>{let l=this._client,f=(p,y,h,b)=>{let D={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(p),range:l.code2ProtocolConverter.asRange(y),context:l.code2ProtocolConverter.asInlineValueContext(h)};return l.sendRequest(ys.InlineValueRequest.type,D,b).then(q=>b.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(q,b),q=>l.handleFailedRequest(ys.InlineValueRequest.type,b,q,null))},g=l.middleware;return g.provideInlineValues?g.provideInlineValues(o,s,a,u,f):f(o,s,a,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return Vm.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};vs.InlineValueFeature=Cd});var Zm=P(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.InlayHintsFeature=void 0;var Jm=require("vscode"),Ur=J(),Oi=ue(),Dd=class extends Oi.TextDocumentLanguageFeature{constructor(e){super(e,Ur.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,Oi.ensure)((0,Oi.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Oi.ensure)((0,Oi.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ur.InlayHintRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Jm.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{let u=this._client,l=async(g,p,y)=>{let h={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(g),range:u.code2ProtocolConverter.asRange(p)};try{let b=await u.sendRequest(Ur.InlayHintRequest.type,h,y);return y.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(b,y)}catch(b){return u.handleFailedRequest(Ur.InlayHintRequest.type,y,b,null)}},f=u.middleware;return f.provideInlayHints?f.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{let a=this._client,u=async(f,g)=>{try{let p=await a.sendRequest(Ur.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(f),g);if(g.isCancellationRequested)return null;let y=a.protocol2CodeConverter.asInlayHint(p,g);return g.isCancellationRequested?null:y}catch(p){return a.handleFailedRequest(Ur.InlayHintResolveRequest.type,g,p,null)}},l=a.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,u):u(o,s)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return Jm.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};_s.InlayHintsFeature=Dd});var Qm=P(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.InlineCompletionItemFeature=void 0;var Nb=require("vscode"),Sd=J(),Rd=ue(),Ab=Ie(),Td=class extends Rd.TextDocumentLanguageFeature{constructor(e){super(e,Sd.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Rd.ensure)((0,Rd.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:Ab.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideInlineCompletionItems:(i,o,s,a)=>{let u=this._client,l=this._client.middleware,f=(g,p,y,h)=>u.sendRequest(Sd.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(g,p,y),h).then(b=>h.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(b,h),b=>u.handleFailedRequest(Sd.InlineCompletionRequest.type,h,b,null));return l.provideInlineCompletionItems?l.provideInlineCompletionItems(i,o,s,a,f):f(i,o,s,a)}};return[Nb.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};bs.InlineCompletionItemFeature=Td});var ry=P(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.ProposedFeatures=Qe.BaseLanguageClient=Qe.MessageTransports=Qe.SuspendMode=Qe.State=Qe.CloseAction=Qe.ErrorAction=Qe.RevealOutputChannelOn=void 0;var _e=require("vscode"),k=J(),jb=Gg(),Hb=tm(),Wt=At(),ws=Eo(),Gm=Ie(),Ub=Qu(),Ut=ue(),Wb=vu(),Ym=am(),ey=um(),Wr=lm(),Bb=dm(),Kb=fm(),$b=hm(),zb=gm(),Vb=mm(),Xb=Cl(),Jb=vm(),Zb=_m(),Qb=bm(),Gb=Cm(),xd=Dm(),Yb=Rm(),ew=Tm(),tw=Pm(),nw=qm(),rw=km(),iw=Im(),ow=Em(),sw=Om(),aw=Lm(),cw=Mm(),uw=Nm(),lw=jm(),dw=Hm(),fw=Um(),Br=Km(),hw=$m(),pw=zm(),gw=Xm(),mw=Zm(),yw=Qm(),nr;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(nr||(Qe.RevealOutputChannelOn=nr={}));var Li;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(Li||(Qe.ErrorAction=Li={}));var On;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(On||(Qe.CloseAction=On={}));var Fi;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Fi||(Qe.State=Fi={}));var ty;(function(n){n.off="off",n.on="on"})(ty||(Qe.SuspendMode=ty={}));var Pd;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&Wt.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(Pd||(Pd={}));var qd=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Li.Continue}:{action:Li.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:On.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:On.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:On.Restart})}},ie;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(ie||(ie={}));var ny;(function(n){function e(t){return t&&k.MessageReader.is(t.reader)&&k.MessageWriter.is(t.writer)}n.is=e})(ny||(Qe.MessageTransports=ny={}));var fn=class{constructor(e,t,r){this._traceFormat=k.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new ws.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=Pd.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??nr.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=ie.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new ws.Semaphore(1),this._pendingChangeDelayer=new ws.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new ws.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new k.Emitter,this._stateChangeEmitter=new k.Emitter,this._trace=k.Trace.Off,this._tracer={log:(o,s)=>{Wt.string(o)?this.logTrace(o,s):this.logObjectTrace(o)}},this._c2p=jb.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=Hb.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=_e.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case ie.Starting:return Fi.Starting;case ie.Running:return Fi.Running;default:return Fi.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===k.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let o,s;return t.length===1?k.CancellationToken.is(t[0])?s=t[0]:o=t[0]:t.length===2&&(o=t[0],s=t[1]),i(e,o,s,(a,u,l)=>{let f=[];return u!==void 0&&f.push(u),l!==void 0&&f.push(l),r.sendRequest(a,...f)})}else return r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),o;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),o={dispose:()=>{let s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),o={dispose:()=>{this._pendingRequestHandlers.delete(r);let s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),o.dispose()}}}async sendNotification(e,t){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===k.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===k.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let o=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(o),i!==void 0&&this._pendingOpenNotifications.delete(i);let s=this._clientOptions.middleware?.sendNotification;return s?s(e,o.sendNotification.bind(o),t):o.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),o;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),o={dispose:()=>{let s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),o={dispose:()=>{this._pendingNotificationHandlers.delete(r);let s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),o.dispose()}}}async sendProgress(e,t,r){if(this.$state===ie.StartFailed||this.$state===ie.Stopping||this.$state===ie.Stopped)return Promise.reject(new k.ResponseError(k.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),o,s=this._clientOptions.middleware?.handleWorkDoneProgress,a=k.WorkDoneProgress.is(e)&&s!==void 0?u=>{s(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),o={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),o={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),o.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new qd(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof k.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Wt.string(e.stack)?e.stack:e.message:Wt.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(k.MessageType.Debug,nr.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(k.MessageType.Info,nr.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(k.MessageType.Warning,nr.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(k.MessageType.Error,nr.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,o,s){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),o!=null&&this.outputChannel.appendLine(this.data2String(o)),(s==="force"||s&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===k.MessageType.Error?_e.window.showErrorMessage:e===k.MessageType.Warning?_e.window.showWarningMessage:_e.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===ie.Initial||this.$state===ie.Stopping||this.$state===ie.Stopped}needsStop(){return this.$state===ie.Starting||this.$state===ie.Running}activeConnection(){return this.$state===ie.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===ie.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===ie.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?_e.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):_e.languages.createDiagnosticCollection());for(let[i,o]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,o);for(let[i,o]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,o);for(let[i,o]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,o);this.$state=ie.Starting;try{let i=await this.createConnection();i.onNotification(k.LogMessageNotification.type,o=>{switch(o.type){case k.MessageType.Error:this.error(o.message,void 0,!1);break;case k.MessageType.Warning:this.warn(o.message,void 0,!1);break;case k.MessageType.Info:this.info(o.message,void 0,!1);break;case k.MessageType.Debug:this.debug(o.message,void 0,!1);break;default:this.outputChannel.appendLine(o.message)}}),i.onNotification(k.ShowMessageNotification.type,o=>{switch(o.type){case k.MessageType.Error:_e.window.showErrorMessage(o.message);break;case k.MessageType.Warning:_e.window.showWarningMessage(o.message);break;case k.MessageType.Info:_e.window.showInformationMessage(o.message);break;default:_e.window.showInformationMessage(o.message)}}),i.onRequest(k.ShowMessageRequest.type,o=>{let s;switch(o.type){case k.MessageType.Error:s=_e.window.showErrorMessage;break;case k.MessageType.Warning:s=_e.window.showWarningMessage;break;case k.MessageType.Info:s=_e.window.showInformationMessage;break;default:s=_e.window.showInformationMessage}let a=o.actions||[];return s(o.message,...a)}),i.onNotification(k.TelemetryEventNotification.type,o=>{this._telemetryEmitter.fire(o)}),i.onRequest(k.ShowDocumentRequest.type,async o=>{let s=async u=>{let l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await _e.env.openExternal(l)};{let f={};return u.selection!==void 0&&(f.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?f.preserveFocus=!0:u.takeFocus===!0&&(f.preserveFocus=!1),await _e.window.showTextDocument(l,f),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(o,s):s(o)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=ie.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,o)=>{e=i,t=o}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:_e.env.appName,version:_e.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(_e.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Wt.func(t)?t():t,trace:k.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let s=Gm.generateUuid(),a=new Ub.ProgressPart(e,s);o.workDoneToken=s;try{let u=await this.doInitialize(e,o);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,o)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==k.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=ie.Running;let i;Wt.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===k.TextDocumentSyncKind.None?i={openClose:!1,change:k.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(k.PublishDiagnosticsNotification.type,o=>this.handleDiagnostics(o)),e.onRequest(k.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(k.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(k.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o));for(let[o,s]of this._pendingNotificationHandlers)this._notificationDisposables.set(o,e.onNotification(o,s));this._pendingNotificationHandlers.clear();for(let[o,s]of this._pendingRequestHandlers)this._requestDisposables.set(o,e.onRequest(o,s));this._pendingRequestHandlers.clear();for(let[o,s]of this._pendingProgressHandlers)this._progressDisposables.set(o,e.onProgress(s.type,o,s.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(k.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof k.ResponseError&&r.data&&r.data.retry?_e.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&_e.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=_e.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===ie.Stopped||this.$state===ie.Initial)return;if(this.$state===ie.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==ie.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=ie.Stopping,this.cleanUp(e);let i=new Promise(s=>{(0,k.RAL)().timer.setTimeout(s,t)}),o=(async s=>(await s.shutdown(),await s.exit(),s))(r);return this._onStop=Promise.race([i,o]).then(s=>{if(s!==void 0)s.end(),s.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},s=>{throw this.error("Stopping server failed",s,!1),s}).finally(()=>{this.$state=ie.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(k.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(k.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,k.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,k.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new _e.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){let s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(u,l)=>this.setDiagnostics(u,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return _e.env.language}async $start(){if(this.$state===ie.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,o,s)=>{this.handleConnectionError(i,o,s).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=vw(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===ie.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:On.DoNotRestart};if(this.$state!==ie.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===On.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===ie.Starting?this.$state=ie.StartFailed:this.$state=ie.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===On.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=ie.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===Li.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(_e.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=_e.workspace.getConfiguration(this._id),i=k.Trace.Off,o=k.TraceFormat.Text;if(r){let s=r.get("trace.server","off");typeof s=="string"?i=k.Trace.fromString(s):(i=k.Trace.fromString(r.get("trace.server.verbosity","off")),o=k.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(s=>{this.error("Updating trace failed with error",s,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Wt.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(k.DidChangeWatchedFilesNotification.type.method).registerRaw(Gm.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Ut.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(k.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Ym.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new ey.ConfigurationFeature(this)),this.registerFeature(new Wr.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new Wr.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new Wr.WillSaveFeature(this)),this.registerFeature(new Wr.WillSaveWaitUntilFeature(this)),this.registerFeature(new Wr.DidSaveTextDocumentFeature(this)),this.registerFeature(new Wr.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new nw.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new Bb.CompletionItemFeature(this)),this.registerFeature(new Kb.HoverFeature(this)),this.registerFeature(new zb.SignatureHelpFeature(this)),this.registerFeature(new $b.DefinitionFeature(this)),this.registerFeature(new Zb.ReferencesFeature(this)),this.registerFeature(new Vb.DocumentHighlightFeature(this)),this.registerFeature(new Xb.DocumentSymbolFeature(this)),this.registerFeature(new Jb.WorkspaceSymbolFeature(this)),this.registerFeature(new Qb.CodeActionFeature(this)),this.registerFeature(new Gb.CodeLensFeature(this)),this.registerFeature(new xd.DocumentFormattingFeature(this)),this.registerFeature(new xd.DocumentRangeFormattingFeature(this)),this.registerFeature(new xd.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new Yb.RenameFeature(this)),this.registerFeature(new ew.DocumentLinkFeature(this)),this.registerFeature(new tw.ExecuteCommandFeature(this)),this.registerFeature(new ey.SyncConfigurationFeature(this)),this.registerFeature(new ow.TypeDefinitionFeature(this)),this.registerFeature(new iw.ImplementationFeature(this)),this.registerFeature(new rw.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new sw.WorkspaceFoldersFeature(this)),this.registerFeature(new aw.FoldingRangeFeature(this)),this.registerFeature(new cw.DeclarationFeature(this)),this.registerFeature(new uw.SelectionRangeFeature(this)),this.registerFeature(new lw.ProgressFeature(this)),this.registerFeature(new dw.CallHierarchyFeature(this)),this.registerFeature(new fw.SemanticTokensFeature(this)),this.registerFeature(new hw.LinkedEditingFeature(this)),this.registerFeature(new Br.DidCreateFilesFeature(this)),this.registerFeature(new Br.DidRenameFilesFeature(this)),this.registerFeature(new Br.DidDeleteFilesFeature(this)),this.registerFeature(new Br.WillCreateFilesFeature(this)),this.registerFeature(new Br.WillRenameFilesFeature(this)),this.registerFeature(new Br.WillDeleteFilesFeature(this)),this.registerFeature(new pw.TypeHierarchyFeature(this)),this.registerFeature(new gw.InlineValueFeature(this)),this.registerFeature(new mw.InlayHintsFeature(this)),this.registerFeature(new Wb.DiagnosticFeature(this)),this.registerFeature(new Ym.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Id.createAll(this))}fillInitializeParams(e){for(let t of this._features)Wt.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Ut.ensure)(e,"workspace").applyEdit=!0;let t=(0,Ut.ensure)((0,Ut.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[k.ResourceOperationKind.Create,k.ResourceOperationKind.Rename,k.ResourceOperationKind.Delete],t.failureHandling=k.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Ut.ensure)((0,Ut.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[k.DiagnosticTag.Unnecessary,k.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,Ut.ensure)(e,"window"),o=(0,Ut.ensure)(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};let s=(0,Ut.ensure)(i,"showDocument");s.support=!0;let a=(0,Ut.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(fn.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)Wt.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let o={id:t.id,registerOptions:i};try{r.register(o)}catch(s){return Promise.reject(s)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;_e.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(let s of t.documentChanges)if(k.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let a=this._p2c.asUri(s.textDocument.uri).toString(),u=i.get(a);if(u&&u.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):Wt.asPromise(_e.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof k.ResponseError){if(r.code===k.ErrorCodes.PendingResponseRejected||r.code===k.ErrorCodes.ConnectionInactive)return i;if(r.code===k.LSPErrorCodes.RequestCancelled||r.code===k.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Ut.LSPCancellationError(r.data):new _e.CancellationError}else if(r.code===k.LSPErrorCodes.ContentModified){if(fn.RequestsToCancelOnContentModified.has(e.method)||fn.CancellableResolveCalls.has(e.method))throw new _e.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}};Qe.BaseLanguageClient=fn;fn.RequestsToCancelOnContentModified=new Set([k.SemanticTokensRequest.method,k.SemanticTokensRangeRequest.method,k.SemanticTokensDeltaRequest.method]);fn.CancellableResolveCalls=new Set([k.CompletionResolveRequest.method,k.CodeLensResolveRequest.method,k.CodeActionResolveRequest.method,k.InlayHintResolveRequest.method,k.DocumentLinkResolveRequest.method,k.WorkspaceSymbolResolveRequest.method]);var kd=class{error(e){(0,k.RAL)().console.error(e)}warn(e){(0,k.RAL)().console.warn(e)}info(e){(0,k.RAL)().console.info(e)}log(e){(0,k.RAL)().console.log(e)}};function vw(n,e,t,r,i){let o=new kd,s=(0,k.createProtocolConnection)(n,e,o,i);return s.onError(u=>{t(u[0],u[1],u[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(u,l,f)=>{let g={sendNotification:!1,traceFormat:k.TraceFormat.Text};return f===void 0?s.trace(u,l,g):(Wt.boolean(f),s.trace(u,l,f))},initialize:u=>s.sendRequest(k.InitializeRequest.type,u),shutdown:()=>s.sendRequest(k.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(k.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()}}var Id;(function(n){function e(t){return[new yw.InlineCompletionItemFeature(t)]}n.createAll=e})(Id||(Qe.ProposedFeatures=Id={}))});var Od=P(Tt=>{"use strict";var _w=Tt&&Tt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ed=Tt&&Tt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&_w(e,n,t)};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.DiagnosticPullMode=Tt.vsdiag=void 0;Ed(J(),Tt);Ed(ue(),Tt);var iy=vu();Object.defineProperty(Tt,"vsdiag",{enumerable:!0,get:function(){return iy.vsdiag}});Object.defineProperty(Tt,"DiagnosticPullMode",{enumerable:!0,get:function(){return iy.DiagnosticPullMode}});Ed(ry(),Tt)});var Fd=P((wD,oy)=>{"use strict";oy.exports=J()});var cy=P(Yt=>{"use strict";var bw=Yt&&Yt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),ay=Yt&&Yt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&bw(e,n,t)};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.LanguageClient=void 0;var ww=Od(),sy=Fd();ay(Fd(),Yt);ay(Od(),Yt);var Ld=class extends ww.BaseLanguageClient{constructor(e,t,r,i){super(e,t,r),this.worker=i}createMessageTransports(e){let t=new sy.BrowserMessageReader(this.worker),r=new sy.BrowserMessageWriter(this.worker);return Promise.resolve({reader:t,writer:r})}};Yt.LanguageClient=Ld});var ly=P((DD,uy)=>{"use strict";uy.exports=cy()});var Rw={};Kd(Rw,{activate:()=>Sw});module.exports=Ni(Rw);var Bt=Un(require("vscode")),xy=Un(ly());var Kr=Un(J());var dy=new Kr.RequestType("moonbit-lsp/stat"),fy=new Kr.RequestType("moonbit-lsp/readFile"),hy=new Kr.RequestType("moonbit-lsp/readDirectory"),py=new Kr.RequestType0("moonbit-lsp/mooncVersion");var hn=require("vscode");var lt=new Map;lt.set("/array.mbt",{content:`
pub fn to_string[X: Show](self: Array[X]) -> String {
  var acc = "["
  var i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      acc = acc + ", "
    }
    acc = acc + self[i].to_string()
  }
  acc + "]"
}
`,stat:{type:1,mtime:1704177721457963e-3,ctime:1704177721457963e-3,size:220}});lt.set("/buffer.mbt",{content:`
/// Extensible buffer.
///
/// It provides accumulative concatenation of strings in linear time.
/// The capacity of buffer will automatically expand as necessary.
///
/// # Usage 
///
/// \`\`\`
/// let buf = Buffer::make(100)
/// buf.write_string("Tes")
/// buf.write_char("t")
/// println(buf.to_string()) // output: Test
/// \`\`\`
struct Buffer {
  mut bytes : Bytes
  mut len : Int
}

/// Expand the buffer size if capacity smaller than requried space.
fn grow_if_necessary(self : Buffer, required : Int) { 
  var enough_space = self.bytes.length()
  // double the enough_space until it larger than required
  while enough_space < required {
    enough_space = enough_space * 2
  }
  if enough_space != self.bytes.length() {
    let new_bytes = Bytes::make(enough_space, 0)
    blit(new_bytes, 0, self.bytes, 0, self.len)
    self.bytes = new_bytes
  }
}

/// Return a new String contains the data in buffer.
pub fn to_string(self : Buffer) -> String {
  self.bytes.sub_string(0, self.len)
}

/// Create a buffer with initial capacity.
pub fn Buffer::make(initial_capacity : Int) -> Buffer {
  let initial = if initial_capacity < 1 { 1 } else { initial_capacity }
  {
    bytes: Bytes::make(initial, 0),
    len: 0,
  }
}

/// Write a string into buffer.
pub fn write_string(self : Buffer, value : String) {
  self.grow_if_necessary(self.len + value.length())
  self.bytes.blit_from_string(self.len, value, 0, value.length())
  self.len = self.len + value.length()
}

/// Write a sub-string into buffer.
pub fn write_sub_string(self : Buffer, value : String, start: Int, len: Int) {
  if start < 0 || len < 0 || start + len > value.length() {
    abort("Buffer::write_sub_string")
  }
  self.grow_if_necessary(self.len + len)
  self.bytes.blit_from_string(self.len, value, start, len)
  self.len = self.len + len
}

/// Write a char into buffer.
pub fn write_char(self : Buffer, value : Char) {
  self.grow_if_necessary(self.len + 4)
  let inc = self.bytes.set_utf8_char(self.len, value)
  self.len = self.len + inc
}


/// Length of containing data.
pub fn length(self : Buffer) -> Int {
  self.len
}

`,stat:{type:1,mtime:17041777214580361e-4,ctime:17041777214580361e-4,size:2104}});lt.set("/bytes.mbt",{content:`
fn unsafe_blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit"
fn unsafe_sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String = "$moonbit.unsafe_bytes_sub_string"
fn unsafe_bytes_blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit_from_string"


/// Transfer bytes.
///
/// It copies \`length\` bytes from \`src\` begin at \`src_offset\`, to destination byte sequence \`self\` begin at \`dst_offset\`. 
///
/// # Usage
/// \`\`\`
/// let b1 = Bytes::of_string("abcdef")
/// let b2 = Bytes::of_string("ABCDEF")
/// b1.blit(2, b2, 3, 2)
/// println(b1.to_string()) // output: abDEef
/// \`\`\`
pub fn blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) {
  let s1 = dst_offset
  let s2 = src_offset
  let e1 = dst_offset + length - 1
  let e2 = src_offset + length - 1
  let len1 = self.length()
  let len2 = src.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit out of bounds")    
  } else {
    unsafe_blit(self, dst_offset, src, src_offset, length)
  } 
}

/// Create a new String from byte sequence.
pub fn to_string(self : Bytes) -> String {
  self.sub_string(0, self.length())
}

/// Create byte sequence from String.
pub fn Bytes::of_string(str : String) -> Bytes {
  let bytes = Bytes::make(str.length(), 0)
  bytes.blit_from_string(0, str, 0, bytes.length())
  bytes
}

/// Return a new String, containing the subsequence of \`self\` that 
/// starts at \`byte_offset\` and has length \`byte_length\`.
pub fn sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String {
  if byte_length < 0 || byte_offset < 0 || 
       byte_offset + byte_length > self.length() {
    abort("sub_string out of bound")
  } else {
    unsafe_sub_string(self, byte_offset, byte_length)
  }
}

/// Copy \`length\` bytes from string \`str\`, starting at \`str_offset\`, 
/// into byte sequence \`self\`, starting at \`bytes_offset\`.
pub fn blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) {
  let s1 = bytes_offset
  let s2 = str_offset
  let e1 = bytes_offset + length - 1
  let e2 = str_offset + length - 1
  let len1 = self.length()
  let len2 = str.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit_from_string out of bounds")
  } else {
    unsafe_bytes_blit_from_string(self, bytes_offset, str, str_offset, length)
  }
}

/// Return a new Bytes that contains the same byte sequence.
pub fn copy(self : Bytes) -> Bytes {
  let dst = Bytes::make(self.length(), 0)
  blit(dst, 0, self, 0, self.length())
  dst
}

/// Fill utf8 encoded char \`value\` into byte sequence \`self\`, starting at \`offset\`.
/// It return the length of bytes has been written.
pub fn set_utf8_char(self : Bytes, offset : Int, value : Char) -> Int {
  let code = value.to_int()
  if (code < 0x80) {
    self[offset] = code.lsr(0).land(0x7F).lor(0x00)
    1
  } else if (code < 0x0800) {
    self[offset] = code.lsr(6).land(0x1F).lor(0xC0)
    self[offset + 1] = code.lsr(0).land(0x3F).lor(0x80)
    2
  } else if (code < 0x010000) {
    self[offset] = code.lsr(12).land(0x0F).lor(0xE0)
    self[offset + 1] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(0).land(0x3F).lor(0x80)
    3
  } else if (code < 0x110000) {
    self[offset] = code.lsr(18).land(0x07).lor(0xF0)
    self[offset + 1] = code.lsr(12).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 3] = code.lsr(0).land(0x3F).lor(0x80)
    4
  } else { 
    abort("Char out of range") 
  }
}


`,stat:{type:1,mtime:17041777214588027e-4,ctime:17041777214588027e-4,size:3700}});lt.set("/console.mbt",{content:`pub fn println[T : Show](input : T) -> Unit {
  print_string(input.to_string())
  print_string("\\n")
}

pub fn print[T : Show](input : T) -> Unit{
  print_string(input.to_string())
}

pub fn to_string(self : Bool) -> String {
  if self { 
    "true"
  } else {
    "false"
  }
}

pub fn to_string(self : Int64) -> String {
  fn abs(n : Int64) -> Int64 {
    if n < 0L {
      0L - n
    } else {
      n
    }
  }
  
  // The min and max value of i64 are -9223372036854775808 and 9223372036854775807,
  // so max=20 is enough. 
  let max = 20
  let bytes = Bytes::make(max,0)
  var num = self
  var p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10L).to_int()
    bytes[p] = c
    num = num / 10L
    if num == 0L { break }
  }

  if self < 0L {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_string(self : Int) -> String {
  fn abs(n : Int) -> Int {
    if n < 0 {
      0 - n
    } else {
      n
    }
  }
 
  // The min and max value of i32 are -2147483648 and 2147483647,
  // so max=11 is enough.
  let max = 11
  let bytes = Bytes::make(max,0)
  var num = self
  var p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10)
    bytes[p] = c
    num = num / 10
    if num == 0 { break }
  }

  if self < 0 {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_int(self : Bool) -> Int {
  if self {
    1
  } else {
    0
  }
}

pub fn to_int64(self : Bool) -> Int64 {
  if self {
    1L
  } else {
    0L
  }
}

fn to_bool(self : Int) -> Bool {
  if self == 0 {
    false
  } else {
    true
  }
}

fn to_bool(self : Int64) -> Bool {
  if self == 0L {
    false
  } else {
    true
  }
}

pub fn to_string(self : Double) -> String {
  double_to_string(self)
}

pub fn op_lt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_neg()
}

pub fn op_gt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_pos()
}

pub fn op_le[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_pos()
}

pub fn op_ge[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_neg()
}

pub fn op_notequal[T: Eq](x: T, y: T) -> Bool {
  not(x == y)
}

/// A reference to string in host JS.
pub type Js_string

/// Create a JS string from a string in Moonbit by calling intrinsic primitive
pub fn Js_string::new(x: String) -> Js_string {
  x.to_js_string()
}

/// Call FFI to log the JS string
pub fn log(self: Js_string) = "js_string" "log"

/// Call FFI to append two JS strings
pub fn op_add(self: Js_string, other: Js_string) -> Js_string = "js_string" "append"


fn unsafe_make_string(length : Int, value : Char) -> String = "$moonbit.unsafe_make_string"

/// Create new string of \`length\`, where each character is \`value\`
/// 
/// \`\`\`
/// println(String::make(5,'S')) // Output: "SSSSS"
/// \`\`\`
pub fn String::make(length : Int, value : Char) -> String {
  if length < 0 { 
    abort("invalid length") 
  } else {
    unsafe_make_string(length, value)
  }
}

/// Convert Char to String
pub fn to_string(self : Char) -> String {
  let bytes = Bytes::make(4, 0)
  let len = bytes.set_utf8_char(0, self)
  bytes.sub_string(0, len)
}
`,stat:{type:1,mtime:17041777214588716e-4,ctime:17041777214588716e-4,size:3196}});lt.set("/debug.mbt",{content:`
/// [Debug] indicates a type can be printed for debugging
pub interface Debug {
  debug_write(Self, Buffer)
}

/// print a value to the console using [Debug], with a tailing newline
pub fn debug[X: Debug](x: X) {
  let buf = Buffer::make(10)
  x.debug_write(buf)
  println(buf.to_string())
}


pub fn debug_write(self: Unit, buf: Buffer) {
  let _ = self
  buf.write_string("()")
}

pub fn debug_write(self: Bool, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int64, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Double, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Char, buf: Buffer) {
  buf.write_char('\\'')
  match self {
    '\\n' => buf.write_string("\\\\n")
    '\\r' => buf.write_string("\\\\r")
    '\\'' => buf.write_string("\\\\'")
    _ => buf.write_char(self)
  }
  buf.write_char('\\'')
}

pub fn debug_write[X: Debug](self: Option[X], buf: Buffer) {
  match self {
    None => buf.write_string("None")
    Some(arg) => {
      buf.write_string("Some(")
      arg.debug_write(buf)
      buf.write_string(")")
    }
  }
}

pub fn debug_write[X: Debug](self: Ref[X], buf: Buffer) {
  buf.write_string("{val: ")
  self.val.debug_write(buf)
  buf.write_string("}")
}

pub fn debug_write[X: Debug](self: Array[X], buf: Buffer) {
  buf.write_char('[')
  var i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      buf.write_string(", ")
    }
    self[i].debug_write(buf)
  }
  buf.write_char(']')
}

pub fn debug_write(self: String, buf: Buffer) {
  buf.write_char('"')
  var segment_start = 0
  var i = 0
  fn flush_segment() {
    if i > segment_start {
      buf.write_sub_string(self, segment_start, i - segment_start)
    }
    segment_start = i + 1
  }
  while i < self.length(), i = i + 1 {
    let c = self[i]
    match c {
      '\\n' => {
        flush_segment()
        buf.write_string("\\\\n")
      }
      '\\r' => {
        flush_segment()
        buf.write_string("\\\\r")
      }
      '"' => {
        flush_segment()
        buf.write_string("\\\\\\"")
      }
      _ => ()
    }
  }
  flush_segment()
  buf.write_char('"')
}

pub fn debug_write[X: Debug, Y: Debug](self: (X, Y), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug](self: (X, Y, Z), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug, W: Debug](
  self: (X, Y, Z, W),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X1: Debug, X2: Debug, X3: Debug, X4: Debug, X5: Debug](
  self: (X1, X2, X3, X4, X5),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_string(", ")
  self.4.debug_write(buf)
  buf.write_char(')')
}
`,stat:{type:1,mtime:17041816940898018e-4,ctime:17041816940898018e-4,size:3409}});lt.set("/moon.pkg.json",{content:`{}
`,stat:{type:1,mtime:17041777214590344e-4,ctime:17041777214590344e-4,size:3}});lt.set("/option.mbt",{content:`
pub fn Option::default[X]() -> Option[X] {
  None
}

pub fn op_equal[X: Eq](self: Option[X], other: Option[X]) -> Bool {
  match (self, other) {
    (None, None) => true
    (Some(x), Some(y)) => x == y
    _ => false
  }
}

pub fn compare[X: Compare](self: Option[X], other: Option[X]) -> Int {
  match self {
    None =>
      match other {
        None => 0
        Some(_) => -1
      }
    Some(x) =>
      match other {
        None => 1
        Some(y) => x.compare(y)
      }
  }
}

pub fn to_string[X: Show](self: Option[X]) -> String {
  match self {
    None => "None"
    Some(x) => "Some(" + x.to_string() + ")"
  }
}
`,stat:{type:1,mtime:17041816940900305e-4,ctime:17041816940900305e-4,size:632}});lt.set("/ref.mbt",{content:`
pub fn to_string[X: Show](self: Ref[X]) -> String {
  "{val: " + self.val.to_string() + "}"
}
`,stat:{type:1,mtime:1704177721459147e-3,ctime:1704177721459147e-3,size:95}});lt.set("/ryu.mbt",{content:`// MoonBit implementation of Ryu, https://github.com/ulfjack/ryu

fn log10Pow5(e : Int) -> Int {
  (e * 732923).lsr(20)
}

fn pow5bits(e : Int) -> Int {
  (e * 1217359).lsr(19) + 1
}

fn log10Pow2(e : Int) -> Int {
  (e * 78913).lsr(18)
}

// TODO: this is not efficient.
fn string_from_bytes(bytes : Bytes, from : Int, to : Int) -> String {
  var s = ""
  var i = from
  while i < to, i = i + 1 {
    s = s + Char::from_int(bytes[i]).to_string()
  }
  s
}

fn copy_special_str(sign : Bool, exponent : Bool, mantissa : Bool) -> String {
  if mantissa {
    return "NaN"
  }
  let s = if sign {
    "-"
  } else {
    ""
  }
  if exponent {
    return s + "Infinity"
  }
  return s + "0.0"
}

fn u64_lt(x : Int64, y : Int64) -> Bool {
  x.compare_u(y) == -1
}

fn umul128(a : Int64, b : Int64) -> (Int64, Int64) {
  let aLo : Int = a.to_int()
  let aHi : Int = a.lsr(32L).to_int()
  let bLo : Int = b.to_int()
  let bHi : Int = b.lsr(32L).to_int()
  let b00 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bLo)
  let b01 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bHi)
  let b10 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bLo)
  let b11 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bHi)
  let b00Lo : Int = b00.to_int()
  let b00Hi : Int = b00.lsr(32L).to_int()
  let mid1 : Int64 = b10 + Int64::extend_i32_u(b00Hi)
  let mid1Lo : Int = mid1.to_int()
  let mid1Hi : Int = mid1.lsr(32L).to_int()
  let mid2 : Int64 = b01 + Int64::extend_i32_u(mid1Lo)
  let mid2Lo : Int = mid2.to_int()
  let mid2Hi : Int = mid2.lsr(32L).to_int()
  let pHi : Int64 = b11 + Int64::extend_i32_u(mid1Hi) + Int64::extend_i32_u(
      mid2Hi,
    )
  let pLo : Int64 = Int64::extend_i32_u(mid2Lo).lsl(32L).lor(
    Int64::extend_i32_u(b00Lo),
  )
  (pLo, pHi)
}

fn shiftright128(lo : Int64, hi : Int64, dist : Int) -> Int64 {
  hi.lsl(64L - Int64::extend_i32_u(dist)).lor(lo.lsr(Int64::extend_i32_u(dist)))
}

fn pow5Factor(value : Int64) -> Int {
  // We want to find the largest power of 5 that divides value.
  if value % 5L != 0L {
    return 0
  }
  if value % 25L != 0L {
    return 1
  }
  if value % 125L != 0L {
    return 2
  }
  if value % 625L != 0L {
    return 3
  }
  var count = 4
  var value = value / 625L
  while value > 0L {
    if value % 5L != 0L {
      return count
    }
    value = value / 5L
    count = count + 1
  }
  abort("IllegalArgumentException \\(value)")
}

fn multipleOfPowerOf5(value : Int64, p : Int) -> Bool {
  pow5Factor(value) >= p
}

fn multipleOfPowerOf2(value : Int64, p : Int) -> Bool {
  value.land(1L.lsl(p.to_int64()) - 1L) == 0L
}

fn mulShiftAll64(m : Int64, mul : (Int64, Int64), j : Int, mmShift : Bool) ->
     (Int64, Int64, Int64) {
  let m = m.lsl(1L)
  let (lo, tmp) = umul128(m, mul.0)
  let (lo2, hi2) = umul128(m, mul.1)
  let mid = tmp + lo2
  let hi = hi2 + u64_lt(mid, tmp).to_int64()
  let lo2 = lo + mul.0
  let mid2 = mid + mul.1 + u64_lt(lo2, lo).to_int64()
  let hi2 = hi + u64_lt(mid2, mid).to_int64()
  let vp = shiftright128(mid2, hi2, j - 64 - 1)
  var vm : Int64 = 0L
  if mmShift {
    let lo3 = lo - mul.0
    let mid3 = mid - mul.1 - u64_lt(lo, lo3).to_int64()
    let hi3 = hi - u64_lt(mid, mid3).to_int64()
    vm = shiftright128(mid3, hi3, j - 64 - 1)
  } else {
    let lo3 : Int64 = lo + lo
    let mid3 : Int64 = mid + mid + u64_lt(lo3, lo).to_int64()
    let hi3 : Int64 = hi + hi + u64_lt(mid3, mid).to_int64()
    let lo4 : Int64 = lo3 - mul.0
    let mid4 : Int64 = mid3 - mul.1 - u64_lt(lo3, lo4).to_int64()
    let hi4 : Int64 = hi3 - u64_lt(mid3, mid4).to_int64()
    vm = shiftright128(mid4, hi4, j - 64)
  }
  let vr = shiftright128(mid, hi, j - 64 - 1)
  (vr, vp, vm)
}

let gPOW5_TABLE_SIZE = 26

let gDOUBLE_POW5_INV_SPLIT2 : Array[Int64] = [
  1L,
  2305843009213693952L,
  5955668970331000884L,
  1784059615882449851L,
  8982663654677661702L,
  1380349269358112757L,
  7286864317269821294L,
  2135987035920910082L,
  7005857020398200553L,
  1652639921975621497L,
  -481418970354774919L,
  1278668206209430417L,
  8928596168509315048L,
  1978643211784836272L,
  -8371072500651252758L,
  1530901034580419511L,
  597001226353042382L,
  1184477304306571148L,
  1527430471115325346L,
  1832889850782397517L,
  -5913534206540532074L,
  1418129833677084982L,
  5577825024675947042L,
  2194449627517475473L,
  -7439769533505684065L,
  1697873161311732311L,
  -8133250842069730034L,
  1313665730009899186L,
  -5745727253942878843L,
  2032799256770390445L,
]

let gPOW5_INV_OFFSETS : Array[Int] = [
  1414808916,
  67458373,
  268701696,
  4195348,
  1073807360,
  1091917141,
  1108,
  65604,
  1073741824,
  1140850753,
  1346716752,
  1431634004,
  1365595476,
  1073758208,
  16777217,
  66816,
  1364284433,
  89478484,
  0,
]

let gDOUBLE_POW5_SPLIT2 : Array[Int64] = [
  0L,
  1152921504606846976L,
  0L,
  1490116119384765625L,
  1032610780636961552L,
  1925929944387235853L,
  7910200175544436838L,
  1244603055572228341L,
  -1504838264676837686L,
  1608611746708759036L,
  -5421850118411349444L,
  2079081953128979843L,
  6607496772837067824L,
  1343575221513417750L,
  -1113817083813899013L,
  1736530273035216783L,
  -5409364890226003632L,
  2244412773384604712L,
  1605989338741628675L,
  1450417759929778918L,
  -8816519005292960336L,
  1874621017369538693L,
  665883850346957067L,
  1211445438634777304L,
  -3514853404985837908L,
  1565756531257009982L,
]

let gPOW5_OFFSETS : Array[Int] = [
  0,
  0,
  0,
  0,
  1073741824,
  1500076437,
  1431590229,
  1448432917,
  1091896580,
  1079333904,
  1146442053,
  1146111296,
  1163220304,
  1073758208,
  -1773927360,
  1431721317,
  1413824581,
  1075134801,
  1431671125,
  1363170645,
  261,
]

let gDOUBLE_POW5_TABLE : Array[Int64] = [
  1L,
  5L,
  25L,
  125L,
  625L,
  3125L,
  15625L,
  78125L,
  390625L,
  1953125L,
  9765625L,
  48828125L,
  244140625L,
  1220703125L,
  6103515625L,
  30517578125L,
  152587890625L,
  762939453125L,
  3814697265625L,
  19073486328125L,
  95367431640625L,
  476837158203125L,
  2384185791015625L,
  11920928955078125L,
  59604644775390625L,
  298023223876953125L,
]

fn double_computePow5(i : Int) -> (Int64, Int64) {
  let base : Int = i / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = i - base2
  let mul0 = gDOUBLE_POW5_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum : Int64 = high0 + low1
  var high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(i) - pow5bits(base2)
  let a = shiftright128(low0, sum, delta) + gPOW5_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

fn double_computeInvPow5(i : Int) -> (Int64, Int64) {
  let base : Int = (i + gPOW5_TABLE_SIZE - 1) / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = base2 - i
  let mul0 = gDOUBLE_POW5_INV_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_INV_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum = high0 + low1
  var high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(base2) - pow5bits(i)
  let a = shiftright128(low0, sum, delta) + 1L + gPOW5_INV_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

let gDOUBLE_MANTISSA_BITS : Int = 52

let gDOUBLE_EXPONENT_BITS : Int = 11

let gDOUBLE_BIAS : Int = 1023

let gDOUBLE_POW5_INV_BITCOUNT : Int = 125

let gDOUBLE_POW5_BITCOUNT : Int = 125

fn assert(b : Bool, msg : String) -> Unit {
  if not(b) {
    abort("assert failed: \\(msg)\\n")
  }
}

fn decimalLength17(v : Int64) -> Int {
  // This is slightly faster than a loop.
  // The average output length is 16.38 digits, so we check high-to-low.
  // Function precondition: v is not an 18, 19, or 20-digit number.
  // (17 digits are sufficient for round-tripping.)
  assert(v < 100000000000000000L, "v < 100000000000000000L")
  if v >= 10000000000000000L {
    return 17
  }
  if v >= 1000000000000000L {
    return 16
  }
  if v >= 100000000000000L {
    return 15
  }
  if v >= 10000000000000L {
    return 14
  }
  if v >= 1000000000000L {
    return 13
  }
  if v >= 100000000000L {
    return 12
  }
  if v >= 10000000000L {
    return 11
  }
  if v >= 1000000000L {
    return 10
  }
  if v >= 100000000L {
    return 9
  }
  if v >= 10000000L {
    return 8
  }
  if v >= 1000000L {
    return 7
  }
  if v >= 100000L {
    return 6
  }
  if v >= 10000L {
    return 5
  }
  if v >= 1000L {
    return 4
  }
  if v >= 100L {
    return 3
  }
  if v >= 10L {
    return 2
  }
  return 1
}

// A floating decimal representing m * 10^e.
priv struct FloatingDecimal64 {
  mantissa : Int64
  // Decimal exponent's range is -324 to 308
  // inclusive, and can fit in a short if needed.
  exponent : Int
}

fn to_string(self : FloatingDecimal64) -> String {
  let m = self.mantissa
  let e = self.exponent
  "{ mantissa: \\(m), exponent: \\(e) }"
}

fn d2d(ieeeMantissa : Int64, ieeeExponent : Int) -> FloatingDecimal64 {
  var e2 : Int = 0
  var m2 : Int64 = 0L
  if ieeeExponent == 0 {
    e2 = 1 - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = ieeeMantissa
  } else {
    e2 = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  }
  let even = m2.land(1L) == 0L
  let acceptBounds = even

  // Step 2: Determine the interval of valid decimal representations.
  let mv = 4L * m2
  // Implicit bool -> int conversion. True is 1, false is 0.
  let mmShift = ieeeMantissa != 0L || ieeeExponent <= 1
  // We would compute mp and mm like this:
  // uint64_t mp = 4 * m2 + 2;
  // uint64_t mm = mv - 1 - mmShift;

  // Step 3: Convert to a decimal power base using 128-bit arithmetic.
  var vr : Int64 = 0L
  var vp : Int64 = 0L
  var vm : Int64 = 0L
  var e10 : Int = 0
  var vmIsTrailingZeros = false
  var vrIsTrailingZeros = false
  if e2 >= 0 {
    // I tried special-casing q == 0, but there was no effect on performance.
    // This expression is slightly faster than max(0, log10Pow2(e2) - 1).
    let q : Int = log10Pow2(e2) - (e2 > 3).to_int()
    e10 = q
    let k = gDOUBLE_POW5_INV_BITCOUNT + pow5bits(q) - 1
    let i = -e2 + q + k
    let pow5 = double_computeInvPow5(q)
    let vs = mulShiftAll64(m2, pow5, i, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 21 {
      // This should use q <= 22, but I think 21 is also safe. Smaller values
      // may still be safe, but it's more difficult to reason about them.
      // Only one of mp, mv, and mm can be a multiple of 5, if any.
      let mvMod5 : Int = mv.to_int() - 5 * (mv / 5L).to_int()
      if mvMod5 == 0 {
        vrIsTrailingZeros = multipleOfPowerOf5(mv, q)
      } else if acceptBounds {
        // Same as min(e2 + (~mm & 1), pow5Factor(mm)) >= q
        // <=> e2 + (~mm & 1) >= q && pow5Factor(mm) >= q
        // <=> true && pow5Factor(mm) >= q, since e2 >= q.
        vmIsTrailingZeros = multipleOfPowerOf5(mv - 1L - mmShift.to_int64(), q)
      } else {
        vp = vp - multipleOfPowerOf5(mv + 2L, q).to_int64()
      }
    }
  } else {
    // This expression is slightly faster than max(0, log10Pow5(-e2) - 1).
    let q : Int = log10Pow5(-e2) - (-e2 > 1).to_int()
    e10 = q + e2
    let i : Int = -e2 - q
    let k = pow5bits(i) - gDOUBLE_POW5_BITCOUNT
    let j = q - k
    let pow5 = double_computePow5(i)
    let vs = mulShiftAll64(m2, pow5, j, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 1 {
      // {vr,vp,vm} is trailing zeros if {mv,mp,mm} has at least q trailing 0 bits.
      // mv = 4 * m2, so it always has at least two trailing 0 bits.
      vrIsTrailingZeros = true
      if acceptBounds {
        vmIsTrailingZeros = mmShift.to_int() == 1
      } else {
        vp = vp - 1L
      }
    } else if q < 63 {
      vrIsTrailingZeros = multipleOfPowerOf2(mv, q)
    }
  }

  // Step 4: Find the shortest decimal representation in the interval of valid representations.
  var removed : Int = 0
  var lastRemovedDigit : Int = 0
  var output : Int64 = 0L
  // On average, we remove ~2 digits.
  if vmIsTrailingZeros || vrIsTrailingZeros {
    // General case, which happens rarely (~0.7%).
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      vmIsTrailingZeros = vmIsTrailingZeros && vmMod10 == 0
      vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
      lastRemovedDigit = vrMod10
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    if vmIsTrailingZeros {
      while true {
        let vmDiv10 : Int64 = vm / 10L
        let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
        if vmMod10 != 0 {
          break
        }
        let vpDiv10 : Int64 = vp / 10L
        let vrDiv10 : Int64 = vr / 10L
        let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
        vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
        lastRemovedDigit = vrMod10
        vr = vrDiv10
        vp = vpDiv10
        vm = vmDiv10
        removed = removed + 1
      }
    }
    if vrIsTrailingZeros && lastRemovedDigit == 5 && vr % 2L == 0L {
      lastRemovedDigit = 4
    }
    output = vr + (vr == vm && (not(acceptBounds) || not(vmIsTrailingZeros)) || lastRemovedDigit >=
    5).to_int64()
  } else {
    // Specialized for the common case (~99.3%). Percentages below are relative to this.
    var roundUp = false
    let vpDiv100 : Int64 = vp / 100L
    let vmDiv100 : Int64 = vm / 100L
    if vpDiv100 > vmDiv100 {
      let vrDiv100 : Int64 = vr / 100L
      let vrMod100 : Int = vr.to_int() - 100 * vrDiv100.to_int()
      roundUp = vrMod100 >= 50
      vr = vrDiv100
      vp = vpDiv100
      vm = vmDiv100
      removed = removed + 2
    }
    // Loop iterations below (approximately), without optimization above:
    // 0: 0.03%, 1: 13.8%, 2: 70.6%, 3: 14.0%, 4: 1.40%, 5: 0.14%, 6+: 0.02%
    // Loop iterations below (approximately), with optimization above:
    // 0: 70.6%, 1: 27.8%, 2: 1.40%, 3: 0.14%, 4+: 0.02%
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      roundUp = vrMod10 >= 5
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    output = vr + (vr == vm || roundUp).to_int64()
  }
  let exp : Int = e10 + removed
  let fd = { mantissa: output, exponent: exp }
  fd
}

fn to_chars(v : FloatingDecimal64, sign : Bool) -> String {
  // Step 5: Print the decimal representation.
  let result = Bytes::make(24, 0)
  var index : Int = 0
  if sign {
    result[index] = '-'.to_int()
    index = index + 1
  }
  var output : Int64 = v.mantissa
  let olength : Int = decimalLength17(output)
  var exp : Int = v.exponent + olength - 1
  let scientificNotation = not(exp >= -3 && exp < 7)
  if scientificNotation {
    // Print the decimal digits.
    var i = 0
    while i < olength - 1, i = i + 1 {
      let c = output % 10L
      output = output / 10L
      result[index + olength - i] = '0'.to_int() + c.to_int()
    }
    result[index] = '0'.to_int() + output.to_int() % 10

    // Always print point
    result[index + 1] = '.'.to_int()
    index = index + olength + 1
    if olength == 1 {
      result[index] = '0'.to_int()
      index = index + 1
    }

    // Print the exponent.
    result[index] = 'e'.to_int()
    index = index + 1
    if exp < 0 {
      result[index] = '-'.to_int()
      index = index + 1
      exp = -exp
    }
    if exp >= 100 {
      let a = exp / 100
      let b = exp / 10 % 10
      let c = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      result[index + 2] = '0'.to_int() + c
      index = index + 3
    } else if exp >= 10 {
      let a = exp / 10
      let b = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      index = index + 2
    } else {
      result[index] = '0'.to_int() + exp
      index = index + 1
    }
    string_from_bytes(result, 0, index)
  } else {
    if exp < 0 {
      // Decimal dot is before any of the digits.
      result[index] = '0'.to_int()
      index = index + 1
      result[index] = '.'.to_int()
      index = index + 1
      var i = -1
      while i > exp, i = i - 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      let current = index
      var i = 0
      while i < olength, i = i + 1 {
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
        index = index + 1
      }
    } else if exp + 1 >= olength {
      // Decimal dot is after any of the digits.
      var i = 0
      while i < olength, i = i + 1 {
        result[index + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength
      var i = olength
      while i < exp + 1, i = i + 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      result[index] = '.'.to_int()
      index = index + 1
      result[index] = '0'.to_int()
      index = index + 1
    } else {
      // Decimal dot is somewhere between the digits.
      var current = index + 1
      var i = 0
      while i < olength, i = i + 1 {
        if olength - i - 1 == exp {
          result[current + olength - i - 1] = '.'.to_int()
          current = current - 1
        }
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength + 1
    }
    return string_from_bytes(result, 0, index)
  }
}

fn d2d_small_int(ieeeMantissa : Int64, ieeeExponent : Int) ->
     Option[FloatingDecimal64] {
  let m2 : Int64 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  let e2 : Int = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS
  if e2 > 0 {
    return None
  }
  if e2 < -52 {
    return None
  }
  let mask : Int64 = 1L.lsl(-e2.to_int64()) - 1L
  let fraction : Int64 = m2.land(mask)
  if fraction != 0L {
    return None
  }
  Some({ mantissa: m2.lsr(-e2.to_int64()), exponent: 0 })
}

fn double_to_string(f : Double) -> String {
  // Step 1: Decode the floating-point number, and unify normalized and subnormal cases.
  let bits : Int64 = f.reinterpret_as_i64()

  // Decode bits into sign, mantissa, and exponent.
  let ieeeSign = bits.lsr(
      gDOUBLE_MANTISSA_BITS.to_int64() + gDOUBLE_EXPONENT_BITS.to_int64(),
    ).land(1L) != 0L
  let ieeeMantissa : Int64 = bits.land(
    1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()) - 1L,
  )
  let ieeeExponent : Int = bits.lsr(gDOUBLE_MANTISSA_BITS.to_int64()).land(
    1L.lsl(gDOUBLE_EXPONENT_BITS.to_int64()) - 1L,
  ).to_int()
  if ieeeExponent == (1).lsl(gDOUBLE_EXPONENT_BITS) - 1 || ieeeExponent == 0 && ieeeMantissa ==
  0L {
    return copy_special_str(
      ieeeSign,
      ieeeExponent.to_bool(),
      ieeeMantissa.to_bool(),
    )
  }
  var v : FloatingDecimal64 = { mantissa: 0L, exponent: 0 }
  let small = d2d_small_int(ieeeMantissa, ieeeExponent)
  match small {
    Some(f) => {
      var x = f
      while true {
        let q : Int64 = x.mantissa / 10L
        let r = x.mantissa.to_int() - 10 * q.to_int()
        if r != 0 {
          break
        }
        x = { mantissa: q, exponent: x.exponent + 1 }
      }
      v = x
    }
    None => {
      v = d2d(ieeeMantissa, ieeeExponent)
    }
  }
  to_chars(v, ieeeSign)
}

`,stat:{type:1,mtime:17041777214593186e-4,ctime:17041777214593186e-4,size:20114}});lt.set("/string.mbt",{content:`
pub fn compare(self: String, other: String) -> Int {
  let len = self.length() 
  match len.compare(other.length()) {
    0 => {
      var i = 0
      while i < len, i = i + 1 {
        let order = self[i].compare(other[i])
        if order != 0 {
          return order
        }
      }
      0
    }
    order => order
  }
}

pub fn String::default() -> String { "" }
`,stat:{type:1,mtime:1704177721459418e-3,ctime:1704177721459418e-3,size:372}});lt.set("/unit.mbt",{content:`
pub fn to_string(self: Unit) -> String {
  let _ = self  
  "()"
}

pub fn op_equal(self: Unit, _other: Unit) -> Bool {
  let _ = self    
  true
}

pub fn compare(self: Unit, _other: Unit) -> Int {
  let _ = self    
  0
}

pub fn hash(self: Unit) -> Int {
  let _ = self    
  0
}

pub fn Unit::default() -> Unit {  
  ()
}
`,stat:{type:1,mtime:17041777214594775e-4,ctime:17041777214594775e-4,size:327}});lt.set("/xxhash.mbt",{content:`let gPRIME1 = -1640531535

let gPRIME2 = -2048144777

let gPRIME3 = -1028477379

let gPRIME4 = 668265263

let gPRIME5 = 374761393

fn xxhash32(input : Bytes, seed : Int) -> Int {
  let len = input.length()
  let h = if len >= 16 {
      h16bytes(input, 0, len, seed)
    } else {
      seed + gPRIME5
    } + len
  finalize(h, input, len.land(-16), len.land(0xF))
}

pub fn to_bytes(self : String) -> Bytes {
  let len = self.length()
  let buf = Bytes::make(len, 0)
  var i = 0
  while i < len, i = i + 1 {
    buf[i] = self[i].to_int()
  }
  buf
}

pub fn hash(self : Bool) -> Int {
  self.to_int()
}

pub fn hash(self : Char) -> Int {
  self.to_int()
}

pub fn hash(self : Int) -> Int {
  self
}

pub fn hash(self : Int64) -> Int {
  let lo = self.to_int()
  let hi = self.lsr(32L).to_int()
  lo.lxor(hi)
}

pub fn hash(self : Double) -> Int {
  self.reinterpret_as_i64().hash()
}

pub fn hash(self : String) -> Int {
  xxhash32(self.to_bytes(), 0)
}

pub fn hash(self : Bytes) -> Int {
  xxhash32(self, 0)
}

fn rotl(x : Int, r : Int) -> Int {
  x.lsl(r).lor(x.lsr(32 - r))
}

fn round(acc : Int, input : Int) -> Int {
  rotl(acc + input * gPRIME2, 13) * gPRIME1
}

fn avalanche_step(h : Int, rshift : Int, prime : Int) -> Int {
  h.lxor(h.lsr(rshift)) * prime
}

fn avalanche(h : Int) -> Int {
  avalanche_step(
    avalanche_step(avalanche_step(h, 15, gPRIME2), 13, gPRIME3),
    16,
    1,
  )
}

fn endian32(input : Bytes, cur : Int) -> Int {
  input[cur + 0].lor(
    input[cur + 1].lsl(8).lor(
      input[cur + 2].lsl(16).lor(input[cur + 3].lsl(24)),
    ),
  )
}

fn fetch32(input : Bytes, cur : Int, v : Int) -> Int {
  round(v, endian32(input, cur))
}

fn finalize(h : Int, input : Bytes, cur : Int, remain : Int) -> Int {
  if remain >= 4 {
    finalize(
      rotl(h + endian32(input, cur) * gPRIME3, 17) * gPRIME4,
      input,
      cur + 4,
      remain - 4,
    )
  } else if remain > 0 {
    finalize(
      rotl(h + input[cur] * gPRIME5, 11) * gPRIME1,
      input,
      cur + 1,
      remain - 1,
    )
  } else {
    avalanche(h)
  }
}

fn _h16bytes(input : Bytes, cur : Int, remain : Int, v1 : Int, v2 : Int,
        v3 : Int, v4 : Int) -> Int {
  if remain >= 16 {
    _h16bytes(
      input,
      cur + 16,
      remain - 16,
      fetch32(input, cur, v1),
      fetch32(input, cur + 4, v2),
      fetch32(input, cur + 8, v3),
      fetch32(input, cur + 12, v4),
    )
  } else {
    rotl(v1, 1) + rotl(v2, 7) + rotl(v3, 12) + rotl(v4, 18)
  }
}

fn h16bytes(input : Bytes, cur : Int, len : Int, seed : Int) -> Int {
  _h16bytes(
    input,
    cur,
    len,
    seed + gPRIME1 + gPRIME2,
    seed + gPRIME2,
    seed,
    seed - gPRIME1,
  )
}

`,stat:{type:1,mtime:17041777214595403e-4,ctime:17041777214595403e-4,size:2675}});var Md="moonbit",gy="Moonbit";var my="moonbit-builtin";var Nd=class{constructor(){this._emmiter=new hn.EventEmitter;this.onDidChangeFile=this._emmiter.event;this._disposable=hn.workspace.registerFileSystemProvider(Nd.scheme,this,{isReadonly:!0})}dispose(){this._disposable.dispose()}watch(e,t){return new hn.Disposable(()=>{})}stat(e){let t=lt.get(e.fsPath);if(t===void 0)throw hn.FileSystemError.FileNotFound(e);return t.stat}readDirectory(e){return[...lt.entries()].map(([t,r])=>[t,r.stat.type])}createDirectory(e){}readFile(e){let t=lt.get(e.fsPath);if(t===void 0)throw hn.FileSystemError.FileNotFound(e);return new TextEncoder().encode(t.content)}writeFile(e,t,r){}delete(e,t){}rename(e,t,r){}},Cs=Nd;Cs.scheme=my;var yy=new Cs;var Ee=Un(require("vscode"));function vy(n){try{return JSON.parse(n)}catch(e){console.error("parse moon.pkg.json",e);return}}function _y(n){return JSON.stringify(n,null,2)}async function Ds(n){return await n.sendRequest(py)}async function by(n){let e=await Ds(n);await Ee.window.showInformationMessage(`Current version is ${e}`,"copy hash")==="copy hash"&&await Ee.env.clipboard.writeText(e)}var wy=async n=>await Ee.workspace.fs.stat(Ee.Uri.parse(n)),Cy=async n=>{let e=await Ee.workspace.fs.readFile(Ee.Uri.parse(n));return Array.from(e)},Dy=async n=>await Ee.workspace.fs.readDirectory(Ee.Uri.parse(n));async function Sy(n,e,t){let r=Ee.Uri.parse(n),i=async()=>{let l=Ee.workspace.textDocuments.find(g=>g.uri.toString(!0)===r.toString(!0));if(l!==void 0)return l.getText();let f=await Ee.workspace.fs.readFile(r);return new TextDecoder().decode(f)},o=async l=>{let f=Ee.workspace.textDocuments.find(g=>g.uri.toString(!0)===r.toString(!0));if(f!==void 0){let g=new Ee.WorkspaceEdit;g.set(r,[new Ee.TextEdit(new Ee.Range(f.positionAt(0),f.positionAt(f.getText().length)),l)]),await Ee.workspace.applyEdit(g);return}await Ee.workspace.fs.writeFile(r,new TextEncoder().encode(l))},s=await i(),a=vy(s);if(a===void 0||(a.import===void 0&&(a.import={}),a.import[e]!==void 0))return;a.import[e]=t;let u=_y(a);await o(u)}var nt=Un(require("vscode"));var Ry;(()=>{"use strict";var n={470:i=>{function o(u){if(typeof u!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(u))}function s(u,l){for(var f,g="",p=0,y=-1,h=0,b=0;b<=u.length;++b){if(b<u.length)f=u.charCodeAt(b);else{if(f===47)break;f=47}if(f===47){if(!(y===b-1||h===1))if(y!==b-1&&h===2){if(g.length<2||p!==2||g.charCodeAt(g.length-1)!==46||g.charCodeAt(g.length-2)!==46){if(g.length>2){var D=g.lastIndexOf("/");if(D!==g.length-1){D===-1?(g="",p=0):p=(g=g.slice(0,D)).length-1-g.lastIndexOf("/"),y=b,h=0;continue}}else if(g.length===2||g.length===1){g="",p=0,y=b,h=0;continue}}l&&(g.length>0?g+="/..":g="..",p=2)}else g.length>0?g+="/"+u.slice(y+1,b):g=u.slice(y+1,b),p=b-y-1;y=b,h=0}else f===46&&h!==-1?++h:h=-1}return g}var a={resolve:function(){for(var u,l="",f=!1,g=arguments.length-1;g>=-1&&!f;g--){var p;g>=0?p=arguments[g]:(u===void 0&&(u=process.cwd()),p=u),o(p),p.length!==0&&(l=p+"/"+l,f=p.charCodeAt(0)===47)}return l=s(l,!f),f?l.length>0?"/"+l:"/":l.length>0?l:"."},normalize:function(u){if(o(u),u.length===0)return".";var l=u.charCodeAt(0)===47,f=u.charCodeAt(u.length-1)===47;return(u=s(u,!l)).length!==0||l||(u="."),u.length>0&&f&&(u+="/"),l?"/"+u:u},isAbsolute:function(u){return o(u),u.length>0&&u.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var u,l=0;l<arguments.length;++l){var f=arguments[l];o(f),f.length>0&&(u===void 0?u=f:u+="/"+f)}return u===void 0?".":a.normalize(u)},relative:function(u,l){if(o(u),o(l),u===l||(u=a.resolve(u))===(l=a.resolve(l)))return"";for(var f=1;f<u.length&&u.charCodeAt(f)===47;++f);for(var g=u.length,p=g-f,y=1;y<l.length&&l.charCodeAt(y)===47;++y);for(var h=l.length-y,b=p<h?p:h,D=-1,q=0;q<=b;++q){if(q===b){if(h>b){if(l.charCodeAt(y+q)===47)return l.slice(y+q+1);if(q===0)return l.slice(y+q)}else p>b&&(u.charCodeAt(f+q)===47?D=q:q===0&&(D=0));break}var K=u.charCodeAt(f+q);if(K!==l.charCodeAt(y+q))break;K===47&&(D=q)}var j="";for(q=f+D+1;q<=g;++q)q!==g&&u.charCodeAt(q)!==47||(j.length===0?j+="..":j+="/..");return j.length>0?j+l.slice(y+D):(y+=D,l.charCodeAt(y)===47&&++y,l.slice(y))},_makeLong:function(u){return u},dirname:function(u){if(o(u),u.length===0)return".";for(var l=u.charCodeAt(0),f=l===47,g=-1,p=!0,y=u.length-1;y>=1;--y)if((l=u.charCodeAt(y))===47){if(!p){g=y;break}}else p=!1;return g===-1?f?"/":".":f&&g===1?"//":u.slice(0,g)},basename:function(u,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');o(u);var f,g=0,p=-1,y=!0;if(l!==void 0&&l.length>0&&l.length<=u.length){if(l.length===u.length&&l===u)return"";var h=l.length-1,b=-1;for(f=u.length-1;f>=0;--f){var D=u.charCodeAt(f);if(D===47){if(!y){g=f+1;break}}else b===-1&&(y=!1,b=f+1),h>=0&&(D===l.charCodeAt(h)?--h==-1&&(p=f):(h=-1,p=b))}return g===p?p=b:p===-1&&(p=u.length),u.slice(g,p)}for(f=u.length-1;f>=0;--f)if(u.charCodeAt(f)===47){if(!y){g=f+1;break}}else p===-1&&(y=!1,p=f+1);return p===-1?"":u.slice(g,p)},extname:function(u){o(u);for(var l=-1,f=0,g=-1,p=!0,y=0,h=u.length-1;h>=0;--h){var b=u.charCodeAt(h);if(b!==47)g===-1&&(p=!1,g=h+1),b===46?l===-1?l=h:y!==1&&(y=1):l!==-1&&(y=-1);else if(!p){f=h+1;break}}return l===-1||g===-1||y===0||y===1&&l===g-1&&l===f+1?"":u.slice(l,g)},format:function(u){if(u===null||typeof u!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof u);return function(l,f){var g=f.dir||f.root,p=f.base||(f.name||"")+(f.ext||"");return g?g===f.root?g+p:g+"/"+p:p}(0,u)},parse:function(u){o(u);var l={root:"",dir:"",base:"",ext:"",name:""};if(u.length===0)return l;var f,g=u.charCodeAt(0),p=g===47;p?(l.root="/",f=1):f=0;for(var y=-1,h=0,b=-1,D=!0,q=u.length-1,K=0;q>=f;--q)if((g=u.charCodeAt(q))!==47)b===-1&&(D=!1,b=q+1),g===46?y===-1?y=q:K!==1&&(K=1):y!==-1&&(K=-1);else if(!D){h=q+1;break}return y===-1||b===-1||K===0||K===1&&y===b-1&&y===h+1?b!==-1&&(l.base=l.name=h===0&&p?u.slice(1,b):u.slice(h,b)):(h===0&&p?(l.name=u.slice(1,y),l.base=u.slice(1,b)):(l.name=u.slice(h,y),l.base=u.slice(h,b)),l.ext=u.slice(y,b)),h>0?l.dir=u.slice(0,h-1):p&&(l.dir="/"),l},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,i.exports=a}},e={};function t(i){var o=e[i];if(o!==void 0)return o.exports;var s=e[i]={exports:{}};return n[i](s,s.exports,t),s.exports}t.d=(i,o)=>{for(var s in o)t.o(o,s)&&!t.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:o[s]})},t.o=(i,o)=>Object.prototype.hasOwnProperty.call(i,o),t.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var r={};(()=>{let i;t.r(r),t.d(r,{URI:()=>p,Utils:()=>Ue}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);let o=/^\w[\w\d+.-]*$/,s=/^\//,a=/^\/\//;function u(O,x){if(!O.scheme&&x)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${O.authority}", path: "${O.path}", query: "${O.query}", fragment: "${O.fragment}"}`);if(O.scheme&&!o.test(O.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(O.path){if(O.authority){if(!s.test(O.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(a.test(O.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let l="",f="/",g=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class p{constructor(x,L,N,ee,B,X=!1){vn(this,"scheme");vn(this,"authority");vn(this,"path");vn(this,"query");vn(this,"fragment");typeof x=="object"?(this.scheme=x.scheme||l,this.authority=x.authority||l,this.path=x.path||l,this.query=x.query||l,this.fragment=x.fragment||l):(this.scheme=function(Ke,ce){return Ke||ce?Ke:"file"}(x,X),this.authority=L||l,this.path=function(Ke,ce){switch(Ke){case"https":case"http":case"file":ce?ce[0]!==f&&(ce=f+ce):ce=f}return ce}(this.scheme,N||l),this.query=ee||l,this.fragment=B||l,u(this,X))}static isUri(x){return x instanceof p||!!x&&typeof x.authority=="string"&&typeof x.fragment=="string"&&typeof x.path=="string"&&typeof x.query=="string"&&typeof x.scheme=="string"&&typeof x.fsPath=="string"&&typeof x.with=="function"&&typeof x.toString=="function"}get fsPath(){return K(this,!1)}with(x){if(!x)return this;let{scheme:L,authority:N,path:ee,query:B,fragment:X}=x;return L===void 0?L=this.scheme:L===null&&(L=l),N===void 0?N=this.authority:N===null&&(N=l),ee===void 0?ee=this.path:ee===null&&(ee=l),B===void 0?B=this.query:B===null&&(B=l),X===void 0?X=this.fragment:X===null&&(X=l),L===this.scheme&&N===this.authority&&ee===this.path&&B===this.query&&X===this.fragment?this:new h(L,N,ee,B,X)}static parse(x,L=!1){let N=g.exec(x);return N?new h(N[2]||l,ae(N[4]||l),ae(N[5]||l),ae(N[7]||l),ae(N[9]||l),L):new h(l,l,l,l,l)}static file(x){let L=l;if(i&&(x=x.replace(/\\/g,f)),x[0]===f&&x[1]===f){let N=x.indexOf(f,2);N===-1?(L=x.substring(2),x=f):(L=x.substring(2,N),x=x.substring(N)||f)}return new h("file",L,x,l,l)}static from(x){let L=new h(x.scheme,x.authority,x.path,x.query,x.fragment);return u(L,!0),L}toString(x=!1){return j(this,x)}toJSON(){return this}static revive(x){if(x){if(x instanceof p)return x;{let L=new h(x);return L._formatted=x.external,L._fsPath=x._sep===y?x.fsPath:null,L}}return x}}let y=i?1:void 0;class h extends p{constructor(){super(...arguments);vn(this,"_formatted",null);vn(this,"_fsPath",null)}get fsPath(){return this._fsPath||(this._fsPath=K(this,!1)),this._fsPath}toString(L=!1){return L?j(this,!0):(this._formatted||(this._formatted=j(this,!1)),this._formatted)}toJSON(){let L={$mid:1};return this._fsPath&&(L.fsPath=this._fsPath,L._sep=y),this._formatted&&(L.external=this._formatted),this.path&&(L.path=this.path),this.scheme&&(L.scheme=this.scheme),this.authority&&(L.authority=this.authority),this.query&&(L.query=this.query),this.fragment&&(L.fragment=this.fragment),L}}let b={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function D(O,x,L){let N,ee=-1;for(let B=0;B<O.length;B++){let X=O.charCodeAt(B);if(X>=97&&X<=122||X>=65&&X<=90||X>=48&&X<=57||X===45||X===46||X===95||X===126||x&&X===47||L&&X===91||L&&X===93||L&&X===58)ee!==-1&&(N+=encodeURIComponent(O.substring(ee,B)),ee=-1),N!==void 0&&(N+=O.charAt(B));else{N===void 0&&(N=O.substr(0,B));let Ke=b[X];Ke!==void 0?(ee!==-1&&(N+=encodeURIComponent(O.substring(ee,B)),ee=-1),N+=Ke):ee===-1&&(ee=B)}}return ee!==-1&&(N+=encodeURIComponent(O.substring(ee))),N!==void 0?N:O}function q(O){let x;for(let L=0;L<O.length;L++){let N=O.charCodeAt(L);N===35||N===63?(x===void 0&&(x=O.substr(0,L)),x+=b[N]):x!==void 0&&(x+=O[L])}return x!==void 0?x:O}function K(O,x){let L;return L=O.authority&&O.path.length>1&&O.scheme==="file"?`//${O.authority}${O.path}`:O.path.charCodeAt(0)===47&&(O.path.charCodeAt(1)>=65&&O.path.charCodeAt(1)<=90||O.path.charCodeAt(1)>=97&&O.path.charCodeAt(1)<=122)&&O.path.charCodeAt(2)===58?x?O.path.substr(1):O.path[1].toLowerCase()+O.path.substr(2):O.path,i&&(L=L.replace(/\//g,"\\")),L}function j(O,x){let L=x?q:D,N="",{scheme:ee,authority:B,path:X,query:Ke,fragment:ce}=O;if(ee&&(N+=ee,N+=":"),(B||ee==="file")&&(N+=f,N+=f),B){let he=B.indexOf("@");if(he!==-1){let rt=B.substr(0,he);B=B.substr(he+1),he=rt.lastIndexOf(":"),he===-1?N+=L(rt,!1,!1):(N+=L(rt.substr(0,he),!1,!1),N+=":",N+=L(rt.substr(he+1),!1,!0)),N+="@"}B=B.toLowerCase(),he=B.lastIndexOf(":"),he===-1?N+=L(B,!1,!0):(N+=L(B.substr(0,he),!1,!0),N+=B.substr(he))}if(X){if(X.length>=3&&X.charCodeAt(0)===47&&X.charCodeAt(2)===58){let he=X.charCodeAt(1);he>=65&&he<=90&&(X=`/${String.fromCharCode(he+32)}:${X.substr(3)}`)}else if(X.length>=2&&X.charCodeAt(1)===58){let he=X.charCodeAt(0);he>=65&&he<=90&&(X=`${String.fromCharCode(he+32)}:${X.substr(2)}`)}N+=L(X,!0,!1)}return Ke&&(N+="?",N+=L(Ke,!1,!1)),ce&&(N+="#",N+=x?ce:D(ce,!1,!1)),N}function fe(O){try{return decodeURIComponent(O)}catch{return O.length>3?O.substr(0,3)+fe(O.substr(3)):O}}let $=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function ae(O){return O.match($)?O.replace($,x=>fe(x)):O}var W=t(470);let Z=W.posix||W,ne="/";var Ue;(function(O){O.joinPath=function(x,...L){return x.with({path:Z.join(x.path,...L)})},O.resolvePath=function(x,...L){let N=x.path,ee=!1;N[0]!==ne&&(N=ne+N,ee=!0);let B=Z.resolve(N,...L);return ee&&B[0]===ne&&!x.authority&&(B=B.substring(1)),x.with({path:B})},O.dirname=function(x){if(x.path.length===0||x.path===ne)return x;let L=Z.dirname(x.path);return L.length===1&&L.charCodeAt(0)===46&&(L=""),x.with({path:L})},O.basename=function(x){return Z.basename(x.path)},O.extname=function(x){return Z.extname(x.path)}})(Ue||(Ue={}))})(),Ry=r})();var{URI:FD,Utils:Fn}=Ry;var Ss=Un(require("vscode"));async function Ty(n){try{return(await Ss.workspace.fs.stat(n)).type===Ss.FileType.File}catch{return!1}}var Ln=Un(require("vscode")),Cw="https://snippet.moonbitlang.com/report";async function Dw(n,e,t){return await fetch(Cw,{method:"Put",headers:{"Content-Type":"application/json"},body:JSON.stringify({snippet:n,msg:e,version:t})})}async function Ad(n,e,t,r){if(e.kind==="package"||!(n.globalState.get("isWillingUpload")??!0))return;let o=await Ln.window.showInformationMessage("Oops, there is a bug in MoonBit compiler",{modal:!0,detail:`${t}
To improve MoonBit's performance, we need your help.
By clicking "Yes", you agree to send the code and error message to our server. Your data will be used only for internal development, and we'll keep it confidential.`},"Yes"),s=await Ln.workspace.fs.readFile(e.programUri),a=new TextDecoder().decode(s);if(o==="Yes"){let u=await Ln.window.withProgress({location:Ln.ProgressLocation.Notification,title:"Uploading",cancellable:!1},async()=>await Dw(a,t,r));await Ln.window.showInformationMessage(u.ok?"Upload Success":"Upload Failed")}else await n.globalState.update("isWillingUpload",!1)}var Rs=class{constructor(e,t){this._context=e,this._client=t,this._outputChannel=nt.window.createOutputChannel("Output","moonbit-output"),this._wasmRunnerUri=Fn.joinPath(e.extensionUri,"browser","wasm-runner.js"),this._wasmRunner=null,this._startTime=new Date,this._endTime=new Date}async _updateRunningState(){await nt.commands.executeCommand("setContext","moonbit.codeRunning",this._wasmRunner!==null)}async dispose(){this._wasmRunner?.terminate(),this._wasmRunner=null,await this._updateRunningState()}async _getProgramType(e){let t=Fn.dirname(e),r=Fn.joinPath(t,"moon.pkg.json");if(await Ty(r)){let o=await nt.workspace.fs.readDirectory(t).then(s=>s.filter(([a,u])=>u===nt.FileType.File&&a.endsWith(".mbt")).map(([a])=>Fn.joinPath(t,a).toString(!0)));return{kind:"package",pkgUri:t,files:o}}else return{kind:"single",programUri:e}}async _compile(e){let t,r=o=>o.filter(s=>s.message.includes("Compiler Internal Error")),i=o=>o.filter(s=>s.severity==="Error").map((s,a)=>`${a+1}: ${s.message}`).join(`
`);switch(e.kind){case"package":{t=await this._client.sendRequest("compile",{files:e.files});break}case"single":{let o=[e.programUri.toString(!0)];t=await this._client.sendRequest("compile",{files:o});break}}if(t.wat===null){let o=r(t.reports),s=await Ds(this._client);this._error(`Compilation failed due to following errors:
${i(t.reports)}`),o.length>0&&await Ad(this._context,e,i(o),s)}return t}async _watToWasm(e){return await this._client.sendRequest("watToWasm",e)}async compileToFile(e,t){let{fileExt:r,silent:i=!1}=t,o=e??nt.window.activeTextEditor?.document.uri;o===void 0&&await nt.window.showInformationMessage("You did not open a Moonbit document"),this._outputChannel.clear();let s=await this._getProgramType(o),a=await this._compile(s);if(a.wat===null)return;let u=s.kind==="package"?Fn.joinPath(s.pkgUri,`moon.${r}`):nt.Uri.parse(o.toString(!0).slice(0,-3)+r),l=r==="wat"?new TextEncoder().encode(a.wat):(await this._watToWasm({wat:a.wat})).wasm;await nt.workspace.fs.writeFile(u,l),i||this._outputChannel.show(),this._info(`Compiled to ${u.toString()} in ${a.timeCost}ms`)}async _getRuntime(e){let t;switch(e.kind){case"package":t=e.pkgUri;break;case"single":t=Fn.dirname(e.programUri);break}let r=Fn.joinPath(t,"runtime.js"),i;try{i=await nt.workspace.fs.readFile(r)}catch{return"export default {}"}return new TextDecoder().decode(i)}_info(e){let t=e.split(`
`).map(r=>r!==""?`[INFO] ${r}`:r);this._outputChannel.appendLine(t.join(`
`))}_error(e){let t=e.split(`
`).map(r=>r!==""?`[ERROR] ${r}`:r);this._outputChannel.show(),this._outputChannel.appendLine(t.join(`
`))}_warn(e){let t=e.split(`
`).map(r=>r!==""?`[WARN] ${r}`:r);this._outputChannel.show(),this._outputChannel.appendLine(t.join(`
`))}_log(e){this._outputChannel.show(),this._outputChannel.append(e)}async run(e){if(this._wasmRunner!==null){await nt.window.showInformationMessage("One MoonBit program is running, stop it and run again");return}let t=e??nt.window.activeTextEditor?.document.uri;if(t===void 0){await nt.window.showInformationMessage("You did not open a Moonbit document");return}this._outputChannel.clear();let r=await this._getProgramType(t),i=await this._compile(r);if(i.wat===null)return;let{wasm:o}=await this._watToWasm({wat:i.wat});this._info(`====== Compilation Statistics ======
Wasm size: ${o.length}B
Time cost: ${i.timeCost}ms
---
`);let s=await this._getRuntime(r),a=URL.createObjectURL(new Blob([s],{type:"application/javascript"}));this._wasmRunner=new Worker(this._wasmRunnerUri.toString());let u=[],l=()=>{let g=new Uint8Array(u);u=[],this._log(new TextDecoder().decode(g))};this._wasmRunner.postMessage({runtimeURL:a,wasm:o}),await this._updateRunningState();let f=await Ds(this._client);this._wasmRunner.onmessage=async g=>{if(typeof g.data=="number")u.push(g.data),g.data===10&&l();else switch(g.data.kind){case"start":this._startTime=new Date;break;case"over":l(),await this.stop();break;case"warn":this._warn(g.data.message);break;case"error":l(),this._error(g.data.message),await this.stop();break;case"internal":l(),this._error(g.data.message),await this.stop(),await Ad(this._context,r,g.data.message,f);break}}}async stop(e=!1){e&&this._info("User Action: aborted"),this._endTime=new Date;let t=(this._endTime.getTime()-this._startTime.getTime())/1e3;this._wasmRunner?.terminate(),this._wasmRunner=null,await this._updateRunningState(),this._info(`program exited in ${t}s`)}};async function Sw(n){let e=Bt.Uri.joinPath(n.extensionUri,"browser","lsp-server.js").toString(!0),t=new xy.LanguageClient(Md,gy,{documentSelector:[{language:Md}],synchronize:{fileEvents:[Bt.workspace.createFileSystemWatcher("{**/*.mbt,**/target/check/packages.json,**/target/check/**/*.mi}")]}},new Worker(e));t.onRequest(dy,wy),t.onRequest(fy,Cy),t.onRequest(hy,Dy),n.subscriptions.push(t);let r=new Rs(n,t),i=Bt.commands.registerCommand("moonbit.run",async u=>{await r.run(u)}),o=Bt.commands.registerCommand("moonbit.stop",async()=>{await r.stop(!0)}),s=Bt.commands.registerCommand("moonbit.compile-to-wat",async(u,l)=>{await r.compileToFile(u,{fileExt:"wat",...l})}),a=Bt.commands.registerCommand("moonbit.compile-to-wasm",async(u,l)=>{await r.compileToFile(u,{fileExt:"wasm",...l})});n.subscriptions.push(i,o,s,a,r),n.subscriptions.push(Bt.commands.registerCommand("moonbit.packageAddImport",Sy)),n.subscriptions.push(yy),n.subscriptions.push(Bt.commands.registerCommand("moonbit.get-extension-version",async()=>{await by(t)})),await t.start()}
