"use strict";var Dy=Object.create;var ls=Object.defineProperty;var Sy=Object.getOwnPropertyDescriptor;var Ry=Object.getOwnPropertyNames;var Ty=Object.getPrototypeOf,Py=Object.prototype.hasOwnProperty;var x=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Iy=(n,e)=>{for(var t in e)ls(n,t,{get:e[t],enumerable:!0})},Od=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ry(e))!Py.call(n,i)&&i!==t&&ls(n,i,{get:()=>e[i],enumerable:!(r=Sy(e,i))||r.enumerable});return n};var $r=(n,e,t)=>(t=n!=null?Dy(Ty(n)):{},Od(e||!n||!n.__esModule?ls(t,"default",{value:n,enumerable:!0}):t,n)),Ey=n=>Od(ls({},"__esModule",{value:!0}),n);var Yt=x(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.asPromise=Ge.thenable=Ge.typedArray=Ge.stringArray=Ge.array=Ge.func=Ge.error=Ge.number=Ge.string=Ge.boolean=void 0;function xy(n){return n===!0||n===!1}Ge.boolean=xy;function Ld(n){return typeof n=="string"||n instanceof String}Ge.string=Ld;function qy(n){return typeof n=="number"||n instanceof Number}Ge.number=qy;function ky(n){return n instanceof Error}Ge.error=ky;function Fd(n){return typeof n=="function"}Ge.func=Fd;function Nd(n){return Array.isArray(n)}Ge.array=Nd;function Oy(n){return Nd(n)&&n.every(e=>Ld(e))}Ge.stringArray=Oy;function Ly(n,e){return Array.isArray(n)&&n.every(e)}Ge.typedArray=Ly;function Md(n){return n&&Fd(n.then)}Ge.thenable=Md;function Fy(n){return n instanceof Promise?n:Md(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}Ge.asPromise=Fy});var Hr=x(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.stringArray=yt.array=yt.func=yt.error=yt.number=yt.string=yt.boolean=void 0;function Ny(n){return n===!0||n===!1}yt.boolean=Ny;function Ad(n){return typeof n=="string"||n instanceof String}yt.string=Ad;function My(n){return typeof n=="number"||n instanceof Number}yt.number=My;function Ay(n){return n instanceof Error}yt.error=Ay;function jy(n){return typeof n=="function"}yt.func=jy;function jd(n){return Array.isArray(n)}yt.array=jd;function $y(n){return jd(n)&&n.every(e=>Ad(e))}yt.stringArray=$y});var Sa=x(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.Message=J.NotificationType9=J.NotificationType8=J.NotificationType7=J.NotificationType6=J.NotificationType5=J.NotificationType4=J.NotificationType3=J.NotificationType2=J.NotificationType1=J.NotificationType0=J.NotificationType=J.RequestType9=J.RequestType8=J.RequestType7=J.RequestType6=J.RequestType5=J.RequestType4=J.RequestType3=J.RequestType2=J.RequestType1=J.RequestType=J.RequestType0=J.AbstractMessageSignature=J.ParameterStructures=J.ResponseError=J.ErrorCodes=void 0;var br=Hr(),ta;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(ta||(J.ErrorCodes=ta={}));var Ti=class extends Error{constructor(e,t,r){super(t),this.code=br.number(e)?e:ta.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,Ti.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};J.ResponseError=Ti;var ot=class{constructor(e){this.kind=e}static is(e){return e===ot.auto||e===ot.byName||e===ot.byPosition}toString(){return this.kind}};J.ParameterStructures=ot;ot.auto=new ot("auto");ot.byPosition=new ot("byPosition");ot.byName=new ot("byName");var Fe=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return ot.auto}};J.AbstractMessageSignature=Fe;var na=class extends Fe{constructor(e){super(e,0)}};J.RequestType0=na;var ra=class extends Fe{constructor(e,t=ot.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType=ra;var ia=class extends Fe{constructor(e,t=ot.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.RequestType1=ia;var sa=class extends Fe{constructor(e){super(e,2)}};J.RequestType2=sa;var oa=class extends Fe{constructor(e){super(e,3)}};J.RequestType3=oa;var aa=class extends Fe{constructor(e){super(e,4)}};J.RequestType4=aa;var ca=class extends Fe{constructor(e){super(e,5)}};J.RequestType5=ca;var ua=class extends Fe{constructor(e){super(e,6)}};J.RequestType6=ua;var la=class extends Fe{constructor(e){super(e,7)}};J.RequestType7=la;var da=class extends Fe{constructor(e){super(e,8)}};J.RequestType8=da;var fa=class extends Fe{constructor(e){super(e,9)}};J.RequestType9=fa;var ha=class extends Fe{constructor(e,t=ot.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType=ha;var pa=class extends Fe{constructor(e){super(e,0)}};J.NotificationType0=pa;var ga=class extends Fe{constructor(e,t=ot.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};J.NotificationType1=ga;var ma=class extends Fe{constructor(e){super(e,2)}};J.NotificationType2=ma;var va=class extends Fe{constructor(e){super(e,3)}};J.NotificationType3=va;var ya=class extends Fe{constructor(e){super(e,4)}};J.NotificationType4=ya;var _a=class extends Fe{constructor(e){super(e,5)}};J.NotificationType5=_a;var ba=class extends Fe{constructor(e){super(e,6)}};J.NotificationType6=ba;var Ca=class extends Fe{constructor(e){super(e,7)}};J.NotificationType7=Ca;var wa=class extends Fe{constructor(e){super(e,8)}};J.NotificationType8=wa;var Da=class extends Fe{constructor(e){super(e,9)}};J.NotificationType9=Da;var $d;(function(n){function e(i){let s=i;return s&&br.string(s.method)&&(br.string(s.id)||br.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&br.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(br.string(s.id)||br.number(s.id)||s.id===null)}n.isResponse=r})($d||(J.Message=$d={}))});var Ta=x(rr=>{"use strict";var Hd;Object.defineProperty(rr,"__esModule",{value:!0});rr.LRUCache=rr.LinkedMap=rr.Touch=void 0;var _t;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(_t||(rr.Touch=_t={}));var ds=class{constructor(){this[Hd]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=_t.None){let r=this._map.get(e);if(r)return t!==_t.None&&this.touch(r,t),r.value}set(e,t,r=_t.None){let i=this._map.get(e);if(i)i.value=t,r!==_t.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case _t.None:this.addItemLast(i);break;case _t.First:this.addItemFirst(i);break;case _t.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Hd=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==_t.First&&t!==_t.Last)){if(t===_t.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===_t.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};rr.LinkedMap=ds;var Ra=class extends ds{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=_t.AsNew){return super.get(e,t)}peek(e){return super.get(e,_t.None)}set(e,t){return super.set(e,t,_t.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};rr.LRUCache=Ra});var Wd=x(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.Disposable=void 0;var Ud;(function(n){function e(t){return{dispose:t}}n.create=e})(Ud||(fs.Disposable=Ud={}))});var ir=x(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});var Pa;function Ia(){if(Pa===void 0)throw new Error("No runtime abstraction layer installed");return Pa}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Pa=t}n.install=e})(Ia||(Ia={}));Ea.default=Ia});var Kr=x(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.Emitter=Wr.Event=void 0;var Hy=ir(),Kd;(function(n){let e={dispose(){}};n.None=function(){return e}})(Kd||(Wr.Event=Kd={}));var xa=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,Hy.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Ur=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new xa),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=Ur._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Wr.Emitter=Ur;Ur._noop=function(){}});var gs=x(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.CancellationTokenSource=Br.CancellationToken=void 0;var Uy=ir(),Wy=Hr(),qa=Kr(),hs;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:qa.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:qa.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||Wy.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(hs||(Br.CancellationToken=hs={}));var Ky=Object.freeze(function(n,e){let t=(0,Uy.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),ps=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Ky:(this._emitter||(this._emitter=new qa.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},ka=class{get token(){return this._token||(this._token=new ps),this._token}cancel(){this._token?this._token.cancel():this._token=hs.Cancelled}dispose(){this._token?this._token instanceof ps&&this._token.dispose():this._token=hs.None}};Br.CancellationTokenSource=ka});var Bd=x(zr=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});zr.SharedArrayReceiverStrategy=zr.SharedArraySenderStrategy=void 0;var By=gs(),Pi;(function(n){n.Continue=0,n.Cancelled=1})(Pi||(Pi={}));var Oa=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=Pi.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,Pi.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};zr.SharedArraySenderStrategy=Oa;var La=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Pi.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Fa=class{constructor(e){this.token=new La(e)}cancel(){}dispose(){}},Na=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new By.CancellationTokenSource:new Fa(t)}};zr.SharedArrayReceiverStrategy=Na});var Aa=x(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.Semaphore=void 0;var zy=ir(),Ma=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,zy.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};ms.Semaphore=Ma});var Xd=x(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.ReadableStreamMessageReader=sr.AbstractMessageReader=sr.MessageReader=void 0;var $a=ir(),Xr=Hr(),ja=Kr(),Xy=Aa(),zd;(function(n){function e(t){let r=t;return r&&Xr.func(r.listen)&&Xr.func(r.dispose)&&Xr.func(r.onError)&&Xr.func(r.onClose)&&Xr.func(r.onPartialMessage)}n.is=e})(zd||(sr.MessageReader=zd={}));var vs=class{constructor(){this.errorEmitter=new ja.Emitter,this.closeEmitter=new ja.Emitter,this.partialMessageEmitter=new ja.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Xr.string(e.message)?e.message:"unknown"}`)}};sr.AbstractMessageReader=vs;var Ha;(function(n){function e(t){let r,i,s,o=new Map,a,u=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let h of t.contentDecoders)o.set(h.name,h);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,u.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let h of t.contentTypeDecoders)u.set(h.name,h)}return a===void 0&&(a=(0,$a.default)().applicationJson.decoder,u.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:u}}n.fromOptions=e})(Ha||(Ha={}));var Ua=class extends vs{constructor(e,t){super(),this.readable=e,this.options=Ha.fromOptions(t),this.buffer=(0,$a.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Xy.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,$a.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};sr.ReadableStreamMessageReader=Ua});var Qd=x(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.WriteableStreamMessageWriter=or.AbstractMessageWriter=or.MessageWriter=void 0;var Gd=ir(),Ii=Hr(),Gy=Aa(),Vd=Kr(),Vy="Content-Length: ",Jd=`\r
`,Zd;(function(n){function e(t){let r=t;return r&&Ii.func(r.dispose)&&Ii.func(r.onClose)&&Ii.func(r.onError)&&Ii.func(r.write)}n.is=e})(Zd||(or.MessageWriter=Zd={}));var ys=class{constructor(){this.errorEmitter=new Vd.Emitter,this.closeEmitter=new Vd.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Ii.string(e.message)?e.message:"unknown"}`)}};or.AbstractMessageWriter=ys;var Wa;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Gd.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Gd.default)().applicationJson.encoder}}n.fromOptions=e})(Wa||(Wa={}));var Ka=class extends ys{constructor(e,t){super(),this.writable=e,this.options=Wa.fromOptions(t),this.errorCount=0,this.writeSemaphore=new Gy.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(Vy,r.byteLength.toString(),Jd),i.push(Jd),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};or.WriteableStreamMessageWriter=Ka});var Yd=x(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.AbstractMessageBuffer=void 0;var Jy=13,Zy=10,Qy=`\r
`,Ba=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let h=this._chunks[r];i=0;t:for(;i<h.length;){switch(h[i]){case Jy:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case Zy:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=h.byteLength,r++}if(t!==4)return;let o=this._read(s+i),a=new Map,u=this.toString(o,"ascii").split(Qy);if(u.length<2)return a;for(let h=0;h<u.length-2;h++){let p=u[h],y=p.indexOf(":");if(y===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);let m=p.substr(0,y),S=p.substr(y+1).trim();a.set(e?m.toLowerCase():m,S)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};_s.AbstractMessageBuffer=Ba});var sf=x(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.createMessageConnection=re.ConnectionOptions=re.MessageStrategy=re.CancellationStrategy=re.CancellationSenderStrategy=re.CancellationReceiverStrategy=re.RequestCancellationReceiverStrategy=re.IdCancellationReceiverStrategy=re.ConnectionStrategy=re.ConnectionError=re.ConnectionErrors=re.LogTraceNotification=re.SetTraceNotification=re.TraceFormat=re.TraceValues=re.Trace=re.NullLogger=re.ProgressType=re.ProgressToken=void 0;var ef=ir(),Ue=Hr(),Z=Sa(),tf=Ta(),Ei=Kr(),za=gs(),ki;(function(n){n.type=new Z.NotificationType("$/cancelRequest")})(ki||(ki={}));var Xa;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Xa||(re.ProgressToken=Xa={}));var xi;(function(n){n.type=new Z.NotificationType("$/progress")})(xi||(xi={}));var Ga=class{constructor(){}};re.ProgressType=Ga;var Va;(function(n){function e(t){return Ue.func(t)}n.is=e})(Va||(Va={}));re.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var De;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(De||(re.Trace=De={}));var nf;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(nf||(re.TraceValues=nf={}));(function(n){function e(r){if(!Ue.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(De||(re.Trace=De={}));var Wt;(function(n){n.Text="text",n.JSON="json"})(Wt||(re.TraceFormat=Wt={}));(function(n){function e(t){return Ue.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Wt||(re.TraceFormat=Wt={}));var Ja;(function(n){n.type=new Z.NotificationType("$/setTrace")})(Ja||(re.SetTraceNotification=Ja={}));var bs;(function(n){n.type=new Z.NotificationType("$/logTrace")})(bs||(re.LogTraceNotification=bs={}));var qi;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(qi||(re.ConnectionErrors=qi={}));var ar=class extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,ar.prototype)}};re.ConnectionError=ar;var Za;(function(n){function e(t){let r=t;return r&&Ue.func(r.cancelUndispatched)}n.is=e})(Za||(re.ConnectionStrategy=Za={}));var Cs;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&Ue.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ue.func(r.dispose))}n.is=e})(Cs||(re.IdCancellationReceiverStrategy=Cs={}));var Qa;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&Ue.func(r.createCancellationTokenSource)&&(r.dispose===void 0||Ue.func(r.dispose))}n.is=e})(Qa||(re.RequestCancellationReceiverStrategy=Qa={}));var ws;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new za.CancellationTokenSource}});function e(t){return Cs.is(t)||Qa.is(t)}n.is=e})(ws||(re.CancellationReceiverStrategy=ws={}));var Ds;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(ki.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&Ue.func(r.sendCancellation)&&Ue.func(r.cleanup)}n.is=e})(Ds||(re.CancellationSenderStrategy=Ds={}));var Ss;(function(n){n.Message=Object.freeze({receiver:ws.Message,sender:Ds.Message});function e(t){let r=t;return r&&ws.is(r.receiver)&&Ds.is(r.sender)}n.is=e})(Ss||(re.CancellationStrategy=Ss={}));var Rs;(function(n){function e(t){let r=t;return r&&Ue.func(r.handleMessage)}n.is=e})(Rs||(re.MessageStrategy=Rs={}));var rf;(function(n){function e(t){let r=t;return r&&(Ss.is(r.cancellationStrategy)||Za.is(r.connectionStrategy)||Rs.is(r.messageStrategy))}n.is=e})(rf||(re.ConnectionOptions=rf={}));var pn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(pn||(pn={}));function Yy(n,e,t,r){let i=t!==void 0?t:re.NullLogger,s=0,o=0,a=0,u="2.0",h,p=new Map,y,m=new Map,S=new Map,v,P=new tf.LinkedMap,E=new Map,F=new Set,M=new Map,N=De.Off,H=Wt.Text,V,de=pn.New,B=new Ei.Emitter,Y=new Ei.Emitter,ce=new Ei.Emitter,Ze=new Ei.Emitter,ze=new Ei.Emitter,Ye=r&&r.cancellationStrategy?r.cancellationStrategy:Ss.Message;function Jt(b){if(b===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+b.toString()}function Rt(b){return b===null?"res-unknown-"+(++a).toString():"res-"+b.toString()}function dt(){return"not-"+(++o).toString()}function ft(b,k){Z.Message.isRequest(k)?b.set(Jt(k.id),k):Z.Message.isResponse(k)?b.set(Rt(k.id),k):b.set(dt(),k)}function cn(b){}function Cn(){return de===pn.Listening}function Oe(){return de===pn.Closed}function qt(){return de===pn.Disposed}function Tt(){(de===pn.New||de===pn.Listening)&&(de=pn.Closed,Y.fire(void 0))}function ht(b){B.fire([b,void 0,void 0])}function Qn(b){B.fire(b)}n.onClose(Tt),n.onError(ht),e.onClose(Tt),e.onError(Qn);function wn(){v||P.size===0||(v=(0,ef.default)().timer.setImmediate(()=>{v=void 0,Ln()}))}function Dn(b){Z.Message.isRequest(b)?Sn(b):Z.Message.isNotification(b)?ln(b):Z.Message.isResponse(b)?un(b):Rn(b)}function Ln(){if(P.size===0)return;let b=P.shift();try{let k=r?.messageStrategy;Rs.is(k)?k.handleMessage(b,Dn):Dn(b)}finally{wn()}}let Yn=b=>{try{if(Z.Message.isNotification(b)&&b.method===ki.type.method){let k=b.params.id,$=Jt(k),W=P.get($);if(Z.Message.isRequest(W)){let me=r?.connectionStrategy,Re=me&&me.cancelUndispatched?me.cancelUndispatched(W,cn):void 0;if(Re&&(Re.error!==void 0||Re.result!==void 0)){P.delete($),M.delete(k),Re.id=W.id,Zt(Re,b.method,Date.now()),e.write(Re).catch(()=>i.error("Sending response for canceled message failed."));return}}let ye=M.get(k);if(ye!==void 0){ye.cancel(),Qt(b);return}else F.add(k)}ft(P,b)}finally{wn()}};function Sn(b){if(qt())return;function k(se,be,fe){let Ee={jsonrpc:u,id:b.id};se instanceof Z.ResponseError?Ee.error=se.toJson():Ee.result=se===void 0?null:se,Zt(Ee,be,fe),e.write(Ee).catch(()=>i.error("Sending response failed."))}function $(se,be,fe){let Ee={jsonrpc:u,id:b.id,error:se.toJson()};Zt(Ee,be,fe),e.write(Ee).catch(()=>i.error("Sending response failed."))}function W(se,be,fe){se===void 0&&(se=null);let Ee={jsonrpc:u,id:b.id,result:se};Zt(Ee,be,fe),e.write(Ee).catch(()=>i.error("Sending response failed."))}er(b);let ye=p.get(b.method),me,Re;ye&&(me=ye.type,Re=ye.handler);let Ie=Date.now();if(Re||h){let se=b.id??String(Date.now()),be=Cs.is(Ye.receiver)?Ye.receiver.createCancellationTokenSource(se):Ye.receiver.createCancellationTokenSource(b);b.id!==null&&F.has(b.id)&&be.cancel(),b.id!==null&&M.set(se,be);try{let fe;if(Re)if(b.params===void 0){if(me!==void 0&&me.numberOfParams!==0){$(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${b.method} defines ${me.numberOfParams} params but received none.`),b.method,Ie);return}fe=Re(be.token)}else if(Array.isArray(b.params)){if(me!==void 0&&me.parameterStructures===Z.ParameterStructures.byName){$(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${b.method} defines parameters by name but received parameters by position`),b.method,Ie);return}fe=Re(...b.params,be.token)}else{if(me!==void 0&&me.parameterStructures===Z.ParameterStructures.byPosition){$(new Z.ResponseError(Z.ErrorCodes.InvalidParams,`Request ${b.method} defines parameters by position but received parameters by name`),b.method,Ie);return}fe=Re(b.params,be.token)}else h&&(fe=h(b.method,b.params,be.token));let Ee=fe;fe?Ee.then?Ee.then(Xe=>{M.delete(se),k(Xe,b.method,Ie)},Xe=>{M.delete(se),Xe instanceof Z.ResponseError?$(Xe,b.method,Ie):Xe&&Ue.string(Xe.message)?$(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${b.method} failed with message: ${Xe.message}`),b.method,Ie):$(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${b.method} failed unexpectedly without providing any details.`),b.method,Ie)}):(M.delete(se),k(fe,b.method,Ie)):(M.delete(se),W(fe,b.method,Ie))}catch(fe){M.delete(se),fe instanceof Z.ResponseError?k(fe,b.method,Ie):fe&&Ue.string(fe.message)?$(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${b.method} failed with message: ${fe.message}`),b.method,Ie):$(new Z.ResponseError(Z.ErrorCodes.InternalError,`Request ${b.method} failed unexpectedly without providing any details.`),b.method,Ie)}}else $(new Z.ResponseError(Z.ErrorCodes.MethodNotFound,`Unhandled method ${b.method}`),b.method,Ie)}function un(b){if(!qt())if(b.id===null)b.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(b.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let k=b.id,$=E.get(k);if(Tn(b,$),$!==void 0){E.delete(k);try{if(b.error){let W=b.error;$.reject(new Z.ResponseError(W.code,W.message,W.data))}else if(b.result!==void 0)$.resolve(b.result);else throw new Error("Should never happen.")}catch(W){W.message?i.error(`Response handler '${$.method}' failed with message: ${W.message}`):i.error(`Response handler '${$.method}' failed unexpectedly.`)}}}}function ln(b){if(qt())return;let k,$;if(b.method===ki.type.method){let W=b.params.id;F.delete(W),Qt(b);return}else{let W=m.get(b.method);W&&($=W.handler,k=W.type)}if($||y)try{if(Qt(b),$)if(b.params===void 0)k!==void 0&&k.numberOfParams!==0&&k.parameterStructures!==Z.ParameterStructures.byName&&i.error(`Notification ${b.method} defines ${k.numberOfParams} params but received none.`),$();else if(Array.isArray(b.params)){let W=b.params;b.method===xi.type.method&&W.length===2&&Xa.is(W[0])?$({token:W[0],value:W[1]}):(k!==void 0&&(k.parameterStructures===Z.ParameterStructures.byName&&i.error(`Notification ${b.method} defines parameters by name but received parameters by position`),k.numberOfParams!==b.params.length&&i.error(`Notification ${b.method} defines ${k.numberOfParams} params but received ${W.length} arguments`)),$(...W))}else k!==void 0&&k.parameterStructures===Z.ParameterStructures.byPosition&&i.error(`Notification ${b.method} defines parameters by position but received parameters by name`),$(b.params);else y&&y(b.method,b.params)}catch(W){W.message?i.error(`Notification handler '${b.method}' failed with message: ${W.message}`):i.error(`Notification handler '${b.method}' failed unexpectedly.`)}else ce.fire(b)}function Rn(b){if(!b){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(b,null,4)}`);let k=b;if(Ue.string(k.id)||Ue.number(k.id)){let $=k.id,W=E.get($);W&&W.reject(new Error("The received response has neither a result nor an error property."))}}function et(b){if(b!=null)switch(N){case De.Verbose:return JSON.stringify(b,null,4);case De.Compact:return JSON.stringify(b);default:return}}function Fn(b){if(!(N===De.Off||!V))if(H===Wt.Text){let k;(N===De.Verbose||N===De.Compact)&&b.params&&(k=`Params: ${et(b.params)}

`),V.log(`Sending request '${b.method} - (${b.id})'.`,k)}else Qe("send-request",b)}function dn(b){if(!(N===De.Off||!V))if(H===Wt.Text){let k;(N===De.Verbose||N===De.Compact)&&(b.params?k=`Params: ${et(b.params)}

`:k=`No parameters provided.

`),V.log(`Sending notification '${b.method}'.`,k)}else Qe("send-notification",b)}function Zt(b,k,$){if(!(N===De.Off||!V))if(H===Wt.Text){let W;(N===De.Verbose||N===De.Compact)&&(b.error&&b.error.data?W=`Error data: ${et(b.error.data)}

`:b.result?W=`Result: ${et(b.result)}

`:b.error===void 0&&(W=`No result returned.

`)),V.log(`Sending response '${k} - (${b.id})'. Processing request took ${Date.now()-$}ms`,W)}else Qe("send-response",b)}function er(b){if(!(N===De.Off||!V))if(H===Wt.Text){let k;(N===De.Verbose||N===De.Compact)&&b.params&&(k=`Params: ${et(b.params)}

`),V.log(`Received request '${b.method} - (${b.id})'.`,k)}else Qe("receive-request",b)}function Qt(b){if(!(N===De.Off||!V||b.method===bs.type.method))if(H===Wt.Text){let k;(N===De.Verbose||N===De.Compact)&&(b.params?k=`Params: ${et(b.params)}

`:k=`No parameters provided.

`),V.log(`Received notification '${b.method}'.`,k)}else Qe("receive-notification",b)}function Tn(b,k){if(!(N===De.Off||!V))if(H===Wt.Text){let $;if((N===De.Verbose||N===De.Compact)&&(b.error&&b.error.data?$=`Error data: ${et(b.error.data)}

`:b.result?$=`Result: ${et(b.result)}

`:b.error===void 0&&($=`No result returned.

`)),k){let W=b.error?` Request failed: ${b.error.message} (${b.error.code}).`:"";V.log(`Received response '${k.method} - (${b.id})' in ${Date.now()-k.timerStart}ms.${W}`,$)}else V.log(`Received response ${b.id} without active response promise.`,$)}else Qe("receive-response",b)}function Qe(b,k){if(!V||N===De.Off)return;let $={isLSPMessage:!0,type:b,message:k,timestamp:Date.now()};V.log($)}function vt(){if(Oe())throw new ar(qi.Closed,"Connection is closed.");if(qt())throw new ar(qi.Disposed,"Connection is disposed.")}function pt(){if(Cn())throw new ar(qi.AlreadyListening,"Connection is already listening")}function Ht(){if(!Cn())throw new Error("Call listen() first.")}function kt(b){return b===void 0?null:b}function Pn(b){if(b!==null)return b}function Nn(b){return b!=null&&!Array.isArray(b)&&typeof b=="object"}function fn(b,k){switch(b){case Z.ParameterStructures.auto:return Nn(k)?Pn(k):[kt(k)];case Z.ParameterStructures.byName:if(!Nn(k))throw new Error("Received parameters by name but param is not an object literal.");return Pn(k);case Z.ParameterStructures.byPosition:return[kt(k)];default:throw new Error(`Unknown parameter structure ${b.toString()}`)}}function Mn(b,k){let $,W=b.numberOfParams;switch(W){case 0:$=void 0;break;case 1:$=fn(b.parameterStructures,k[0]);break;default:$=[];for(let ye=0;ye<k.length&&ye<W;ye++)$.push(kt(k[ye]));if(k.length<W)for(let ye=k.length;ye<W;ye++)$.push(null);break}return $}let Pt={sendNotification:(b,...k)=>{vt();let $,W;if(Ue.string(b)){$=b;let me=k[0],Re=0,Ie=Z.ParameterStructures.auto;Z.ParameterStructures.is(me)&&(Re=1,Ie=me);let se=k.length,be=se-Re;switch(be){case 0:W=void 0;break;case 1:W=fn(Ie,k[Re]);break;default:if(Ie===Z.ParameterStructures.byName)throw new Error(`Received ${be} parameters for 'by Name' notification parameter structure.`);W=k.slice(Re,se).map(fe=>kt(fe));break}}else{let me=k;$=b.method,W=Mn(b,me)}let ye={jsonrpc:u,method:$,params:W};return dn(ye),e.write(ye).catch(me=>{throw i.error("Sending notification failed."),me})},onNotification:(b,k)=>{vt();let $;return Ue.func(b)?y=b:k&&(Ue.string(b)?($=b,m.set(b,{type:void 0,handler:k})):($=b.method,m.set(b.method,{type:b,handler:k}))),{dispose:()=>{$!==void 0?m.delete($):y=void 0}}},onProgress:(b,k,$)=>{if(S.has(k))throw new Error(`Progress handler for token ${k} already registered`);return S.set(k,$),{dispose:()=>{S.delete(k)}}},sendProgress:(b,k,$)=>Pt.sendNotification(xi.type,{token:k,value:$}),onUnhandledProgress:Ze.event,sendRequest:(b,...k)=>{vt(),Ht();let $,W,ye;if(Ue.string(b)){$=b;let se=k[0],be=k[k.length-1],fe=0,Ee=Z.ParameterStructures.auto;Z.ParameterStructures.is(se)&&(fe=1,Ee=se);let Xe=k.length;za.CancellationToken.is(be)&&(Xe=Xe-1,ye=be);let it=Xe-fe;switch(it){case 0:W=void 0;break;case 1:W=fn(Ee,k[fe]);break;default:if(Ee===Z.ParameterStructures.byName)throw new Error(`Received ${it} parameters for 'by Name' request parameter structure.`);W=k.slice(fe,Xe).map(tr=>kt(tr));break}}else{let se=k;$=b.method,W=Mn(b,se);let be=b.numberOfParams;ye=za.CancellationToken.is(se[be])?se[be]:void 0}let me=s++,Re;ye&&(Re=ye.onCancellationRequested(()=>{let se=Ye.sender.sendCancellation(Pt,me);return se===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${me}`),Promise.resolve()):se.catch(()=>{i.log(`Sending cancellation messages for id ${me} failed`)})}));let Ie={jsonrpc:u,id:me,method:$,params:W};return Fn(Ie),typeof Ye.sender.enableCancellation=="function"&&Ye.sender.enableCancellation(Ie),new Promise(async(se,be)=>{let fe=it=>{se(it),Ye.sender.cleanup(me),Re?.dispose()},Ee=it=>{be(it),Ye.sender.cleanup(me),Re?.dispose()},Xe={method:$,timerStart:Date.now(),resolve:fe,reject:Ee};try{await e.write(Ie),E.set(me,Xe)}catch(it){throw i.error("Sending request failed."),Xe.reject(new Z.ResponseError(Z.ErrorCodes.MessageWriteError,it.message?it.message:"Unknown reason")),it}})},onRequest:(b,k)=>{vt();let $=null;return Va.is(b)?($=void 0,h=b):Ue.string(b)?($=null,k!==void 0&&($=b,p.set(b,{handler:k,type:void 0}))):k!==void 0&&($=b.method,p.set(b.method,{type:b,handler:k})),{dispose:()=>{$!==null&&($!==void 0?p.delete($):h=void 0)}}},hasPendingResponse:()=>E.size>0,trace:async(b,k,$)=>{let W=!1,ye=Wt.Text;$!==void 0&&(Ue.boolean($)?W=$:(W=$.sendNotification||!1,ye=$.traceFormat||Wt.Text)),N=b,H=ye,N===De.Off?V=void 0:V=k,W&&!Oe()&&!qt()&&await Pt.sendNotification(Ja.type,{value:De.toString(b)})},onError:B.event,onClose:Y.event,onUnhandledNotification:ce.event,onDispose:ze.event,end:()=>{e.end()},dispose:()=>{if(qt())return;de=pn.Disposed,ze.fire(void 0);let b=new Z.ResponseError(Z.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let k of E.values())k.reject(b);E=new Map,M=new Map,F=new Set,P=new tf.LinkedMap,Ue.func(e.dispose)&&e.dispose(),Ue.func(n.dispose)&&n.dispose()},listen:()=>{vt(),pt(),de=pn.Listening,n.listen(Yn)},inspect:()=>{(0,ef.default)().console.log("inspect")}};return Pt.onNotification(bs.type,b=>{if(N===De.Off||!V)return;let k=N===De.Verbose||N===De.Compact;V.log(b.message,k?b.verbose:void 0)}),Pt.onNotification(xi.type,b=>{let k=S.get(b.token);k?k(b.value):Ze.fire(b)}),Pt}re.createMessageConnection=Yy});var Ts=x(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.ProgressType=q.ProgressToken=q.createMessageConnection=q.NullLogger=q.ConnectionOptions=q.ConnectionStrategy=q.AbstractMessageBuffer=q.WriteableStreamMessageWriter=q.AbstractMessageWriter=q.MessageWriter=q.ReadableStreamMessageReader=q.AbstractMessageReader=q.MessageReader=q.SharedArrayReceiverStrategy=q.SharedArraySenderStrategy=q.CancellationToken=q.CancellationTokenSource=q.Emitter=q.Event=q.Disposable=q.LRUCache=q.Touch=q.LinkedMap=q.ParameterStructures=q.NotificationType9=q.NotificationType8=q.NotificationType7=q.NotificationType6=q.NotificationType5=q.NotificationType4=q.NotificationType3=q.NotificationType2=q.NotificationType1=q.NotificationType0=q.NotificationType=q.ErrorCodes=q.ResponseError=q.RequestType9=q.RequestType8=q.RequestType7=q.RequestType6=q.RequestType5=q.RequestType4=q.RequestType3=q.RequestType2=q.RequestType1=q.RequestType0=q.RequestType=q.Message=q.RAL=void 0;q.MessageStrategy=q.CancellationStrategy=q.CancellationSenderStrategy=q.CancellationReceiverStrategy=q.ConnectionError=q.ConnectionErrors=q.LogTraceNotification=q.SetTraceNotification=q.TraceFormat=q.TraceValues=q.Trace=void 0;var Le=Sa();Object.defineProperty(q,"Message",{enumerable:!0,get:function(){return Le.Message}});Object.defineProperty(q,"RequestType",{enumerable:!0,get:function(){return Le.RequestType}});Object.defineProperty(q,"RequestType0",{enumerable:!0,get:function(){return Le.RequestType0}});Object.defineProperty(q,"RequestType1",{enumerable:!0,get:function(){return Le.RequestType1}});Object.defineProperty(q,"RequestType2",{enumerable:!0,get:function(){return Le.RequestType2}});Object.defineProperty(q,"RequestType3",{enumerable:!0,get:function(){return Le.RequestType3}});Object.defineProperty(q,"RequestType4",{enumerable:!0,get:function(){return Le.RequestType4}});Object.defineProperty(q,"RequestType5",{enumerable:!0,get:function(){return Le.RequestType5}});Object.defineProperty(q,"RequestType6",{enumerable:!0,get:function(){return Le.RequestType6}});Object.defineProperty(q,"RequestType7",{enumerable:!0,get:function(){return Le.RequestType7}});Object.defineProperty(q,"RequestType8",{enumerable:!0,get:function(){return Le.RequestType8}});Object.defineProperty(q,"RequestType9",{enumerable:!0,get:function(){return Le.RequestType9}});Object.defineProperty(q,"ResponseError",{enumerable:!0,get:function(){return Le.ResponseError}});Object.defineProperty(q,"ErrorCodes",{enumerable:!0,get:function(){return Le.ErrorCodes}});Object.defineProperty(q,"NotificationType",{enumerable:!0,get:function(){return Le.NotificationType}});Object.defineProperty(q,"NotificationType0",{enumerable:!0,get:function(){return Le.NotificationType0}});Object.defineProperty(q,"NotificationType1",{enumerable:!0,get:function(){return Le.NotificationType1}});Object.defineProperty(q,"NotificationType2",{enumerable:!0,get:function(){return Le.NotificationType2}});Object.defineProperty(q,"NotificationType3",{enumerable:!0,get:function(){return Le.NotificationType3}});Object.defineProperty(q,"NotificationType4",{enumerable:!0,get:function(){return Le.NotificationType4}});Object.defineProperty(q,"NotificationType5",{enumerable:!0,get:function(){return Le.NotificationType5}});Object.defineProperty(q,"NotificationType6",{enumerable:!0,get:function(){return Le.NotificationType6}});Object.defineProperty(q,"NotificationType7",{enumerable:!0,get:function(){return Le.NotificationType7}});Object.defineProperty(q,"NotificationType8",{enumerable:!0,get:function(){return Le.NotificationType8}});Object.defineProperty(q,"NotificationType9",{enumerable:!0,get:function(){return Le.NotificationType9}});Object.defineProperty(q,"ParameterStructures",{enumerable:!0,get:function(){return Le.ParameterStructures}});var Ya=Ta();Object.defineProperty(q,"LinkedMap",{enumerable:!0,get:function(){return Ya.LinkedMap}});Object.defineProperty(q,"LRUCache",{enumerable:!0,get:function(){return Ya.LRUCache}});Object.defineProperty(q,"Touch",{enumerable:!0,get:function(){return Ya.Touch}});var e_=Wd();Object.defineProperty(q,"Disposable",{enumerable:!0,get:function(){return e_.Disposable}});var of=Kr();Object.defineProperty(q,"Event",{enumerable:!0,get:function(){return of.Event}});Object.defineProperty(q,"Emitter",{enumerable:!0,get:function(){return of.Emitter}});var af=gs();Object.defineProperty(q,"CancellationTokenSource",{enumerable:!0,get:function(){return af.CancellationTokenSource}});Object.defineProperty(q,"CancellationToken",{enumerable:!0,get:function(){return af.CancellationToken}});var cf=Bd();Object.defineProperty(q,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return cf.SharedArraySenderStrategy}});Object.defineProperty(q,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return cf.SharedArrayReceiverStrategy}});var ec=Xd();Object.defineProperty(q,"MessageReader",{enumerable:!0,get:function(){return ec.MessageReader}});Object.defineProperty(q,"AbstractMessageReader",{enumerable:!0,get:function(){return ec.AbstractMessageReader}});Object.defineProperty(q,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return ec.ReadableStreamMessageReader}});var tc=Qd();Object.defineProperty(q,"MessageWriter",{enumerable:!0,get:function(){return tc.MessageWriter}});Object.defineProperty(q,"AbstractMessageWriter",{enumerable:!0,get:function(){return tc.AbstractMessageWriter}});Object.defineProperty(q,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return tc.WriteableStreamMessageWriter}});var t_=Yd();Object.defineProperty(q,"AbstractMessageBuffer",{enumerable:!0,get:function(){return t_.AbstractMessageBuffer}});var mt=sf();Object.defineProperty(q,"ConnectionStrategy",{enumerable:!0,get:function(){return mt.ConnectionStrategy}});Object.defineProperty(q,"ConnectionOptions",{enumerable:!0,get:function(){return mt.ConnectionOptions}});Object.defineProperty(q,"NullLogger",{enumerable:!0,get:function(){return mt.NullLogger}});Object.defineProperty(q,"createMessageConnection",{enumerable:!0,get:function(){return mt.createMessageConnection}});Object.defineProperty(q,"ProgressToken",{enumerable:!0,get:function(){return mt.ProgressToken}});Object.defineProperty(q,"ProgressType",{enumerable:!0,get:function(){return mt.ProgressType}});Object.defineProperty(q,"Trace",{enumerable:!0,get:function(){return mt.Trace}});Object.defineProperty(q,"TraceValues",{enumerable:!0,get:function(){return mt.TraceValues}});Object.defineProperty(q,"TraceFormat",{enumerable:!0,get:function(){return mt.TraceFormat}});Object.defineProperty(q,"SetTraceNotification",{enumerable:!0,get:function(){return mt.SetTraceNotification}});Object.defineProperty(q,"LogTraceNotification",{enumerable:!0,get:function(){return mt.LogTraceNotification}});Object.defineProperty(q,"ConnectionErrors",{enumerable:!0,get:function(){return mt.ConnectionErrors}});Object.defineProperty(q,"ConnectionError",{enumerable:!0,get:function(){return mt.ConnectionError}});Object.defineProperty(q,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return mt.CancellationReceiverStrategy}});Object.defineProperty(q,"CancellationSenderStrategy",{enumerable:!0,get:function(){return mt.CancellationSenderStrategy}});Object.defineProperty(q,"CancellationStrategy",{enumerable:!0,get:function(){return mt.CancellationStrategy}});Object.defineProperty(q,"MessageStrategy",{enumerable:!0,get:function(){return mt.MessageStrategy}});var n_=ir();q.RAL=n_.default});var df=x(sc=>{"use strict";Object.defineProperty(sc,"__esModule",{value:!0});var uf=require("util"),An=Ts(),Gr=class extends An.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return Gr.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new uf.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Gr.emptyBuffer=Buffer.allocUnsafe(0);var nc=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),An.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),An.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),An.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),An.Disposable.create(()=>this.stream.off("data",e))}},rc=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),An.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),An.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),An.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},lf=Object.freeze({messageBuffer:Object.freeze({create:n=>new Gr(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new uf.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new nc(n),asWritableStream:n=>new rc(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function ic(){return lf}(function(n){function e(){An.RAL.install(lf)}n.install=e})(ic||(ic={}));sc.default=ic});var Dr=x(ge=>{"use strict";var r_=ge&&ge.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),i_=ge&&ge.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&r_(e,n,t)};Object.defineProperty(ge,"__esModule",{value:!0});ge.createMessageConnection=ge.createServerSocketTransport=ge.createClientSocketTransport=ge.createServerPipeTransport=ge.createClientPipeTransport=ge.generateRandomPipeName=ge.StreamMessageWriter=ge.StreamMessageReader=ge.SocketMessageWriter=ge.SocketMessageReader=ge.PortMessageWriter=ge.PortMessageReader=ge.IPCMessageWriter=ge.IPCMessageReader=void 0;var Vr=df();Vr.default.install();var ff=require("path"),s_=require("os"),o_=require("crypto"),Es=require("net"),Kt=Ts();i_(Ts(),ge);var oc=class extends Kt.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Kt.Disposable.create(()=>this.process.off("message",e))}};ge.IPCMessageReader=oc;var ac=class extends Kt.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};ge.IPCMessageWriter=ac;var cc=class extends Kt.AbstractMessageReader{constructor(e){super(),this.onData=new Kt.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};ge.PortMessageReader=cc;var uc=class extends Kt.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};ge.PortMessageWriter=uc;var Cr=class extends Kt.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,Vr.default)().stream.asReadableStream(e),t)}};ge.SocketMessageReader=Cr;var wr=class extends Kt.WriteableStreamMessageWriter{constructor(e,t){super((0,Vr.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};ge.SocketMessageWriter=wr;var Ps=class extends Kt.ReadableStreamMessageReader{constructor(e,t){super((0,Vr.default)().stream.asReadableStream(e),t)}};ge.StreamMessageReader=Ps;var Is=class extends Kt.WriteableStreamMessageWriter{constructor(e,t){super((0,Vr.default)().stream.asWritableStream(e),t)}};ge.StreamMessageWriter=Is;var hf=process.env.XDG_RUNTIME_DIR,a_=new Map([["linux",107],["darwin",103]]);function c_(){let n=(0,o_.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;hf?e=ff.join(hf,`vscode-ipc-${n}.sock`):e=ff.join(s_.tmpdir(),`vscode-${n}.sock`);let t=a_.get(process.platform);return t!==void 0&&e.length>t&&(0,Vr.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}ge.generateRandomPipeName=c_;function u_(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Es.createServer)(a=>{o.close(),t([new Cr(a,e),new wr(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}ge.createClientPipeTransport=u_;function l_(n,e="utf-8"){let t=(0,Es.createConnection)(n);return[new Cr(t,e),new wr(t,e)]}ge.createServerPipeTransport=l_;function d_(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Es.createServer)(a=>{o.close(),t([new Cr(a,e),new wr(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}ge.createClientSocketTransport=d_;function f_(n,e="utf-8"){let t=(0,Es.createConnection)(n,"127.0.0.1");return[new Cr(t,e),new wr(t,e)]}ge.createServerSocketTransport=f_;function h_(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function p_(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function g_(n,e,t,r){t||(t=Kt.NullLogger);let i=h_(n)?new Ps(n):n,s=p_(e)?new Is(e):e;return Kt.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Kt.createMessageConnection)(i,s,t,r)}ge.createMessageConnection=g_});var lc=x((eS,pf)=>{"use strict";pf.exports=Dr()});var qs=x((gf,xs)=>{(function(n){if(typeof xs=="object"&&typeof xs.exports=="object"){var e=n(require,gf);e!==void 0&&(xs.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(f){function C(w){return typeof w=="string"}f.is=C})(t||(e.DocumentUri=t={}));var r;(function(f){function C(w){return typeof w=="string"}f.is=C})(r||(e.URI=r={}));var i;(function(f){f.MIN_VALUE=-2147483648,f.MAX_VALUE=2147483647;function C(w){return typeof w=="number"&&f.MIN_VALUE<=w&&w<=f.MAX_VALUE}f.is=C})(i||(e.integer=i={}));var s;(function(f){f.MIN_VALUE=0,f.MAX_VALUE=2147483647;function C(w){return typeof w=="number"&&f.MIN_VALUE<=w&&w<=f.MAX_VALUE}f.is=C})(s||(e.uinteger=s={}));var o;(function(f){function C(g,l){return g===Number.MAX_VALUE&&(g=s.MAX_VALUE),l===Number.MAX_VALUE&&(l=s.MAX_VALUE),{line:g,character:l}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&R.uinteger(l.line)&&R.uinteger(l.character)}f.is=w})(o||(e.Position=o={}));var a;(function(f){function C(g,l,T,O){if(R.uinteger(g)&&R.uinteger(l)&&R.uinteger(T)&&R.uinteger(O))return{start:o.create(g,l),end:o.create(T,O)};if(o.is(g)&&o.is(l))return{start:g,end:l};throw new Error("Range#create called with invalid arguments[".concat(g,", ").concat(l,", ").concat(T,", ").concat(O,"]"))}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&o.is(l.start)&&o.is(l.end)}f.is=w})(a||(e.Range=a={}));var u;(function(f){function C(g,l){return{uri:g,range:l}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&a.is(l.range)&&(R.string(l.uri)||R.undefined(l.uri))}f.is=w})(u||(e.Location=u={}));var h;(function(f){function C(g,l,T,O){return{targetUri:g,targetRange:l,targetSelectionRange:T,originSelectionRange:O}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&a.is(l.targetRange)&&R.string(l.targetUri)&&a.is(l.targetSelectionRange)&&(a.is(l.originSelectionRange)||R.undefined(l.originSelectionRange))}f.is=w})(h||(e.LocationLink=h={}));var p;(function(f){function C(g,l,T,O){return{red:g,green:l,blue:T,alpha:O}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&R.numberRange(l.red,0,1)&&R.numberRange(l.green,0,1)&&R.numberRange(l.blue,0,1)&&R.numberRange(l.alpha,0,1)}f.is=w})(p||(e.Color=p={}));var y;(function(f){function C(g,l){return{range:g,color:l}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&a.is(l.range)&&p.is(l.color)}f.is=w})(y||(e.ColorInformation=y={}));var m;(function(f){function C(g,l,T){return{label:g,textEdit:l,additionalTextEdits:T}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&R.string(l.label)&&(R.undefined(l.textEdit)||V.is(l))&&(R.undefined(l.additionalTextEdits)||R.typedArray(l.additionalTextEdits,V.is))}f.is=w})(m||(e.ColorPresentation=m={}));var S;(function(f){f.Comment="comment",f.Imports="imports",f.Region="region"})(S||(e.FoldingRangeKind=S={}));var v;(function(f){function C(g,l,T,O,te,Me){var xe={startLine:g,endLine:l};return R.defined(T)&&(xe.startCharacter=T),R.defined(O)&&(xe.endCharacter=O),R.defined(te)&&(xe.kind=te),R.defined(Me)&&(xe.collapsedText=Me),xe}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&R.uinteger(l.startLine)&&R.uinteger(l.startLine)&&(R.undefined(l.startCharacter)||R.uinteger(l.startCharacter))&&(R.undefined(l.endCharacter)||R.uinteger(l.endCharacter))&&(R.undefined(l.kind)||R.string(l.kind))}f.is=w})(v||(e.FoldingRange=v={}));var P;(function(f){function C(g,l){return{location:g,message:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&u.is(l.location)&&R.string(l.message)}f.is=w})(P||(e.DiagnosticRelatedInformation=P={}));var E;(function(f){f.Error=1,f.Warning=2,f.Information=3,f.Hint=4})(E||(e.DiagnosticSeverity=E={}));var F;(function(f){f.Unnecessary=1,f.Deprecated=2})(F||(e.DiagnosticTag=F={}));var M;(function(f){function C(w){var g=w;return R.objectLiteral(g)&&R.string(g.href)}f.is=C})(M||(e.CodeDescription=M={}));var N;(function(f){function C(g,l,T,O,te,Me){var xe={range:g,message:l};return R.defined(T)&&(xe.severity=T),R.defined(O)&&(xe.code=O),R.defined(te)&&(xe.source=te),R.defined(Me)&&(xe.relatedInformation=Me),xe}f.create=C;function w(g){var l,T=g;return R.defined(T)&&a.is(T.range)&&R.string(T.message)&&(R.number(T.severity)||R.undefined(T.severity))&&(R.integer(T.code)||R.string(T.code)||R.undefined(T.code))&&(R.undefined(T.codeDescription)||R.string((l=T.codeDescription)===null||l===void 0?void 0:l.href))&&(R.string(T.source)||R.undefined(T.source))&&(R.undefined(T.relatedInformation)||R.typedArray(T.relatedInformation,P.is))}f.is=w})(N||(e.Diagnostic=N={}));var H;(function(f){function C(g,l){for(var T=[],O=2;O<arguments.length;O++)T[O-2]=arguments[O];var te={title:g,command:l};return R.defined(T)&&T.length>0&&(te.arguments=T),te}f.create=C;function w(g){var l=g;return R.defined(l)&&R.string(l.title)&&R.string(l.command)}f.is=w})(H||(e.Command=H={}));var V;(function(f){function C(T,O){return{range:T,newText:O}}f.replace=C;function w(T,O){return{range:{start:T,end:T},newText:O}}f.insert=w;function g(T){return{range:T,newText:""}}f.del=g;function l(T){var O=T;return R.objectLiteral(O)&&R.string(O.newText)&&a.is(O.range)}f.is=l})(V||(e.TextEdit=V={}));var de;(function(f){function C(g,l,T){var O={label:g};return l!==void 0&&(O.needsConfirmation=l),T!==void 0&&(O.description=T),O}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&R.string(l.label)&&(R.boolean(l.needsConfirmation)||l.needsConfirmation===void 0)&&(R.string(l.description)||l.description===void 0)}f.is=w})(de||(e.ChangeAnnotation=de={}));var B;(function(f){function C(w){var g=w;return R.string(g)}f.is=C})(B||(e.ChangeAnnotationIdentifier=B={}));var Y;(function(f){function C(T,O,te){return{range:T,newText:O,annotationId:te}}f.replace=C;function w(T,O,te){return{range:{start:T,end:T},newText:O,annotationId:te}}f.insert=w;function g(T,O){return{range:T,newText:"",annotationId:O}}f.del=g;function l(T){var O=T;return V.is(O)&&(de.is(O.annotationId)||B.is(O.annotationId))}f.is=l})(Y||(e.AnnotatedTextEdit=Y={}));var ce;(function(f){function C(g,l){return{textDocument:g,edits:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&Oe.is(l.textDocument)&&Array.isArray(l.edits)}f.is=w})(ce||(e.TextDocumentEdit=ce={}));var Ze;(function(f){function C(g,l,T){var O={kind:"create",uri:g};return l!==void 0&&(l.overwrite!==void 0||l.ignoreIfExists!==void 0)&&(O.options=l),T!==void 0&&(O.annotationId=T),O}f.create=C;function w(g){var l=g;return l&&l.kind==="create"&&R.string(l.uri)&&(l.options===void 0||(l.options.overwrite===void 0||R.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||R.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||B.is(l.annotationId))}f.is=w})(Ze||(e.CreateFile=Ze={}));var ze;(function(f){function C(g,l,T,O){var te={kind:"rename",oldUri:g,newUri:l};return T!==void 0&&(T.overwrite!==void 0||T.ignoreIfExists!==void 0)&&(te.options=T),O!==void 0&&(te.annotationId=O),te}f.create=C;function w(g){var l=g;return l&&l.kind==="rename"&&R.string(l.oldUri)&&R.string(l.newUri)&&(l.options===void 0||(l.options.overwrite===void 0||R.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||R.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||B.is(l.annotationId))}f.is=w})(ze||(e.RenameFile=ze={}));var Ye;(function(f){function C(g,l,T){var O={kind:"delete",uri:g};return l!==void 0&&(l.recursive!==void 0||l.ignoreIfNotExists!==void 0)&&(O.options=l),T!==void 0&&(O.annotationId=T),O}f.create=C;function w(g){var l=g;return l&&l.kind==="delete"&&R.string(l.uri)&&(l.options===void 0||(l.options.recursive===void 0||R.boolean(l.options.recursive))&&(l.options.ignoreIfNotExists===void 0||R.boolean(l.options.ignoreIfNotExists)))&&(l.annotationId===void 0||B.is(l.annotationId))}f.is=w})(Ye||(e.DeleteFile=Ye={}));var Jt;(function(f){function C(w){var g=w;return g&&(g.changes!==void 0||g.documentChanges!==void 0)&&(g.documentChanges===void 0||g.documentChanges.every(function(l){return R.string(l.kind)?Ze.is(l)||ze.is(l)||Ye.is(l):ce.is(l)}))}f.is=C})(Jt||(e.WorkspaceEdit=Jt={}));var Rt=function(){function f(C,w){this.edits=C,this.changeAnnotations=w}return f.prototype.insert=function(C,w,g){var l,T;if(g===void 0?l=V.insert(C,w):B.is(g)?(T=g,l=Y.insert(C,w,g)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(g),l=Y.insert(C,w,T)),this.edits.push(l),T!==void 0)return T},f.prototype.replace=function(C,w,g){var l,T;if(g===void 0?l=V.replace(C,w):B.is(g)?(T=g,l=Y.replace(C,w,g)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(g),l=Y.replace(C,w,T)),this.edits.push(l),T!==void 0)return T},f.prototype.delete=function(C,w){var g,l;if(w===void 0?g=V.del(C):B.is(w)?(l=w,g=Y.del(C,w)):(this.assertChangeAnnotations(this.changeAnnotations),l=this.changeAnnotations.manage(w),g=Y.del(C,l)),this.edits.push(g),l!==void 0)return l},f.prototype.add=function(C){this.edits.push(C)},f.prototype.all=function(){return this.edits},f.prototype.clear=function(){this.edits.splice(0,this.edits.length)},f.prototype.assertChangeAnnotations=function(C){if(C===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},f}(),dt=function(){function f(C){this._annotations=C===void 0?Object.create(null):C,this._counter=0,this._size=0}return f.prototype.all=function(){return this._annotations},Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),f.prototype.manage=function(C,w){var g;if(B.is(C)?g=C:(g=this.nextId(),w=C),this._annotations[g]!==void 0)throw new Error("Id ".concat(g," is already in use."));if(w===void 0)throw new Error("No annotation provided for id ".concat(g));return this._annotations[g]=w,this._size++,g},f.prototype.nextId=function(){return this._counter++,this._counter.toString()},f}(),ft=function(){function f(C){var w=this;this._textEditChanges=Object.create(null),C!==void 0?(this._workspaceEdit=C,C.documentChanges?(this._changeAnnotations=new dt(C.changeAnnotations),C.changeAnnotations=this._changeAnnotations.all(),C.documentChanges.forEach(function(g){if(ce.is(g)){var l=new Rt(g.edits,w._changeAnnotations);w._textEditChanges[g.textDocument.uri]=l}})):C.changes&&Object.keys(C.changes).forEach(function(g){var l=new Rt(C.changes[g]);w._textEditChanges[g]=l})):this._workspaceEdit={}}return Object.defineProperty(f.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),f.prototype.getTextEditChange=function(C){if(Oe.is(C)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var w={uri:C.uri,version:C.version},g=this._textEditChanges[w.uri];if(!g){var l=[],T={textDocument:w,edits:l};this._workspaceEdit.documentChanges.push(T),g=new Rt(l,this._changeAnnotations),this._textEditChanges[w.uri]=g}return g}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var g=this._textEditChanges[C];if(!g){var l=[];this._workspaceEdit.changes[C]=l,g=new Rt(l),this._textEditChanges[C]=g}return g}},f.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new dt,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},f.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},f.prototype.createFile=function(C,w,g){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var l;de.is(w)||B.is(w)?l=w:g=w;var T,O;if(l===void 0?T=Ze.create(C,g):(O=B.is(l)?l:this._changeAnnotations.manage(l),T=Ze.create(C,g,O)),this._workspaceEdit.documentChanges.push(T),O!==void 0)return O},f.prototype.renameFile=function(C,w,g,l){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;de.is(g)||B.is(g)?T=g:l=g;var O,te;if(T===void 0?O=ze.create(C,w,l):(te=B.is(T)?T:this._changeAnnotations.manage(T),O=ze.create(C,w,l,te)),this._workspaceEdit.documentChanges.push(O),te!==void 0)return te},f.prototype.deleteFile=function(C,w,g){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var l;de.is(w)||B.is(w)?l=w:g=w;var T,O;if(l===void 0?T=Ye.create(C,g):(O=B.is(l)?l:this._changeAnnotations.manage(l),T=Ye.create(C,g,O)),this._workspaceEdit.documentChanges.push(T),O!==void 0)return O},f}();e.WorkspaceChange=ft;var cn;(function(f){function C(g){return{uri:g}}f.create=C;function w(g){var l=g;return R.defined(l)&&R.string(l.uri)}f.is=w})(cn||(e.TextDocumentIdentifier=cn={}));var Cn;(function(f){function C(g,l){return{uri:g,version:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&R.string(l.uri)&&R.integer(l.version)}f.is=w})(Cn||(e.VersionedTextDocumentIdentifier=Cn={}));var Oe;(function(f){function C(g,l){return{uri:g,version:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&R.string(l.uri)&&(l.version===null||R.integer(l.version))}f.is=w})(Oe||(e.OptionalVersionedTextDocumentIdentifier=Oe={}));var qt;(function(f){function C(g,l,T,O){return{uri:g,languageId:l,version:T,text:O}}f.create=C;function w(g){var l=g;return R.defined(l)&&R.string(l.uri)&&R.string(l.languageId)&&R.integer(l.version)&&R.string(l.text)}f.is=w})(qt||(e.TextDocumentItem=qt={}));var Tt;(function(f){f.PlainText="plaintext",f.Markdown="markdown";function C(w){var g=w;return g===f.PlainText||g===f.Markdown}f.is=C})(Tt||(e.MarkupKind=Tt={}));var ht;(function(f){function C(w){var g=w;return R.objectLiteral(w)&&Tt.is(g.kind)&&R.string(g.value)}f.is=C})(ht||(e.MarkupContent=ht={}));var Qn;(function(f){f.Text=1,f.Method=2,f.Function=3,f.Constructor=4,f.Field=5,f.Variable=6,f.Class=7,f.Interface=8,f.Module=9,f.Property=10,f.Unit=11,f.Value=12,f.Enum=13,f.Keyword=14,f.Snippet=15,f.Color=16,f.File=17,f.Reference=18,f.Folder=19,f.EnumMember=20,f.Constant=21,f.Struct=22,f.Event=23,f.Operator=24,f.TypeParameter=25})(Qn||(e.CompletionItemKind=Qn={}));var wn;(function(f){f.PlainText=1,f.Snippet=2})(wn||(e.InsertTextFormat=wn={}));var Dn;(function(f){f.Deprecated=1})(Dn||(e.CompletionItemTag=Dn={}));var Ln;(function(f){function C(g,l,T){return{newText:g,insert:l,replace:T}}f.create=C;function w(g){var l=g;return l&&R.string(l.newText)&&a.is(l.insert)&&a.is(l.replace)}f.is=w})(Ln||(e.InsertReplaceEdit=Ln={}));var Yn;(function(f){f.asIs=1,f.adjustIndentation=2})(Yn||(e.InsertTextMode=Yn={}));var Sn;(function(f){function C(w){var g=w;return g&&(R.string(g.detail)||g.detail===void 0)&&(R.string(g.description)||g.description===void 0)}f.is=C})(Sn||(e.CompletionItemLabelDetails=Sn={}));var un;(function(f){function C(w){return{label:w}}f.create=C})(un||(e.CompletionItem=un={}));var ln;(function(f){function C(w,g){return{items:w||[],isIncomplete:!!g}}f.create=C})(ln||(e.CompletionList=ln={}));var Rn;(function(f){function C(g){return g.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}f.fromPlainText=C;function w(g){var l=g;return R.string(l)||R.objectLiteral(l)&&R.string(l.language)&&R.string(l.value)}f.is=w})(Rn||(e.MarkedString=Rn={}));var et;(function(f){function C(w){var g=w;return!!g&&R.objectLiteral(g)&&(ht.is(g.contents)||Rn.is(g.contents)||R.typedArray(g.contents,Rn.is))&&(w.range===void 0||a.is(w.range))}f.is=C})(et||(e.Hover=et={}));var Fn;(function(f){function C(w,g){return g?{label:w,documentation:g}:{label:w}}f.create=C})(Fn||(e.ParameterInformation=Fn={}));var dn;(function(f){function C(w,g){for(var l=[],T=2;T<arguments.length;T++)l[T-2]=arguments[T];var O={label:w};return R.defined(g)&&(O.documentation=g),R.defined(l)?O.parameters=l:O.parameters=[],O}f.create=C})(dn||(e.SignatureInformation=dn={}));var Zt;(function(f){f.Text=1,f.Read=2,f.Write=3})(Zt||(e.DocumentHighlightKind=Zt={}));var er;(function(f){function C(w,g){var l={range:w};return R.number(g)&&(l.kind=g),l}f.create=C})(er||(e.DocumentHighlight=er={}));var Qt;(function(f){f.File=1,f.Module=2,f.Namespace=3,f.Package=4,f.Class=5,f.Method=6,f.Property=7,f.Field=8,f.Constructor=9,f.Enum=10,f.Interface=11,f.Function=12,f.Variable=13,f.Constant=14,f.String=15,f.Number=16,f.Boolean=17,f.Array=18,f.Object=19,f.Key=20,f.Null=21,f.EnumMember=22,f.Struct=23,f.Event=24,f.Operator=25,f.TypeParameter=26})(Qt||(e.SymbolKind=Qt={}));var Tn;(function(f){f.Deprecated=1})(Tn||(e.SymbolTag=Tn={}));var Qe;(function(f){function C(w,g,l,T,O){var te={name:w,kind:g,location:{uri:T,range:l}};return O&&(te.containerName=O),te}f.create=C})(Qe||(e.SymbolInformation=Qe={}));var vt;(function(f){function C(w,g,l,T){return T!==void 0?{name:w,kind:g,location:{uri:l,range:T}}:{name:w,kind:g,location:{uri:l}}}f.create=C})(vt||(e.WorkspaceSymbol=vt={}));var pt;(function(f){function C(g,l,T,O,te,Me){var xe={name:g,detail:l,kind:T,range:O,selectionRange:te};return Me!==void 0&&(xe.children=Me),xe}f.create=C;function w(g){var l=g;return l&&R.string(l.name)&&R.number(l.kind)&&a.is(l.range)&&a.is(l.selectionRange)&&(l.detail===void 0||R.string(l.detail))&&(l.deprecated===void 0||R.boolean(l.deprecated))&&(l.children===void 0||Array.isArray(l.children))&&(l.tags===void 0||Array.isArray(l.tags))}f.is=w})(pt||(e.DocumentSymbol=pt={}));var Ht;(function(f){f.Empty="",f.QuickFix="quickfix",f.Refactor="refactor",f.RefactorExtract="refactor.extract",f.RefactorInline="refactor.inline",f.RefactorRewrite="refactor.rewrite",f.Source="source",f.SourceOrganizeImports="source.organizeImports",f.SourceFixAll="source.fixAll"})(Ht||(e.CodeActionKind=Ht={}));var kt;(function(f){f.Invoked=1,f.Automatic=2})(kt||(e.CodeActionTriggerKind=kt={}));var Pn;(function(f){function C(g,l,T){var O={diagnostics:g};return l!=null&&(O.only=l),T!=null&&(O.triggerKind=T),O}f.create=C;function w(g){var l=g;return R.defined(l)&&R.typedArray(l.diagnostics,N.is)&&(l.only===void 0||R.typedArray(l.only,R.string))&&(l.triggerKind===void 0||l.triggerKind===kt.Invoked||l.triggerKind===kt.Automatic)}f.is=w})(Pn||(e.CodeActionContext=Pn={}));var Nn;(function(f){function C(g,l,T){var O={title:g},te=!0;return typeof l=="string"?(te=!1,O.kind=l):H.is(l)?O.command=l:O.edit=l,te&&T!==void 0&&(O.kind=T),O}f.create=C;function w(g){var l=g;return l&&R.string(l.title)&&(l.diagnostics===void 0||R.typedArray(l.diagnostics,N.is))&&(l.kind===void 0||R.string(l.kind))&&(l.edit!==void 0||l.command!==void 0)&&(l.command===void 0||H.is(l.command))&&(l.isPreferred===void 0||R.boolean(l.isPreferred))&&(l.edit===void 0||Jt.is(l.edit))}f.is=w})(Nn||(e.CodeAction=Nn={}));var fn;(function(f){function C(g,l){var T={range:g};return R.defined(l)&&(T.data=l),T}f.create=C;function w(g){var l=g;return R.defined(l)&&a.is(l.range)&&(R.undefined(l.command)||H.is(l.command))}f.is=w})(fn||(e.CodeLens=fn={}));var Mn;(function(f){function C(g,l){return{tabSize:g,insertSpaces:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&R.uinteger(l.tabSize)&&R.boolean(l.insertSpaces)}f.is=w})(Mn||(e.FormattingOptions=Mn={}));var Pt;(function(f){function C(g,l,T){return{range:g,target:l,data:T}}f.create=C;function w(g){var l=g;return R.defined(l)&&a.is(l.range)&&(R.undefined(l.target)||R.string(l.target))}f.is=w})(Pt||(e.DocumentLink=Pt={}));var b;(function(f){function C(g,l){return{range:g,parent:l}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&a.is(l.range)&&(l.parent===void 0||f.is(l.parent))}f.is=w})(b||(e.SelectionRange=b={}));var k;(function(f){f.namespace="namespace",f.type="type",f.class="class",f.enum="enum",f.interface="interface",f.struct="struct",f.typeParameter="typeParameter",f.parameter="parameter",f.variable="variable",f.property="property",f.enumMember="enumMember",f.event="event",f.function="function",f.method="method",f.macro="macro",f.keyword="keyword",f.modifier="modifier",f.comment="comment",f.string="string",f.number="number",f.regexp="regexp",f.operator="operator",f.decorator="decorator"})(k||(e.SemanticTokenTypes=k={}));var $;(function(f){f.declaration="declaration",f.definition="definition",f.readonly="readonly",f.static="static",f.deprecated="deprecated",f.abstract="abstract",f.async="async",f.modification="modification",f.documentation="documentation",f.defaultLibrary="defaultLibrary"})($||(e.SemanticTokenModifiers=$={}));var W;(function(f){function C(w){var g=w;return R.objectLiteral(g)&&(g.resultId===void 0||typeof g.resultId=="string")&&Array.isArray(g.data)&&(g.data.length===0||typeof g.data[0]=="number")}f.is=C})(W||(e.SemanticTokens=W={}));var ye;(function(f){function C(g,l){return{range:g,text:l}}f.create=C;function w(g){var l=g;return l!=null&&a.is(l.range)&&R.string(l.text)}f.is=w})(ye||(e.InlineValueText=ye={}));var me;(function(f){function C(g,l,T){return{range:g,variableName:l,caseSensitiveLookup:T}}f.create=C;function w(g){var l=g;return l!=null&&a.is(l.range)&&R.boolean(l.caseSensitiveLookup)&&(R.string(l.variableName)||l.variableName===void 0)}f.is=w})(me||(e.InlineValueVariableLookup=me={}));var Re;(function(f){function C(g,l){return{range:g,expression:l}}f.create=C;function w(g){var l=g;return l!=null&&a.is(l.range)&&(R.string(l.expression)||l.expression===void 0)}f.is=w})(Re||(e.InlineValueEvaluatableExpression=Re={}));var Ie;(function(f){function C(g,l){return{frameId:g,stoppedLocation:l}}f.create=C;function w(g){var l=g;return R.defined(l)&&a.is(g.stoppedLocation)}f.is=w})(Ie||(e.InlineValueContext=Ie={}));var se;(function(f){f.Type=1,f.Parameter=2;function C(w){return w===1||w===2}f.is=C})(se||(e.InlayHintKind=se={}));var be;(function(f){function C(g){return{value:g}}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&(l.tooltip===void 0||R.string(l.tooltip)||ht.is(l.tooltip))&&(l.location===void 0||u.is(l.location))&&(l.command===void 0||H.is(l.command))}f.is=w})(be||(e.InlayHintLabelPart=be={}));var fe;(function(f){function C(g,l,T){var O={position:g,label:l};return T!==void 0&&(O.kind=T),O}f.create=C;function w(g){var l=g;return R.objectLiteral(l)&&o.is(l.position)&&(R.string(l.label)||R.typedArray(l.label,be.is))&&(l.kind===void 0||se.is(l.kind))&&l.textEdits===void 0||R.typedArray(l.textEdits,V.is)&&(l.tooltip===void 0||R.string(l.tooltip)||ht.is(l.tooltip))&&(l.paddingLeft===void 0||R.boolean(l.paddingLeft))&&(l.paddingRight===void 0||R.boolean(l.paddingRight))}f.is=w})(fe||(e.InlayHint=fe={}));var Ee;(function(f){function C(w){return{kind:"snippet",value:w}}f.createSnippet=C})(Ee||(e.StringValue=Ee={}));var Xe;(function(f){function C(w,g,l,T){return{insertText:w,filterText:g,range:l,command:T}}f.create=C})(Xe||(e.InlineCompletionItem=Xe={}));var it;(function(f){function C(w){return{items:w}}f.create=C})(it||(e.InlineCompletionList=it={}));var tr;(function(f){f.Invoked=0,f.Automatic=1})(tr||(e.InlineCompletionTriggerKind=tr={}));var nr;(function(f){function C(w,g){return{range:w,text:g}}f.create=C})(nr||(e.SelectedCompletionInfo=nr={}));var d;(function(f){function C(w,g){return{triggerKind:w,selectedCompletionInfo:g}}f.create=C})(d||(e.InlineCompletionContext=d={}));var I;(function(f){function C(w){var g=w;return R.objectLiteral(g)&&r.is(g.uri)&&R.string(g.name)}f.is=C})(I||(e.WorkspaceFolder=I={})),e.EOL=[`
`,`\r
`,"\r"];var K;(function(f){function C(T,O,te,Me){return new Ce(T,O,te,Me)}f.create=C;function w(T){var O=T;return!!(R.defined(O)&&R.string(O.uri)&&(R.undefined(O.languageId)||R.string(O.languageId))&&R.uinteger(O.lineCount)&&R.func(O.getText)&&R.func(O.positionAt)&&R.func(O.offsetAt))}f.is=w;function g(T,O){for(var te=T.getText(),Me=l(O,function(In,c){var D=In.range.start.line-c.range.start.line;return D===0?In.range.start.character-c.range.start.character:D}),xe=te.length,Ot=Me.length-1;Ot>=0;Ot--){var Ut=Me[Ot],hn=T.offsetAt(Ut.range.start),le=T.offsetAt(Ut.range.end);if(le<=xe)te=te.substring(0,hn)+Ut.newText+te.substring(le,te.length);else throw new Error("Overlapping edit");xe=hn}return te}f.applyEdits=g;function l(T,O){if(T.length<=1)return T;var te=T.length/2|0,Me=T.slice(0,te),xe=T.slice(te);l(Me,O),l(xe,O);for(var Ot=0,Ut=0,hn=0;Ot<Me.length&&Ut<xe.length;){var le=O(Me[Ot],xe[Ut]);le<=0?T[hn++]=Me[Ot++]:T[hn++]=xe[Ut++]}for(;Ot<Me.length;)T[hn++]=Me[Ot++];for(;Ut<xe.length;)T[hn++]=xe[Ut++];return T}})(K||(e.TextDocument=K={}));var Ce=function(){function f(C,w,g,l){this._uri=C,this._languageId=w,this._version=g,this._content=l,this._lineOffsets=void 0}return Object.defineProperty(f.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),f.prototype.getText=function(C){if(C){var w=this.offsetAt(C.start),g=this.offsetAt(C.end);return this._content.substring(w,g)}return this._content},f.prototype.update=function(C,w){this._content=C.text,this._version=w,this._lineOffsets=void 0},f.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var C=[],w=this._content,g=!0,l=0;l<w.length;l++){g&&(C.push(l),g=!1);var T=w.charAt(l);g=T==="\r"||T===`
`,T==="\r"&&l+1<w.length&&w.charAt(l+1)===`
`&&l++}g&&w.length>0&&C.push(w.length),this._lineOffsets=C}return this._lineOffsets},f.prototype.positionAt=function(C){C=Math.max(Math.min(C,this._content.length),0);var w=this.getLineOffsets(),g=0,l=w.length;if(l===0)return o.create(0,C);for(;g<l;){var T=Math.floor((g+l)/2);w[T]>C?l=T:g=T+1}var O=g-1;return o.create(O,C-w[O])},f.prototype.offsetAt=function(C){var w=this.getLineOffsets();if(C.line>=w.length)return this._content.length;if(C.line<0)return 0;var g=w[C.line],l=C.line+1<w.length?w[C.line+1]:this._content.length;return Math.max(Math.min(g+C.character,l),g)},Object.defineProperty(f.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),f}(),R;(function(f){var C=Object.prototype.toString;function w(le){return typeof le<"u"}f.defined=w;function g(le){return typeof le>"u"}f.undefined=g;function l(le){return le===!0||le===!1}f.boolean=l;function T(le){return C.call(le)==="[object String]"}f.string=T;function O(le){return C.call(le)==="[object Number]"}f.number=O;function te(le,In,c){return C.call(le)==="[object Number]"&&In<=le&&le<=c}f.numberRange=te;function Me(le){return C.call(le)==="[object Number]"&&-2147483648<=le&&le<=2147483647}f.integer=Me;function xe(le){return C.call(le)==="[object Number]"&&0<=le&&le<=2147483647}f.uinteger=xe;function Ot(le){return C.call(le)==="[object Function]"}f.func=Ot;function Ut(le){return le!==null&&typeof le=="object"}f.objectLiteral=Ut;function hn(le,In){return Array.isArray(le)&&le.every(In)}f.typedArray=hn})(R||(R={}))})});var Ae=x(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.ProtocolNotificationType=Lt.ProtocolNotificationType0=Lt.ProtocolRequestType=Lt.ProtocolRequestType0=Lt.RegistrationType=Lt.MessageDirection=void 0;var Jr=Dr(),mf;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(mf||(Lt.MessageDirection=mf={}));var dc=class{constructor(e){this.method=e}};Lt.RegistrationType=dc;var fc=class extends Jr.RequestType0{constructor(e){super(e)}};Lt.ProtocolRequestType0=fc;var hc=class extends Jr.RequestType{constructor(e){super(e,Jr.ParameterStructures.byName)}};Lt.ProtocolRequestType=hc;var pc=class extends Jr.NotificationType0{constructor(e){super(e)}};Lt.ProtocolNotificationType0=pc;var gc=class extends Jr.NotificationType{constructor(e){super(e,Jr.ParameterStructures.byName)}};Lt.ProtocolNotificationType=gc});var ks=x(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.objectLiteral=tt.typedArray=tt.stringArray=tt.array=tt.func=tt.error=tt.number=tt.string=tt.boolean=void 0;function m_(n){return n===!0||n===!1}tt.boolean=m_;function vf(n){return typeof n=="string"||n instanceof String}tt.string=vf;function v_(n){return typeof n=="number"||n instanceof Number}tt.number=v_;function y_(n){return n instanceof Error}tt.error=y_;function __(n){return typeof n=="function"}tt.func=__;function yf(n){return Array.isArray(n)}tt.array=yf;function b_(n){return yf(n)&&n.every(e=>vf(e))}tt.stringArray=b_;function C_(n,e){return Array.isArray(n)&&n.every(e)}tt.typedArray=C_;function w_(n){return n!==null&&typeof n=="object"}tt.objectLiteral=w_});var Cf=x(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});Os.ImplementationRequest=void 0;var _f=Ae(),bf;(function(n){n.method="textDocument/implementation",n.messageDirection=_f.MessageDirection.clientToServer,n.type=new _f.ProtocolRequestType(n.method)})(bf||(Os.ImplementationRequest=bf={}))});var Sf=x(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.TypeDefinitionRequest=void 0;var wf=Ae(),Df;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=wf.MessageDirection.clientToServer,n.type=new wf.ProtocolRequestType(n.method)})(Df||(Ls.TypeDefinitionRequest=Df={}))});var Pf=x(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.DidChangeWorkspaceFoldersNotification=Zr.WorkspaceFoldersRequest=void 0;var Fs=Ae(),Rf;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=Fs.MessageDirection.serverToClient,n.type=new Fs.ProtocolRequestType0(n.method)})(Rf||(Zr.WorkspaceFoldersRequest=Rf={}));var Tf;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=Fs.MessageDirection.clientToServer,n.type=new Fs.ProtocolNotificationType(n.method)})(Tf||(Zr.DidChangeWorkspaceFoldersNotification=Tf={}))});var xf=x(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.ConfigurationRequest=void 0;var If=Ae(),Ef;(function(n){n.method="workspace/configuration",n.messageDirection=If.MessageDirection.serverToClient,n.type=new If.ProtocolRequestType(n.method)})(Ef||(Ns.ConfigurationRequest=Ef={}))});var Of=x(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.ColorPresentationRequest=Qr.DocumentColorRequest=void 0;var Ms=Ae(),qf;(function(n){n.method="textDocument/documentColor",n.messageDirection=Ms.MessageDirection.clientToServer,n.type=new Ms.ProtocolRequestType(n.method)})(qf||(Qr.DocumentColorRequest=qf={}));var kf;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Ms.MessageDirection.clientToServer,n.type=new Ms.ProtocolRequestType(n.method)})(kf||(Qr.ColorPresentationRequest=kf={}))});var Nf=x(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.FoldingRangeRefreshRequest=Yr.FoldingRangeRequest=void 0;var As=Ae(),Lf;(function(n){n.method="textDocument/foldingRange",n.messageDirection=As.MessageDirection.clientToServer,n.type=new As.ProtocolRequestType(n.method)})(Lf||(Yr.FoldingRangeRequest=Lf={}));var Ff;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=As.MessageDirection.serverToClient,n.type=new As.ProtocolRequestType0(n.method)})(Ff||(Yr.FoldingRangeRefreshRequest=Ff={}))});var jf=x(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.DeclarationRequest=void 0;var Mf=Ae(),Af;(function(n){n.method="textDocument/declaration",n.messageDirection=Mf.MessageDirection.clientToServer,n.type=new Mf.ProtocolRequestType(n.method)})(Af||(js.DeclarationRequest=Af={}))});var Uf=x($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.SelectionRangeRequest=void 0;var $f=Ae(),Hf;(function(n){n.method="textDocument/selectionRange",n.messageDirection=$f.MessageDirection.clientToServer,n.type=new $f.ProtocolRequestType(n.method)})(Hf||($s.SelectionRangeRequest=Hf={}))});var zf=x(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.WorkDoneProgressCancelNotification=cr.WorkDoneProgressCreateRequest=cr.WorkDoneProgress=void 0;var D_=Dr(),Hs=Ae(),Wf;(function(n){n.type=new D_.ProgressType;function e(t){return t===n.type}n.is=e})(Wf||(cr.WorkDoneProgress=Wf={}));var Kf;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Hs.MessageDirection.serverToClient,n.type=new Hs.ProtocolRequestType(n.method)})(Kf||(cr.WorkDoneProgressCreateRequest=Kf={}));var Bf;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Hs.MessageDirection.clientToServer,n.type=new Hs.ProtocolNotificationType(n.method)})(Bf||(cr.WorkDoneProgressCancelNotification=Bf={}))});var Jf=x(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.CallHierarchyOutgoingCallsRequest=ur.CallHierarchyIncomingCallsRequest=ur.CallHierarchyPrepareRequest=void 0;var ei=Ae(),Xf;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=ei.MessageDirection.clientToServer,n.type=new ei.ProtocolRequestType(n.method)})(Xf||(ur.CallHierarchyPrepareRequest=Xf={}));var Gf;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=ei.MessageDirection.clientToServer,n.type=new ei.ProtocolRequestType(n.method)})(Gf||(ur.CallHierarchyIncomingCallsRequest=Gf={}));var Vf;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=ei.MessageDirection.clientToServer,n.type=new ei.ProtocolRequestType(n.method)})(Vf||(ur.CallHierarchyOutgoingCallsRequest=Vf={}))});var nh=x(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.SemanticTokensRefreshRequest=Ft.SemanticTokensRangeRequest=Ft.SemanticTokensDeltaRequest=Ft.SemanticTokensRequest=Ft.SemanticTokensRegistrationType=Ft.TokenFormat=void 0;var jn=Ae(),Zf;(function(n){n.Relative="relative"})(Zf||(Ft.TokenFormat=Zf={}));var Oi;(function(n){n.method="textDocument/semanticTokens",n.type=new jn.RegistrationType(n.method)})(Oi||(Ft.SemanticTokensRegistrationType=Oi={}));var Qf;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=jn.MessageDirection.clientToServer,n.type=new jn.ProtocolRequestType(n.method),n.registrationMethod=Oi.method})(Qf||(Ft.SemanticTokensRequest=Qf={}));var Yf;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=jn.MessageDirection.clientToServer,n.type=new jn.ProtocolRequestType(n.method),n.registrationMethod=Oi.method})(Yf||(Ft.SemanticTokensDeltaRequest=Yf={}));var eh;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=jn.MessageDirection.clientToServer,n.type=new jn.ProtocolRequestType(n.method),n.registrationMethod=Oi.method})(eh||(Ft.SemanticTokensRangeRequest=eh={}));var th;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=jn.MessageDirection.serverToClient,n.type=new jn.ProtocolRequestType0(n.method)})(th||(Ft.SemanticTokensRefreshRequest=th={}))});var sh=x(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.ShowDocumentRequest=void 0;var rh=Ae(),ih;(function(n){n.method="window/showDocument",n.messageDirection=rh.MessageDirection.serverToClient,n.type=new rh.ProtocolRequestType(n.method)})(ih||(Us.ShowDocumentRequest=ih={}))});var ch=x(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.LinkedEditingRangeRequest=void 0;var oh=Ae(),ah;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=oh.MessageDirection.clientToServer,n.type=new oh.ProtocolRequestType(n.method)})(ah||(Ws.LinkedEditingRangeRequest=ah={}))});var mh=x(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.WillDeleteFilesRequest=bt.DidDeleteFilesNotification=bt.DidRenameFilesNotification=bt.WillRenameFilesRequest=bt.DidCreateFilesNotification=bt.WillCreateFilesRequest=bt.FileOperationPatternKind=void 0;var en=Ae(),uh;(function(n){n.file="file",n.folder="folder"})(uh||(bt.FileOperationPatternKind=uh={}));var lh;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolRequestType(n.method)})(lh||(bt.WillCreateFilesRequest=lh={}));var dh;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolNotificationType(n.method)})(dh||(bt.DidCreateFilesNotification=dh={}));var fh;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolRequestType(n.method)})(fh||(bt.WillRenameFilesRequest=fh={}));var hh;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolNotificationType(n.method)})(hh||(bt.DidRenameFilesNotification=hh={}));var ph;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolNotificationType(n.method)})(ph||(bt.DidDeleteFilesNotification=ph={}));var gh;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=en.MessageDirection.clientToServer,n.type=new en.ProtocolRequestType(n.method)})(gh||(bt.WillDeleteFilesRequest=gh={}))});var Ch=x(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.MonikerRequest=lr.MonikerKind=lr.UniquenessLevel=void 0;var vh=Ae(),yh;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(yh||(lr.UniquenessLevel=yh={}));var _h;(function(n){n.$import="import",n.$export="export",n.local="local"})(_h||(lr.MonikerKind=_h={}));var bh;(function(n){n.method="textDocument/moniker",n.messageDirection=vh.MessageDirection.clientToServer,n.type=new vh.ProtocolRequestType(n.method)})(bh||(lr.MonikerRequest=bh={}))});var Rh=x(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.TypeHierarchySubtypesRequest=dr.TypeHierarchySupertypesRequest=dr.TypeHierarchyPrepareRequest=void 0;var ti=Ae(),wh;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=ti.MessageDirection.clientToServer,n.type=new ti.ProtocolRequestType(n.method)})(wh||(dr.TypeHierarchyPrepareRequest=wh={}));var Dh;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=ti.MessageDirection.clientToServer,n.type=new ti.ProtocolRequestType(n.method)})(Dh||(dr.TypeHierarchySupertypesRequest=Dh={}));var Sh;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=ti.MessageDirection.clientToServer,n.type=new ti.ProtocolRequestType(n.method)})(Sh||(dr.TypeHierarchySubtypesRequest=Sh={}))});var Ih=x(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.InlineValueRefreshRequest=ni.InlineValueRequest=void 0;var Ks=Ae(),Th;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Ks.MessageDirection.clientToServer,n.type=new Ks.ProtocolRequestType(n.method)})(Th||(ni.InlineValueRequest=Th={}));var Ph;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Ks.MessageDirection.serverToClient,n.type=new Ks.ProtocolRequestType0(n.method)})(Ph||(ni.InlineValueRefreshRequest=Ph={}))});var kh=x(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.InlayHintRefreshRequest=fr.InlayHintResolveRequest=fr.InlayHintRequest=void 0;var ri=Ae(),Eh;(function(n){n.method="textDocument/inlayHint",n.messageDirection=ri.MessageDirection.clientToServer,n.type=new ri.ProtocolRequestType(n.method)})(Eh||(fr.InlayHintRequest=Eh={}));var xh;(function(n){n.method="inlayHint/resolve",n.messageDirection=ri.MessageDirection.clientToServer,n.type=new ri.ProtocolRequestType(n.method)})(xh||(fr.InlayHintResolveRequest=xh={}));var qh;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=ri.MessageDirection.serverToClient,n.type=new ri.ProtocolRequestType0(n.method)})(qh||(fr.InlayHintRefreshRequest=qh={}))});var jh=x(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.DiagnosticRefreshRequest=tn.WorkspaceDiagnosticRequest=tn.DocumentDiagnosticRequest=tn.DocumentDiagnosticReportKind=tn.DiagnosticServerCancellationData=void 0;var Ah=Dr(),S_=ks(),ii=Ae(),Oh;(function(n){function e(t){let r=t;return r&&S_.boolean(r.retriggerRequest)}n.is=e})(Oh||(tn.DiagnosticServerCancellationData=Oh={}));var Lh;(function(n){n.Full="full",n.Unchanged="unchanged"})(Lh||(tn.DocumentDiagnosticReportKind=Lh={}));var Fh;(function(n){n.method="textDocument/diagnostic",n.messageDirection=ii.MessageDirection.clientToServer,n.type=new ii.ProtocolRequestType(n.method),n.partialResult=new Ah.ProgressType})(Fh||(tn.DocumentDiagnosticRequest=Fh={}));var Nh;(function(n){n.method="workspace/diagnostic",n.messageDirection=ii.MessageDirection.clientToServer,n.type=new ii.ProtocolRequestType(n.method),n.partialResult=new Ah.ProgressType})(Nh||(tn.WorkspaceDiagnosticRequest=Nh={}));var Mh;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=ii.MessageDirection.serverToClient,n.type=new ii.ProtocolRequestType0(n.method)})(Mh||(tn.DiagnosticRefreshRequest=Mh={}))});var zh=x(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.DidCloseNotebookDocumentNotification=Ve.DidSaveNotebookDocumentNotification=Ve.DidChangeNotebookDocumentNotification=Ve.NotebookCellArrayChange=Ve.DidOpenNotebookDocumentNotification=Ve.NotebookDocumentSyncRegistrationType=Ve.NotebookDocument=Ve.NotebookCell=Ve.ExecutionSummary=Ve.NotebookCellKind=void 0;var Li=qs(),gn=ks(),xn=Ae(),mc;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(mc||(Ve.NotebookCellKind=mc={}));var vc;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return gn.objectLiteral(s)&&Li.uinteger.is(s.executionOrder)&&(s.success===void 0||gn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(vc||(Ve.ExecutionSummary=vc={}));var Bs;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return gn.objectLiteral(o)&&mc.is(o.kind)&&Li.DocumentUri.is(o.document)&&(o.metadata===void 0||gn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!vc.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),u=Array.isArray(o);if(a!==u)return!1;if(a&&u){if(s.length!==o.length)return!1;for(let h=0;h<s.length;h++)if(!i(s[h],o[h]))return!1}if(gn.objectLiteral(s)&&gn.objectLiteral(o)){let h=Object.keys(s),p=Object.keys(o);if(h.length!==p.length||(h.sort(),p.sort(),!i(h,p)))return!1;for(let y=0;y<h.length;y++){let m=h[y];if(!i(s[m],o[m]))return!1}}return!0}})(Bs||(Ve.NotebookCell=Bs={}));var $h;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return gn.objectLiteral(i)&&gn.string(i.uri)&&Li.integer.is(i.version)&&gn.typedArray(i.cells,Bs.is)}n.is=t})($h||(Ve.NotebookDocument=$h={}));var si;(function(n){n.method="notebookDocument/sync",n.messageDirection=xn.MessageDirection.clientToServer,n.type=new xn.RegistrationType(n.method)})(si||(Ve.NotebookDocumentSyncRegistrationType=si={}));var Hh;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=xn.MessageDirection.clientToServer,n.type=new xn.ProtocolNotificationType(n.method),n.registrationMethod=si.method})(Hh||(Ve.DidOpenNotebookDocumentNotification=Hh={}));var Uh;(function(n){function e(r){let i=r;return gn.objectLiteral(i)&&Li.uinteger.is(i.start)&&Li.uinteger.is(i.deleteCount)&&(i.cells===void 0||gn.typedArray(i.cells,Bs.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(Uh||(Ve.NotebookCellArrayChange=Uh={}));var Wh;(function(n){n.method="notebookDocument/didChange",n.messageDirection=xn.MessageDirection.clientToServer,n.type=new xn.ProtocolNotificationType(n.method),n.registrationMethod=si.method})(Wh||(Ve.DidChangeNotebookDocumentNotification=Wh={}));var Kh;(function(n){n.method="notebookDocument/didSave",n.messageDirection=xn.MessageDirection.clientToServer,n.type=new xn.ProtocolNotificationType(n.method),n.registrationMethod=si.method})(Kh||(Ve.DidSaveNotebookDocumentNotification=Kh={}));var Bh;(function(n){n.method="notebookDocument/didClose",n.messageDirection=xn.MessageDirection.clientToServer,n.type=new xn.ProtocolNotificationType(n.method),n.registrationMethod=si.method})(Bh||(Ve.DidCloseNotebookDocumentNotification=Bh={}))});var Vh=x(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.InlineCompletionRequest=void 0;var Xh=Ae(),Gh;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=Xh.MessageDirection.clientToServer,n.type=new Xh.ProtocolRequestType(n.method)})(Gh||(zs.InlineCompletionRequest=Gh={}))});var cg=x(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.WorkspaceSymbolRequest=_.CodeActionResolveRequest=_.CodeActionRequest=_.DocumentSymbolRequest=_.DocumentHighlightRequest=_.ReferencesRequest=_.DefinitionRequest=_.SignatureHelpRequest=_.SignatureHelpTriggerKind=_.HoverRequest=_.CompletionResolveRequest=_.CompletionRequest=_.CompletionTriggerKind=_.PublishDiagnosticsNotification=_.WatchKind=_.RelativePattern=_.FileChangeType=_.DidChangeWatchedFilesNotification=_.WillSaveTextDocumentWaitUntilRequest=_.WillSaveTextDocumentNotification=_.TextDocumentSaveReason=_.DidSaveTextDocumentNotification=_.DidCloseTextDocumentNotification=_.DidChangeTextDocumentNotification=_.TextDocumentContentChangeEvent=_.DidOpenTextDocumentNotification=_.TextDocumentSyncKind=_.TelemetryEventNotification=_.LogMessageNotification=_.ShowMessageRequest=_.ShowMessageNotification=_.MessageType=_.DidChangeConfigurationNotification=_.ExitNotification=_.ShutdownRequest=_.InitializedNotification=_.InitializeErrorCodes=_.InitializeRequest=_.WorkDoneProgressOptions=_.TextDocumentRegistrationOptions=_.StaticRegistrationOptions=_.PositionEncodingKind=_.FailureHandlingKind=_.ResourceOperationKind=_.UnregistrationRequest=_.RegistrationRequest=_.DocumentSelector=_.NotebookCellTextDocumentFilter=_.NotebookDocumentFilter=_.TextDocumentFilter=void 0;_.MonikerRequest=_.MonikerKind=_.UniquenessLevel=_.WillDeleteFilesRequest=_.DidDeleteFilesNotification=_.WillRenameFilesRequest=_.DidRenameFilesNotification=_.WillCreateFilesRequest=_.DidCreateFilesNotification=_.FileOperationPatternKind=_.LinkedEditingRangeRequest=_.ShowDocumentRequest=_.SemanticTokensRegistrationType=_.SemanticTokensRefreshRequest=_.SemanticTokensRangeRequest=_.SemanticTokensDeltaRequest=_.SemanticTokensRequest=_.TokenFormat=_.CallHierarchyPrepareRequest=_.CallHierarchyOutgoingCallsRequest=_.CallHierarchyIncomingCallsRequest=_.WorkDoneProgressCancelNotification=_.WorkDoneProgressCreateRequest=_.WorkDoneProgress=_.SelectionRangeRequest=_.DeclarationRequest=_.FoldingRangeRefreshRequest=_.FoldingRangeRequest=_.ColorPresentationRequest=_.DocumentColorRequest=_.ConfigurationRequest=_.DidChangeWorkspaceFoldersNotification=_.WorkspaceFoldersRequest=_.TypeDefinitionRequest=_.ImplementationRequest=_.ApplyWorkspaceEditRequest=_.ExecuteCommandRequest=_.PrepareRenameRequest=_.RenameRequest=_.PrepareSupportDefaultBehavior=_.DocumentOnTypeFormattingRequest=_.DocumentRangesFormattingRequest=_.DocumentRangeFormattingRequest=_.DocumentFormattingRequest=_.DocumentLinkResolveRequest=_.DocumentLinkRequest=_.CodeLensRefreshRequest=_.CodeLensResolveRequest=_.CodeLensRequest=_.WorkspaceSymbolResolveRequest=void 0;_.InlineCompletionRequest=_.DidCloseNotebookDocumentNotification=_.DidSaveNotebookDocumentNotification=_.DidChangeNotebookDocumentNotification=_.NotebookCellArrayChange=_.DidOpenNotebookDocumentNotification=_.NotebookDocumentSyncRegistrationType=_.NotebookDocument=_.NotebookCell=_.ExecutionSummary=_.NotebookCellKind=_.DiagnosticRefreshRequest=_.WorkspaceDiagnosticRequest=_.DocumentDiagnosticRequest=_.DocumentDiagnosticReportKind=_.DiagnosticServerCancellationData=_.InlayHintRefreshRequest=_.InlayHintResolveRequest=_.InlayHintRequest=_.InlineValueRefreshRequest=_.InlineValueRequest=_.TypeHierarchySupertypesRequest=_.TypeHierarchySubtypesRequest=_.TypeHierarchyPrepareRequest=void 0;var j=Ae(),Jh=qs(),at=ks(),R_=Cf();Object.defineProperty(_,"ImplementationRequest",{enumerable:!0,get:function(){return R_.ImplementationRequest}});var T_=Sf();Object.defineProperty(_,"TypeDefinitionRequest",{enumerable:!0,get:function(){return T_.TypeDefinitionRequest}});var ig=Pf();Object.defineProperty(_,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return ig.WorkspaceFoldersRequest}});Object.defineProperty(_,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return ig.DidChangeWorkspaceFoldersNotification}});var P_=xf();Object.defineProperty(_,"ConfigurationRequest",{enumerable:!0,get:function(){return P_.ConfigurationRequest}});var sg=Of();Object.defineProperty(_,"DocumentColorRequest",{enumerable:!0,get:function(){return sg.DocumentColorRequest}});Object.defineProperty(_,"ColorPresentationRequest",{enumerable:!0,get:function(){return sg.ColorPresentationRequest}});var og=Nf();Object.defineProperty(_,"FoldingRangeRequest",{enumerable:!0,get:function(){return og.FoldingRangeRequest}});Object.defineProperty(_,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return og.FoldingRangeRefreshRequest}});var I_=jf();Object.defineProperty(_,"DeclarationRequest",{enumerable:!0,get:function(){return I_.DeclarationRequest}});var E_=Uf();Object.defineProperty(_,"SelectionRangeRequest",{enumerable:!0,get:function(){return E_.SelectionRangeRequest}});var wc=zf();Object.defineProperty(_,"WorkDoneProgress",{enumerable:!0,get:function(){return wc.WorkDoneProgress}});Object.defineProperty(_,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return wc.WorkDoneProgressCreateRequest}});Object.defineProperty(_,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return wc.WorkDoneProgressCancelNotification}});var Dc=Jf();Object.defineProperty(_,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Dc.CallHierarchyIncomingCallsRequest}});Object.defineProperty(_,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Dc.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(_,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Dc.CallHierarchyPrepareRequest}});var oi=nh();Object.defineProperty(_,"TokenFormat",{enumerable:!0,get:function(){return oi.TokenFormat}});Object.defineProperty(_,"SemanticTokensRequest",{enumerable:!0,get:function(){return oi.SemanticTokensRequest}});Object.defineProperty(_,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return oi.SemanticTokensDeltaRequest}});Object.defineProperty(_,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return oi.SemanticTokensRangeRequest}});Object.defineProperty(_,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return oi.SemanticTokensRefreshRequest}});Object.defineProperty(_,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return oi.SemanticTokensRegistrationType}});var x_=sh();Object.defineProperty(_,"ShowDocumentRequest",{enumerable:!0,get:function(){return x_.ShowDocumentRequest}});var q_=ch();Object.defineProperty(_,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return q_.LinkedEditingRangeRequest}});var Sr=mh();Object.defineProperty(_,"FileOperationPatternKind",{enumerable:!0,get:function(){return Sr.FileOperationPatternKind}});Object.defineProperty(_,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Sr.DidCreateFilesNotification}});Object.defineProperty(_,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Sr.WillCreateFilesRequest}});Object.defineProperty(_,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Sr.DidRenameFilesNotification}});Object.defineProperty(_,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Sr.WillRenameFilesRequest}});Object.defineProperty(_,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Sr.DidDeleteFilesNotification}});Object.defineProperty(_,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Sr.WillDeleteFilesRequest}});var Sc=Ch();Object.defineProperty(_,"UniquenessLevel",{enumerable:!0,get:function(){return Sc.UniquenessLevel}});Object.defineProperty(_,"MonikerKind",{enumerable:!0,get:function(){return Sc.MonikerKind}});Object.defineProperty(_,"MonikerRequest",{enumerable:!0,get:function(){return Sc.MonikerRequest}});var Rc=Rh();Object.defineProperty(_,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Rc.TypeHierarchyPrepareRequest}});Object.defineProperty(_,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Rc.TypeHierarchySubtypesRequest}});Object.defineProperty(_,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Rc.TypeHierarchySupertypesRequest}});var ag=Ih();Object.defineProperty(_,"InlineValueRequest",{enumerable:!0,get:function(){return ag.InlineValueRequest}});Object.defineProperty(_,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return ag.InlineValueRefreshRequest}});var Tc=kh();Object.defineProperty(_,"InlayHintRequest",{enumerable:!0,get:function(){return Tc.InlayHintRequest}});Object.defineProperty(_,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Tc.InlayHintResolveRequest}});Object.defineProperty(_,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Tc.InlayHintRefreshRequest}});var Fi=jh();Object.defineProperty(_,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Fi.DiagnosticServerCancellationData}});Object.defineProperty(_,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Fi.DocumentDiagnosticReportKind}});Object.defineProperty(_,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Fi.DocumentDiagnosticRequest}});Object.defineProperty(_,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Fi.WorkspaceDiagnosticRequest}});Object.defineProperty(_,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Fi.DiagnosticRefreshRequest}});var qn=zh();Object.defineProperty(_,"NotebookCellKind",{enumerable:!0,get:function(){return qn.NotebookCellKind}});Object.defineProperty(_,"ExecutionSummary",{enumerable:!0,get:function(){return qn.ExecutionSummary}});Object.defineProperty(_,"NotebookCell",{enumerable:!0,get:function(){return qn.NotebookCell}});Object.defineProperty(_,"NotebookDocument",{enumerable:!0,get:function(){return qn.NotebookDocument}});Object.defineProperty(_,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return qn.NotebookDocumentSyncRegistrationType}});Object.defineProperty(_,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return qn.DidOpenNotebookDocumentNotification}});Object.defineProperty(_,"NotebookCellArrayChange",{enumerable:!0,get:function(){return qn.NotebookCellArrayChange}});Object.defineProperty(_,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return qn.DidChangeNotebookDocumentNotification}});Object.defineProperty(_,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return qn.DidSaveNotebookDocumentNotification}});Object.defineProperty(_,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return qn.DidCloseNotebookDocumentNotification}});var k_=Vh();Object.defineProperty(_,"InlineCompletionRequest",{enumerable:!0,get:function(){return k_.InlineCompletionRequest}});var yc;(function(n){function e(t){let r=t;return at.string(r)||at.string(r.language)||at.string(r.scheme)||at.string(r.pattern)}n.is=e})(yc||(_.TextDocumentFilter=yc={}));var _c;(function(n){function e(t){let r=t;return at.objectLiteral(r)&&(at.string(r.notebookType)||at.string(r.scheme)||at.string(r.pattern))}n.is=e})(_c||(_.NotebookDocumentFilter=_c={}));var bc;(function(n){function e(t){let r=t;return at.objectLiteral(r)&&(at.string(r.notebook)||_c.is(r.notebook))&&(r.language===void 0||at.string(r.language))}n.is=e})(bc||(_.NotebookCellTextDocumentFilter=bc={}));var Cc;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!at.string(r)&&!yc.is(r)&&!bc.is(r))return!1;return!0}n.is=e})(Cc||(_.DocumentSelector=Cc={}));var Zh;(function(n){n.method="client/registerCapability",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(Zh||(_.RegistrationRequest=Zh={}));var Qh;(function(n){n.method="client/unregisterCapability",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(Qh||(_.UnregistrationRequest=Qh={}));var Yh;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(Yh||(_.ResourceOperationKind=Yh={}));var ep;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(ep||(_.FailureHandlingKind=ep={}));var tp;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(tp||(_.PositionEncodingKind=tp={}));var np;(function(n){function e(t){let r=t;return r&&at.string(r.id)&&r.id.length>0}n.hasId=e})(np||(_.StaticRegistrationOptions=np={}));var rp;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Cc.is(r.documentSelector))}n.is=e})(rp||(_.TextDocumentRegistrationOptions=rp={}));var ip;(function(n){function e(r){let i=r;return at.objectLiteral(i)&&(i.workDoneProgress===void 0||at.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&at.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(ip||(_.WorkDoneProgressOptions=ip={}));var sp;(function(n){n.method="initialize",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(sp||(_.InitializeRequest=sp={}));var op;(function(n){n.unknownProtocolVersion=1})(op||(_.InitializeErrorCodes=op={}));var ap;(function(n){n.method="initialized",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(ap||(_.InitializedNotification=ap={}));var cp;(function(n){n.method="shutdown",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType0(n.method)})(cp||(_.ShutdownRequest=cp={}));var up;(function(n){n.method="exit",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType0(n.method)})(up||(_.ExitNotification=up={}));var lp;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(lp||(_.DidChangeConfigurationNotification=lp={}));var dp;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(dp||(_.MessageType=dp={}));var fp;(function(n){n.method="window/showMessage",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(fp||(_.ShowMessageNotification=fp={}));var hp;(function(n){n.method="window/showMessageRequest",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType(n.method)})(hp||(_.ShowMessageRequest=hp={}));var pp;(function(n){n.method="window/logMessage",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(pp||(_.LogMessageNotification=pp={}));var gp;(function(n){n.method="telemetry/event",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(gp||(_.TelemetryEventNotification=gp={}));var mp;(function(n){n.None=0,n.Full=1,n.Incremental=2})(mp||(_.TextDocumentSyncKind=mp={}));var vp;(function(n){n.method="textDocument/didOpen",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(vp||(_.DidOpenTextDocumentNotification=vp={}));var yp;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(yp||(_.TextDocumentContentChangeEvent=yp={}));var _p;(function(n){n.method="textDocument/didChange",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(_p||(_.DidChangeTextDocumentNotification=_p={}));var bp;(function(n){n.method="textDocument/didClose",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(bp||(_.DidCloseTextDocumentNotification=bp={}));var Cp;(function(n){n.method="textDocument/didSave",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(Cp||(_.DidSaveTextDocumentNotification=Cp={}));var wp;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(wp||(_.TextDocumentSaveReason=wp={}));var Dp;(function(n){n.method="textDocument/willSave",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(Dp||(_.WillSaveTextDocumentNotification=Dp={}));var Sp;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Sp||(_.WillSaveTextDocumentWaitUntilRequest=Sp={}));var Rp;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolNotificationType(n.method)})(Rp||(_.DidChangeWatchedFilesNotification=Rp={}));var Tp;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(Tp||(_.FileChangeType=Tp={}));var Pp;(function(n){function e(t){let r=t;return at.objectLiteral(r)&&(Jh.URI.is(r.baseUri)||Jh.WorkspaceFolder.is(r.baseUri))&&at.string(r.pattern)}n.is=e})(Pp||(_.RelativePattern=Pp={}));var Ip;(function(n){n.Create=1,n.Change=2,n.Delete=4})(Ip||(_.WatchKind=Ip={}));var Ep;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolNotificationType(n.method)})(Ep||(_.PublishDiagnosticsNotification=Ep={}));var xp;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(xp||(_.CompletionTriggerKind=xp={}));var qp;(function(n){n.method="textDocument/completion",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(qp||(_.CompletionRequest=qp={}));var kp;(function(n){n.method="completionItem/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(kp||(_.CompletionResolveRequest=kp={}));var Op;(function(n){n.method="textDocument/hover",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Op||(_.HoverRequest=Op={}));var Lp;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(Lp||(_.SignatureHelpTriggerKind=Lp={}));var Fp;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Fp||(_.SignatureHelpRequest=Fp={}));var Np;(function(n){n.method="textDocument/definition",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Np||(_.DefinitionRequest=Np={}));var Mp;(function(n){n.method="textDocument/references",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Mp||(_.ReferencesRequest=Mp={}));var Ap;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Ap||(_.DocumentHighlightRequest=Ap={}));var jp;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(jp||(_.DocumentSymbolRequest=jp={}));var $p;(function(n){n.method="textDocument/codeAction",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})($p||(_.CodeActionRequest=$p={}));var Hp;(function(n){n.method="codeAction/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Hp||(_.CodeActionResolveRequest=Hp={}));var Up;(function(n){n.method="workspace/symbol",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Up||(_.WorkspaceSymbolRequest=Up={}));var Wp;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Wp||(_.WorkspaceSymbolResolveRequest=Wp={}));var Kp;(function(n){n.method="textDocument/codeLens",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Kp||(_.CodeLensRequest=Kp={}));var Bp;(function(n){n.method="codeLens/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Bp||(_.CodeLensResolveRequest=Bp={}));var zp;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType0(n.method)})(zp||(_.CodeLensRefreshRequest=zp={}));var Xp;(function(n){n.method="textDocument/documentLink",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Xp||(_.DocumentLinkRequest=Xp={}));var Gp;(function(n){n.method="documentLink/resolve",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Gp||(_.DocumentLinkResolveRequest=Gp={}));var Vp;(function(n){n.method="textDocument/formatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Vp||(_.DocumentFormattingRequest=Vp={}));var Jp;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Jp||(_.DocumentRangeFormattingRequest=Jp={}));var Zp;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Zp||(_.DocumentRangesFormattingRequest=Zp={}));var Qp;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(Qp||(_.DocumentOnTypeFormattingRequest=Qp={}));var Yp;(function(n){n.Identifier=1})(Yp||(_.PrepareSupportDefaultBehavior=Yp={}));var eg;(function(n){n.method="textDocument/rename",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(eg||(_.RenameRequest=eg={}));var tg;(function(n){n.method="textDocument/prepareRename",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(tg||(_.PrepareRenameRequest=tg={}));var ng;(function(n){n.method="workspace/executeCommand",n.messageDirection=j.MessageDirection.clientToServer,n.type=new j.ProtocolRequestType(n.method)})(ng||(_.ExecuteCommandRequest=ng={}));var rg;(function(n){n.method="workspace/applyEdit",n.messageDirection=j.MessageDirection.serverToClient,n.type=new j.ProtocolRequestType("workspace/applyEdit")})(rg||(_.ApplyWorkspaceEditRequest=rg={}))});var lg=x(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.createProtocolConnection=void 0;var ug=Dr();function O_(n,e,t,r){return ug.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,ug.createMessageConnection)(n,e,t,r)}Xs.createProtocolConnection=O_});var fg=x(Nt=>{"use strict";var L_=Nt&&Nt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Gs=Nt&&Nt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&L_(e,n,t)};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.LSPErrorCodes=Nt.createProtocolConnection=void 0;Gs(Dr(),Nt);Gs(qs(),Nt);Gs(Ae(),Nt);Gs(cg(),Nt);var F_=lg();Object.defineProperty(Nt,"createProtocolConnection",{enumerable:!0,get:function(){return F_.createProtocolConnection}});var dg;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(dg||(Nt.LSPErrorCodes=dg={}))});var ee=x(kn=>{"use strict";var N_=kn&&kn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),hg=kn&&kn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&N_(e,n,t)};Object.defineProperty(kn,"__esModule",{value:!0});kn.createProtocolConnection=void 0;var M_=lc();hg(lc(),kn);hg(fg(),kn);function A_(n,e,t,r){return(0,M_.createMessageConnection)(n,e,t,r)}kn.createProtocolConnection=A_});var Vs=x(Ct=>{"use strict";Object.defineProperty(Ct,"__esModule",{value:!0});Ct.forEach=Ct.mapAsync=Ct.map=Ct.clearTestMode=Ct.setTestMode=Ct.Semaphore=Ct.Delayer=void 0;var Mi=ee(),Pc=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Mi.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};Ct.Delayer=Pc;var Ic=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Mi.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Ct.Semaphore=Ic;var Ec=!1;function j_(){Ec=!0}Ct.setTestMode=j_;function $_(){Ec=!1}Ct.clearTestMode=$_;var pg=15,Ni=class{constructor(e=pg){this.yieldAfter=Ec===!0?Math.max(e,2):Math.max(e,pg),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function H_(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Ni(r?.yieldAfter);function o(u){s.start();for(let h=u;h<n.length;h++)if(i[h]=e(n[h]),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),h+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,Mi.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}Ct.map=H_;async function U_(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Ni(r?.yieldAfter);async function o(u){s.start();for(let h=u;h<n.length;h++)if(i[h]=await e(n[h],t),s.shouldYield())return r?.yieldCallback&&r.yieldCallback(),h+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,Mi.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}Ct.mapAsync=U_;async function W_(n,e,t,r){if(n.length===0)return;let i=new Ni(r?.yieldAfter);function s(a){i.start();for(let u=a;u<n.length;u++)if(e(n[u]),i.shouldYield())return r?.yieldCallback&&r.yieldCallback(),u+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,Mi.RAL)().timer.setImmediate(()=>{a(s(o))})})}Ct.forEach=W_});var kc=x(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});var K_=require("vscode"),xc=class extends K_.CompletionItem{constructor(e){super(e)}};qc.default=xc});var Fc=x(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});var B_=require("vscode"),Oc=class extends B_.CodeLens{constructor(e){super(e)}};Lc.default=Oc});var Ac=x(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});var z_=require("vscode"),Nc=class extends z_.DocumentLink{constructor(e,t){super(e,t)}};Mc.default=Nc});var Hc=x($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});var X_=require("vscode"),jc=class extends X_.CodeAction{constructor(e,t){super(e),this.data=t}};$c.default=jc});var Kc=x(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.ProtocolDiagnostic=ai.DiagnosticCode=void 0;var G_=require("vscode"),Uc=Yt(),gg;(function(n){function e(t){let r=t;return r!=null&&(Uc.number(r.value)||Uc.string(r.value))&&Uc.string(r.target)}n.is=e})(gg||(ai.DiagnosticCode=gg={}));var Wc=class extends G_.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}};ai.ProtocolDiagnostic=Wc});var Xc=x(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});var V_=require("vscode"),Bc=class extends V_.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};zc.default=Bc});var Jc=x(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});var J_=require("vscode"),Gc=class extends J_.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o),a!==void 0&&(this.data=a)}};Vc.default=Gc});var Yc=x(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});var Js=require("vscode"),Zc=class extends Js.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof Js.Uri);super(e,t,r,o?i:new Js.Location(i,new Js.Range(0,0,0,0))),this.hasRange=o,s!==void 0&&(this.data=s)}};Qc.default=Zc});var nu=x(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});var Z_=require("vscode"),eu=class extends Z_.InlayHint{constructor(e,t,r){super(e,t,r)}};tu.default=eu});var _g=x(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.createConverter=void 0;var nt=require("vscode"),ne=ee(),Rr=Yt(),mg=Vs(),Q_=kc(),Y_=Fc(),eb=Ac(),vg=Hc(),yg=Kc(),tb=Xc(),nb=Jc(),rb=Yc(),ib=nu(),ru;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(ru||(ru={}));function sb(n){let t=n||(d=>d.toString());function r(d){return t(d)}function i(d){return{uri:t(d.uri)}}function s(d){return{uri:t(d.uri),languageId:d.languageId,version:d.version,text:d.getText()}}function o(d){return{uri:t(d.uri),version:d.version}}function a(d){return{textDocument:s(d)}}function u(d){let I=d;return!!I.document&&!!I.contentChanges}function h(d){let I=d;return!!I.uri&&!!I.version}function p(d,I,K){if(h(d))return{textDocument:{uri:t(d.uri),version:d.version},contentChanges:[{text:d.getText()}]};if(u(d)){let Ce=I,R=K;return{textDocument:{uri:t(Ce),version:R},contentChanges:d.contentChanges.map(C=>{let w=C.range;return{range:{start:{line:w.start.line,character:w.start.character},end:{line:w.end.line,character:w.end.character}},rangeLength:C.rangeLength,text:C.text}})}}else throw Error("Unsupported text document change parameter")}function y(d){return{textDocument:i(d)}}function m(d,I=!1){let K={textDocument:i(d)};return I&&(K.text=d.getText()),K}function S(d){switch(d){case nt.TextDocumentSaveReason.Manual:return ne.TextDocumentSaveReason.Manual;case nt.TextDocumentSaveReason.AfterDelay:return ne.TextDocumentSaveReason.AfterDelay;case nt.TextDocumentSaveReason.FocusOut:return ne.TextDocumentSaveReason.FocusOut}return ne.TextDocumentSaveReason.Manual}function v(d){return{textDocument:i(d.document),reason:S(d.reason)}}function P(d){return{files:d.files.map(I=>({uri:t(I)}))}}function E(d){return{files:d.files.map(I=>({oldUri:t(I.oldUri),newUri:t(I.newUri)}))}}function F(d){return{files:d.files.map(I=>({uri:t(I)}))}}function M(d){return{files:d.files.map(I=>({uri:t(I)}))}}function N(d){return{files:d.files.map(I=>({oldUri:t(I.oldUri),newUri:t(I.newUri)}))}}function H(d){return{files:d.files.map(I=>({uri:t(I)}))}}function V(d,I){return{textDocument:i(d),position:dt(I)}}function de(d){switch(d){case nt.CompletionTriggerKind.TriggerCharacter:return ne.CompletionTriggerKind.TriggerCharacter;case nt.CompletionTriggerKind.TriggerForIncompleteCompletions:return ne.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return ne.CompletionTriggerKind.Invoked}}function B(d,I,K){return{textDocument:i(d),position:dt(I),context:{triggerKind:de(K.triggerKind),triggerCharacter:K.triggerCharacter}}}function Y(d){switch(d){case nt.SignatureHelpTriggerKind.Invoke:return ne.SignatureHelpTriggerKind.Invoked;case nt.SignatureHelpTriggerKind.TriggerCharacter:return ne.SignatureHelpTriggerKind.TriggerCharacter;case nt.SignatureHelpTriggerKind.ContentChange:return ne.SignatureHelpTriggerKind.ContentChange}}function ce(d){return{label:d.label}}function Ze(d){return d.map(ce)}function ze(d){return{label:d.label,parameters:Ze(d.parameters)}}function Ye(d){return d.map(ze)}function Jt(d){return d===void 0?d:{signatures:Ye(d.signatures),activeSignature:d.activeSignature,activeParameter:d.activeParameter}}function Rt(d,I,K){return{textDocument:i(d),position:dt(I),context:{isRetrigger:K.isRetrigger,triggerCharacter:K.triggerCharacter,triggerKind:Y(K.triggerKind),activeSignatureHelp:Jt(K.activeSignatureHelp)}}}function dt(d){return{line:d.line,character:d.character}}function ft(d){return d==null?d:{line:d.line>ne.uinteger.MAX_VALUE?ne.uinteger.MAX_VALUE:d.line,character:d.character>ne.uinteger.MAX_VALUE?ne.uinteger.MAX_VALUE:d.character}}function cn(d,I){return mg.map(d,ft,I)}function Cn(d){return d.map(ft)}function Oe(d){return d==null?d:{start:ft(d.start),end:ft(d.end)}}function qt(d){return d.map(Oe)}function Tt(d){return d==null?d:ne.Location.create(r(d.uri),Oe(d.range))}function ht(d){switch(d){case nt.DiagnosticSeverity.Error:return ne.DiagnosticSeverity.Error;case nt.DiagnosticSeverity.Warning:return ne.DiagnosticSeverity.Warning;case nt.DiagnosticSeverity.Information:return ne.DiagnosticSeverity.Information;case nt.DiagnosticSeverity.Hint:return ne.DiagnosticSeverity.Hint}}function Qn(d){if(!d)return;let I=[];for(let K of d){let Ce=wn(K);Ce!==void 0&&I.push(Ce)}return I.length>0?I:void 0}function wn(d){switch(d){case nt.DiagnosticTag.Unnecessary:return ne.DiagnosticTag.Unnecessary;case nt.DiagnosticTag.Deprecated:return ne.DiagnosticTag.Deprecated;default:return}}function Dn(d){return{message:d.message,location:Tt(d.location)}}function Ln(d){return d.map(Dn)}function Yn(d){if(d!=null)return Rr.number(d)||Rr.string(d)?d:{value:d.value,target:r(d.target)}}function Sn(d){let I=ne.Diagnostic.create(Oe(d.range),d.message),K=d instanceof yg.ProtocolDiagnostic?d:void 0;K!==void 0&&K.data!==void 0&&(I.data=K.data);let Ce=Yn(d.code);return yg.DiagnosticCode.is(Ce)?K!==void 0&&K.hasDiagnosticCode?I.code=Ce:(I.code=Ce.value,I.codeDescription={href:Ce.target}):I.code=Ce,Rr.number(d.severity)&&(I.severity=ht(d.severity)),Array.isArray(d.tags)&&(I.tags=Qn(d.tags)),d.relatedInformation&&(I.relatedInformation=Ln(d.relatedInformation)),d.source&&(I.source=d.source),I}function un(d,I){return d==null?d:mg.map(d,Sn,I)}function ln(d){return d==null?d:d.map(Sn)}function Rn(d,I){switch(d){case"$string":return I;case ne.MarkupKind.PlainText:return{kind:d,value:I};case ne.MarkupKind.Markdown:return{kind:d,value:I.value};default:return`Unsupported Markup content received. Kind is: ${d}`}}function et(d){switch(d){case nt.CompletionItemTag.Deprecated:return ne.CompletionItemTag.Deprecated}}function Fn(d){if(d===void 0)return d;let I=[];for(let K of d){let Ce=et(K);Ce!==void 0&&I.push(Ce)}return I}function dn(d,I){return I!==void 0?I:d+1}function Zt(d,I=!1){let K,Ce;Rr.string(d.label)?K=d.label:(K=d.label.label,I&&(d.label.detail!==void 0||d.label.description!==void 0)&&(Ce={detail:d.label.detail,description:d.label.description}));let R={label:K};Ce!==void 0&&(R.labelDetails=Ce);let f=d instanceof Q_.default?d:void 0;d.detail&&(R.detail=d.detail),d.documentation&&(!f||f.documentationFormat==="$string"?R.documentation=d.documentation:R.documentation=Rn(f.documentationFormat,d.documentation)),d.filterText&&(R.filterText=d.filterText),er(R,d),Rr.number(d.kind)&&(R.kind=dn(d.kind,f&&f.originalItemKind)),d.sortText&&(R.sortText=d.sortText),d.additionalTextEdits&&(R.additionalTextEdits=Qe(d.additionalTextEdits)),d.commitCharacters&&(R.commitCharacters=d.commitCharacters.slice()),d.command&&(R.command=W(d.command)),(d.preselect===!0||d.preselect===!1)&&(R.preselect=d.preselect);let C=Fn(d.tags);if(f){if(f.data!==void 0&&(R.data=f.data),f.deprecated===!0||f.deprecated===!1){if(f.deprecated===!0&&C!==void 0&&C.length>0){let w=C.indexOf(nt.CompletionItemTag.Deprecated);w!==-1&&C.splice(w,1)}R.deprecated=f.deprecated}f.insertTextMode!==void 0&&(R.insertTextMode=f.insertTextMode)}return C!==void 0&&C.length>0&&(R.tags=C),R.insertTextMode===void 0&&d.keepWhitespace===!0&&(R.insertTextMode=ne.InsertTextMode.adjustIndentation),R}function er(d,I){let K=ne.InsertTextFormat.PlainText,Ce,R;I.textEdit?(Ce=I.textEdit.newText,R=I.textEdit.range):I.insertText instanceof nt.SnippetString?(K=ne.InsertTextFormat.Snippet,Ce=I.insertText.value):Ce=I.insertText,I.range&&(R=I.range),d.insertTextFormat=K,I.fromEdit&&Ce!==void 0&&R!==void 0?d.textEdit=Qt(Ce,R):d.insertText=Ce}function Qt(d,I){return ru.is(I)?ne.InsertReplaceEdit.create(d,Oe(I.inserting),Oe(I.replacing)):{newText:d,range:Oe(I)}}function Tn(d){return{range:Oe(d.range),newText:d.newText}}function Qe(d){return d==null?d:d.map(Tn)}function vt(d){return d<=nt.SymbolKind.TypeParameter?d+1:ne.SymbolKind.Property}function pt(d){return d}function Ht(d){return d.map(pt)}function kt(d,I,K){return{textDocument:i(d),position:dt(I),context:{includeDeclaration:K.includeDeclaration}}}async function Pn(d,I){let K=ne.CodeAction.create(d.title);if(d instanceof vg.default&&d.data!==void 0&&(K.data=d.data),d.kind!==void 0&&(K.kind=b(d.kind)),d.diagnostics!==void 0&&(K.diagnostics=await un(d.diagnostics,I)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(K.command=W(d.command)),d.isPreferred!==void 0&&(K.isPreferred=d.isPreferred),d.disabled!==void 0&&(K.disabled={reason:d.disabled.reason}),K}function Nn(d){let I=ne.CodeAction.create(d.title);if(d instanceof vg.default&&d.data!==void 0&&(I.data=d.data),d.kind!==void 0&&(I.kind=b(d.kind)),d.diagnostics!==void 0&&(I.diagnostics=ln(d.diagnostics)),d.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return d.command!==void 0&&(I.command=W(d.command)),d.isPreferred!==void 0&&(I.isPreferred=d.isPreferred),d.disabled!==void 0&&(I.disabled={reason:d.disabled.reason}),I}async function fn(d,I){if(d==null)return d;let K;return d.only&&Rr.string(d.only.value)&&(K=[d.only.value]),ne.CodeActionContext.create(await un(d.diagnostics,I),K,Pt(d.triggerKind))}function Mn(d){if(d==null)return d;let I;return d.only&&Rr.string(d.only.value)&&(I=[d.only.value]),ne.CodeActionContext.create(ln(d.diagnostics),I,Pt(d.triggerKind))}function Pt(d){switch(d){case nt.CodeActionTriggerKind.Invoke:return ne.CodeActionTriggerKind.Invoked;case nt.CodeActionTriggerKind.Automatic:return ne.CodeActionTriggerKind.Automatic;default:return}}function b(d){if(d!=null)return d.value}function k(d){return d==null?d:ne.InlineValueContext.create(d.frameId,Oe(d.stoppedLocation))}function $(d,I,K){return{context:ne.InlineCompletionContext.create(K.triggerKind,K.selectedCompletionInfo),textDocument:i(d),position:ft(I)}}function W(d){let I=ne.Command.create(d.title,d.command);return d.arguments&&(I.arguments=d.arguments),I}function ye(d){let I=ne.CodeLens.create(Oe(d.range));return d.command&&(I.command=W(d.command)),d instanceof Y_.default&&d.data&&(I.data=d.data),I}function me(d,I){let K={tabSize:d.tabSize,insertSpaces:d.insertSpaces};return I.trimTrailingWhitespace&&(K.trimTrailingWhitespace=!0),I.trimFinalNewlines&&(K.trimFinalNewlines=!0),I.insertFinalNewline&&(K.insertFinalNewline=!0),K}function Re(d){return{textDocument:i(d)}}function Ie(d){return{textDocument:i(d)}}function se(d){let I=ne.DocumentLink.create(Oe(d.range));d.target&&(I.target=r(d.target)),d.tooltip!==void 0&&(I.tooltip=d.tooltip);let K=d instanceof eb.default?d:void 0;return K&&K.data&&(I.data=K.data),I}function be(d){return{textDocument:i(d)}}function fe(d){let I={name:d.name,kind:vt(d.kind),uri:r(d.uri),range:Oe(d.range),selectionRange:Oe(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(I.detail=d.detail),d.tags!==void 0&&(I.tags=Ht(d.tags)),d instanceof tb.default&&d.data!==void 0&&(I.data=d.data),I}function Ee(d){let I={name:d.name,kind:vt(d.kind),uri:r(d.uri),range:Oe(d.range),selectionRange:Oe(d.selectionRange)};return d.detail!==void 0&&d.detail.length>0&&(I.detail=d.detail),d.tags!==void 0&&(I.tags=Ht(d.tags)),d instanceof nb.default&&d.data!==void 0&&(I.data=d.data),I}function Xe(d){let I=d instanceof rb.default?{name:d.name,kind:vt(d.kind),location:d.hasRange?Tt(d.location):{uri:t(d.location.uri)},data:d.data}:{name:d.name,kind:vt(d.kind),location:Tt(d.location)};return d.tags!==void 0&&(I.tags=Ht(d.tags)),d.containerName!==""&&(I.containerName=d.containerName),I}function it(d){let I=typeof d.label=="string"?d.label:d.label.map(tr),K=ne.InlayHint.create(ft(d.position),I);return d.kind!==void 0&&(K.kind=d.kind),d.textEdits!==void 0&&(K.textEdits=Qe(d.textEdits)),d.tooltip!==void 0&&(K.tooltip=nr(d.tooltip)),d.paddingLeft!==void 0&&(K.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(K.paddingRight=d.paddingRight),d instanceof ib.default&&d.data!==void 0&&(K.data=d.data),K}function tr(d){let I=ne.InlayHintLabelPart.create(d.value);return d.location!==void 0&&(I.location=Tt(d.location)),d.command!==void 0&&(I.command=W(d.command)),d.tooltip!==void 0&&(I.tooltip=nr(d.tooltip)),I}function nr(d){return typeof d=="string"?d:{kind:ne.MarkupKind.Markdown,value:d.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:p,asCloseTextDocumentParams:y,asSaveTextDocumentParams:m,asWillSaveTextDocumentParams:v,asDidCreateFilesParams:P,asDidRenameFilesParams:E,asDidDeleteFilesParams:F,asWillCreateFilesParams:M,asWillRenameFilesParams:N,asWillDeleteFilesParams:H,asTextDocumentPositionParams:V,asCompletionParams:B,asSignatureHelpParams:Rt,asWorkerPosition:dt,asRange:Oe,asRanges:qt,asPosition:ft,asPositions:cn,asPositionsSync:Cn,asLocation:Tt,asDiagnosticSeverity:ht,asDiagnosticTag:wn,asDiagnostic:Sn,asDiagnostics:un,asDiagnosticsSync:ln,asCompletionItem:Zt,asTextEdit:Tn,asSymbolKind:vt,asSymbolTag:pt,asSymbolTags:Ht,asReferenceParams:kt,asCodeAction:Pn,asCodeActionSync:Nn,asCodeActionContext:fn,asCodeActionContextSync:Mn,asInlineValueContext:k,asCommand:W,asCodeLens:ye,asFormattingOptions:me,asDocumentSymbolParams:Re,asCodeLensParams:Ie,asDocumentLink:se,asDocumentLinkParams:be,asCallHierarchyItem:fe,asTypeHierarchyItem:Ee,asInlayHint:it,asWorkspaceSymbol:Xe,asInlineCompletionParams:$}}Zs.createConverter=sb});var wg=x(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.createConverter=void 0;var U=require("vscode"),Q=ee(),nn=Yt(),_e=Vs(),ob=kc(),ab=Fc(),cb=Ac(),ub=Hc(),bg=Kc(),lb=Xc(),db=Jc(),fb=Yc(),hb=nu(),Cg=ee(),Qs;(function(n){function e(t){let r=t;return r&&nn.string(r.language)&&nn.string(r.value)}n.is=e})(Qs||(Qs={}));function pb(n,e,t){let i=n||(c=>U.Uri.parse(c));function s(c){return i(c)}function o(c){let D=[];for(let L of c)if(typeof L=="string")D.push(L);else if(Cg.NotebookCellTextDocumentFilter.is(L))if(typeof L.notebook=="string")D.push({notebookType:L.notebook,language:L.language});else{let G=L.notebook.notebookType??"*";D.push({notebookType:G,scheme:L.notebook.scheme,pattern:L.notebook.pattern,language:L.language})}else Cg.TextDocumentFilter.is(L)&&D.push({language:L.language,scheme:L.scheme,pattern:L.pattern});return D}async function a(c,D){return _e.map(c,h,D)}function u(c){let D=new Array(c.length);for(let L=0;L<c.length;L++)D[L]=h(c[L]);return D}function h(c){let D=new bg.ProtocolDiagnostic(v(c.range),c.message,E(c.severity),c.data);if(c.code!==void 0){if(typeof c.code=="string"||typeof c.code=="number")Q.CodeDescription.is(c.codeDescription)?D.code={value:c.code,target:s(c.codeDescription.href)}:D.code=c.code;else if(bg.DiagnosticCode.is(c.code)){D.hasDiagnosticCode=!0;let L=c.code;D.code={value:L.value,target:s(L.target)}}}return c.source&&(D.source=c.source),c.relatedInformation&&(D.relatedInformation=p(c.relatedInformation)),Array.isArray(c.tags)&&(D.tags=y(c.tags)),D}function p(c){let D=new Array(c.length);for(let L=0;L<c.length;L++){let G=c[L];D[L]=new U.DiagnosticRelatedInformation(ht(G.location),G.message)}return D}function y(c){if(!c)return;let D=[];for(let L of c){let G=m(L);G!==void 0&&D.push(G)}return D.length>0?D:void 0}function m(c){switch(c){case Q.DiagnosticTag.Unnecessary:return U.DiagnosticTag.Unnecessary;case Q.DiagnosticTag.Deprecated:return U.DiagnosticTag.Deprecated;default:return}}function S(c){return c?new U.Position(c.line,c.character):void 0}function v(c){return c?new U.Range(c.start.line,c.start.character,c.end.line,c.end.character):void 0}async function P(c,D){return _e.map(c,L=>new U.Range(L.start.line,L.start.character,L.end.line,L.end.character),D)}function E(c){if(c==null)return U.DiagnosticSeverity.Error;switch(c){case Q.DiagnosticSeverity.Error:return U.DiagnosticSeverity.Error;case Q.DiagnosticSeverity.Warning:return U.DiagnosticSeverity.Warning;case Q.DiagnosticSeverity.Information:return U.DiagnosticSeverity.Information;case Q.DiagnosticSeverity.Hint:return U.DiagnosticSeverity.Hint}return U.DiagnosticSeverity.Error}function F(c){if(nn.string(c))return N(c);if(Qs.is(c))return N().appendCodeblock(c.value,c.language);if(Array.isArray(c)){let D=[];for(let L of c){let G=N();Qs.is(L)?G.appendCodeblock(L.value,L.language):G.appendMarkdown(L),D.push(G)}return D}else return N(c)}function M(c){if(nn.string(c))return c;switch(c.kind){case Q.MarkupKind.Markdown:return N(c.value);case Q.MarkupKind.PlainText:return c.value;default:return`Unsupported Markup content received. Kind is: ${c.kind}`}}function N(c){let D;if(c===void 0||typeof c=="string")D=new U.MarkdownString(c);else switch(c.kind){case Q.MarkupKind.Markdown:D=new U.MarkdownString(c.value);break;case Q.MarkupKind.PlainText:D=new U.MarkdownString,D.appendText(c.value);break;default:D=new U.MarkdownString,D.appendText(`Unsupported Markup content received. Kind is: ${c.kind}`);break}return D.isTrusted=e,D.supportHtml=t,D}function H(c){if(c)return new U.Hover(F(c.contents),v(c.range))}async function V(c,D,L){if(!c)return;if(Array.isArray(c))return _e.map(c,En=>Ze(En,D),L);let G=c,{defaultRange:st,commitCharacters:gt}=de(G,D),Pe=await _e.map(G.items,En=>Ze(En,gt,st,G.itemDefaults?.insertTextMode,G.itemDefaults?.insertTextFormat,G.itemDefaults?.data),L);return new U.CompletionList(Pe,G.isIncomplete)}function de(c,D){let L=c.itemDefaults?.editRange,G=c.itemDefaults?.commitCharacters??D;return Q.Range.is(L)?{defaultRange:v(L),commitCharacters:G}:L!==void 0?{defaultRange:{inserting:v(L.insert),replacing:v(L.replace)},commitCharacters:G}:{defaultRange:void 0,commitCharacters:G}}function B(c){return Q.CompletionItemKind.Text<=c&&c<=Q.CompletionItemKind.TypeParameter?[c-1,void 0]:[U.CompletionItemKind.Text,c]}function Y(c){switch(c){case Q.CompletionItemTag.Deprecated:return U.CompletionItemTag.Deprecated}}function ce(c){if(c==null)return[];let D=[];for(let L of c){let G=Y(L);G!==void 0&&D.push(G)}return D}function Ze(c,D,L,G,st,gt){let Pe=ce(c.tags),En=ze(c),qe=new ob.default(En);c.detail&&(qe.detail=c.detail),c.documentation&&(qe.documentation=M(c.documentation),qe.documentationFormat=nn.string(c.documentation)?"$string":c.documentation.kind),c.filterText&&(qe.filterText=c.filterText);let us=Ye(c,L,st);if(us&&(qe.insertText=us.text,qe.range=us.range,qe.fromEdit=us.fromEdit),nn.number(c.kind)){let[wy,kd]=B(c.kind);qe.kind=wy,kd&&(qe.originalItemKind=kd)}c.sortText&&(qe.sortText=c.sortText),c.additionalTextEdits&&(qe.additionalTextEdits=ft(c.additionalTextEdits));let xd=c.commitCharacters!==void 0?nn.stringArray(c.commitCharacters)?c.commitCharacters:void 0:D;xd&&(qe.commitCharacters=xd.slice()),c.command&&(qe.command=Qe(c.command)),(c.deprecated===!0||c.deprecated===!1)&&(qe.deprecated=c.deprecated,c.deprecated===!0&&Pe.push(U.CompletionItemTag.Deprecated)),(c.preselect===!0||c.preselect===!1)&&(qe.preselect=c.preselect);let qd=c.data??gt;qd!==void 0&&(qe.data=qd),Pe.length>0&&(qe.tags=Pe);let ea=c.insertTextMode??G;return ea!==void 0&&(qe.insertTextMode=ea,ea===Q.InsertTextMode.asIs&&(qe.keepWhitespace=!0)),qe}function ze(c){return Q.CompletionItemLabelDetails.is(c.labelDetails)?{label:c.label,detail:c.labelDetails.detail,description:c.labelDetails.description}:c.label}function Ye(c,D,L){let G=c.insertTextFormat??L;if(c.textEdit!==void 0||D!==void 0){let[st,gt]=c.textEdit!==void 0?Jt(c.textEdit):[D,c.textEditText??c.label];return G===Q.InsertTextFormat.Snippet?{text:new U.SnippetString(gt),range:st,fromEdit:!0}:{text:gt,range:st,fromEdit:!0}}else return c.insertText?G===Q.InsertTextFormat.Snippet?{text:new U.SnippetString(c.insertText),fromEdit:!1}:{text:c.insertText,fromEdit:!1}:void 0}function Jt(c){return Q.InsertReplaceEdit.is(c)?[{inserting:v(c.insert),replacing:v(c.replace)},c.newText]:[v(c.range),c.newText]}function Rt(c){if(c)return new U.TextEdit(v(c.range),c.newText)}async function dt(c,D){if(c)return _e.map(c,Rt,D)}function ft(c){if(!c)return;let D=new Array(c.length);for(let L=0;L<c.length;L++)D[L]=Rt(c[L]);return D}async function cn(c,D){if(!c)return;let L=new U.SignatureHelp;return nn.number(c.activeSignature)?L.activeSignature=c.activeSignature:L.activeSignature=0,nn.number(c.activeParameter)?L.activeParameter=c.activeParameter:L.activeParameter=0,c.signatures&&(L.signatures=await Cn(c.signatures,D)),L}async function Cn(c,D){return _e.mapAsync(c,Oe,D)}async function Oe(c,D){let L=new U.SignatureInformation(c.label);return c.documentation!==void 0&&(L.documentation=M(c.documentation)),c.parameters!==void 0&&(L.parameters=await qt(c.parameters,D)),c.activeParameter!==void 0&&(L.activeParameter=c.activeParameter),L}function qt(c,D){return _e.map(c,Tt,D)}function Tt(c){let D=new U.ParameterInformation(c.label);return c.documentation&&(D.documentation=M(c.documentation)),D}function ht(c){return c?new U.Location(i(c.uri),v(c.range)):void 0}async function Qn(c,D){if(c)return Ln(c,D)}async function wn(c,D){if(c)return Ln(c,D)}function Dn(c){if(!c)return;let D={targetUri:i(c.targetUri),targetRange:v(c.targetRange),originSelectionRange:v(c.originSelectionRange),targetSelectionRange:v(c.targetSelectionRange)};if(!D.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return D}async function Ln(c,D){if(c)if(nn.array(c)){if(c.length===0)return[];if(Q.LocationLink.is(c[0])){let L=c;return _e.map(L,Dn,D)}else{let L=c;return _e.map(L,ht,D)}}else return Q.LocationLink.is(c)?[Dn(c)]:ht(c)}async function Yn(c,D){if(c)return _e.map(c,ht,D)}async function Sn(c,D){if(c)return _e.map(c,un,D)}function un(c){let D=new U.DocumentHighlight(v(c.range));return nn.number(c.kind)&&(D.kind=ln(c.kind)),D}function ln(c){switch(c){case Q.DocumentHighlightKind.Text:return U.DocumentHighlightKind.Text;case Q.DocumentHighlightKind.Read:return U.DocumentHighlightKind.Read;case Q.DocumentHighlightKind.Write:return U.DocumentHighlightKind.Write}return U.DocumentHighlightKind.Text}async function Rn(c,D){if(c)return _e.map(c,Zt,D)}function et(c){return c<=Q.SymbolKind.TypeParameter?c-1:U.SymbolKind.Property}function Fn(c){switch(c){case Q.SymbolTag.Deprecated:return U.SymbolTag.Deprecated;default:return}}function dn(c){if(c==null)return;let D=[];for(let L of c){let G=Fn(L);G!==void 0&&D.push(G)}return D.length===0?void 0:D}function Zt(c){let D=c.data,L=c.location,G=L.range===void 0||D!==void 0?new fb.default(c.name,et(c.kind),c.containerName??"",L.range===void 0?i(L.uri):new U.Location(i(c.location.uri),v(L.range)),D):new U.SymbolInformation(c.name,et(c.kind),c.containerName??"",new U.Location(i(c.location.uri),v(L.range)));return Tn(G,c),G}async function er(c,D){if(c!=null)return _e.map(c,Qt,D)}function Qt(c){let D=new U.DocumentSymbol(c.name,c.detail||"",et(c.kind),v(c.range),v(c.selectionRange));if(Tn(D,c),c.children!==void 0&&c.children.length>0){let L=[];for(let G of c.children)L.push(Qt(G));D.children=L}return D}function Tn(c,D){c.tags=dn(D.tags),D.deprecated&&(c.tags?c.tags.includes(U.SymbolTag.Deprecated)||(c.tags=c.tags.concat(U.SymbolTag.Deprecated)):c.tags=[U.SymbolTag.Deprecated])}function Qe(c){let D={title:c.title,command:c.command};return c.arguments&&(D.arguments=c.arguments),D}async function vt(c,D){if(c)return _e.map(c,Qe,D)}let pt=new Map;pt.set(Q.CodeActionKind.Empty,U.CodeActionKind.Empty),pt.set(Q.CodeActionKind.QuickFix,U.CodeActionKind.QuickFix),pt.set(Q.CodeActionKind.Refactor,U.CodeActionKind.Refactor),pt.set(Q.CodeActionKind.RefactorExtract,U.CodeActionKind.RefactorExtract),pt.set(Q.CodeActionKind.RefactorInline,U.CodeActionKind.RefactorInline),pt.set(Q.CodeActionKind.RefactorRewrite,U.CodeActionKind.RefactorRewrite),pt.set(Q.CodeActionKind.Source,U.CodeActionKind.Source),pt.set(Q.CodeActionKind.SourceOrganizeImports,U.CodeActionKind.SourceOrganizeImports);function Ht(c){if(c==null)return;let D=pt.get(c);if(D)return D;let L=c.split(".");D=U.CodeActionKind.Empty;for(let G of L)D=D.append(G);return D}function kt(c){if(c!=null)return c.map(D=>Ht(D))}async function Pn(c,D){if(c==null)return;let L=new ub.default(c.title,c.data);return c.kind!==void 0&&(L.kind=Ht(c.kind)),c.diagnostics!==void 0&&(L.diagnostics=u(c.diagnostics)),c.edit!==void 0&&(L.edit=await Pt(c.edit,D)),c.command!==void 0&&(L.command=Qe(c.command)),c.isPreferred!==void 0&&(L.isPreferred=c.isPreferred),c.disabled!==void 0&&(L.disabled={reason:c.disabled.reason}),L}function Nn(c,D){return _e.mapAsync(c,async L=>Q.Command.is(L)?Qe(L):Pn(L,D),D)}function fn(c){if(!c)return;let D=new ab.default(v(c.range));return c.command&&(D.command=Qe(c.command)),c.data!==void 0&&c.data!==null&&(D.data=c.data),D}async function Mn(c,D){if(c)return _e.map(c,fn,D)}async function Pt(c,D){if(!c)return;let L=new Map;if(c.changeAnnotations!==void 0){let gt=c.changeAnnotations;await _e.forEach(Object.keys(gt),Pe=>{let En=b(gt[Pe]);L.set(Pe,En)},D)}let G=gt=>{if(gt!==void 0)return L.get(gt)},st=new U.WorkspaceEdit;if(c.documentChanges){let gt=c.documentChanges;await _e.forEach(gt,Pe=>{if(Q.CreateFile.is(Pe))st.createFile(i(Pe.uri),Pe.options,G(Pe.annotationId));else if(Q.RenameFile.is(Pe))st.renameFile(i(Pe.oldUri),i(Pe.newUri),Pe.options,G(Pe.annotationId));else if(Q.DeleteFile.is(Pe))st.deleteFile(i(Pe.uri),Pe.options,G(Pe.annotationId));else if(Q.TextDocumentEdit.is(Pe)){let En=i(Pe.textDocument.uri);for(let qe of Pe.edits)Q.AnnotatedTextEdit.is(qe)?st.replace(En,v(qe.range),qe.newText,G(qe.annotationId)):st.replace(En,v(qe.range),qe.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Pe,void 0,4)}`)},D)}else if(c.changes){let gt=c.changes;await _e.forEach(Object.keys(gt),Pe=>{st.set(i(Pe),ft(gt[Pe]))},D)}return st}function b(c){if(c!==void 0)return{label:c.label,needsConfirmation:!!c.needsConfirmation,description:c.description}}function k(c){let D=v(c.range),L=c.target?s(c.target):void 0,G=new cb.default(D,L);return c.tooltip!==void 0&&(G.tooltip=c.tooltip),c.data!==void 0&&c.data!==null&&(G.data=c.data),G}async function $(c,D){if(c)return _e.map(c,k,D)}function W(c){return new U.Color(c.red,c.green,c.blue,c.alpha)}function ye(c){return new U.ColorInformation(v(c.range),W(c.color))}async function me(c,D){if(c)return _e.map(c,ye,D)}function Re(c){let D=new U.ColorPresentation(c.label);return D.additionalTextEdits=ft(c.additionalTextEdits),c.textEdit&&(D.textEdit=Rt(c.textEdit)),D}async function Ie(c,D){if(c)return _e.map(c,Re,D)}function se(c){if(c)switch(c){case Q.FoldingRangeKind.Comment:return U.FoldingRangeKind.Comment;case Q.FoldingRangeKind.Imports:return U.FoldingRangeKind.Imports;case Q.FoldingRangeKind.Region:return U.FoldingRangeKind.Region}}function be(c){return new U.FoldingRange(c.startLine,c.endLine,se(c.kind))}async function fe(c,D){if(c)return _e.map(c,be,D)}function Ee(c){return new U.SelectionRange(v(c.range),c.parent?Ee(c.parent):void 0)}async function Xe(c,D){return Array.isArray(c)?_e.map(c,Ee,D):[]}function it(c){return Q.InlineValueText.is(c)?new U.InlineValueText(v(c.range),c.text):Q.InlineValueVariableLookup.is(c)?new U.InlineValueVariableLookup(v(c.range),c.variableName,c.caseSensitiveLookup):new U.InlineValueEvaluatableExpression(v(c.range),c.expression)}async function tr(c,D){return Array.isArray(c)?_e.map(c,it,D):[]}async function nr(c,D){let L=typeof c.label=="string"?c.label:await _e.map(c.label,d,D),G=new hb.default(S(c.position),L);return c.kind!==void 0&&(G.kind=c.kind),c.textEdits!==void 0&&(G.textEdits=await dt(c.textEdits,D)),c.tooltip!==void 0&&(G.tooltip=I(c.tooltip)),c.paddingLeft!==void 0&&(G.paddingLeft=c.paddingLeft),c.paddingRight!==void 0&&(G.paddingRight=c.paddingRight),c.data!==void 0&&(G.data=c.data),G}function d(c){let D=new U.InlayHintLabelPart(c.value);return c.location!==void 0&&(D.location=ht(c.location)),c.tooltip!==void 0&&(D.tooltip=I(c.tooltip)),c.command!==void 0&&(D.command=Qe(c.command)),D}function I(c){return typeof c=="string"?c:N(c)}async function K(c,D){if(Array.isArray(c))return _e.mapAsync(c,nr,D)}function Ce(c){if(c===null)return;let D=new lb.default(et(c.kind),c.name,c.detail||"",s(c.uri),v(c.range),v(c.selectionRange),c.data);return c.tags!==void 0&&(D.tags=dn(c.tags)),D}async function R(c,D){if(c!==null)return _e.map(c,Ce,D)}async function f(c,D){return new U.CallHierarchyIncomingCall(Ce(c.from),await P(c.fromRanges,D))}async function C(c,D){if(c!==null)return _e.mapAsync(c,f,D)}async function w(c,D){return new U.CallHierarchyOutgoingCall(Ce(c.to),await P(c.fromRanges,D))}async function g(c,D){if(c!==null)return _e.mapAsync(c,w,D)}async function l(c,D){if(c!=null)return new U.SemanticTokens(new Uint32Array(c.data),c.resultId)}function T(c){return new U.SemanticTokensEdit(c.start,c.deleteCount,c.data!==void 0?new Uint32Array(c.data):void 0)}async function O(c,D){if(c!=null)return new U.SemanticTokensEdits(c.edits.map(T),c.resultId)}function te(c){return c}async function Me(c,D){if(c!=null)return new U.LinkedEditingRanges(await P(c.ranges,D),xe(c.wordPattern))}function xe(c){if(c!=null)return new RegExp(c)}function Ot(c){if(c===null)return;let D=new db.default(et(c.kind),c.name,c.detail||"",s(c.uri),v(c.range),v(c.selectionRange),c.data);return c.tags!==void 0&&(D.tags=dn(c.tags)),D}async function Ut(c,D){if(c!==null)return _e.map(c,Ot,D)}function hn(c){if(nn.string(c))return c;if(Q.RelativePattern.is(c)){if(Q.URI.is(c.baseUri))return new U.RelativePattern(s(c.baseUri),c.pattern);if(Q.WorkspaceFolder.is(c.baseUri)){let D=U.workspace.getWorkspaceFolder(s(c.baseUri.uri));return D!==void 0?new U.RelativePattern(D,c.pattern):void 0}}}async function le(c,D){if(!c)return;if(Array.isArray(c))return _e.map(c,st=>In(st),D);let L=c,G=await _e.map(L.items,st=>In(st),D);return new U.InlineCompletionList(G)}function In(c){let D;typeof c.insertText=="string"?D=c.insertText:D=new U.SnippetString(c.insertText.value);let L;c.command&&(L=Qe(c.command));let G=new U.InlineCompletionItem(D,v(c.range),L);return c.filterText&&(G.filterText=c.filterText),G}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:h,asRange:v,asRanges:P,asPosition:S,asDiagnosticSeverity:E,asDiagnosticTag:m,asHover:H,asCompletionResult:V,asCompletionItem:Ze,asTextEdit:Rt,asTextEdits:dt,asSignatureHelp:cn,asSignatureInformations:Cn,asSignatureInformation:Oe,asParameterInformations:qt,asParameterInformation:Tt,asDeclarationResult:Qn,asDefinitionResult:wn,asLocation:ht,asReferences:Yn,asDocumentHighlights:Sn,asDocumentHighlight:un,asDocumentHighlightKind:ln,asSymbolKind:et,asSymbolTag:Fn,asSymbolTags:dn,asSymbolInformations:Rn,asSymbolInformation:Zt,asDocumentSymbols:er,asDocumentSymbol:Qt,asCommand:Qe,asCommands:vt,asCodeAction:Pn,asCodeActionKind:Ht,asCodeActionKinds:kt,asCodeActionResult:Nn,asCodeLens:fn,asCodeLenses:Mn,asWorkspaceEdit:Pt,asDocumentLink:k,asDocumentLinks:$,asFoldingRangeKind:se,asFoldingRange:be,asFoldingRanges:fe,asColor:W,asColorInformation:ye,asColorInformations:me,asColorPresentation:Re,asColorPresentations:Ie,asSelectionRange:Ee,asSelectionRanges:Xe,asInlineValue:it,asInlineValues:tr,asInlayHint:nr,asInlayHints:K,asSemanticTokensLegend:te,asSemanticTokens:l,asSemanticTokensEdit:T,asSemanticTokensEdits:O,asCallHierarchyItem:Ce,asCallHierarchyItems:R,asCallHierarchyIncomingCall:f,asCallHierarchyIncomingCalls:C,asCallHierarchyOutgoingCall:w,asCallHierarchyOutgoingCalls:g,asLinkedEditingRanges:Me,asTypeHierarchyItem:Ot,asTypeHierarchyItems:Ut,asGlobPattern:hn,asInlineCompletionResult:le,asInlineCompletionItem:In}}Ys.createConverter=pb});var je=x(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.generateUuid=rn.parse=rn.isUUID=rn.v4=rn.empty=void 0;var Ai=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},oe=class extends Ai{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return oe._oneOf(oe._chars)}constructor(){super([oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),"-",oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),"-","4",oe._randomHex(),oe._randomHex(),oe._randomHex(),"-",oe._oneOf(oe._timeHighBits),oe._randomHex(),oe._randomHex(),oe._randomHex(),"-",oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex(),oe._randomHex()].join(""))}};oe._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];oe._timeHighBits=["8","9","a","b"];rn.empty=new Ai("00000000-0000-0000-0000-000000000000");function Dg(){return new oe}rn.v4=Dg;var gb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Sg(n){return gb.test(n)}rn.isUUID=Sg;function mb(n){if(!Sg(n))throw new Error("invalid uuid");return new Ai(n)}rn.parse=mb;function vb(){return Dg().asHex()}rn.generateUuid=vb});var su=x(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.ProgressPart=void 0;var Rg=require("vscode"),Tg=ee(),Pg=Yt(),iu=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Tg.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Rg.window.withProgress({location:Rg.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Tg.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&Pg.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Pg.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};eo.ProgressPart=iu});var ve=x(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.WorkspaceFeature=ct.TextDocumentLanguageFeature=ct.TextDocumentEventFeature=ct.DynamicDocumentFeature=ct.DynamicFeature=ct.StaticFeature=ct.ensure=ct.LSPCancellationError=void 0;var Tr=require("vscode"),ou=ee(),It=Yt(),Ig=je(),au=class extends Tr.CancellationError{constructor(e){super(),this.data=e}};ct.LSPCancellationError=au;function yb(n,e){return n[e]===void 0&&(n[e]={}),n[e]}ct.ensure=yb;var Eg;(function(n){function e(t){let r=t;return r!=null&&It.func(r.fillClientCapabilities)&&It.func(r.initialize)&&It.func(r.getState)&&It.func(r.clear)&&(r.fillInitializeParams===void 0||It.func(r.fillInitializeParams))}n.is=e})(Eg||(ct.StaticFeature=Eg={}));var xg;(function(n){function e(t){let r=t;return r!=null&&It.func(r.fillClientCapabilities)&&It.func(r.initialize)&&It.func(r.getState)&&It.func(r.clear)&&(r.fillInitializeParams===void 0||It.func(r.fillInitializeParams))&&It.func(r.register)&&It.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(xg||(ct.DynamicFeature=xg={}));var ji=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of Tr.workspace.textDocuments)if(Tr.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};ct.DynamicDocumentFeature=ji;var cu=class extends ji{static textDocumentFilter(e,t){for(let r of e)if(Tr.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,s,o,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Tr.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Tr.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};ct.TextDocumentEventFeature=cu;var uu=class extends ji{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(ou.TextDocumentRegistrationOptions.is(t)){let r=ou.StaticRegistrationOptions.hasId(t)?t.id:Ig.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(It.boolean(t)&&t===!0||ou.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=It.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Ig.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return It.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Tr.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};ct.TextDocumentLanguageFeature=uu;var lu=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};ct.WorkspaceFeature=lu});var kg=x((WS,qg)=>{var _b=typeof process=="object"&&process&&process.platform==="win32";qg.exports=_b?{sep:"\\"}:{sep:"/"}});var Mg=x((KS,Ng)=>{"use strict";Ng.exports=Lg;function Lg(n,e,t){n instanceof RegExp&&(n=Og(n,t)),e instanceof RegExp&&(e=Og(e,t));var r=Fg(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Og(n,e){var t=e.match(n);return t?t[0]:null}Lg.range=Fg;function Fg(n,e,t){var r,i,s,o,a,u=t.indexOf(n),h=t.indexOf(e,u+1),p=u;if(u>=0&&h>0){if(n===e)return[u,h];for(r=[],s=t.length;p>=0&&!a;)p==u?(r.push(p),u=t.indexOf(n,p+1)):r.length==1?a=[r.pop(),h]:(i=r.pop(),i<s&&(s=i,o=h),h=t.indexOf(e,p+1)),p=u<h&&u>=0?u:h;r.length&&(a=[s,o])}return a}});var Bg=x((BS,Kg)=>{var Ag=Mg();Kg.exports=wb;var jg="\0SLASH"+Math.random()+"\0",$g="\0OPEN"+Math.random()+"\0",fu="\0CLOSE"+Math.random()+"\0",Hg="\0COMMA"+Math.random()+"\0",Ug="\0PERIOD"+Math.random()+"\0";function du(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function bb(n){return n.split("\\\\").join(jg).split("\\{").join($g).split("\\}").join(fu).split("\\,").join(Hg).split("\\.").join(Ug)}function Cb(n){return n.split(jg).join("\\").split($g).join("{").split(fu).join("}").split(Hg).join(",").split(Ug).join(".")}function Wg(n){if(!n)return[""];var e=[],t=Ag("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=Wg(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function wb(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),$i(bb(n),!0).map(Cb)):[]}function Db(n){return"{"+n+"}"}function Sb(n){return/^-?0\d/.test(n)}function Rb(n,e){return n<=e}function Tb(n,e){return n>=e}function $i(n,e){var t=[],r=Ag("{","}",n);if(!r)return[n];var i=r.pre,s=r.post.length?$i(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<s.length;o++){var a=i+"{"+r.body+"}"+s[o];t.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),h=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),p=u||h,y=r.body.indexOf(",")>=0;if(!p&&!y)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+fu+r.post,$i(n)):[n];var m;if(p)m=r.body.split(/\.\./);else if(m=Wg(r.body),m.length===1&&(m=$i(m[0],!1).map(Db),m.length===1))return s.map(function(Ze){return r.pre+m[0]+Ze});var S;if(p){var v=du(m[0]),P=du(m[1]),E=Math.max(m[0].length,m[1].length),F=m.length==3?Math.abs(du(m[2])):1,M=Rb,N=P<v;N&&(F*=-1,M=Tb);var H=m.some(Sb);S=[];for(var V=v;M(V,P);V+=F){var de;if(h)de=String.fromCharCode(V),de==="\\"&&(de="");else if(de=String(V),H){var B=E-de.length;if(B>0){var Y=new Array(B+1).join("0");V<0?de="-"+Y+de.slice(1):de=Y+de}}S.push(de)}}else{S=[];for(var ce=0;ce<m.length;ce++)S.push.apply(S,$i(m[ce],!1))}for(var ce=0;ce<S.length;ce++)for(var o=0;o<s.length;o++){var a=i+S[ce]+s[o];(!e||p||a)&&t.push(a)}}return t}});var no=x((XS,vu)=>{var Bt=vu.exports=(n,e,t={})=>(to(e),!t.nocomment&&e.charAt(0)==="#"?!1:new ci(e,t).match(n));vu.exports=Bt;var gu=kg();Bt.sep=gu.sep;var mn=Symbol("globstar **");Bt.GLOBSTAR=mn;var Pb=Bg(),zg={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},mu="[^/]",hu=mu+"*?",Ib="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Eb="(?:(?!(?:\\/|^)\\.).)*?",Vg=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),Xg=Vg("().*{}+?[]^$\\!"),xb=Vg("[.("),Gg=/\/+/;Bt.filter=(n,e={})=>(t,r,i)=>Bt(t,n,e);var hr=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Bt.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Bt;let e=Bt,t=(r,i,s)=>e(r,i,hr(n,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,hr(n,s))}},t.Minimatch.defaults=r=>e.defaults(hr(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,hr(n,i)),t.defaults=r=>e.defaults(hr(n,r)),t.makeRe=(r,i)=>e.makeRe(r,hr(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,hr(n,i)),t.match=(r,i,s)=>e.match(r,i,hr(n,s)),t};Bt.braceExpand=(n,e)=>Jg(n,e);var Jg=(n,e={})=>(to(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:Pb(n)),qb=1024*64,to=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>qb)throw new TypeError("pattern is too long")},pu=Symbol("subparse");Bt.makeRe=(n,e)=>new ci(n,e||{}).makeRe();Bt.match=(n,e,t={})=>{let r=new ci(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var kb=n=>n.replace(/\\(.)/g,"$1"),Ob=n=>n.replace(/\\([^-\]])/g,"$1"),Lb=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Fb=n=>n.replace(/[[\]\\]/g,"\\$&"),ci=class{constructor(e,t){to(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Gg)),this.debug(this.pattern,r),r=r.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,u=t.length;s<a&&o<u;s++,o++){this.debug("matchOne loop");var h=t[o],p=e[s];if(this.debug(t,h,p),h===!1)return!1;if(h===mn){this.debug("GLOBSTAR",[t,h,p]);var y=s,m=o+1;if(m===u){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;y<a;){var S=e[y];if(this.debug(`
globstar while`,e,y,t,m,S),this.matchOne(e.slice(y),t.slice(m),r))return this.debug("globstar found match!",y,a,S),!0;if(S==="."||S===".."||!i.dot&&S.charAt(0)==="."){this.debug("dot detected!",e,y,t,m);break}this.debug("globstar swallow a segment, and continue"),y++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,y,t,m),y===a))}var v;if(typeof h=="string"?(v=p===h,this.debug("string match",h,p,v)):(v=p.match(h),this.debug("pattern match",h,p,v)),!v)return!1}if(s===a&&o===u)return!0;if(s===a)return r;if(o===u)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return Jg(this.pattern,this.options)}parse(e,t){to(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return mn;if(e==="")return"";let i="",s=!1,o=!1,a=[],u=[],h,p=!1,y=-1,m=-1,S,v,P,E=e.charAt(0)===".",F=r.dot||E,M=()=>E?"":F?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",N=B=>B.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",H=()=>{if(h){switch(h){case"*":i+=hu,s=!0;break;case"?":i+=mu,s=!0;break;default:i+="\\"+h;break}this.debug("clearStateChar %j %j",h,i),h=!1}};for(let B=0,Y;B<e.length&&(Y=e.charAt(B));B++){if(this.debug("%s	%s %s %j",e,B,i,Y),o){if(Y==="/")return!1;Xg[Y]&&(i+="\\"),i+=Y,o=!1;continue}switch(Y){case"/":return!1;case"\\":if(p&&e.charAt(B+1)==="-"){i+=Y;continue}H(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,B,i,Y),p){this.debug("  in class"),Y==="!"&&B===m+1&&(Y="^"),i+=Y;continue}this.debug("call clearStateChar %j",h),H(),h=Y,r.noext&&H();continue;case"(":{if(p){i+="(";continue}if(!h){i+="\\(";continue}let ce={type:h,start:B-1,reStart:i.length,open:zg[h].open,close:zg[h].close};this.debug(this.pattern,"	",ce),a.push(ce),i+=ce.open,ce.start===0&&ce.type!=="!"&&(E=!0,i+=N(e.slice(B+1))),this.debug("plType %j %j",h,i),h=!1;continue}case")":{let ce=a[a.length-1];if(p||!ce){i+="\\)";continue}a.pop(),H(),s=!0,v=ce,i+=v.close,v.type==="!"&&u.push(Object.assign(v,{reEnd:i.length}));continue}case"|":{let ce=a[a.length-1];if(p||!ce){i+="\\|";continue}H(),i+="|",ce.start===0&&ce.type!=="!"&&(E=!0,i+=N(e.slice(B+1)));continue}case"[":if(H(),p){i+="\\"+Y;continue}p=!0,m=B,y=i.length,i+=Y;continue;case"]":if(B===m+1||!p){i+="\\"+Y;continue}S=e.substring(m+1,B);try{RegExp("["+Fb(Ob(S))+"]"),i+=Y}catch{i=i.substring(0,y)+"(?:$.)"}s=!0,p=!1;continue;default:H(),Xg[Y]&&!(Y==="^"&&p)&&(i+="\\"),i+=Y;break}}for(p&&(S=e.slice(m+1),P=this.parse(S,pu),i=i.substring(0,y)+"\\["+P[0],s=s||P[1]),v=a.pop();v;v=a.pop()){let B;B=i.slice(v.reStart+v.open.length),this.debug("setting tail",i,v),B=B.replace(/((?:\\{2}){0,64})(\\?)\|/g,(ce,Ze,ze)=>(ze||(ze="\\"),Ze+Ze+ze+"|")),this.debug(`tail=%j
   %s`,B,B,v,i);let Y=v.type==="*"?hu:v.type==="?"?mu:"\\"+v.type;s=!0,i=i.slice(0,v.reStart)+Y+"\\("+B}H(),o&&(i+="\\\\");let V=xb[i.charAt(0)];for(let B=u.length-1;B>-1;B--){let Y=u[B],ce=i.slice(0,Y.reStart),Ze=i.slice(Y.reStart,Y.reEnd-8),ze=i.slice(Y.reEnd),Ye=i.slice(Y.reEnd-8,Y.reEnd)+ze,Jt=ce.split(")").length,Rt=ce.split("(").length-Jt,dt=ze;for(let cn=0;cn<Rt;cn++)dt=dt.replace(/\)[+*?]?/,"");ze=dt;let ft=ze===""&&t!==pu?"(?:$|\\/)":"";i=ce+Ze+ze+ft+Ye}if(i!==""&&s&&(i="(?=.)"+i),V&&(i=M()+i),t===pu)return[i,s];if(r.nocase&&!s&&(s=e.toUpperCase()!==e.toLowerCase()),!s)return kb(e);let de=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",de),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?hu:t.dot?Ib:Eb,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?Lb(a):a===mn?mn:a._src).reduce((a,u)=>(a[a.length-1]===mn&&u===mn||a.push(u),a),[]),o.forEach((a,u)=>{a!==mn||o[u-1]===mn||(u===0?o.length>1?o[u+1]="(?:\\/|"+r+"\\/)?"+o[u+1]:o[u]=r:u===o.length-1?o[u-1]+="(?:\\/|"+r+")?":(o[u-1]+="(?:\\/|\\/"+r+"\\/)"+o[u+1],o[u+1]=mn))}),o.filter(a=>a!==mn).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;gu.sep!=="/"&&(e=e.split(gu.sep).join("/")),e=e.split(Gg),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],u=e;if(r.matchBase&&a.length===1&&(u=[s]),this.matchOne(u,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Bt.defaults(e).Minimatch}};Bt.Minimatch=ci});var Su=x(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.DiagnosticFeature=pr.DiagnosticPullMode=pr.vsdiag=void 0;var Nb=no(),he=require("vscode"),Je=ee(),Mb=je(),yu=ve();function ro(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var sn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(sn||(pr.vsdiag=sn={}));var io;(function(n){n.onType="onType",n.onSave="onSave"})(io||(pr.DiagnosticPullMode=io={}));var wt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(wt||(wt={}));var Pr=class{constructor(){this.open=new Set,this._onOpen=new he.EventEmitter,this._onClose=new he.EventEmitter,Pr.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;Pr.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of r.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let u of s)a.add(he.Uri.parse(u));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let u of o)a.add(he.Uri.parse(u));this._onOpen.fire(a)}};he.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=he.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof he.Uri?he.window.activeTextEditor?.document.uri===e:he.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof he.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return Pr.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of he.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof he.TabInputText?a=o.uri:o instanceof he.TabInputTextDiff?a=o.modified:o instanceof he.TabInputCustom&&(a=o.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},rt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(rt||(rt={}));var $n;(function(n){function e(t){return t instanceof he.Uri?t.toString():t.uri.toString()}n.asKey=e})($n||($n={}));var _u=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===rt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof he.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],u=i.get(s);return u===void 0&&(u={document:o,pulledVersion:a,resultId:void 0},i.set(s,u)),u}update(e,t,r,i){let s=e===rt.document?this.documentPullStates:this.workspacePullStates,[o,a,u,h]=t instanceof he.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],p=s.get(o);p===void 0?(p={document:a,pulledVersion:u,resultId:h},s.set(o,p)):(p.pulledVersion=u,p.resultId=h)}unTrack(e,t){let r=$n.asKey(t);(e===rt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=$n.asKey(t);return(e===rt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){let r=$n.asKey(t);return(e===rt.document?this.documentPullStates:this.workspacePullStates).get(r)?.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},bu=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new he.EventEmitter,this.provider=this.createProvider(),this.diagnostics=he.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new _u,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof he.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof he.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof he.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(rt.document,e,t):this.documentStates.track(rt.document,e);if(o===void 0){let u=new he.CancellationTokenSource;this.openRequests.set(s,{state:wt.active,document:e,version:t,tokenSource:u});let h,p;try{h=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:sn.DocumentDiagnosticReportKind.full,items:[]}}catch(y){if(y instanceof yu.LSPCancellationError&&Je.DiagnosticServerCancellationData.is(y.data)&&y.data.retriggerRequest===!1&&(p={state:wt.outDated,document:e}),p===void 0&&y instanceof he.CancellationError)p={state:wt.reschedule,document:e};else throw y}if(p=p??this.openRequests.get(s),p===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(rt.document,e);return}if(p.state===wt.outDated)return;h!==void 0&&(h.kind===sn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,h.items),a.pulledVersion=t,a.resultId=h.resultId),p.state===wt.reschedule&&this.pull(e)}else o.state===wt.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:wt.reschedule,document:o.document})):o.state===wt.outDated&&this.openRequests.set(s,{state:wt.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof he.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:wt.reschedule,document:e}):this.pull(e,()=>{this.forget(rt.document,e)}):(i!==void 0&&(i.state===wt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:wt.outDated,document:e})),this.diagnostics.delete(t),this.forget(rt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Je.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof yu.LSPCancellationError)&&!Je.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Je.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new he.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===sn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(rt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(rt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,u,h)=>{let p={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof he.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:sn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Je.DocumentDiagnosticRequest.type,p,h).then(async y=>y==null||this.isDisposed||h.isCancellationRequested?{kind:sn.DocumentDiagnosticReportKind.full,items:[]}:y.kind===Je.DocumentDiagnosticReportKind.Full?{kind:sn.DocumentDiagnosticReportKind.full,resultId:y.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(y.items,h)}:{kind:sn.DocumentDiagnosticReportKind.unChanged,resultId:y.resultId},y=>this.client.handleFailedRequest(Je.DocumentDiagnosticRequest.type,h,y,{kind:sn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async h=>h.kind===Je.DocumentDiagnosticReportKind.Full?{kind:sn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(h.uri),resultId:h.resultId,version:h.version,items:await this.client.protocol2CodeConverter.asDiagnostics(h.items,r)}:{kind:sn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(h.uri),resultId:h.resultId,version:h.version},o=h=>{let p=[];for(let y of h)p.push({uri:this.client.code2ProtocolConverter.asUri(y.uri),value:y.value});return p},a=(h,p)=>{let y=(0,Mb.generateUuid)(),m=this.client.onProgress(Je.WorkspaceDiagnosticRequest.partialResult,y,async v=>{if(v==null){i(null);return}let P={items:[]};for(let E of v.items)try{P.items.push(await s(E))}catch(F){this.client.error("Converting workspace diagnostics failed.",F)}i(P)}),S={identifier:this.options.identifier,previousResultIds:o(h),partialResultToken:y};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Je.WorkspaceDiagnosticRequest.type,S,p).then(async v=>{if(p.isCancellationRequested)return{items:[]};let P={items:[]};for(let E of v.items)P.items.push(await s(E));return m.dispose(),i(P),{items:[]}},v=>(m.dispose(),this.client.handleFailedRequest(Je.DocumentDiagnosticRequest.type,p,v,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===wt.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:wt.outDated,document:t.document});this.diagnostics.dispose()}},Cu=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Je.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=$n.asKey(e);this.documents.has(t)||(this.documents.set(t,e,Je.Touch.Last),this.trigger())}remove(e){let t=$n.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Je.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=$n.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,Je.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?$n.asKey(this.endDocument):void 0}},wu=class{constructor(e,t,r){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=v=>{let P=r.documentSelector;if(i.match!==void 0)return i.match(P,v);for(let E of P)if(Je.TextDocumentFilter.is(E)){if(typeof E=="string"||E.language!==void 0&&E.language!=="*"||E.scheme!==void 0&&E.scheme!=="*"&&E.scheme!==v.scheme)return!1;if(E.pattern!==void 0){let F=new Nb.Minimatch(E.pattern,{noext:!0});if(!F.makeRe()||!F.match(v.fsPath))return!1}}return!0},u=v=>v instanceof he.Uri?a(v):he.languages.match(s,v)>0&&t.isVisible(v),h=v=>v instanceof he.Uri?this.activeTextDocument?.uri.toString()===v.toString():this.activeTextDocument===v;this.diagnosticRequestor=new bu(e,t,r),this.backgroundScheduler=new Cu(this.diagnosticRequestor);let p=v=>{!u(v)||!r.interFileDependencies||h(v)||this.backgroundScheduler.add(v)};this.activeTextDocument=he.window.activeTextEditor?.document,he.window.onDidChangeActiveTextEditor(v=>{let P=this.activeTextDocument;this.activeTextDocument=v?.document,P!==void 0&&p(P),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let y=e.getFeature(Je.DidOpenTextDocumentNotification.method);o.push(y.onNotificationSent(v=>{let P=v.textDocument;this.diagnosticRequestor.knows(rt.document,P)||u(P)&&this.diagnosticRequestor.pull(P,()=>{p(P)})})),o.push(t.onOpen(v=>{for(let P of v){if(this.diagnosticRequestor.knows(rt.document,P))continue;let E=P.toString(),F;for(let M of he.workspace.textDocuments)if(E===M.uri.toString()){F=M;break}F!==void 0&&u(F)&&this.diagnosticRequestor.pull(F,()=>{p(F)})}}));let m=new Set;for(let v of he.workspace.textDocuments)u(v)&&(this.diagnosticRequestor.pull(v,()=>{p(v)}),m.add(v.uri.toString()));if(i.onTabs===!0)for(let v of t.getTabResources())!m.has(v.toString())&&u(v)&&this.diagnosticRequestor.pull(v,()=>{p(v)});if(i.onChange===!0){let v=e.getFeature(Je.DidChangeTextDocumentNotification.method);o.push(v.onNotificationSent(async P=>{let E=P.textDocument;(i.filter===void 0||!i.filter(E,io.onType))&&this.diagnosticRequestor.knows(rt.document,E)&&this.diagnosticRequestor.pull(E,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let v=e.getFeature(Je.DidSaveTextDocumentNotification.method);o.push(v.onNotificationSent(P=>{let E=P.textDocument;(i.filter===void 0||!i.filter(E,io.onSave))&&this.diagnosticRequestor.knows(rt.document,E)&&this.diagnosticRequestor.pull(P.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let S=e.getFeature(Je.DidCloseTextDocumentNotification.method);o.push(S.onNotificationSent(v=>{this.cleanUpDocument(v.textDocument)})),t.onClose(v=>{for(let P of v)this.cleanUpDocument(P)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let v of he.workspace.textDocuments)u(v)&&this.diagnosticRequestor.pull(v)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=he.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(rt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},Du=class extends yu.TextDocumentLanguageFeature{constructor(e){super(e,Je.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=ro(ro(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,ro(ro(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(Je.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new Pr);let t=new wu(this._client,this.tabs,e);return[t.disposable,t]}};pr.DiagnosticFeature=Du});var Yg=x(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.NotebookDocumentSyncFeature=void 0;var Dt=require("vscode"),Ab=no(),Hn=ee(),jb=je(),Zg=Yt();function Qg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ui;(function(n){let e;(function(t){function r(m,S){return{version:m.version,uri:S.asUri(m.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(m,S,v){let P=Hn.NotebookDocument.create(v.asUri(m.uri),m.notebookType,m.version,s(S,v));return Object.keys(m.metadata).length>0&&(P.metadata=o(m.metadata)),P}t.asNotebookDocument=i;function s(m,S){return m.map(v=>a(v,S))}t.asNotebookCells=s;function o(m){return h(new Set,m)}t.asMetadata=o;function a(m,S){let v=Hn.NotebookCell.create(u(m.kind),S.asUri(m.document.uri));return Object.keys(m.metadata).length>0&&(v.metadata=o(m.metadata)),m.executionSummary!==void 0&&Zg.number(m.executionSummary.executionOrder)&&Zg.boolean(m.executionSummary.success)&&(v.executionSummary={executionOrder:m.executionSummary.executionOrder,success:m.executionSummary.success}),v}t.asNotebookCell=a;function u(m){switch(m){case Dt.NotebookCellKind.Markup:return Hn.NotebookCellKind.Markup;case Dt.NotebookCellKind.Code:return Hn.NotebookCellKind.Code}}function h(m,S){if(m.has(S))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(S)){let v=[];for(let P of S)if(P!==null&&typeof P=="object"||Array.isArray(P))v.push(h(m,P));else{if(P instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");v.push(P)}return v}else{let v=Object.keys(S),P=Object.create(null);for(let E of v){let F=S[E];if(F!==null&&typeof F=="object"||Array.isArray(F))P[E]=h(m,F);else{if(F instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");P[E]=F}}return P}}function p(m,S){let v=S.asChangeTextDocumentParams(m,m.document.uri,m.document.version);return{document:v.textDocument,changes:v.contentChanges}}t.asTextContentChange=p;function y(m,S){let v=Object.create(null);if(m.metadata&&(v.metadata=n.c2p.asMetadata(m.metadata)),m.cells!==void 0){let P=Object.create(null),E=m.cells;E.structure&&(P.structure={array:{start:E.structure.array.start,deleteCount:E.structure.array.deleteCount,cells:E.structure.array.cells!==void 0?E.structure.array.cells.map(F=>n.c2p.asNotebookCell(F,S)):void 0},didOpen:E.structure.didOpen!==void 0?E.structure.didOpen.map(F=>S.asOpenTextDocumentParams(F.document).textDocument):void 0,didClose:E.structure.didClose!==void 0?E.structure.didClose.map(F=>S.asCloseTextDocumentParams(F.document).textDocument):void 0}),E.data!==void 0&&(P.data=E.data.map(F=>n.c2p.asNotebookCell(F,S))),E.textContent!==void 0&&(P.textContent=E.textContent.map(F=>n.c2p.asTextContentChange(F,S))),Object.keys(P).length>0&&(v.cells=P)}return v}t.asNotebookDocumentChangeEvent=y})(e=n.c2p||(n.c2p={}))})(ui||(ui={}));var Ru;(function(n){function e(a,u,h){let p=a.length,y=u.length,m=0;for(;m<y&&m<p&&t(a[m],u[m],h);)m++;if(m<y&&m<p){let S=p-1,v=y-1;for(;S>=0&&v>=0&&t(a[S],u[v],h);)S--,v--;let P=S+1-m,E=m===v+1?void 0:u.slice(m,v+1);return E!==void 0?{start:m,deleteCount:P,cells:E}:{start:m,deleteCount:P}}else return m<y?{start:m,deleteCount:0,cells:u.slice(m)}:m<p?{start:m,deleteCount:p-m}:void 0}n.computeDiff=e;function t(a,u,h=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!r(a.executionSummary,u.executionSummary)?!1:!h||h&&s(a.metadata,u.metadata)}function r(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&i(a.timing,u.timing)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function s(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;let h=Array.isArray(a),p=Array.isArray(u);if(h!==p)return!1;if(h&&p){if(a.length!==u.length)return!1;for(let y=0;y<a.length;y++)if(!s(a[y],u[y]))return!1}if(o(a)&&o(u)){let y=Object.keys(a),m=Object.keys(u);if(y.length!==m.length||(y.sort(),m.sort(),!s(y,m)))return!1;for(let S=0;S<y.length;S++){let v=y[S];if(!s(a[v],u[v]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(Ru||(Ru={}));var Tu;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new Ab.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(Tu||(Tu={}));var so;(function(n){function e(r){let i=r.notebookSelector,s=[];for(let o of i){let a=(typeof o.notebook=="string"?o.notebook:o.notebook?.notebookType)??"*",u=typeof o.notebook=="string"?void 0:o.notebook?.scheme,h=typeof o.notebook=="string"?void 0:o.notebook?.pattern;if(o.cells!==void 0)for(let p of o.cells)s.push(t(a,u,h,p.language));else s.push(t(a,u,h,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(so||(so={}));var oo;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(oo||(oo={}));var li=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(so.asDocumentSelector(t)),Dt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of Dt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);Dt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&Dt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),Dt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of Dt.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return Dt.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(Dt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){Dt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let r=async(s,o)=>{let a=ui.c2p.asNotebookDocument(s,o,this.client.code2ProtocolConverter),u=o.map(h=>this.client.code2ProtocolConverter.asTextDocumentItem(h.document));try{await this.client.sendNotification(Hn.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(h){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",h),h}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),oo.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let r=async s=>{try{await this.client.sendNotification(Hn.DidChangeNotebookDocumentNotification.type,{notebookDocument:ui.c2p.asVersionedNotebookDocumentIdentifier(s.notebook,this.client.code2ProtocolConverter),change:ui.c2p.asNotebookDocumentChangeEvent(s,this.client.code2ProtocolConverter)})}catch(o){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),oo.create(t??[])),i?.didChange!==void 0?i?.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(Hn.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=this.client.middleware?.notebooks;return r?.didSave!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let r=async(s,o)=>{try{await this.client.sendNotification(Hn.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:o.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};t?.metadata!==void 0&&(s.metadata=ui.c2p.asMetadata(t.metadata));let o;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(u=>u.document.uri.toString()));for(let u of t.cellChanges)o.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,u=i,h=Ru.computeDiff(a,u,!1),p,y;if(h!==void 0){p=h.cells===void 0?new Map:new Map(h.cells.map(v=>[v.document.uri.toString(),v])),y=h.deleteCount===0?new Map:new Map(a.slice(h.start,h.start+h.deleteCount).map(v=>[v.document.uri.toString(),v]));for(let v of Array.from(y.keys()))p.has(v)&&(y.delete(v),p.delete(v));s.cells=s.cells??{};let m=[],S=[];if(p.size>0||y.size>0){for(let v of p.values())m.push(v);for(let v of y.values())S.push(v)}s.cells.structure={array:h,didOpen:m,didClose:S}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||Tu.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){let i=r!==void 0?t.filter(s=>{let o=s.document.languageId;return r.some(a=>a.language==="*"||o===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},Un=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=Hn.NotebookDocumentSyncRegistrationType.type,Dt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==Un.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof li&&s.didOpenNotebookCellTextDocument(r,i)}),Dt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==Un.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof li&&s.didChangeNotebookCellTextDocument(i,t)}),Dt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==Un.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof li&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Qg(Qg(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(so.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??jb.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new li(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==Un.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&Dt.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of Dt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};ao.NotebookDocumentSyncFeature=Un;Un.CellScheme="vscode-notebook-cell"});var tm=x(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.SyncConfigurationFeature=gr.toJSONObject=gr.ConfigurationFeature=void 0;var di=require("vscode"),Hi=ee(),$b=Yt(),Hb=je(),em=ve(),Pu=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Hi.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let u of o.items){let h=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(h,u.section!==null?u.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Ir(di.workspace.getConfiguration(void 0,e).get(t));else{let s=di.workspace.getConfiguration(t.substr(0,i),e);s&&(r=Ir(s.get(t.substr(i+1))))}}else{let i=di.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=Ir(i.get(s)))}return r===void 0&&(r=null),r}clear(){}};gr.ConfigurationFeature=Pu;function Ir(n){if(n){if(Array.isArray(n))return n.map(Ir);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ir(n[t]));return e}}return n}gr.toJSONObject=Ir;var Iu=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Hi.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,em.ensure)((0,em.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:Hb.generateUuid(),registerOptions:{section:e}})}register(e){let t=di.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let r;if($b.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async o=>o===void 0?this._client.sendNotification(Hi.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Hi.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)}),s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(r,i):i(r)).catch(o=>{this._client.error(`Sending notification ${Hi.DidChangeConfigurationNotification.type.method} failed`,o)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let u=0;u<o.length-1;u++){let h=a[o[u]];h||(h=Object.create(null),a[o[u]]=h),a=h}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),u=null;if(a>=0?u=di.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):u=di.workspace.getConfiguration(void 0,r).get(o),u){let h=e[s].split(".");t(i,h)[h[h.length-1]]=Ir(u)}}return i}};gr.SyncConfigurationFeature=Iu});var nm=x(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.DidSaveTextDocumentFeature=Mt.WillSaveWaitUntilFeature=Mt.WillSaveFeature=Mt.DidChangeTextDocumentFeature=Mt.DidCloseTextDocumentFeature=Mt.DidOpenTextDocumentFeature=void 0;var zt=require("vscode"),ke=ee(),We=ve(),fi=je(),Eu=class extends We.TextDocumentEventFeature{constructor(e,t){super(e,zt.workspace.onDidOpenTextDocument,ke.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,We.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return ke.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);zt.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&zt.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};Mt.DidOpenTextDocumentFeature=Eu;var xu=class extends We.TextDocumentEventFeature{constructor(e,t,r){super(e,zt.workspace.onDidCloseTextDocument,ke.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,We.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return ke.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(zt.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};Mt.DidCloseTextDocumentFeature=xu;var qu=class extends We.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new zt.EventEmitter,this._onPendingChangeAdded=new zt.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=ke.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return ke.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==ke.TextDocumentSyncKind.None&&this.register({id:fi.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=zt.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let s of this._changeData.values())if(zt.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===ke.TextDocumentSyncKind.Incremental){let a=async u=>{let h=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,r);await this._client.sendNotification(ke.DidChangeTextDocumentNotification.type,h),this.notificationSent(u.document,ke.DidChangeTextDocumentNotification.type,h)};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}else if(s.syncKind===ke.TextDocumentSyncKind.Full){let a=async u=>{let h=u.document.uri.toString();this._pendingTextDocumentChanges.set(h,u.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${ke.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=ke.TextDocumentSyncKind.None;else{this._syncKind=ke.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===ke.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=ke.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(zt.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==ke.TextDocumentSyncKind.Full)switch(e){case ke.TextDocumentSyncKind.Full:this._syncKind=e;break;case ke.TextDocumentSyncKind.Incremental:this._syncKind===ke.TextDocumentSyncKind.None&&(this._syncKind=ke.TextDocumentSyncKind.Incremental);break}}};Mt.DidChangeTextDocumentFeature=qu;var ku=class extends We.TextDocumentEventFeature{constructor(e){super(e,zt.workspace.onWillSaveTextDocument,ke.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>We.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return ke.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};Mt.WillSaveFeature=ku;var Ou=class extends We.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return ke.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:fi.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=zt.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(We.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(ke.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};Mt.WillSaveWaitUntilFeature=Ou;var Lu=class extends We.TextDocumentEventFeature{constructor(e){super(e,zt.workspace.onDidSaveTextDocument,ke.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,We.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return ke.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,We.ensure)((0,We.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:fi.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};Mt.DidSaveTextDocumentFeature=Lu});var rm=x(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.CompletionItemFeature=void 0;var Ub=require("vscode"),pe=ee(),Fu=ve(),Wb=je(),Kb=[pe.CompletionItemKind.Text,pe.CompletionItemKind.Method,pe.CompletionItemKind.Function,pe.CompletionItemKind.Constructor,pe.CompletionItemKind.Field,pe.CompletionItemKind.Variable,pe.CompletionItemKind.Class,pe.CompletionItemKind.Interface,pe.CompletionItemKind.Module,pe.CompletionItemKind.Property,pe.CompletionItemKind.Unit,pe.CompletionItemKind.Value,pe.CompletionItemKind.Enum,pe.CompletionItemKind.Keyword,pe.CompletionItemKind.Snippet,pe.CompletionItemKind.Color,pe.CompletionItemKind.File,pe.CompletionItemKind.Reference,pe.CompletionItemKind.Folder,pe.CompletionItemKind.EnumMember,pe.CompletionItemKind.Constant,pe.CompletionItemKind.Struct,pe.CompletionItemKind.Event,pe.CompletionItemKind.Operator,pe.CompletionItemKind.TypeParameter],Nu=class extends Fu.TextDocumentLanguageFeature{constructor(e){super(e,pe.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,Fu.ensure)((0,Fu.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[pe.MarkupKind.Markdown,pe.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[pe.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[pe.InsertTextMode.asIs,pe.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=pe.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:Kb},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:Wb.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(a,u,h,p)=>{let y=this._client,m=this._client.middleware,S=(v,P,E,F)=>y.sendRequest(pe.CompletionRequest.type,y.code2ProtocolConverter.asCompletionParams(v,P,E),F).then(M=>F.isCancellationRequested?null:y.protocol2CodeConverter.asCompletionResult(M,i,F),M=>y.handleFailedRequest(pe.CompletionRequest.type,F,M,null));return m.provideCompletionItem?m.provideCompletionItem(a,u,p,h,S):S(a,u,p,h)},resolveCompletionItem:e.resolveProvider?(a,u)=>{let h=this._client,p=this._client.middleware,y=(m,S)=>h.sendRequest(pe.CompletionResolveRequest.type,h.code2ProtocolConverter.asCompletionItem(m,!!this.labelDetailsSupport.get(t)),S).then(v=>S.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionItem(v),v=>h.handleFailedRequest(pe.CompletionResolveRequest.type,S,v,m));return p.resolveCompletionItem?p.resolveCompletionItem(a,u,y):y(a,u)}:void 0};return[Ub.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};co.CompletionItemFeature=Nu});var im=x(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.HoverFeature=void 0;var Bb=require("vscode"),Ui=ee(),Mu=ve(),zb=je(),Au=class extends Mu.TextDocumentLanguageFeature{constructor(e){super(e,Ui.HoverRequest.type)}fillClientCapabilities(e){let t=(0,Mu.ensure)((0,Mu.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Ui.MarkupKind.Markdown,Ui.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:zb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(Ui.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asHover(S),S=>a.handleFailedRequest(Ui.HoverRequest.type,m,S,null)),h=a.middleware;return h.provideHover?h.provideHover(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Bb.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};uo.HoverFeature=Au});var sm=x(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.DefinitionFeature=void 0;var Xb=require("vscode"),ju=ee(),$u=ve(),Gb=je(),Hu=class extends $u.TextDocumentLanguageFeature{constructor(e){super(e,ju.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,$u.ensure)((0,$u.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:Gb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(ju.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,m),S=>a.handleFailedRequest(ju.DefinitionRequest.type,m,S,null)),h=a.middleware;return h.provideDefinition?h.provideDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Xb.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};lo.DefinitionFeature=Hu});var am=x(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.SignatureHelpFeature=void 0;var om=require("vscode"),Wi=ee(),Uu=ve(),Vb=je(),Wu=class extends Uu.TextDocumentLanguageFeature{constructor(e){super(e,Wi.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Uu.ensure)((0,Uu.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Wi.MarkupKind.Markdown,Wi.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:Vb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,u=(p,y,m,S)=>a.sendRequest(Wi.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(p,y,m),S).then(v=>S.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(v,S),v=>a.handleFailedRequest(Wi.SignatureHelpRequest.type,S,v,null)),h=a.middleware;return h.provideSignatureHelp?h.provideSignatureHelp(r,i,o,s,u):u(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return om.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return om.languages.registerSignatureHelpProvider(r,t,i)}}};fo.SignatureHelpFeature=Wu});var cm=x(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.DocumentHighlightFeature=void 0;var Jb=require("vscode"),Ku=ee(),Bu=ve(),Zb=je(),zu=class extends Bu.TextDocumentLanguageFeature{constructor(e){super(e,Ku.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Bu.ensure)((0,Bu.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:Zb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(Ku.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(S,m),S=>a.handleFailedRequest(Ku.DocumentHighlightRequest.type,m,S,null)),h=a.middleware;return h.provideDocumentHighlights?h.provideDocumentHighlights(i,s,o,u):u(i,s,o)}};return[Jb.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ho.DocumentHighlightFeature=zu});var Vu=x(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.DocumentSymbolFeature=On.SupportedSymbolTags=On.SupportedSymbolKinds=void 0;var Qb=require("vscode"),Se=ee(),Xu=ve(),Yb=je();On.SupportedSymbolKinds=[Se.SymbolKind.File,Se.SymbolKind.Module,Se.SymbolKind.Namespace,Se.SymbolKind.Package,Se.SymbolKind.Class,Se.SymbolKind.Method,Se.SymbolKind.Property,Se.SymbolKind.Field,Se.SymbolKind.Constructor,Se.SymbolKind.Enum,Se.SymbolKind.Interface,Se.SymbolKind.Function,Se.SymbolKind.Variable,Se.SymbolKind.Constant,Se.SymbolKind.String,Se.SymbolKind.Number,Se.SymbolKind.Boolean,Se.SymbolKind.Array,Se.SymbolKind.Object,Se.SymbolKind.Key,Se.SymbolKind.Null,Se.SymbolKind.EnumMember,Se.SymbolKind.Struct,Se.SymbolKind.Event,Se.SymbolKind.Operator,Se.SymbolKind.TypeParameter];On.SupportedSymbolTags=[Se.SymbolTag.Deprecated];var Gu=class extends Xu.TextDocumentLanguageFeature{constructor(e){super(e,Se.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Xu.ensure)((0,Xu.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:On.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:On.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);r&&this.register({id:Yb.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,u=async(p,y)=>{try{let m=await a.sendRequest(Se.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(p),y);if(y.isCancellationRequested||m===void 0||m===null)return null;if(m.length===0)return[];{let S=m[0];return Se.DocumentSymbol.is(S)?await a.protocol2CodeConverter.asDocumentSymbols(m,y):await a.protocol2CodeConverter.asSymbolInformations(m,y)}}catch(m){return a.handleFailedRequest(Se.DocumentSymbolRequest.type,y,m,null)}},h=a.middleware;return h.provideDocumentSymbols?h.provideDocumentSymbols(s,o,u):u(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[Qb.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};On.DocumentSymbolFeature=Gu});var lm=x(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.WorkspaceSymbolFeature=void 0;var eC=require("vscode"),Ki=ee(),Ju=ve(),um=Vu(),tC=je(),Zu=class extends Ju.WorkspaceFeature{constructor(e){super(e,Ki.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Ju.ensure)((0,Ju.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:um.SupportedSymbolKinds},t.tagSupport={valueSet:um.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:tC.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(u,h)=>s.sendRequest(Ki.WorkspaceSymbolRequest.type,{query:u},h).then(p=>h.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(p,h),p=>s.handleFailedRequest(Ki.WorkspaceSymbolRequest.type,h,p,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(u,h)=>s.sendRequest(Ki.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(u),h).then(p=>h.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(p),p=>s.handleFailedRequest(Ki.WorkspaceSymbolResolveRequest.type,h,p,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[eC.languages.registerWorkspaceSymbolProvider(t),t]}};po.WorkspaceSymbolFeature=Zu});var dm=x(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.ReferencesFeature=void 0;var nC=require("vscode"),Qu=ee(),Yu=ve(),rC=je(),el=class extends Yu.TextDocumentLanguageFeature{constructor(e){super(e,Qu.ReferencesRequest.type)}fillClientCapabilities(e){(0,Yu.ensure)((0,Yu.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:rC.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let u=this._client,h=(y,m,S,v)=>u.sendRequest(Qu.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(y,m,S),v).then(P=>v.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(P,v),P=>u.handleFailedRequest(Qu.ReferencesRequest.type,v,P,null)),p=u.middleware;return p.provideReferences?p.provideReferences(i,s,o,a,h):h(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return nC.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};go.ReferencesFeature=el});var fm=x(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.CodeActionFeature=void 0;var iC=require("vscode"),Xt=ee(),sC=je(),tl=ve(),nl=class extends tl.TextDocumentLanguageFeature{constructor(e){super(e,Xt.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,tl.ensure)((0,tl.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[Xt.CodeActionKind.Empty,Xt.CodeActionKind.QuickFix,Xt.CodeActionKind.Refactor,Xt.CodeActionKind.RefactorExtract,Xt.CodeActionKind.RefactorInline,Xt.CodeActionKind.RefactorRewrite,Xt.CodeActionKind.Source,Xt.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:sC.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let u=this._client,h=async(y,m,S,v)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y),range:u.code2ProtocolConverter.asRange(m),context:u.code2ProtocolConverter.asCodeActionContextSync(S)};return u.sendRequest(Xt.CodeActionRequest.type,P,v).then(E=>v.isCancellationRequested||E===null||E===void 0?null:u.protocol2CodeConverter.asCodeActionResult(E,v),E=>u.handleFailedRequest(Xt.CodeActionRequest.type,v,E,null))},p=u.middleware;return p.provideCodeActions?p.provideCodeActions(i,s,o,a,h):h(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,u=async(h,p)=>o.sendRequest(Xt.CodeActionResolveRequest.type,o.code2ProtocolConverter.asCodeActionSync(h),p).then(y=>p.isCancellationRequested?h:o.protocol2CodeConverter.asCodeAction(y,p),y=>o.handleFailedRequest(Xt.CodeActionResolveRequest.type,p,y,h));return a.resolveCodeAction?a.resolveCodeAction(i,s,u):u(i,s)}:void 0};return[iC.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};mo.CodeActionFeature=nl});var pm=x(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.CodeLensFeature=void 0;var hm=require("vscode"),hi=ee(),oC=je(),Bi=ve(),rl=class extends Bi.TextDocumentLanguageFeature{constructor(e){super(e,hi.CodeLensRequest.type)}fillClientCapabilities(e){(0,Bi.ensure)((0,Bi.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Bi.ensure)((0,Bi.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(hi.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:oC.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new hm.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,u=(p,y)=>a.sendRequest(hi.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(p),y).then(m=>y.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(m,y),m=>a.handleFailedRequest(hi.CodeLensRequest.type,y,m,null)),h=a.middleware;return h.provideCodeLenses?h.provideCodeLenses(s,o,u):u(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,u=(p,y)=>a.sendRequest(hi.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(p),y).then(m=>y.isCancellationRequested?p:a.protocol2CodeConverter.asCodeLens(m),m=>a.handleFailedRequest(hi.CodeLensResolveRequest.type,y,m,p)),h=a.middleware;return h.resolveCodeLens?h.resolveCodeLens(s,o,u):u(s,o)}:void 0};return[hm.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};vo.CodeLensFeature=rl});var gm=x(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.DocumentOnTypeFormattingFeature=mr.DocumentRangeFormattingFeature=mr.DocumentFormattingFeature=void 0;var yo=require("vscode"),vn=ee(),al=je(),Wn=ve(),pi;(function(n){function e(t){let r=yo.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(pi||(pi={}));var il=class extends Wn.TextDocumentLanguageFeature{constructor(e){super(e,vn.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,Wn.ensure)((0,Wn.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:al.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,u=(p,y,m)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),options:a.code2ProtocolConverter.asFormattingOptions(y,pi.fromConfiguration(p))};return a.sendRequest(vn.DocumentFormattingRequest.type,S,m).then(v=>m.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(v,m),v=>a.handleFailedRequest(vn.DocumentFormattingRequest.type,m,v,null))},h=a.middleware;return h.provideDocumentFormattingEdits?h.provideDocumentFormattingEdits(i,s,o,u):u(i,s,o)}};return[yo.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};mr.DocumentFormattingFeature=il;var sl=class extends Wn.TextDocumentLanguageFeature{constructor(e){super(e,vn.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,Wn.ensure)((0,Wn.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:al.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let u=this._client,h=(y,m,S,v)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y),range:u.code2ProtocolConverter.asRange(m),options:u.code2ProtocolConverter.asFormattingOptions(S,pi.fromConfiguration(y))};return u.sendRequest(vn.DocumentRangeFormattingRequest.type,P,v).then(E=>v.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(E,v),E=>u.handleFailedRequest(vn.DocumentRangeFormattingRequest.type,v,E,null))},p=u.middleware;return p.provideDocumentRangeFormattingEdits?p.provideDocumentRangeFormattingEdits(i,s,o,a,h):h(i,s,o,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,s,o,a)=>{let u=this._client,h=(y,m,S,v)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y),ranges:u.code2ProtocolConverter.asRanges(m),options:u.code2ProtocolConverter.asFormattingOptions(S,pi.fromConfiguration(y))};return u.sendRequest(vn.DocumentRangesFormattingRequest.type,P,v).then(E=>v.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(E,v),E=>u.handleFailedRequest(vn.DocumentRangesFormattingRequest.type,v,E,null))},p=u.middleware;return p.provideDocumentRangesFormattingEdits?p.provideDocumentRangesFormattingEdits(i,s,o,a,h):h(i,s,o,a)}),[yo.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};mr.DocumentRangeFormattingFeature=sl;var ol=class extends Wn.TextDocumentLanguageFeature{constructor(e){super(e,vn.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,Wn.ensure)((0,Wn.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:al.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,u,h)=>{let p=this._client,y=(S,v,P,E,F)=>{let M={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(S),position:p.code2ProtocolConverter.asPosition(v),ch:P,options:p.code2ProtocolConverter.asFormattingOptions(E,pi.fromConfiguration(S))};return p.sendRequest(vn.DocumentOnTypeFormattingRequest.type,M,F).then(N=>F.isCancellationRequested?null:p.protocol2CodeConverter.asTextEdits(N,F),N=>p.handleFailedRequest(vn.DocumentOnTypeFormattingRequest.type,F,N,null))},m=p.middleware;return m.provideOnTypeFormattingEdits?m.provideOnTypeFormattingEdits(s,o,a,u,h,y):y(s,o,a,u,h)}},i=e.moreTriggerCharacter||[];return[yo.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};mr.DocumentOnTypeFormattingFeature=ol});var vm=x(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.RenameFeature=void 0;var aC=require("vscode"),Er=ee(),cC=je(),mm=Yt(),cl=ve(),ul=class extends cl.TextDocumentLanguageFeature{constructor(e){super(e,Er.RenameRequest.type)}fillClientCapabilities(e){let t=(0,cl.ensure)((0,cl.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Er.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);r&&(mm.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:cC.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let u=this._client,h=(y,m,S,v)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y),position:u.code2ProtocolConverter.asPosition(m),newName:S};return u.sendRequest(Er.RenameRequest.type,P,v).then(E=>v.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(E,v),E=>u.handleFailedRequest(Er.RenameRequest.type,v,E,null,!1))},p=u.middleware;return p.provideRenameEdits?p.provideRenameEdits(i,s,o,a,h):h(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,u=(p,y,m)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),position:a.code2ProtocolConverter.asPosition(y)};return a.sendRequest(Er.PrepareRenameRequest.type,S,m).then(v=>m.isCancellationRequested?null:Er.Range.is(v)?a.protocol2CodeConverter.asRange(v):this.isDefaultBehavior(v)?v.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):v&&Er.Range.is(v.range)?{range:a.protocol2CodeConverter.asRange(v.range),placeholder:v.placeholder}:Promise.reject(new Error("The element can't be renamed.")),v=>{throw typeof v.message=="string"?new Error(v.message):new Error("The element can't be renamed.")})},h=a.middleware;return h.prepareRename?h.prepareRename(i,s,o,u):u(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return aC.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&mm.boolean(t.defaultBehavior)}};_o.RenameFeature=ul});var ym=x(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.DocumentLinkFeature=void 0;var uC=require("vscode"),zi=ee(),ll=ve(),lC=je(),dl=class extends ll.TextDocumentLanguageFeature{constructor(e){super(e,zi.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,ll.ensure)((0,ll.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:lC.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(h,p)=>o.sendRequest(zi.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(h),p).then(y=>p.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(y,p),y=>o.handleFailedRequest(zi.DocumentLinkRequest.type,p,y,null)),u=o.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(h,p)=>o.sendRequest(zi.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(h),p).then(y=>p.isCancellationRequested?h:o.protocol2CodeConverter.asDocumentLink(y),y=>o.handleFailedRequest(zi.DocumentLinkResolveRequest.type,p,y,h)),u=o.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[uC.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};bo.DocumentLinkFeature=dl});var bm=x(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.ExecuteCommandFeature=void 0;var dC=require("vscode"),fl=ee(),fC=je(),_m=ve(),hl=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return fl.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,_m.ensure)((0,_m.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:fC.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(fl.ExecuteCommandRequest.type,a).then(void 0,u=>t.handleFailedRequest(fl.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(dC.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Co.ExecuteCommandFeature=hl});var Cm=x(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.FileSystemWatcherFeature=void 0;var hC=require("vscode"),xr=ee(),wo=ve(),pl=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return xr.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,wo.ensure)((0,wo.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,wo.ensure)((0,wo.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&xr.WatchKind.Create)!==0,o=(r.kind&xr.WatchKind.Change)!==0,a=(r.kind&xr.WatchKind.Delete)!==0);let u=hC.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(u,s,o,a,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:xr.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:xr.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:xr.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};Do.FileSystemWatcherFeature=pl});var wm=x(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.ColorProviderFeature=void 0;var pC=require("vscode"),Xi=ee(),gl=ve(),ml=class extends gl.TextDocumentLanguageFeature{constructor(e){super(e,Xi.DocumentColorRequest.type)}fillClientCapabilities(e){(0,gl.ensure)((0,gl.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,u=(p,y,m)=>{let S={color:p,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(y.document),range:a.code2ProtocolConverter.asRange(y.range)};return a.sendRequest(Xi.ColorPresentationRequest.type,S,m).then(v=>m.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(v,m),v=>a.handleFailedRequest(Xi.ColorPresentationRequest.type,m,v,null))},h=a.middleware;return h.provideColorPresentations?h.provideColorPresentations(i,s,o,u):u(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(h,p)=>{let y={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(h)};return o.sendRequest(Xi.DocumentColorRequest.type,y,p).then(m=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(m,p),m=>o.handleFailedRequest(Xi.DocumentColorRequest.type,p,m,null))},u=o.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,s,a):a(i,s)}};return[pC.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};So.ColorProviderFeature=ml});var Dm=x(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.ImplementationFeature=void 0;var gC=require("vscode"),vl=ee(),yl=ve(),_l=class extends yl.TextDocumentLanguageFeature{constructor(e){super(e,vl.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,yl.ensure)((0,yl.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(vl.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,m),S=>a.handleFailedRequest(vl.ImplementationRequest.type,m,S,null)),h=a.middleware;return h.provideImplementation?h.provideImplementation(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return gC.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ro.ImplementationFeature=_l});var Sm=x(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.TypeDefinitionFeature=void 0;var mC=require("vscode"),bl=ee(),Gi=ve(),Cl=class extends Gi.TextDocumentLanguageFeature{constructor(e){super(e,bl.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Gi.ensure)((0,Gi.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Gi.ensure)((0,Gi.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(bl.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,m),S=>a.handleFailedRequest(bl.TypeDefinitionRequest.type,m,S,null)),h=a.middleware;return h.provideTypeDefinition?h.provideTypeDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return mC.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};To.TypeDefinitionFeature=Cl});var Rm=x(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.WorkspaceFoldersFeature=gi.arrayDiff=void 0;var vC=je(),Po=require("vscode"),Vi=ee();function wl(n,e){if(n!=null)return n[e]}function Dl(n,e){return n.filter(t=>e.indexOf(t)<0)}gi.arrayDiff=Dl;var Sl=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Vi.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Po.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Vi.WorkspaceFoldersRequest.type,s=>{let o=()=>{let u=Po.workspace.workspaceFolders;return u===void 0?null:u.map(p=>this.asProtocol(p))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=wl(wl(wl(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=vC.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Dl(this._initialFolders,e),i=Dl(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Vi.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Vi.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Po.workspace.onDidChangeWorkspaceFolders(s=>{let o=h=>this.doSendEvent(h.added,h.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(h=>{this._client.error(`Sending notification ${Vi.DidChangeWorkspaceFoldersNotification.type.method} failed`,h)})});this._listeners.set(t,i),this.sendInitialEvent(Po.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};gi.WorkspaceFoldersFeature=Sl});var Pm=x(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.FoldingRangeFeature=void 0;var Tm=require("vscode"),qr=ee(),Ji=ve(),Rl=class extends Ji.TextDocumentLanguageFeature{constructor(e){super(e,qr.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Ji.ensure)((0,Ji.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[qr.FoldingRangeKind.Comment,qr.FoldingRangeKind.Imports,qr.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,Ji.ensure)((0,Ji.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(qr.FoldingRangeRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Tm.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(s,o,a)=>{let u=this._client,h=(y,m,S)=>{let v={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y)};return u.sendRequest(qr.FoldingRangeRequest.type,v,S).then(P=>S.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(P,S),P=>u.handleFailedRequest(qr.FoldingRangeRequest.type,S,P,null))},p=u.middleware;return p.provideFoldingRanges?p.provideFoldingRanges(s,o,a,h):h(s,o,a)}};return[Tm.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}};Io.FoldingRangeFeature=Rl});var Im=x(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.DeclarationFeature=void 0;var yC=require("vscode"),Tl=ee(),Pl=ve(),Il=class extends Pl.TextDocumentLanguageFeature{constructor(e){super(e,Tl.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,Pl.ensure)((0,Pl.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(Tl.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(S,m),S=>a.handleFailedRequest(Tl.DeclarationRequest.type,m,S,null)),h=a.middleware;return h.provideDeclaration?h.provideDeclaration(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return yC.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Eo.DeclarationFeature=Il});var Em=x(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.SelectionRangeFeature=void 0;var _C=require("vscode"),El=ee(),xl=ve(),ql=class extends xl.TextDocumentLanguageFeature{constructor(e){super(e,El.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,xl.ensure)((0,xl.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,u=async(p,y,m)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),positions:a.code2ProtocolConverter.asPositionsSync(y,m)};return a.sendRequest(El.SelectionRangeRequest.type,S,m).then(v=>m.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(v,m),v=>a.handleFailedRequest(El.SelectionRangeRequest.type,m,v,null))},h=a.middleware;return h.provideSelectionRanges?h.provideSelectionRanges(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return _C.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xo.SelectionRangeFeature=ql});var qm=x(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.ProgressFeature=void 0;var xm=ee(),bC=su();function CC(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var kl=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:xm.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){CC(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new bC.ProgressPart(this._client,i.token,t))};e.onRequest(xm.WorkDoneProgressCreateRequest.type,r)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};qo.ProgressFeature=kl});var km=x(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.CallHierarchyFeature=void 0;var wC=require("vscode"),kr=ee(),Ol=ve(),Ll=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,u,h)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(kr.CallHierarchyPrepareRequest.type,p,h).then(y=>h.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(y,h),y=>i.handleFailedRequest(kr.CallHierarchyPrepareRequest.type,h,y,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(kr.CallHierarchyIncomingCallsRequest.type,u,a).then(h=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(h,a),h=>r.handleFailedRequest(kr.CallHierarchyIncomingCallsRequest.type,a,h,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let u={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(kr.CallHierarchyOutgoingCallsRequest.type,u,a).then(h=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(h,a),h=>r.handleFailedRequest(kr.CallHierarchyOutgoingCallsRequest.type,a,h,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},Fl=class extends Ol.TextDocumentLanguageFeature{constructor(e){super(e,kr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,Ol.ensure)((0,Ol.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Ll(t);return[wC.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ko.CallHierarchyFeature=Fl});var Om=x(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.SemanticTokensFeature=void 0;var Oo=require("vscode"),ie=ee(),Zi=ve(),DC=Yt(),Nl=class extends Zi.TextDocumentLanguageFeature{constructor(e){super(e,ie.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Zi.ensure)((0,Zi.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[ie.SemanticTokenTypes.namespace,ie.SemanticTokenTypes.type,ie.SemanticTokenTypes.class,ie.SemanticTokenTypes.enum,ie.SemanticTokenTypes.interface,ie.SemanticTokenTypes.struct,ie.SemanticTokenTypes.typeParameter,ie.SemanticTokenTypes.parameter,ie.SemanticTokenTypes.variable,ie.SemanticTokenTypes.property,ie.SemanticTokenTypes.enumMember,ie.SemanticTokenTypes.event,ie.SemanticTokenTypes.function,ie.SemanticTokenTypes.method,ie.SemanticTokenTypes.macro,ie.SemanticTokenTypes.keyword,ie.SemanticTokenTypes.modifier,ie.SemanticTokenTypes.comment,ie.SemanticTokenTypes.string,ie.SemanticTokenTypes.number,ie.SemanticTokenTypes.regexp,ie.SemanticTokenTypes.operator,ie.SemanticTokenTypes.decorator],t.tokenModifiers=[ie.SemanticTokenModifiers.declaration,ie.SemanticTokenModifiers.definition,ie.SemanticTokenModifiers.readonly,ie.SemanticTokenModifiers.static,ie.SemanticTokenModifiers.deprecated,ie.SemanticTokenModifiers.abstract,ie.SemanticTokenModifiers.async,ie.SemanticTokenModifiers.modification,ie.SemanticTokenModifiers.documentation,ie.SemanticTokenModifiers.defaultLibrary],t.formats=[ie.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Zi.ensure)((0,Zi.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ie.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=DC.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Oo.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(S,v)=>{let P=this._client,E=P.middleware,F=(M,N)=>{let H={textDocument:P.code2ProtocolConverter.asTextDocumentIdentifier(M)};return P.sendRequest(ie.SemanticTokensRequest.type,H,N).then(V=>N.isCancellationRequested?null:P.protocol2CodeConverter.asSemanticTokens(V,N),V=>P.handleFailedRequest(ie.SemanticTokensRequest.type,N,V,null))};return E.provideDocumentSemanticTokens?E.provideDocumentSemanticTokens(S,v,F):F(S,v)},provideDocumentSemanticTokensEdits:i?(S,v,P)=>{let E=this._client,F=E.middleware,M=(N,H,V)=>{let de={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(N),previousResultId:H};return E.sendRequest(ie.SemanticTokensDeltaRequest.type,de,V).then(async B=>V.isCancellationRequested?null:ie.SemanticTokens.is(B)?await E.protocol2CodeConverter.asSemanticTokens(B,V):await E.protocol2CodeConverter.asSemanticTokensEdits(B,V),B=>E.handleFailedRequest(ie.SemanticTokensDeltaRequest.type,V,B,null))};return F.provideDocumentSemanticTokensEdits?F.provideDocumentSemanticTokensEdits(S,v,P,M):M(S,v,P)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(S,v,P)=>{let E=this._client,F=E.middleware,M=(N,H,V)=>{let de={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(N),range:E.code2ProtocolConverter.asRange(H)};return E.sendRequest(ie.SemanticTokensRangeRequest.type,de,V).then(B=>V.isCancellationRequested?null:E.protocol2CodeConverter.asSemanticTokens(B,V),B=>E.handleFailedRequest(ie.SemanticTokensRangeRequest.type,V,B,null))};return F.provideDocumentRangeSemanticTokens?F.provideDocumentRangeSemanticTokens(S,v,P,M):M(S,v,P)}}:void 0,h=[],p=this._client,y=p.protocol2CodeConverter.asSemanticTokensLegend(e.legend),m=p.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&h.push(Oo.languages.registerDocumentSemanticTokensProvider(m,o,y)),u!==void 0&&h.push(Oo.languages.registerDocumentRangeSemanticTokensProvider(m,u,y)),[new Oo.Disposable(()=>h.forEach(S=>S.dispose())),{range:u,full:o,onDidChangeSemanticTokensEmitter:s}]}};Lo.SemanticTokensFeature=Nl});var Nm=x(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.WillDeleteFilesFeature=At.WillRenameFilesFeature=At.WillCreateFilesFeature=At.DidDeleteFilesFeature=At.DidRenameFilesFeature=At.DidCreateFilesFeature=void 0;var on=require("vscode"),SC=no(),Kn=ee(),RC=je();function Lm(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function TC(n,e){return n[e]}function Fm(n,e,t){n[e]=t}var Bn=class{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Lm(Lm(e,"workspace"),"fileOperations");Fm(t,"dynamicRegistration",!0),Fm(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,r=t!==void 0?TC(t,this._serverCapability):void 0;if(r?.filters!==void 0)try{this.register({id:RC.generateUuid(),registerOptions:{filters:r.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new SC.Minimatch(r.pattern.glob,Bn.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return Bn.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let u of this._filters.values())for(let h of u)if(!(h.scheme!==void 0&&h.scheme!==o.scheme)){if(h.matcher.match(a)){if(h.kind===void 0)return!0;let p=await this.getFileType(o);if(p===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(p===on.FileType.File&&h.kind===Kn.FileOperationPatternKind.file||p===on.FileType.Directory&&h.kind===Kn.FileOperationPatternKind.folder)return!0}else if(h.kind===Kn.FileOperationPatternKind.folder&&await Bn.getFileType(o)===on.FileType.Directory&&h.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return{...e,files:i}}static async getFileType(e){try{return(await on.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},Fo=class extends Bn{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},No=class extends Fo{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await Bn.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Ml=class extends Fo{constructor(e){super(e,on.workspace.onDidCreateFiles,Kn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.didCreateFiles?r.didCreateFiles(e,t):t(e)}};At.DidCreateFilesFeature=Ml;var Al=class extends No{constructor(e){super(e,on.workspace.onDidRenameFiles,Kn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=on.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didRenameFiles?r.didRenameFiles(e,t):t(e)}};At.DidRenameFilesFeature=Al;var jl=class extends No{constructor(e){super(e,on.workspace.onDidDeleteFiles,Kn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=on.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return r?.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};At.DidDeleteFilesFeature=jl;var Qi=class extends Bn{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s),this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},$l=class extends Qi{constructor(e){super(e,on.workspace.onWillCreateFiles,Kn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willCreateFiles?r.willCreateFiles(e,t):t(e)}};At.WillCreateFilesFeature=$l;var Hl=class extends Qi{constructor(e){super(e,on.workspace.onWillRenameFiles,Kn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willRenameFiles?r.willRenameFiles(e,t):t(e)}};At.WillRenameFilesFeature=Hl;var Ul=class extends Qi{constructor(e){super(e,on.workspace.onWillDeleteFiles,Kn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return r?.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};At.WillDeleteFilesFeature=Ul});var Mm=x(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.LinkedEditingFeature=void 0;var PC=require("vscode"),Wl=ee(),Kl=ve(),Bl=class extends Kl.TextDocumentLanguageFeature{constructor(e){super(e,Wl.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Kl.ensure)((0,Kl.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,u=(p,y,m)=>a.sendRequest(Wl.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,y),m).then(S=>m.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(S,m),S=>a.handleFailedRequest(Wl.LinkedEditingRangeRequest.type,m,S,null)),h=a.middleware;return h.provideLinkedEditingRange?h.provideLinkedEditingRange(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return PC.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Mo.LinkedEditingFeature=Bl});var Am=x(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.TypeHierarchyFeature=void 0;var IC=require("vscode"),Or=ee(),zl=ve(),Xl=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,u,h)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(Or.TypeHierarchyPrepareRequest.type,p,h).then(y=>h.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(y,h),y=>i.handleFailedRequest(Or.TypeHierarchyPrepareRequest.type,h,y,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Or.TypeHierarchySupertypesRequest.type,u,a).then(h=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(h,a),h=>r.handleFailedRequest(Or.TypeHierarchySupertypesRequest.type,a,h,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let u={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Or.TypeHierarchySubtypesRequest.type,u,a).then(h=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(h,a),h=>r.handleFailedRequest(Or.TypeHierarchySubtypesRequest.type,a,h,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},Gl=class extends zl.TextDocumentLanguageFeature{constructor(e){super(e,Or.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,zl.ensure)((0,zl.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Xl(t);return[IC.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Ao.TypeHierarchyFeature=Gl});var $m=x($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.InlineValueFeature=void 0;var jm=require("vscode"),jo=ee(),Yi=ve(),Vl=class extends Yi.TextDocumentLanguageFeature{constructor(e){super(e,jo.InlineValueRequest.type)}fillClientCapabilities(e){(0,Yi.ensure)((0,Yi.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Yi.ensure)((0,Yi.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(jo.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new jm.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,u)=>{let h=this._client,p=(m,S,v,P)=>{let E={textDocument:h.code2ProtocolConverter.asTextDocumentIdentifier(m),range:h.code2ProtocolConverter.asRange(S),context:h.code2ProtocolConverter.asInlineValueContext(v)};return h.sendRequest(jo.InlineValueRequest.type,E,P).then(F=>P.isCancellationRequested?null:h.protocol2CodeConverter.asInlineValues(F,P),F=>h.handleFailedRequest(jo.InlineValueRequest.type,P,F,null))},y=h.middleware;return y.provideInlineValues?y.provideInlineValues(s,o,a,u,p):p(s,o,a,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return jm.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};$o.InlineValueFeature=Vl});var Um=x(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.InlayHintsFeature=void 0;var Hm=require("vscode"),mi=ee(),es=ve(),Jl=class extends es.TextDocumentLanguageFeature{constructor(e){super(e,mi.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,es.ensure)((0,es.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,es.ensure)((0,es.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(mi.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Hm.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let u=this._client,h=async(y,m,S)=>{let v={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(y),range:u.code2ProtocolConverter.asRange(m)};try{let P=await u.sendRequest(mi.InlayHintRequest.type,v,S);return S.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(P,S)}catch(P){return u.handleFailedRequest(mi.InlayHintRequest.type,S,P,null)}},p=u.middleware;return p.provideInlayHints?p.provideInlayHints(s,o,a,h):h(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,u=async(p,y)=>{try{let m=await a.sendRequest(mi.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(p),y);if(y.isCancellationRequested)return null;let S=a.protocol2CodeConverter.asInlayHint(m,y);return y.isCancellationRequested?null:S}catch(m){return a.handleFailedRequest(mi.InlayHintResolveRequest.type,y,m,null)}},h=a.middleware;return h.resolveInlayHint?h.resolveInlayHint(s,o,u):u(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return Hm.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ho.InlayHintsFeature=Jl});var Wm=x(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.InlineCompletionItemFeature=void 0;var EC=require("vscode"),Zl=ee(),Ql=ve(),xC=je(),Yl=class extends Ql.TextDocumentLanguageFeature{constructor(e){super(e,Zl.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Ql.ensure)((0,Ql.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:xC.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideInlineCompletionItems:(i,s,o,a)=>{let u=this._client,h=this._client.middleware,p=(y,m,S,v)=>u.sendRequest(Zl.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(y,m,S),v).then(P=>v.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(P,v),P=>u.handleFailedRequest(Zl.InlineCompletionRequest.type,v,P,null));return h.provideInlineCompletionItems?h.provideInlineCompletionItems(i,s,o,a,p):p(i,s,o,a)}};return[EC.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Uo.InlineCompletionItemFeature=Yl});var sd=x(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.ProposedFeatures=ut.BaseLanguageClient=ut.MessageTransports=ut.SuspendMode=ut.State=ut.CloseAction=ut.ErrorAction=ut.RevealOutputChannelOn=void 0;var Te=require("vscode"),A=ee(),qC=_g(),kC=wg(),_n=Yt(),Wo=Vs(),Km=je(),OC=su(),yn=ve(),LC=Su(),Bm=Yg(),zm=tm(),vi=nm(),FC=rm(),NC=im(),MC=sm(),AC=am(),jC=cm(),$C=Vu(),HC=lm(),UC=dm(),WC=fm(),KC=pm(),ed=gm(),BC=vm(),zC=ym(),XC=bm(),GC=Cm(),VC=wm(),JC=Dm(),ZC=Sm(),QC=Rm(),YC=Pm(),ew=Im(),tw=Em(),nw=qm(),rw=km(),iw=Om(),yi=Nm(),sw=Mm(),ow=Am(),aw=$m(),cw=Um(),uw=Wm(),Lr;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Lr||(ut.RevealOutputChannelOn=Lr={}));var ns;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(ns||(ut.ErrorAction=ns={}));var vr;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(vr||(ut.CloseAction=vr={}));var ts;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(ts||(ut.State=ts={}));var Xm;(function(n){n.off="off",n.on="on"})(Xm||(ut.SuspendMode=Xm={}));var td;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&_n.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(td||(td={}));var nd=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:ns.Continue}:{action:ns.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:vr.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:vr.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:vr.Restart})}},ue;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(ue||(ue={}));var Gm;(function(n){function e(t){return t&&A.MessageReader.is(t.reader)&&A.MessageWriter.is(t.writer)}n.is=e})(Gm||(ut.MessageTransports=Gm={}));var zn=class{constructor(e,t,r){this._traceFormat=A.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Wo.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=td.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Lr.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler(r.connectionOptions?.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=ue.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new Wo.Semaphore(1),this._pendingChangeDelayer=new Wo.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new Wo.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new A.Emitter,this._stateChangeEmitter=new A.Emitter,this._trace=A.Trace.Off,this._tracer={log:(s,o)=>{_n.string(s)?this.logTrace(s,o):this.logObjectTrace(s)}},this._c2p=qC.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=kC.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Te.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case ue.Starting:return ts.Starting;case ue.Running:return ts.Running;default:return ts.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===ue.StartFailed||this.$state===ue.Stopping||this.$state===ue.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();this._didChangeTextDocumentFeature.syncKind===A.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let s,o;return t.length===1?A.CancellationToken.is(t[0])?o=t[0]:s=t[0]:t.length===2&&(s=t[0],o=t[1]),i(e,s,o,(a,u,h)=>{let p=[];return u!==void 0&&p.push(u),h!==void 0&&p.push(h),r.sendRequest(a,...p)})}else return r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===ue.StartFailed||this.$state===ue.Stopping||this.$state===ue.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===A.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===A.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,s.sendNotification.bind(s),t):s.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){if(this.$state===ue.StartFailed||this.$state===ue.Stopping||this.$state===ue.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=this._clientOptions.middleware?.handleWorkDoneProgress,a=A.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new nd(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof A.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?_n.string(e.stack)?e.stack:e.message:_n.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(A.MessageType.Debug,Lr.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(A.MessageType.Info,Lr.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(A.MessageType.Warning,Lr.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(A.MessageType.Error,Lr.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,s,o){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),s!=null&&this.outputChannel.appendLine(this.data2String(s)),(o==="force"||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===A.MessageType.Error?Te.window.showErrorMessage:e===A.MessageType.Warning?Te.window.showWarningMessage:Te.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===ue.Initial||this.$state===ue.Stopping||this.$state===ue.Stopped}needsStop(){return this.$state===ue.Starting||this.$state===ue.Running}activeConnection(){return this.$state===ue.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===ue.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===ue.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Te.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Te.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=ue.Starting;try{let i=await this.createConnection();i.onNotification(A.LogMessageNotification.type,s=>{switch(s.type){case A.MessageType.Error:this.error(s.message,void 0,!1);break;case A.MessageType.Warning:this.warn(s.message,void 0,!1);break;case A.MessageType.Info:this.info(s.message,void 0,!1);break;case A.MessageType.Debug:this.debug(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(A.ShowMessageNotification.type,s=>{switch(s.type){case A.MessageType.Error:Te.window.showErrorMessage(s.message);break;case A.MessageType.Warning:Te.window.showWarningMessage(s.message);break;case A.MessageType.Info:Te.window.showInformationMessage(s.message);break;default:Te.window.showInformationMessage(s.message)}}),i.onRequest(A.ShowMessageRequest.type,s=>{let o;switch(s.type){case A.MessageType.Error:o=Te.window.showErrorMessage;break;case A.MessageType.Warning:o=Te.window.showWarningMessage;break;case A.MessageType.Info:o=Te.window.showInformationMessage;break;default:o=Te.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(A.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(A.ShowDocumentRequest.type,async s=>{let o=async u=>{let h=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Te.env.openExternal(h)};{let p={};return u.selection!==void 0&&(p.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?p.preserveFocus=!0:u.takeFocus===!0&&(p.preserveFocus=!1),await Te.window.showTextDocument(h,p),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=ue.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Te.env.appName,version:Te.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Te.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:_n.func(t)?t():t,trace:A.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=Km.generateUuid(),a=new OC.ProgressPart(e,o);s.workDoneToken=o;try{let u=await this.doInitialize(e,s);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==A.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=ue.Running;let i;_n.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===A.TextDocumentSyncKind.None?i={openClose:!1,change:A.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(A.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(A.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(A.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(A.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(A.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof A.ResponseError&&r.data&&r.data.retry?Te.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Te.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Te.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===ue.Stopped||this.$state===ue.Initial)return;if(this.$state===ue.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==ue.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=ue.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,A.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=ue.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(A.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(A.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,A.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,A.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new Te.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(u,h)=>this.setDiagnostics(u,h)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return Te.env.language}async $start(){if(this.$state===ue.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=lw(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===ue.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:vr.DoNotRestart};if(this.$state!==ue.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===vr.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===ue.Starting?this.$state=ue.StartFailed:this.$state=ue.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===vr.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=ue.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===ns.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Te.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=Te.workspace.getConfiguration(this._id),i=A.Trace.Off,s=A.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=A.Trace.fromString(o):(i=A.Trace.fromString(r.get("trace.server.verbosity","off")),s=A.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;_n.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(A.DidChangeWatchedFilesNotification.type.method).registerRaw(Km.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),yn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(A.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Bm.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new zm.ConfigurationFeature(this)),this.registerFeature(new vi.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new vi.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new vi.WillSaveFeature(this)),this.registerFeature(new vi.WillSaveWaitUntilFeature(this)),this.registerFeature(new vi.DidSaveTextDocumentFeature(this)),this.registerFeature(new vi.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new GC.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new FC.CompletionItemFeature(this)),this.registerFeature(new NC.HoverFeature(this)),this.registerFeature(new AC.SignatureHelpFeature(this)),this.registerFeature(new MC.DefinitionFeature(this)),this.registerFeature(new UC.ReferencesFeature(this)),this.registerFeature(new jC.DocumentHighlightFeature(this)),this.registerFeature(new $C.DocumentSymbolFeature(this)),this.registerFeature(new HC.WorkspaceSymbolFeature(this)),this.registerFeature(new WC.CodeActionFeature(this)),this.registerFeature(new KC.CodeLensFeature(this)),this.registerFeature(new ed.DocumentFormattingFeature(this)),this.registerFeature(new ed.DocumentRangeFormattingFeature(this)),this.registerFeature(new ed.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new BC.RenameFeature(this)),this.registerFeature(new zC.DocumentLinkFeature(this)),this.registerFeature(new XC.ExecuteCommandFeature(this)),this.registerFeature(new zm.SyncConfigurationFeature(this)),this.registerFeature(new ZC.TypeDefinitionFeature(this)),this.registerFeature(new JC.ImplementationFeature(this)),this.registerFeature(new VC.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new QC.WorkspaceFoldersFeature(this)),this.registerFeature(new YC.FoldingRangeFeature(this)),this.registerFeature(new ew.DeclarationFeature(this)),this.registerFeature(new tw.SelectionRangeFeature(this)),this.registerFeature(new nw.ProgressFeature(this)),this.registerFeature(new rw.CallHierarchyFeature(this)),this.registerFeature(new iw.SemanticTokensFeature(this)),this.registerFeature(new sw.LinkedEditingFeature(this)),this.registerFeature(new yi.DidCreateFilesFeature(this)),this.registerFeature(new yi.DidRenameFilesFeature(this)),this.registerFeature(new yi.DidDeleteFilesFeature(this)),this.registerFeature(new yi.WillCreateFilesFeature(this)),this.registerFeature(new yi.WillRenameFilesFeature(this)),this.registerFeature(new yi.WillDeleteFilesFeature(this)),this.registerFeature(new ow.TypeHierarchyFeature(this)),this.registerFeature(new aw.InlineValueFeature(this)),this.registerFeature(new cw.InlayHintsFeature(this)),this.registerFeature(new LC.DiagnosticFeature(this)),this.registerFeature(new Bm.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(id.createAll(this))}fillInitializeParams(e){for(let t of this._features)_n.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,yn.ensure)(e,"workspace").applyEdit=!0;let t=(0,yn.ensure)((0,yn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[A.ResourceOperationKind.Create,A.ResourceOperationKind.Rename,A.ResourceOperationKind.Delete],t.failureHandling=A.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,yn.ensure)((0,yn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[A.DiagnosticTag.Unnecessary,A.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,yn.ensure)(e,"window"),s=(0,yn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,yn.ensure)(i,"showDocument");o.support=!0;let a=(0,yn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(zn.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)_n.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,r=>this.doRegisterCapability(r)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,r=>this.doUnregisterCapability(r)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Te.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(A.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),u=i.get(a);if(u&&u.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):_n.asPromise(Te.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof A.ResponseError){if(r.code===A.ErrorCodes.PendingResponseRejected||r.code===A.ErrorCodes.ConnectionInactive)return i;if(r.code===A.LSPErrorCodes.RequestCancelled||r.code===A.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new yn.LSPCancellationError(r.data):new Te.CancellationError}else if(r.code===A.LSPErrorCodes.ContentModified){if(zn.RequestsToCancelOnContentModified.has(e.method)||zn.CancellableResolveCalls.has(e.method))throw new Te.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};ut.BaseLanguageClient=zn;zn.RequestsToCancelOnContentModified=new Set([A.SemanticTokensRequest.method,A.SemanticTokensRangeRequest.method,A.SemanticTokensDeltaRequest.method]);zn.CancellableResolveCalls=new Set([A.CompletionResolveRequest.method,A.CodeLensResolveRequest.method,A.CodeActionResolveRequest.method,A.InlayHintResolveRequest.method,A.DocumentLinkResolveRequest.method,A.WorkspaceSymbolResolveRequest.method]);var rd=class{error(e){(0,A.RAL)().console.error(e)}warn(e){(0,A.RAL)().console.warn(e)}info(e){(0,A.RAL)().console.info(e)}log(e){(0,A.RAL)().console.log(e)}};function lw(n,e,t,r,i){let s=new rd,o=(0,A.createProtocolConnection)(n,e,s,i);return o.onError(u=>{t(u[0],u[1],u[2])}),o.onClose(r),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(u,h,p)=>{let y={sendNotification:!1,traceFormat:A.TraceFormat.Text};return p===void 0?o.trace(u,h,y):(_n.boolean(p),o.trace(u,h,p))},initialize:u=>o.sendRequest(A.InitializeRequest.type,u),shutdown:()=>o.sendRequest(A.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(A.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var id;(function(n){function e(t){return[new uw.InlineCompletionItemFeature(t)]}n.createAll=e})(id||(ut.ProposedFeatures=id={}))});var Jm=x(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.terminate=void 0;var Vm=require("child_process"),dw=require("path"),fw=process.platform==="win32",hw=process.platform==="darwin",pw=process.platform==="linux";function gw(n,e){if(fw)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Vm.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(pw||hw)try{var t=(0,dw.join)(__dirname,"terminateProcess.sh"),r=Vm.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Ko.terminate=gw});var od=x((q0,Zm)=>{"use strict";Zm.exports=ee()});var rs=x((k0,Qm)=>{var mw=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Qm.exports=mw});var Bo=x((O0,Ym)=>{var vw="2.0.0",yw=Number.MAX_SAFE_INTEGER||9007199254740991,_w=16,bw=256-6,Cw=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Ym.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:_w,MAX_SAFE_BUILD_LENGTH:bw,MAX_SAFE_INTEGER:yw,RELEASE_TYPES:Cw,SEMVER_SPEC_VERSION:vw,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var zo=x((Xn,ev)=>{var{MAX_SAFE_COMPONENT_LENGTH:ad,MAX_SAFE_BUILD_LENGTH:ww,MAX_LENGTH:Dw}=Bo(),Sw=rs();Xn=ev.exports={};var Rw=Xn.re=[],Tw=Xn.safeRe=[],z=Xn.src=[],X=Xn.t={},Pw=0,cd="[a-zA-Z0-9-]",Iw=[["\\s",1],["\\d",Dw],[cd,ww]],Ew=n=>{for(let[e,t]of Iw)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},ae=(n,e,t)=>{let r=Ew(e),i=Pw++;Sw(n,i,e),X[n]=i,z[i]=e,Rw[i]=new RegExp(e,t?"g":void 0),Tw[i]=new RegExp(r,t?"g":void 0)};ae("NUMERICIDENTIFIER","0|[1-9]\\d*");ae("NUMERICIDENTIFIERLOOSE","\\d+");ae("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${cd}*`);ae("MAINVERSION",`(${z[X.NUMERICIDENTIFIER]})\\.(${z[X.NUMERICIDENTIFIER]})\\.(${z[X.NUMERICIDENTIFIER]})`);ae("MAINVERSIONLOOSE",`(${z[X.NUMERICIDENTIFIERLOOSE]})\\.(${z[X.NUMERICIDENTIFIERLOOSE]})\\.(${z[X.NUMERICIDENTIFIERLOOSE]})`);ae("PRERELEASEIDENTIFIER",`(?:${z[X.NUMERICIDENTIFIER]}|${z[X.NONNUMERICIDENTIFIER]})`);ae("PRERELEASEIDENTIFIERLOOSE",`(?:${z[X.NUMERICIDENTIFIERLOOSE]}|${z[X.NONNUMERICIDENTIFIER]})`);ae("PRERELEASE",`(?:-(${z[X.PRERELEASEIDENTIFIER]}(?:\\.${z[X.PRERELEASEIDENTIFIER]})*))`);ae("PRERELEASELOOSE",`(?:-?(${z[X.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${z[X.PRERELEASEIDENTIFIERLOOSE]})*))`);ae("BUILDIDENTIFIER",`${cd}+`);ae("BUILD",`(?:\\+(${z[X.BUILDIDENTIFIER]}(?:\\.${z[X.BUILDIDENTIFIER]})*))`);ae("FULLPLAIN",`v?${z[X.MAINVERSION]}${z[X.PRERELEASE]}?${z[X.BUILD]}?`);ae("FULL",`^${z[X.FULLPLAIN]}$`);ae("LOOSEPLAIN",`[v=\\s]*${z[X.MAINVERSIONLOOSE]}${z[X.PRERELEASELOOSE]}?${z[X.BUILD]}?`);ae("LOOSE",`^${z[X.LOOSEPLAIN]}$`);ae("GTLT","((?:<|>)?=?)");ae("XRANGEIDENTIFIERLOOSE",`${z[X.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ae("XRANGEIDENTIFIER",`${z[X.NUMERICIDENTIFIER]}|x|X|\\*`);ae("XRANGEPLAIN",`[v=\\s]*(${z[X.XRANGEIDENTIFIER]})(?:\\.(${z[X.XRANGEIDENTIFIER]})(?:\\.(${z[X.XRANGEIDENTIFIER]})(?:${z[X.PRERELEASE]})?${z[X.BUILD]}?)?)?`);ae("XRANGEPLAINLOOSE",`[v=\\s]*(${z[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${z[X.XRANGEIDENTIFIERLOOSE]})(?:\\.(${z[X.XRANGEIDENTIFIERLOOSE]})(?:${z[X.PRERELEASELOOSE]})?${z[X.BUILD]}?)?)?`);ae("XRANGE",`^${z[X.GTLT]}\\s*${z[X.XRANGEPLAIN]}$`);ae("XRANGELOOSE",`^${z[X.GTLT]}\\s*${z[X.XRANGEPLAINLOOSE]}$`);ae("COERCE",`(^|[^\\d])(\\d{1,${ad}})(?:\\.(\\d{1,${ad}}))?(?:\\.(\\d{1,${ad}}))?(?:$|[^\\d])`);ae("COERCERTL",z[X.COERCE],!0);ae("LONETILDE","(?:~>?)");ae("TILDETRIM",`(\\s*)${z[X.LONETILDE]}\\s+`,!0);Xn.tildeTrimReplace="$1~";ae("TILDE",`^${z[X.LONETILDE]}${z[X.XRANGEPLAIN]}$`);ae("TILDELOOSE",`^${z[X.LONETILDE]}${z[X.XRANGEPLAINLOOSE]}$`);ae("LONECARET","(?:\\^)");ae("CARETTRIM",`(\\s*)${z[X.LONECARET]}\\s+`,!0);Xn.caretTrimReplace="$1^";ae("CARET",`^${z[X.LONECARET]}${z[X.XRANGEPLAIN]}$`);ae("CARETLOOSE",`^${z[X.LONECARET]}${z[X.XRANGEPLAINLOOSE]}$`);ae("COMPARATORLOOSE",`^${z[X.GTLT]}\\s*(${z[X.LOOSEPLAIN]})$|^$`);ae("COMPARATOR",`^${z[X.GTLT]}\\s*(${z[X.FULLPLAIN]})$|^$`);ae("COMPARATORTRIM",`(\\s*)${z[X.GTLT]}\\s*(${z[X.LOOSEPLAIN]}|${z[X.XRANGEPLAIN]})`,!0);Xn.comparatorTrimReplace="$1$2$3";ae("HYPHENRANGE",`^\\s*(${z[X.XRANGEPLAIN]})\\s+-\\s+(${z[X.XRANGEPLAIN]})\\s*$`);ae("HYPHENRANGELOOSE",`^\\s*(${z[X.XRANGEPLAINLOOSE]})\\s+-\\s+(${z[X.XRANGEPLAINLOOSE]})\\s*$`);ae("STAR","(<|>)?=?\\s*\\*");ae("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ae("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Xo=x((L0,tv)=>{var xw=Object.freeze({loose:!0}),qw=Object.freeze({}),kw=n=>n?typeof n!="object"?xw:n:qw;tv.exports=kw});var sv=x((F0,iv)=>{var nv=/^[0-9]+$/,rv=(n,e)=>{let t=nv.test(n),r=nv.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},Ow=(n,e)=>rv(e,n);iv.exports={compareIdentifiers:rv,rcompareIdentifiers:Ow}});var is=x((N0,uv)=>{var Go=rs(),{MAX_LENGTH:ov,MAX_SAFE_INTEGER:Vo}=Bo(),{safeRe:av,t:cv}=zo(),Lw=Xo(),{compareIdentifiers:_i}=sv(),Gt=class{constructor(e,t){if(t=Lw(t),e instanceof Gt){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>ov)throw new TypeError(`version is longer than ${ov} characters`);Go("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?av[cv.LOOSE]:av[cv.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Vo||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Vo||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Vo||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<Vo)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Go("SemVer.compare",this.version,this.options,e),!(e instanceof Gt)){if(typeof e=="string"&&e===this.version)return 0;e=new Gt(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Gt||(e=new Gt(e,this.options)),_i(this.major,e.major)||_i(this.minor,e.minor)||_i(this.patch,e.patch)}comparePre(e){if(e instanceof Gt||(e=new Gt(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(Go("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return _i(r,i)}while(++t)}compareBuild(e){e instanceof Gt||(e=new Gt(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(Go("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return _i(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),_i(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};uv.exports=Gt});var fv=x((M0,dv)=>{var lv=is(),Fw=(n,e,t=!1)=>{if(n instanceof lv)return n;try{return new lv(n,e)}catch(r){if(!t)return null;throw r}};dv.exports=Fw});var pv=x((A0,hv)=>{"use strict";hv.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var mv=x((j0,gv)=>{"use strict";gv.exports=we;we.Node=Fr;we.create=we;function we(n){var e=this;if(e instanceof we||(e=new we),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}we.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};we.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};we.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};we.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)Mw(this,arguments[n]);return this.length};we.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)Aw(this,arguments[n]);return this.length};we.prototype.pop=function(){if(this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};we.prototype.shift=function(){if(this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};we.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};we.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};we.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};we.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};we.prototype.map=function(n,e){e=e||this;for(var t=new we,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};we.prototype.mapReverse=function(n,e){e=e||this;for(var t=new we,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};we.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};we.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};we.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};we.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};we.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new we;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};we.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new we;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};we.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var s=[],r=0;i&&r<e;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=Nw(this,i,t[r]);return s};we.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function Nw(n,e,t){var r=e===n.head?new Fr(t,null,e,n):new Fr(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function Mw(n,e){n.tail=new Fr(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function Aw(n,e){n.head=new Fr(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function Fr(n,e,t,r){if(!(this instanceof Fr))return new Fr(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{pv()(we)}catch{}});var Cv=x(($0,bv)=>{"use strict";var jw=mv(),Nr=Symbol("max"),Vn=Symbol("length"),bi=Symbol("lengthCalculator"),os=Symbol("allowStale"),Mr=Symbol("maxAge"),Gn=Symbol("dispose"),vv=Symbol("noDisposeOnSet"),lt=Symbol("lruList"),bn=Symbol("cache"),_v=Symbol("updateAgeOnGet"),ud=()=>1,dd=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[Nr]=e.max||1/0,r=e.length||ud;if(this[bi]=typeof r!="function"?ud:r,this[os]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Mr]=e.maxAge||0,this[Gn]=e.dispose,this[vv]=e.noDisposeOnSet||!1,this[_v]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Nr]=e||1/0,ss(this)}get max(){return this[Nr]}set allowStale(e){this[os]=!!e}get allowStale(){return this[os]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Mr]=e,ss(this)}get maxAge(){return this[Mr]}set lengthCalculator(e){typeof e!="function"&&(e=ud),e!==this[bi]&&(this[bi]=e,this[Vn]=0,this[lt].forEach(t=>{t.length=this[bi](t.value,t.key),this[Vn]+=t.length})),ss(this)}get lengthCalculator(){return this[bi]}get length(){return this[Vn]}get itemCount(){return this[lt].length}rforEach(e,t){t=t||this;for(let r=this[lt].tail;r!==null;){let i=r.prev;yv(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[lt].head;r!==null;){let i=r.next;yv(this,e,r,t),r=i}}keys(){return this[lt].toArray().map(e=>e.key)}values(){return this[lt].toArray().map(e=>e.value)}reset(){this[Gn]&&this[lt]&&this[lt].length&&this[lt].forEach(e=>this[Gn](e.key,e.value)),this[bn]=new Map,this[lt]=new jw,this[Vn]=0}dump(){return this[lt].map(e=>Jo(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[lt]}set(e,t,r){if(r=r||this[Mr],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,s=this[bi](t,e);if(this[bn].has(e)){if(s>this[Nr])return Ci(this,this[bn].get(e)),!1;let u=this[bn].get(e).value;return this[Gn]&&(this[vv]||this[Gn](e,u.value)),u.now=i,u.maxAge=r,u.value=t,this[Vn]+=s-u.length,u.length=s,this.get(e),ss(this),!0}let o=new fd(e,t,s,i,r);return o.length>this[Nr]?(this[Gn]&&this[Gn](e,t),!1):(this[Vn]+=o.length,this[lt].unshift(o),this[bn].set(e,this[lt].head),ss(this),!0)}has(e){if(!this[bn].has(e))return!1;let t=this[bn].get(e).value;return!Jo(this,t)}get(e){return ld(this,e,!0)}peek(e){return ld(this,e,!1)}pop(){let e=this[lt].tail;return e?(Ci(this,e),e.value):null}del(e){Ci(this,this[bn].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[bn].forEach((e,t)=>ld(this,t,!1))}},ld=(n,e,t)=>{let r=n[bn].get(e);if(r){let i=r.value;if(Jo(n,i)){if(Ci(n,r),!n[os])return}else t&&(n[_v]&&(r.value.now=Date.now()),n[lt].unshiftNode(r));return i.value}},Jo=(n,e)=>{if(!e||!e.maxAge&&!n[Mr])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[Mr]&&t>n[Mr]},ss=n=>{if(n[Vn]>n[Nr])for(let e=n[lt].tail;n[Vn]>n[Nr]&&e!==null;){let t=e.prev;Ci(n,e),e=t}},Ci=(n,e)=>{if(e){let t=e.value;n[Gn]&&n[Gn](t.key,t.value),n[Vn]-=t.length,n[bn].delete(t.key),n[lt].removeNode(e)}},fd=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=s||0}},yv=(n,e,t,r)=>{let i=t.value;Jo(n,i)&&(Ci(n,t),n[os]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};bv.exports=dd});var Ar=x((H0,Dv)=>{var wv=is(),$w=(n,e,t)=>new wv(n,t).compare(new wv(e,t));Dv.exports=$w});var Rv=x((U0,Sv)=>{var Hw=Ar(),Uw=(n,e,t)=>Hw(n,e,t)===0;Sv.exports=Uw});var Pv=x((W0,Tv)=>{var Ww=Ar(),Kw=(n,e,t)=>Ww(n,e,t)!==0;Tv.exports=Kw});var Ev=x((K0,Iv)=>{var Bw=Ar(),zw=(n,e,t)=>Bw(n,e,t)>0;Iv.exports=zw});var qv=x((B0,xv)=>{var Xw=Ar(),Gw=(n,e,t)=>Xw(n,e,t)>=0;xv.exports=Gw});var Ov=x((z0,kv)=>{var Vw=Ar(),Jw=(n,e,t)=>Vw(n,e,t)<0;kv.exports=Jw});var Fv=x((X0,Lv)=>{var Zw=Ar(),Qw=(n,e,t)=>Zw(n,e,t)<=0;Lv.exports=Qw});var Mv=x((G0,Nv)=>{var Yw=Rv(),eD=Pv(),tD=Ev(),nD=qv(),rD=Ov(),iD=Fv(),sD=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return Yw(n,t,r);case"!=":return eD(n,t,r);case">":return tD(n,t,r);case">=":return nD(n,t,r);case"<":return rD(n,t,r);case"<=":return iD(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Nv.exports=sD});var Kv=x((V0,Wv)=>{var as=Symbol("SemVer ANY"),wi=class{static get ANY(){return as}constructor(e,t){if(t=Av(t),e instanceof wi){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),pd("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===as?this.value="":this.value=this.operator+this.semver.version,pd("comp",this)}parse(e){let t=this.options.loose?jv[$v.COMPARATORLOOSE]:jv[$v.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Hv(r[2],this.options.loose):this.semver=as}toString(){return this.value}test(e){if(pd("Comparator.test",e,this.options.loose),this.semver===as||e===as)return!0;if(typeof e=="string")try{e=new Hv(e,this.options)}catch{return!1}return hd(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof wi))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Uv(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Uv(this.value,t).test(e.semver):(t=Av(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||hd(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||hd(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Wv.exports=wi;var Av=Xo(),{safeRe:jv,t:$v}=zo(),hd=Mv(),pd=rs(),Hv=is(),Uv=gd()});var gd=x((J0,Gv)=>{var jr=class{constructor(e,t){if(t=aD(t),e instanceof jr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new jr(e.raw,t);if(e instanceof md)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!zv(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&pD(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&fD)|(this.options.loose&&hD))+":"+e,i=Bv.get(r);if(i)return i;let s=this.options.loose,o=s?jt[Et.HYPHENRANGELOOSE]:jt[Et.HYPHENRANGE];e=e.replace(o,SD(this.options.includePrerelease)),Ne("hyphen replace",e),e=e.replace(jt[Et.COMPARATORTRIM],uD),Ne("comparator trim",e),e=e.replace(jt[Et.TILDETRIM],lD),Ne("tilde trim",e),e=e.replace(jt[Et.CARETTRIM],dD),Ne("caret trim",e);let a=e.split(" ").map(y=>gD(y,this.options)).join(" ").split(/\s+/).map(y=>DD(y,this.options));s&&(a=a.filter(y=>(Ne("loose invalid filter",y,this.options),!!y.match(jt[Et.COMPARATORLOOSE])))),Ne("range list",a);let u=new Map,h=a.map(y=>new md(y,this.options));for(let y of h){if(zv(y))return[y];u.set(y.value,y)}u.size>1&&u.has("")&&u.delete("");let p=[...u.values()];return Bv.set(r,p),p}intersects(e,t){if(!(e instanceof jr))throw new TypeError("a Range is required");return this.set.some(r=>Xv(r,t)&&e.set.some(i=>Xv(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new cD(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(RD(this.set[t],e,this.options))return!0;return!1}};Gv.exports=jr;var oD=Cv(),Bv=new oD({max:1e3}),aD=Xo(),md=Kv(),Ne=rs(),cD=is(),{safeRe:jt,t:Et,comparatorTrimReplace:uD,tildeTrimReplace:lD,caretTrimReplace:dD}=zo(),{FLAG_INCLUDE_PRERELEASE:fD,FLAG_LOOSE:hD}=Bo(),zv=n=>n.value==="<0.0.0-0",pD=n=>n.value==="",Xv=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},gD=(n,e)=>(Ne("comp",n,e),n=yD(n,e),Ne("caret",n),n=mD(n,e),Ne("tildes",n),n=bD(n,e),Ne("xrange",n),n=wD(n,e),Ne("stars",n),n),xt=n=>!n||n.toLowerCase()==="x"||n==="*",mD=(n,e)=>n.trim().split(/\s+/).map(t=>vD(t,e)).join(" "),vD=(n,e)=>{let t=e.loose?jt[Et.TILDELOOSE]:jt[Et.TILDE];return n.replace(t,(r,i,s,o,a)=>{Ne("tilde",n,r,i,s,o,a);let u;return xt(i)?u="":xt(s)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:xt(o)?u=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(Ne("replaceTilde pr",a),u=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):u=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,Ne("tilde return",u),u})},yD=(n,e)=>n.trim().split(/\s+/).map(t=>_D(t,e)).join(" "),_D=(n,e)=>{Ne("caret",n,e);let t=e.loose?jt[Et.CARETLOOSE]:jt[Et.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,u)=>{Ne("caret",n,i,s,o,a,u);let h;return xt(s)?h="":xt(o)?h=`>=${s}.0.0${r} <${+s+1}.0.0-0`:xt(a)?s==="0"?h=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:h=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:u?(Ne("replaceCaret pr",u),s==="0"?o==="0"?h=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:h=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:h=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(Ne("no pr"),s==="0"?o==="0"?h=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:h=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:h=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),Ne("caret return",h),h})},bD=(n,e)=>(Ne("replaceXRanges",n,e),n.split(/\s+/).map(t=>CD(t,e)).join(" ")),CD=(n,e)=>{n=n.trim();let t=e.loose?jt[Et.XRANGELOOSE]:jt[Et.XRANGE];return n.replace(t,(r,i,s,o,a,u)=>{Ne("xRange",n,r,i,s,o,a,u);let h=xt(s),p=h||xt(o),y=p||xt(a),m=y;return i==="="&&m&&(i=""),u=e.includePrerelease?"-0":"",h?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&m?(p&&(o=0),a=0,i===">"?(i=">=",p?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",p?s=+s+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+s}.${o}.${a}${u}`):p?r=`>=${s}.0.0${u} <${+s+1}.0.0-0`:y&&(r=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),Ne("xRange return",r),r})},wD=(n,e)=>(Ne("replaceStars",n,e),n.trim().replace(jt[Et.STAR],"")),DD=(n,e)=>(Ne("replaceGTE0",n,e),n.trim().replace(jt[e.includePrerelease?Et.GTE0PRE:Et.GTE0],"")),SD=n=>(e,t,r,i,s,o,a,u,h,p,y,m,S)=>(xt(r)?t="":xt(i)?t=`>=${r}.0.0${n?"-0":""}`:xt(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,xt(h)?u="":xt(p)?u=`<${+h+1}.0.0-0`:xt(y)?u=`<${h}.${+p+1}.0-0`:m?u=`<=${h}.${p}.${y}-${m}`:n?u=`<${h}.${p}.${+y+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),RD=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Ne(n[r].semver),n[r].semver!==md.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Jv=x((Z0,Vv)=>{var TD=gd(),PD=(n,e,t)=>{try{e=new TD(e,t)}catch{return!1}return e.test(n)};Vv.exports=PD});var Qv=x(Vt=>{"use strict";var ID=Vt&&Vt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),vd=Vt&&Vt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ID(e,n,t)};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.DiagnosticPullMode=Vt.vsdiag=void 0;vd(ee(),Vt);vd(ve(),Vt);var Zv=Su();Object.defineProperty(Vt,"vsdiag",{enumerable:!0,get:function(){return Zv.vsdiag}});Object.defineProperty(Vt,"DiagnosticPullMode",{enumerable:!0,get:function(){return Zv.DiagnosticPullMode}});vd(sd(),Vt)});var ny=x($t=>{"use strict";var ED=$t&&$t.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),ty=$t&&$t.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ED(e,n,t)};Object.defineProperty($t,"__esModule",{value:!0});$t.SettingMonitor=$t.LanguageClient=$t.TransportKind=void 0;var Jn=require("child_process"),yd=require("fs"),_d=require("path"),_r=require("vscode"),$e=Yt(),Yv=sd(),xD=Jm(),Ke=od(),qD=fv(),kD=Jv();ty(od(),$t);ty(Qv(),$t);var ey="^1.82.0",Be;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(Be||($t.TransportKind=Be={}));var yr;(function(n){function e(t){let r=t;return r&&r.kind===Be.socket&&$e.number(r.port)}n.isSocket=e})(yr||(yr={}));var bd;(function(n){function e(t){return $e.string(t.command)}n.is=e})(bd||(bd={}));var Cd;(function(n){function e(t){return $e.string(t.module)}n.is=e})(Cd||(Cd={}));var wd;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(wd||(wd={}));var Dd;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Dd||(Dd={}));var Sd=class extends Yv.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,u,h,p;$e.string(t)?(o=e,a=t,u=r,h=i,p=!!s):(o=e.toLowerCase(),a=e,u=t,h=r,p=i),p===void 0&&(p=!1),super(o,a,h),this._serverOptions=u,this._forceDebug=p,this._isInDebugMode=p;try{this.checkVersion()}catch(y){throw $e.string(y.message)&&this.outputChannel.appendLine(y.message),y}}checkVersion(){let e=qD(_r.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${_r.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!kD(e,ey))throw new Error(`The language client requires VS Code version ${ey} but received version ${_r.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,xD.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(p,y){if(!p&&!y)return;let m=Object.create(null);return Object.keys(process.env).forEach(S=>m[S]=process.env[S]),y&&(m.ELECTRON_RUN_AS_NODE="1",m.ELECTRON_NO_ASAR="1"),p&&Object.keys(p).forEach(S=>m[S]=p[S]),m}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let p=process.execArgv;return p?p.some(y=>r.some(m=>y.startsWith(m))||i.some(m=>y===m)):!1}function o(p){if(p.stdin===null||p.stdout===null||p.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if($e.func(a))return a().then(p=>{if(Yv.MessageTransports.is(p))return this._isDetached=!!p.detached,p;if(wd.is(p))return this._isDetached=!!p.detached,{reader:new Ke.StreamMessageReader(p.reader),writer:new Ke.StreamMessageWriter(p.writer)};{let y;return Dd.is(p)?(y=p.process,this._isDetached=p.detached):(y=p,this._isDetached=!1),y.stderr.on("data",m=>this.outputChannel.append($e.string(m)?m:m.toString(e))),{reader:new Ke.StreamMessageReader(y.stdout),writer:new Ke.StreamMessageWriter(y.stdin)}}});let u,h=a;return h.run||h.debug?this._forceDebug||s()?(u=h.debug,this._isInDebugMode=!0):(u=h.run,this._isInDebugMode=!1):u=a,this._getServerWorkingDir(u.options).then(p=>{if(Cd.is(u)&&u.module){let y=u,m=y.transport||Be.stdio;if(y.runtime){let S=[],v=y.options??Object.create(null);v.execArgv&&v.execArgv.forEach(M=>S.push(M)),S.push(y.module),y.args&&y.args.forEach(M=>S.push(M));let P=Object.create(null);P.cwd=p,P.env=t(v.env,!1);let E=this._getRuntimePath(y.runtime,p),F;if(m===Be.ipc?(P.stdio=[null,null,null,"ipc"],S.push("--node-ipc")):m===Be.stdio?S.push("--stdio"):m===Be.pipe?(F=(0,Ke.generateRandomPipeName)(),S.push(`--pipe=${F}`)):yr.isSocket(m)&&S.push(`--socket=${m.port}`),S.push(`--clientProcessId=${process.pid.toString()}`),m===Be.ipc||m===Be.stdio){let M=Jn.spawn(E,S,P);return!M||!M.pid?Di(M,`Launching server using runtime ${E} failed.`):(this._serverProcess=M,M.stderr.on("data",N=>this.outputChannel.append($e.string(N)?N:N.toString(e))),m===Be.ipc?(M.stdout.on("data",N=>this.outputChannel.append($e.string(N)?N:N.toString(e))),Promise.resolve({reader:new Ke.IPCMessageReader(M),writer:new Ke.IPCMessageWriter(M)})):Promise.resolve({reader:new Ke.StreamMessageReader(M.stdout),writer:new Ke.StreamMessageWriter(M.stdin)}))}else{if(m===Be.pipe)return(0,Ke.createClientPipeTransport)(F).then(M=>{let N=Jn.spawn(E,S,P);return!N||!N.pid?Di(N,`Launching server using runtime ${E} failed.`):(this._serverProcess=N,N.stderr.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),N.stdout.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),M.onConnected().then(H=>({reader:H[0],writer:H[1]})))});if(yr.isSocket(m))return(0,Ke.createClientSocketTransport)(m.port).then(M=>{let N=Jn.spawn(E,S,P);return!N||!N.pid?Di(N,`Launching server using runtime ${E} failed.`):(this._serverProcess=N,N.stderr.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),N.stdout.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),M.onConnected().then(H=>({reader:H[0],writer:H[1]})))})}}else{let S;return new Promise((v,P)=>{let E=(y.args&&y.args.slice())??[];m===Be.ipc?E.push("--node-ipc"):m===Be.stdio?E.push("--stdio"):m===Be.pipe?(S=(0,Ke.generateRandomPipeName)(),E.push(`--pipe=${S}`)):yr.isSocket(m)&&E.push(`--socket=${m.port}`),E.push(`--clientProcessId=${process.pid.toString()}`);let F=y.options??Object.create(null);if(F.env=t(F.env,!0),F.execArgv=F.execArgv||[],F.cwd=p,F.silent=!0,m===Be.ipc||m===Be.stdio){let M=Jn.fork(y.module,E||[],F);o(M),this._serverProcess=M,M.stderr.on("data",N=>this.outputChannel.append($e.string(N)?N:N.toString(e))),m===Be.ipc?(M.stdout.on("data",N=>this.outputChannel.append($e.string(N)?N:N.toString(e))),v({reader:new Ke.IPCMessageReader(this._serverProcess),writer:new Ke.IPCMessageWriter(this._serverProcess)})):v({reader:new Ke.StreamMessageReader(M.stdout),writer:new Ke.StreamMessageWriter(M.stdin)})}else m===Be.pipe?(0,Ke.createClientPipeTransport)(S).then(M=>{let N=Jn.fork(y.module,E||[],F);o(N),this._serverProcess=N,N.stderr.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),N.stdout.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),M.onConnected().then(H=>{v({reader:H[0],writer:H[1]})},P)},P):yr.isSocket(m)&&(0,Ke.createClientSocketTransport)(m.port).then(M=>{let N=Jn.fork(y.module,E||[],F);o(N),this._serverProcess=N,N.stderr.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),N.stdout.on("data",H=>this.outputChannel.append($e.string(H)?H:H.toString(e))),M.onConnected().then(H=>{v({reader:H[0],writer:H[1]})},P)},P)})}}else if(bd.is(u)&&u.command){let y=u,m=u.args!==void 0?u.args.slice(0):[],S,v=u.transport;if(v===Be.stdio)m.push("--stdio");else if(v===Be.pipe)S=(0,Ke.generateRandomPipeName)(),m.push(`--pipe=${S}`);else if(yr.isSocket(v))m.push(`--socket=${v.port}`);else if(v===Be.ipc)throw new Error("Transport kind ipc is not support for command executable");let P=Object.assign({},y.options);if(P.cwd=P.cwd||p,v===void 0||v===Be.stdio){let E=Jn.spawn(y.command,m,P);return!E||!E.pid?Di(E,`Launching server using command ${y.command} failed.`):(E.stderr.on("data",F=>this.outputChannel.append($e.string(F)?F:F.toString(e))),this._serverProcess=E,this._isDetached=!!P.detached,Promise.resolve({reader:new Ke.StreamMessageReader(E.stdout),writer:new Ke.StreamMessageWriter(E.stdin)}))}else{if(v===Be.pipe)return(0,Ke.createClientPipeTransport)(S).then(E=>{let F=Jn.spawn(y.command,m,P);return!F||!F.pid?Di(F,`Launching server using command ${y.command} failed.`):(this._serverProcess=F,this._isDetached=!!P.detached,F.stderr.on("data",M=>this.outputChannel.append($e.string(M)?M:M.toString(e))),F.stdout.on("data",M=>this.outputChannel.append($e.string(M)?M:M.toString(e))),E.onConnected().then(M=>({reader:M[0],writer:M[1]})))});if(yr.isSocket(v))return(0,Ke.createClientSocketTransport)(v.port).then(E=>{let F=Jn.spawn(y.command,m,P);return!F||!F.pid?Di(F,`Launching server using command ${y.command} failed.`):(this._serverProcess=F,this._isDetached=!!P.detached,F.stderr.on("data",M=>this.outputChannel.append($e.string(M)?M:M.toString(e))),F.stdout.on("data",M=>this.outputChannel.append($e.string(M)?M:M.toString(e))),E.onConnected().then(M=>({reader:M[0],writer:M[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(p,y)=>{p!==null&&this.error(`Server process exited with code ${p}.`,void 0,!1),y!==null&&this.error(`Server process exited with signal ${y}.`,void 0,!1)})})}_getRuntimePath(e,t){if(_d.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=_d.join(r,e);if(yd.existsSync(i))return i}if(t!==void 0){let i=_d.join(t,e);if(yd.existsSync(i))return i}return e}_mainGetRootPath(){let e=_r.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{yd.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};$t.LanguageClient=Sd;var Rd=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return _r.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new _r.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?_r.workspace.getConfiguration(t).get(r,!1):_r.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};$t.SettingMonitor=Rd;function Di(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var iy=x((eR,ry)=>{"use strict";ry.exports=ny()});var FD={};Iy(FD,{activate:()=>LD});module.exports=Ey(FD);var Cy=$r(require("path")),Ri=$r(require("vscode")),cs=$r(iy());var Si=$r(ee());var sy=new Si.RequestType("moonbit-lsp/stat"),oy=new Si.RequestType("moonbit-lsp/readFile"),ay=new Si.RequestType("moonbit-lsp/readDirectory"),cy=new Si.RequestType0("moonbit-lsp/mooncVersion");var Zn=require("vscode");var St=new Map;St.set("/array.mbt",{content:`
pub fn to_string[X: Show](self: Array[X]) -> String {
  var acc = "["
  var i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      acc = acc + ", "
    }
    acc = acc + self[i].to_string()
  }
  acc + "]"
}
`,stat:{type:1,mtime:1704177721457963e-3,ctime:1704177721457963e-3,size:220}});St.set("/buffer.mbt",{content:`
/// Extensible buffer.
///
/// It provides accumulative concatenation of strings in linear time.
/// The capacity of buffer will automatically expand as necessary.
///
/// # Usage 
///
/// \`\`\`
/// let buf = Buffer::make(100)
/// buf.write_string("Tes")
/// buf.write_char("t")
/// println(buf.to_string()) // output: Test
/// \`\`\`
struct Buffer {
  mut bytes : Bytes
  mut len : Int
}

/// Expand the buffer size if capacity smaller than requried space.
fn grow_if_necessary(self : Buffer, required : Int) { 
  var enough_space = self.bytes.length()
  // double the enough_space until it larger than required
  while enough_space < required {
    enough_space = enough_space * 2
  }
  if enough_space != self.bytes.length() {
    let new_bytes = Bytes::make(enough_space, 0)
    blit(new_bytes, 0, self.bytes, 0, self.len)
    self.bytes = new_bytes
  }
}

/// Return a new String contains the data in buffer.
pub fn to_string(self : Buffer) -> String {
  self.bytes.sub_string(0, self.len)
}

/// Create a buffer with initial capacity.
pub fn Buffer::make(initial_capacity : Int) -> Buffer {
  let initial = if initial_capacity < 1 { 1 } else { initial_capacity }
  {
    bytes: Bytes::make(initial, 0),
    len: 0,
  }
}

/// Write a string into buffer.
pub fn write_string(self : Buffer, value : String) {
  self.grow_if_necessary(self.len + value.length())
  self.bytes.blit_from_string(self.len, value, 0, value.length())
  self.len = self.len + value.length()
}

/// Write a sub-string into buffer.
pub fn write_sub_string(self : Buffer, value : String, start: Int, len: Int) {
  if start < 0 || len < 0 || start + len > value.length() {
    abort("Buffer::write_sub_string")
  }
  self.grow_if_necessary(self.len + len)
  self.bytes.blit_from_string(self.len, value, start, len)
  self.len = self.len + len
}

/// Write a char into buffer.
pub fn write_char(self : Buffer, value : Char) {
  self.grow_if_necessary(self.len + 4)
  let inc = self.bytes.set_utf8_char(self.len, value)
  self.len = self.len + inc
}


/// Length of containing data.
pub fn length(self : Buffer) -> Int {
  self.len
}

`,stat:{type:1,mtime:17041777214580361e-4,ctime:17041777214580361e-4,size:2104}});St.set("/bytes.mbt",{content:`
fn unsafe_blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit"
fn unsafe_sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String = "$moonbit.unsafe_bytes_sub_string"
fn unsafe_bytes_blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) = "$moonbit.unsafe_bytes_blit_from_string"


/// Transfer bytes.
///
/// It copies \`length\` bytes from \`src\` begin at \`src_offset\`, to destination byte sequence \`self\` begin at \`dst_offset\`. 
///
/// # Usage
/// \`\`\`
/// let b1 = Bytes::of_string("abcdef")
/// let b2 = Bytes::of_string("ABCDEF")
/// b1.blit(2, b2, 3, 2)
/// println(b1.to_string()) // output: abDEef
/// \`\`\`
pub fn blit(self : Bytes, dst_offset : Int, src : Bytes, src_offset : Int, length : Int) {
  let s1 = dst_offset
  let s2 = src_offset
  let e1 = dst_offset + length - 1
  let e2 = src_offset + length - 1
  let len1 = self.length()
  let len2 = src.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit out of bounds")    
  } else {
    unsafe_blit(self, dst_offset, src, src_offset, length)
  } 
}

/// Create a new String from byte sequence.
pub fn to_string(self : Bytes) -> String {
  self.sub_string(0, self.length())
}

/// Create byte sequence from String.
pub fn Bytes::of_string(str : String) -> Bytes {
  let bytes = Bytes::make(str.length(), 0)
  bytes.blit_from_string(0, str, 0, bytes.length())
  bytes
}

/// Return a new String, containing the subsequence of \`self\` that 
/// starts at \`byte_offset\` and has length \`byte_length\`.
pub fn sub_string(self : Bytes, byte_offset : Int, byte_length : Int) -> String {
  if byte_length < 0 || byte_offset < 0 || 
       byte_offset + byte_length > self.length() {
    abort("sub_string out of bound")
  } else {
    unsafe_sub_string(self, byte_offset, byte_length)
  }
}

/// Copy \`length\` bytes from string \`str\`, starting at \`str_offset\`, 
/// into byte sequence \`self\`, starting at \`bytes_offset\`.
pub fn blit_from_string(self : Bytes, bytes_offset : Int, str : String, str_offset : Int, length : Int) {
  let s1 = bytes_offset
  let s2 = str_offset
  let e1 = bytes_offset + length - 1
  let e2 = str_offset + length - 1
  let len1 = self.length()
  let len2 = str.length()

  if length < 0 || 
     s1 < 0 || e1 >= len1 ||
     s2 < 0 || e2 >= len2 {
    abort("blit_from_string out of bounds")
  } else {
    unsafe_bytes_blit_from_string(self, bytes_offset, str, str_offset, length)
  }
}

/// Return a new Bytes that contains the same byte sequence.
pub fn copy(self : Bytes) -> Bytes {
  let dst = Bytes::make(self.length(), 0)
  blit(dst, 0, self, 0, self.length())
  dst
}

/// Fill utf8 encoded char \`value\` into byte sequence \`self\`, starting at \`offset\`.
/// It return the length of bytes has been written.
pub fn set_utf8_char(self : Bytes, offset : Int, value : Char) -> Int {
  let code = value.to_int()
  if (code < 0x80) {
    self[offset] = code.lsr(0).land(0x7F).lor(0x00)
    1
  } else if (code < 0x0800) {
    self[offset] = code.lsr(6).land(0x1F).lor(0xC0)
    self[offset + 1] = code.lsr(0).land(0x3F).lor(0x80)
    2
  } else if (code < 0x010000) {
    self[offset] = code.lsr(12).land(0x0F).lor(0xE0)
    self[offset + 1] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(0).land(0x3F).lor(0x80)
    3
  } else if (code < 0x110000) {
    self[offset] = code.lsr(18).land(0x07).lor(0xF0)
    self[offset + 1] = code.lsr(12).land(0x3F).lor(0x80)
    self[offset + 2] = code.lsr(6).land(0x3F).lor(0x80)
    self[offset + 3] = code.lsr(0).land(0x3F).lor(0x80)
    4
  } else { 
    abort("Char out of range") 
  }
}


`,stat:{type:1,mtime:17041777214588027e-4,ctime:17041777214588027e-4,size:3700}});St.set("/console.mbt",{content:`pub fn println[T : Show](input : T) -> Unit {
  print_string(input.to_string())
  print_string("\\n")
}

pub fn print[T : Show](input : T) -> Unit{
  print_string(input.to_string())
}

pub fn to_string(self : Bool) -> String {
  if self { 
    "true"
  } else {
    "false"
  }
}

pub fn to_string(self : Int64) -> String {
  fn abs(n : Int64) -> Int64 {
    if n < 0L {
      0L - n
    } else {
      n
    }
  }
  
  // The min and max value of i64 are -9223372036854775808 and 9223372036854775807,
  // so max=20 is enough. 
  let max = 20
  let bytes = Bytes::make(max,0)
  var num = self
  var p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10L).to_int()
    bytes[p] = c
    num = num / 10L
    if num == 0L { break }
  }

  if self < 0L {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_string(self : Int) -> String {
  fn abs(n : Int) -> Int {
    if n < 0 {
      0 - n
    } else {
      n
    }
  }
 
  // The min and max value of i32 are -2147483648 and 2147483647,
  // so max=11 is enough.
  let max = 11
  let bytes = Bytes::make(max,0)
  var num = self
  var p = max
  while true {
    p = p - 1 
    let c = 48 + abs(num % 10)
    bytes[p] = c
    num = num / 10
    if num == 0 { break }
  }

  if self < 0 {
    p = p - 1
    bytes[p] = '-'.to_int()
  }

  bytes.sub_string(p, max - p)
}

pub fn to_int(self : Bool) -> Int {
  if self {
    1
  } else {
    0
  }
}

pub fn to_int64(self : Bool) -> Int64 {
  if self {
    1L
  } else {
    0L
  }
}

fn to_bool(self : Int) -> Bool {
  if self == 0 {
    false
  } else {
    true
  }
}

fn to_bool(self : Int64) -> Bool {
  if self == 0L {
    false
  } else {
    true
  }
}

pub fn to_string(self : Double) -> String {
  double_to_string(self)
}

pub fn op_lt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_neg()
}

pub fn op_gt[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_pos()
}

pub fn op_le[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_pos()
}

pub fn op_ge[T: Compare](self_: T, other: T) -> Bool {
  self_.compare(other).is_non_neg()
}

pub fn op_notequal[T: Eq](x: T, y: T) -> Bool {
  not(x == y)
}

/// A reference to string in host JS.
pub type Js_string

/// Create a JS string from a string in Moonbit by calling intrinsic primitive
pub fn Js_string::new(x: String) -> Js_string {
  x.to_js_string()
}

/// Call FFI to log the JS string
pub fn log(self: Js_string) = "js_string" "log"

/// Call FFI to append two JS strings
pub fn op_add(self: Js_string, other: Js_string) -> Js_string = "js_string" "append"


fn unsafe_make_string(length : Int, value : Char) -> String = "$moonbit.unsafe_make_string"

/// Create new string of \`length\`, where each character is \`value\`
/// 
/// \`\`\`
/// println(String::make(5,'S')) // Output: "SSSSS"
/// \`\`\`
pub fn String::make(length : Int, value : Char) -> String {
  if length < 0 { 
    abort("invalid length") 
  } else {
    unsafe_make_string(length, value)
  }
}

/// Convert Char to String
pub fn to_string(self : Char) -> String {
  let bytes = Bytes::make(4, 0)
  let len = bytes.set_utf8_char(0, self)
  bytes.sub_string(0, len)
}
`,stat:{type:1,mtime:17041777214588716e-4,ctime:17041777214588716e-4,size:3196}});St.set("/debug.mbt",{content:`
/// [Debug] indicates a type can be printed for debugging
pub interface Debug {
  debug_write(Self, Buffer)
}

/// print a value to the console using [Debug], with a tailing newline
pub fn debug[X: Debug](x: X) {
  let buf = Buffer::make(10)
  x.debug_write(buf)
  println(buf.to_string())
}


pub fn debug_write(self: Unit, buf: Buffer) {
  let _ = self
  buf.write_string("()")
}

pub fn debug_write(self: Bool, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Int64, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Double, buf: Buffer) {
  buf.write_string(self.to_string())
}

pub fn debug_write(self: Char, buf: Buffer) {
  buf.write_char('\\'')
  match self {
    '\\n' => buf.write_string("\\\\n")
    '\\r' => buf.write_string("\\\\r")
    '\\'' => buf.write_string("\\\\'")
    _ => buf.write_char(self)
  }
  buf.write_char('\\'')
}

pub fn debug_write[X: Debug](self: Option[X], buf: Buffer) {
  match self {
    None => buf.write_string("None")
    Some(arg) => {
      buf.write_string("Some(")
      arg.debug_write(buf)
      buf.write_string(")")
    }
  }
}

pub fn debug_write[X: Debug](self: Ref[X], buf: Buffer) {
  buf.write_string("{val: ")
  self.val.debug_write(buf)
  buf.write_string("}")
}

pub fn debug_write[X: Debug](self: Array[X], buf: Buffer) {
  buf.write_char('[')
  var i = 0
  while i < self.length(), i = i + 1 {
    if i > 0 {
      buf.write_string(", ")
    }
    self[i].debug_write(buf)
  }
  buf.write_char(']')
}

pub fn debug_write(self: String, buf: Buffer) {
  buf.write_char('"')
  var segment_start = 0
  var i = 0
  fn flush_segment() {
    if i > segment_start {
      buf.write_sub_string(self, segment_start, i - segment_start)
    }
    segment_start = i + 1
  }
  while i < self.length(), i = i + 1 {
    let c = self[i]
    match c {
      '\\n' => {
        flush_segment()
        buf.write_string("\\\\n")
      }
      '\\r' => {
        flush_segment()
        buf.write_string("\\\\r")
      }
      '"' => {
        flush_segment()
        buf.write_string("\\\\\\"")
      }
      _ => ()
    }
  }
  flush_segment()
  buf.write_char('"')
}

pub fn debug_write[X: Debug, Y: Debug](self: (X, Y), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug](self: (X, Y, Z), buf: Buffer) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X: Debug, Y: Debug, Z: Debug, W: Debug](
  self: (X, Y, Z, W),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_char(')')
}

pub fn debug_write[X1: Debug, X2: Debug, X3: Debug, X4: Debug, X5: Debug](
  self: (X1, X2, X3, X4, X5),
  buf: Buffer
) {
  buf.write_char('(')
  self.0.debug_write(buf)
  buf.write_string(", ")
  self.1.debug_write(buf)
  buf.write_string(", ")
  self.2.debug_write(buf)
  buf.write_string(", ")
  self.3.debug_write(buf)
  buf.write_string(", ")
  self.4.debug_write(buf)
  buf.write_char(')')
}
`,stat:{type:1,mtime:17041816940898018e-4,ctime:17041816940898018e-4,size:3409}});St.set("/moon.pkg.json",{content:`{}
`,stat:{type:1,mtime:17041777214590344e-4,ctime:17041777214590344e-4,size:3}});St.set("/option.mbt",{content:`
pub fn Option::default[X]() -> Option[X] {
  None
}

pub fn op_equal[X: Eq](self: Option[X], other: Option[X]) -> Bool {
  match (self, other) {
    (None, None) => true
    (Some(x), Some(y)) => x == y
    _ => false
  }
}

pub fn compare[X: Compare](self: Option[X], other: Option[X]) -> Int {
  match self {
    None =>
      match other {
        None => 0
        Some(_) => -1
      }
    Some(x) =>
      match other {
        None => 1
        Some(y) => x.compare(y)
      }
  }
}

pub fn to_string[X: Show](self: Option[X]) -> String {
  match self {
    None => "None"
    Some(x) => "Some(" + x.to_string() + ")"
  }
}
`,stat:{type:1,mtime:17041816940900305e-4,ctime:17041816940900305e-4,size:632}});St.set("/ref.mbt",{content:`
pub fn to_string[X: Show](self: Ref[X]) -> String {
  "{val: " + self.val.to_string() + "}"
}
`,stat:{type:1,mtime:1704177721459147e-3,ctime:1704177721459147e-3,size:95}});St.set("/ryu.mbt",{content:`// MoonBit implementation of Ryu, https://github.com/ulfjack/ryu

fn log10Pow5(e : Int) -> Int {
  (e * 732923).lsr(20)
}

fn pow5bits(e : Int) -> Int {
  (e * 1217359).lsr(19) + 1
}

fn log10Pow2(e : Int) -> Int {
  (e * 78913).lsr(18)
}

// TODO: this is not efficient.
fn string_from_bytes(bytes : Bytes, from : Int, to : Int) -> String {
  var s = ""
  var i = from
  while i < to, i = i + 1 {
    s = s + Char::from_int(bytes[i]).to_string()
  }
  s
}

fn copy_special_str(sign : Bool, exponent : Bool, mantissa : Bool) -> String {
  if mantissa {
    return "NaN"
  }
  let s = if sign {
    "-"
  } else {
    ""
  }
  if exponent {
    return s + "Infinity"
  }
  return s + "0.0"
}

fn u64_lt(x : Int64, y : Int64) -> Bool {
  x.compare_u(y) == -1
}

fn umul128(a : Int64, b : Int64) -> (Int64, Int64) {
  let aLo : Int = a.to_int()
  let aHi : Int = a.lsr(32L).to_int()
  let bLo : Int = b.to_int()
  let bHi : Int = b.lsr(32L).to_int()
  let b00 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bLo)
  let b01 : Int64 = Int64::extend_i32_u(aLo) * Int64::extend_i32_u(bHi)
  let b10 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bLo)
  let b11 : Int64 = Int64::extend_i32_u(aHi) * Int64::extend_i32_u(bHi)
  let b00Lo : Int = b00.to_int()
  let b00Hi : Int = b00.lsr(32L).to_int()
  let mid1 : Int64 = b10 + Int64::extend_i32_u(b00Hi)
  let mid1Lo : Int = mid1.to_int()
  let mid1Hi : Int = mid1.lsr(32L).to_int()
  let mid2 : Int64 = b01 + Int64::extend_i32_u(mid1Lo)
  let mid2Lo : Int = mid2.to_int()
  let mid2Hi : Int = mid2.lsr(32L).to_int()
  let pHi : Int64 = b11 + Int64::extend_i32_u(mid1Hi) + Int64::extend_i32_u(
      mid2Hi,
    )
  let pLo : Int64 = Int64::extend_i32_u(mid2Lo).lsl(32L).lor(
    Int64::extend_i32_u(b00Lo),
  )
  (pLo, pHi)
}

fn shiftright128(lo : Int64, hi : Int64, dist : Int) -> Int64 {
  hi.lsl(64L - Int64::extend_i32_u(dist)).lor(lo.lsr(Int64::extend_i32_u(dist)))
}

fn pow5Factor(value : Int64) -> Int {
  // We want to find the largest power of 5 that divides value.
  if value % 5L != 0L {
    return 0
  }
  if value % 25L != 0L {
    return 1
  }
  if value % 125L != 0L {
    return 2
  }
  if value % 625L != 0L {
    return 3
  }
  var count = 4
  var value = value / 625L
  while value > 0L {
    if value % 5L != 0L {
      return count
    }
    value = value / 5L
    count = count + 1
  }
  abort("IllegalArgumentException \\(value)")
}

fn multipleOfPowerOf5(value : Int64, p : Int) -> Bool {
  pow5Factor(value) >= p
}

fn multipleOfPowerOf2(value : Int64, p : Int) -> Bool {
  value.land(1L.lsl(p.to_int64()) - 1L) == 0L
}

fn mulShiftAll64(m : Int64, mul : (Int64, Int64), j : Int, mmShift : Bool) ->
     (Int64, Int64, Int64) {
  let m = m.lsl(1L)
  let (lo, tmp) = umul128(m, mul.0)
  let (lo2, hi2) = umul128(m, mul.1)
  let mid = tmp + lo2
  let hi = hi2 + u64_lt(mid, tmp).to_int64()
  let lo2 = lo + mul.0
  let mid2 = mid + mul.1 + u64_lt(lo2, lo).to_int64()
  let hi2 = hi + u64_lt(mid2, mid).to_int64()
  let vp = shiftright128(mid2, hi2, j - 64 - 1)
  var vm : Int64 = 0L
  if mmShift {
    let lo3 = lo - mul.0
    let mid3 = mid - mul.1 - u64_lt(lo, lo3).to_int64()
    let hi3 = hi - u64_lt(mid, mid3).to_int64()
    vm = shiftright128(mid3, hi3, j - 64 - 1)
  } else {
    let lo3 : Int64 = lo + lo
    let mid3 : Int64 = mid + mid + u64_lt(lo3, lo).to_int64()
    let hi3 : Int64 = hi + hi + u64_lt(mid3, mid).to_int64()
    let lo4 : Int64 = lo3 - mul.0
    let mid4 : Int64 = mid3 - mul.1 - u64_lt(lo3, lo4).to_int64()
    let hi4 : Int64 = hi3 - u64_lt(mid3, mid4).to_int64()
    vm = shiftright128(mid4, hi4, j - 64)
  }
  let vr = shiftright128(mid, hi, j - 64 - 1)
  (vr, vp, vm)
}

let gPOW5_TABLE_SIZE = 26

let gDOUBLE_POW5_INV_SPLIT2 : Array[Int64] = [
  1L,
  2305843009213693952L,
  5955668970331000884L,
  1784059615882449851L,
  8982663654677661702L,
  1380349269358112757L,
  7286864317269821294L,
  2135987035920910082L,
  7005857020398200553L,
  1652639921975621497L,
  -481418970354774919L,
  1278668206209430417L,
  8928596168509315048L,
  1978643211784836272L,
  -8371072500651252758L,
  1530901034580419511L,
  597001226353042382L,
  1184477304306571148L,
  1527430471115325346L,
  1832889850782397517L,
  -5913534206540532074L,
  1418129833677084982L,
  5577825024675947042L,
  2194449627517475473L,
  -7439769533505684065L,
  1697873161311732311L,
  -8133250842069730034L,
  1313665730009899186L,
  -5745727253942878843L,
  2032799256770390445L,
]

let gPOW5_INV_OFFSETS : Array[Int] = [
  1414808916,
  67458373,
  268701696,
  4195348,
  1073807360,
  1091917141,
  1108,
  65604,
  1073741824,
  1140850753,
  1346716752,
  1431634004,
  1365595476,
  1073758208,
  16777217,
  66816,
  1364284433,
  89478484,
  0,
]

let gDOUBLE_POW5_SPLIT2 : Array[Int64] = [
  0L,
  1152921504606846976L,
  0L,
  1490116119384765625L,
  1032610780636961552L,
  1925929944387235853L,
  7910200175544436838L,
  1244603055572228341L,
  -1504838264676837686L,
  1608611746708759036L,
  -5421850118411349444L,
  2079081953128979843L,
  6607496772837067824L,
  1343575221513417750L,
  -1113817083813899013L,
  1736530273035216783L,
  -5409364890226003632L,
  2244412773384604712L,
  1605989338741628675L,
  1450417759929778918L,
  -8816519005292960336L,
  1874621017369538693L,
  665883850346957067L,
  1211445438634777304L,
  -3514853404985837908L,
  1565756531257009982L,
]

let gPOW5_OFFSETS : Array[Int] = [
  0,
  0,
  0,
  0,
  1073741824,
  1500076437,
  1431590229,
  1448432917,
  1091896580,
  1079333904,
  1146442053,
  1146111296,
  1163220304,
  1073758208,
  -1773927360,
  1431721317,
  1413824581,
  1075134801,
  1431671125,
  1363170645,
  261,
]

let gDOUBLE_POW5_TABLE : Array[Int64] = [
  1L,
  5L,
  25L,
  125L,
  625L,
  3125L,
  15625L,
  78125L,
  390625L,
  1953125L,
  9765625L,
  48828125L,
  244140625L,
  1220703125L,
  6103515625L,
  30517578125L,
  152587890625L,
  762939453125L,
  3814697265625L,
  19073486328125L,
  95367431640625L,
  476837158203125L,
  2384185791015625L,
  11920928955078125L,
  59604644775390625L,
  298023223876953125L,
]

fn double_computePow5(i : Int) -> (Int64, Int64) {
  let base : Int = i / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = i - base2
  let mul0 = gDOUBLE_POW5_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum : Int64 = high0 + low1
  var high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(i) - pow5bits(base2)
  let a = shiftright128(low0, sum, delta) + gPOW5_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

fn double_computeInvPow5(i : Int) -> (Int64, Int64) {
  let base : Int = (i + gPOW5_TABLE_SIZE - 1) / gPOW5_TABLE_SIZE
  let base2 : Int = base * gPOW5_TABLE_SIZE
  let offset : Int = base2 - i
  let mul0 = gDOUBLE_POW5_INV_SPLIT2[base * 2]
  let mul1 = gDOUBLE_POW5_INV_SPLIT2[base * 2 + 1]
  if offset == 0 {
    return (mul0, mul1)
  }
  let m : Int64 = gDOUBLE_POW5_TABLE[offset]
  let (low1, high1) = umul128(m, mul1)
  let (low0, high0) = umul128(m, mul0)
  let sum = high0 + low1
  var high1 = high1
  if u64_lt(sum, high0) {
    high1 = high1 + 1L
  }
  let delta : Int = pow5bits(base2) - pow5bits(i)
  let a = shiftright128(low0, sum, delta) + 1L + gPOW5_INV_OFFSETS[i / 16].lsr(
      (i % 16).lsl(1),
    ).land(3).to_int64()
  let b = shiftright128(sum, high1, delta)
  (a, b)
}

let gDOUBLE_MANTISSA_BITS : Int = 52

let gDOUBLE_EXPONENT_BITS : Int = 11

let gDOUBLE_BIAS : Int = 1023

let gDOUBLE_POW5_INV_BITCOUNT : Int = 125

let gDOUBLE_POW5_BITCOUNT : Int = 125

fn assert(b : Bool, msg : String) -> Unit {
  if not(b) {
    abort("assert failed: \\(msg)\\n")
  }
}

fn decimalLength17(v : Int64) -> Int {
  // This is slightly faster than a loop.
  // The average output length is 16.38 digits, so we check high-to-low.
  // Function precondition: v is not an 18, 19, or 20-digit number.
  // (17 digits are sufficient for round-tripping.)
  assert(v < 100000000000000000L, "v < 100000000000000000L")
  if v >= 10000000000000000L {
    return 17
  }
  if v >= 1000000000000000L {
    return 16
  }
  if v >= 100000000000000L {
    return 15
  }
  if v >= 10000000000000L {
    return 14
  }
  if v >= 1000000000000L {
    return 13
  }
  if v >= 100000000000L {
    return 12
  }
  if v >= 10000000000L {
    return 11
  }
  if v >= 1000000000L {
    return 10
  }
  if v >= 100000000L {
    return 9
  }
  if v >= 10000000L {
    return 8
  }
  if v >= 1000000L {
    return 7
  }
  if v >= 100000L {
    return 6
  }
  if v >= 10000L {
    return 5
  }
  if v >= 1000L {
    return 4
  }
  if v >= 100L {
    return 3
  }
  if v >= 10L {
    return 2
  }
  return 1
}

// A floating decimal representing m * 10^e.
priv struct FloatingDecimal64 {
  mantissa : Int64
  // Decimal exponent's range is -324 to 308
  // inclusive, and can fit in a short if needed.
  exponent : Int
}

fn to_string(self : FloatingDecimal64) -> String {
  let m = self.mantissa
  let e = self.exponent
  "{ mantissa: \\(m), exponent: \\(e) }"
}

fn d2d(ieeeMantissa : Int64, ieeeExponent : Int) -> FloatingDecimal64 {
  var e2 : Int = 0
  var m2 : Int64 = 0L
  if ieeeExponent == 0 {
    e2 = 1 - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = ieeeMantissa
  } else {
    e2 = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS - 2
    m2 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  }
  let even = m2.land(1L) == 0L
  let acceptBounds = even

  // Step 2: Determine the interval of valid decimal representations.
  let mv = 4L * m2
  // Implicit bool -> int conversion. True is 1, false is 0.
  let mmShift = ieeeMantissa != 0L || ieeeExponent <= 1
  // We would compute mp and mm like this:
  // uint64_t mp = 4 * m2 + 2;
  // uint64_t mm = mv - 1 - mmShift;

  // Step 3: Convert to a decimal power base using 128-bit arithmetic.
  var vr : Int64 = 0L
  var vp : Int64 = 0L
  var vm : Int64 = 0L
  var e10 : Int = 0
  var vmIsTrailingZeros = false
  var vrIsTrailingZeros = false
  if e2 >= 0 {
    // I tried special-casing q == 0, but there was no effect on performance.
    // This expression is slightly faster than max(0, log10Pow2(e2) - 1).
    let q : Int = log10Pow2(e2) - (e2 > 3).to_int()
    e10 = q
    let k = gDOUBLE_POW5_INV_BITCOUNT + pow5bits(q) - 1
    let i = -e2 + q + k
    let pow5 = double_computeInvPow5(q)
    let vs = mulShiftAll64(m2, pow5, i, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 21 {
      // This should use q <= 22, but I think 21 is also safe. Smaller values
      // may still be safe, but it's more difficult to reason about them.
      // Only one of mp, mv, and mm can be a multiple of 5, if any.
      let mvMod5 : Int = mv.to_int() - 5 * (mv / 5L).to_int()
      if mvMod5 == 0 {
        vrIsTrailingZeros = multipleOfPowerOf5(mv, q)
      } else if acceptBounds {
        // Same as min(e2 + (~mm & 1), pow5Factor(mm)) >= q
        // <=> e2 + (~mm & 1) >= q && pow5Factor(mm) >= q
        // <=> true && pow5Factor(mm) >= q, since e2 >= q.
        vmIsTrailingZeros = multipleOfPowerOf5(mv - 1L - mmShift.to_int64(), q)
      } else {
        vp = vp - multipleOfPowerOf5(mv + 2L, q).to_int64()
      }
    }
  } else {
    // This expression is slightly faster than max(0, log10Pow5(-e2) - 1).
    let q : Int = log10Pow5(-e2) - (-e2 > 1).to_int()
    e10 = q + e2
    let i : Int = -e2 - q
    let k = pow5bits(i) - gDOUBLE_POW5_BITCOUNT
    let j = q - k
    let pow5 = double_computePow5(i)
    let vs = mulShiftAll64(m2, pow5, j, mmShift)
    vr = vs.0
    vp = vs.1
    vm = vs.2
    if q <= 1 {
      // {vr,vp,vm} is trailing zeros if {mv,mp,mm} has at least q trailing 0 bits.
      // mv = 4 * m2, so it always has at least two trailing 0 bits.
      vrIsTrailingZeros = true
      if acceptBounds {
        vmIsTrailingZeros = mmShift.to_int() == 1
      } else {
        vp = vp - 1L
      }
    } else if q < 63 {
      vrIsTrailingZeros = multipleOfPowerOf2(mv, q)
    }
  }

  // Step 4: Find the shortest decimal representation in the interval of valid representations.
  var removed : Int = 0
  var lastRemovedDigit : Int = 0
  var output : Int64 = 0L
  // On average, we remove ~2 digits.
  if vmIsTrailingZeros || vrIsTrailingZeros {
    // General case, which happens rarely (~0.7%).
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      vmIsTrailingZeros = vmIsTrailingZeros && vmMod10 == 0
      vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
      lastRemovedDigit = vrMod10
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    if vmIsTrailingZeros {
      while true {
        let vmDiv10 : Int64 = vm / 10L
        let vmMod10 : Int = vm.to_int() - 10 * vmDiv10.to_int()
        if vmMod10 != 0 {
          break
        }
        let vpDiv10 : Int64 = vp / 10L
        let vrDiv10 : Int64 = vr / 10L
        let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
        vrIsTrailingZeros = vrIsTrailingZeros && lastRemovedDigit == 0
        lastRemovedDigit = vrMod10
        vr = vrDiv10
        vp = vpDiv10
        vm = vmDiv10
        removed = removed + 1
      }
    }
    if vrIsTrailingZeros && lastRemovedDigit == 5 && vr % 2L == 0L {
      lastRemovedDigit = 4
    }
    output = vr + (vr == vm && (not(acceptBounds) || not(vmIsTrailingZeros)) || lastRemovedDigit >=
    5).to_int64()
  } else {
    // Specialized for the common case (~99.3%). Percentages below are relative to this.
    var roundUp = false
    let vpDiv100 : Int64 = vp / 100L
    let vmDiv100 : Int64 = vm / 100L
    if vpDiv100 > vmDiv100 {
      let vrDiv100 : Int64 = vr / 100L
      let vrMod100 : Int = vr.to_int() - 100 * vrDiv100.to_int()
      roundUp = vrMod100 >= 50
      vr = vrDiv100
      vp = vpDiv100
      vm = vmDiv100
      removed = removed + 2
    }
    // Loop iterations below (approximately), without optimization above:
    // 0: 0.03%, 1: 13.8%, 2: 70.6%, 3: 14.0%, 4: 1.40%, 5: 0.14%, 6+: 0.02%
    // Loop iterations below (approximately), with optimization above:
    // 0: 70.6%, 1: 27.8%, 2: 1.40%, 3: 0.14%, 4+: 0.02%
    while true {
      let vpDiv10 : Int64 = vp / 10L
      let vmDiv10 : Int64 = vm / 10L
      if vpDiv10 <= vmDiv10 {
        break
      }
      let vrDiv10 : Int64 = vr / 10L
      let vrMod10 : Int = vr.to_int() - 10 * vrDiv10.to_int()
      roundUp = vrMod10 >= 5
      vr = vrDiv10
      vp = vpDiv10
      vm = vmDiv10
      removed = removed + 1
    }
    output = vr + (vr == vm || roundUp).to_int64()
  }
  let exp : Int = e10 + removed
  let fd = { mantissa: output, exponent: exp }
  fd
}

fn to_chars(v : FloatingDecimal64, sign : Bool) -> String {
  // Step 5: Print the decimal representation.
  let result = Bytes::make(24, 0)
  var index : Int = 0
  if sign {
    result[index] = '-'.to_int()
    index = index + 1
  }
  var output : Int64 = v.mantissa
  let olength : Int = decimalLength17(output)
  var exp : Int = v.exponent + olength - 1
  let scientificNotation = not(exp >= -3 && exp < 7)
  if scientificNotation {
    // Print the decimal digits.
    var i = 0
    while i < olength - 1, i = i + 1 {
      let c = output % 10L
      output = output / 10L
      result[index + olength - i] = '0'.to_int() + c.to_int()
    }
    result[index] = '0'.to_int() + output.to_int() % 10

    // Always print point
    result[index + 1] = '.'.to_int()
    index = index + olength + 1
    if olength == 1 {
      result[index] = '0'.to_int()
      index = index + 1
    }

    // Print the exponent.
    result[index] = 'e'.to_int()
    index = index + 1
    if exp < 0 {
      result[index] = '-'.to_int()
      index = index + 1
      exp = -exp
    }
    if exp >= 100 {
      let a = exp / 100
      let b = exp / 10 % 10
      let c = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      result[index + 2] = '0'.to_int() + c
      index = index + 3
    } else if exp >= 10 {
      let a = exp / 10
      let b = exp % 10
      result[index + 0] = '0'.to_int() + a
      result[index + 1] = '0'.to_int() + b
      index = index + 2
    } else {
      result[index] = '0'.to_int() + exp
      index = index + 1
    }
    string_from_bytes(result, 0, index)
  } else {
    if exp < 0 {
      // Decimal dot is before any of the digits.
      result[index] = '0'.to_int()
      index = index + 1
      result[index] = '.'.to_int()
      index = index + 1
      var i = -1
      while i > exp, i = i - 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      let current = index
      var i = 0
      while i < olength, i = i + 1 {
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
        index = index + 1
      }
    } else if exp + 1 >= olength {
      // Decimal dot is after any of the digits.
      var i = 0
      while i < olength, i = i + 1 {
        result[index + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength
      var i = olength
      while i < exp + 1, i = i + 1 {
        result[index] = '0'.to_int()
        index = index + 1
      }
      result[index] = '.'.to_int()
      index = index + 1
      result[index] = '0'.to_int()
      index = index + 1
    } else {
      // Decimal dot is somewhere between the digits.
      var current = index + 1
      var i = 0
      while i < olength, i = i + 1 {
        if olength - i - 1 == exp {
          result[current + olength - i - 1] = '.'.to_int()
          current = current - 1
        }
        result[current + olength - i - 1] = '0'.to_int() + (output % 10L).to_int()
        output = output / 10L
      }
      index = index + olength + 1
    }
    return string_from_bytes(result, 0, index)
  }
}

fn d2d_small_int(ieeeMantissa : Int64, ieeeExponent : Int) ->
     Option[FloatingDecimal64] {
  let m2 : Int64 = 1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()).lor(ieeeMantissa)
  let e2 : Int = ieeeExponent - gDOUBLE_BIAS - gDOUBLE_MANTISSA_BITS
  if e2 > 0 {
    return None
  }
  if e2 < -52 {
    return None
  }
  let mask : Int64 = 1L.lsl(-e2.to_int64()) - 1L
  let fraction : Int64 = m2.land(mask)
  if fraction != 0L {
    return None
  }
  Some({ mantissa: m2.lsr(-e2.to_int64()), exponent: 0 })
}

fn double_to_string(f : Double) -> String {
  // Step 1: Decode the floating-point number, and unify normalized and subnormal cases.
  let bits : Int64 = f.reinterpret_as_i64()

  // Decode bits into sign, mantissa, and exponent.
  let ieeeSign = bits.lsr(
      gDOUBLE_MANTISSA_BITS.to_int64() + gDOUBLE_EXPONENT_BITS.to_int64(),
    ).land(1L) != 0L
  let ieeeMantissa : Int64 = bits.land(
    1L.lsl(gDOUBLE_MANTISSA_BITS.to_int64()) - 1L,
  )
  let ieeeExponent : Int = bits.lsr(gDOUBLE_MANTISSA_BITS.to_int64()).land(
    1L.lsl(gDOUBLE_EXPONENT_BITS.to_int64()) - 1L,
  ).to_int()
  if ieeeExponent == (1).lsl(gDOUBLE_EXPONENT_BITS) - 1 || ieeeExponent == 0 && ieeeMantissa ==
  0L {
    return copy_special_str(
      ieeeSign,
      ieeeExponent.to_bool(),
      ieeeMantissa.to_bool(),
    )
  }
  var v : FloatingDecimal64 = { mantissa: 0L, exponent: 0 }
  let small = d2d_small_int(ieeeMantissa, ieeeExponent)
  match small {
    Some(f) => {
      var x = f
      while true {
        let q : Int64 = x.mantissa / 10L
        let r = x.mantissa.to_int() - 10 * q.to_int()
        if r != 0 {
          break
        }
        x = { mantissa: q, exponent: x.exponent + 1 }
      }
      v = x
    }
    None => {
      v = d2d(ieeeMantissa, ieeeExponent)
    }
  }
  to_chars(v, ieeeSign)
}

`,stat:{type:1,mtime:17041777214593186e-4,ctime:17041777214593186e-4,size:20114}});St.set("/string.mbt",{content:`
pub fn compare(self: String, other: String) -> Int {
  let len = self.length() 
  match len.compare(other.length()) {
    0 => {
      var i = 0
      while i < len, i = i + 1 {
        let order = self[i].compare(other[i])
        if order != 0 {
          return order
        }
      }
      0
    }
    order => order
  }
}

pub fn String::default() -> String { "" }
`,stat:{type:1,mtime:1704177721459418e-3,ctime:1704177721459418e-3,size:372}});St.set("/unit.mbt",{content:`
pub fn to_string(self: Unit) -> String {
  let _ = self  
  "()"
}

pub fn op_equal(self: Unit, _other: Unit) -> Bool {
  let _ = self    
  true
}

pub fn compare(self: Unit, _other: Unit) -> Int {
  let _ = self    
  0
}

pub fn hash(self: Unit) -> Int {
  let _ = self    
  0
}

pub fn Unit::default() -> Unit {  
  ()
}
`,stat:{type:1,mtime:17041777214594775e-4,ctime:17041777214594775e-4,size:327}});St.set("/xxhash.mbt",{content:`let gPRIME1 = -1640531535

let gPRIME2 = -2048144777

let gPRIME3 = -1028477379

let gPRIME4 = 668265263

let gPRIME5 = 374761393

fn xxhash32(input : Bytes, seed : Int) -> Int {
  let len = input.length()
  let h = if len >= 16 {
      h16bytes(input, 0, len, seed)
    } else {
      seed + gPRIME5
    } + len
  finalize(h, input, len.land(-16), len.land(0xF))
}

pub fn to_bytes(self : String) -> Bytes {
  let len = self.length()
  let buf = Bytes::make(len, 0)
  var i = 0
  while i < len, i = i + 1 {
    buf[i] = self[i].to_int()
  }
  buf
}

pub fn hash(self : Bool) -> Int {
  self.to_int()
}

pub fn hash(self : Char) -> Int {
  self.to_int()
}

pub fn hash(self : Int) -> Int {
  self
}

pub fn hash(self : Int64) -> Int {
  let lo = self.to_int()
  let hi = self.lsr(32L).to_int()
  lo.lxor(hi)
}

pub fn hash(self : Double) -> Int {
  self.reinterpret_as_i64().hash()
}

pub fn hash(self : String) -> Int {
  xxhash32(self.to_bytes(), 0)
}

pub fn hash(self : Bytes) -> Int {
  xxhash32(self, 0)
}

fn rotl(x : Int, r : Int) -> Int {
  x.lsl(r).lor(x.lsr(32 - r))
}

fn round(acc : Int, input : Int) -> Int {
  rotl(acc + input * gPRIME2, 13) * gPRIME1
}

fn avalanche_step(h : Int, rshift : Int, prime : Int) -> Int {
  h.lxor(h.lsr(rshift)) * prime
}

fn avalanche(h : Int) -> Int {
  avalanche_step(
    avalanche_step(avalanche_step(h, 15, gPRIME2), 13, gPRIME3),
    16,
    1,
  )
}

fn endian32(input : Bytes, cur : Int) -> Int {
  input[cur + 0].lor(
    input[cur + 1].lsl(8).lor(
      input[cur + 2].lsl(16).lor(input[cur + 3].lsl(24)),
    ),
  )
}

fn fetch32(input : Bytes, cur : Int, v : Int) -> Int {
  round(v, endian32(input, cur))
}

fn finalize(h : Int, input : Bytes, cur : Int, remain : Int) -> Int {
  if remain >= 4 {
    finalize(
      rotl(h + endian32(input, cur) * gPRIME3, 17) * gPRIME4,
      input,
      cur + 4,
      remain - 4,
    )
  } else if remain > 0 {
    finalize(
      rotl(h + input[cur] * gPRIME5, 11) * gPRIME1,
      input,
      cur + 1,
      remain - 1,
    )
  } else {
    avalanche(h)
  }
}

fn _h16bytes(input : Bytes, cur : Int, remain : Int, v1 : Int, v2 : Int,
        v3 : Int, v4 : Int) -> Int {
  if remain >= 16 {
    _h16bytes(
      input,
      cur + 16,
      remain - 16,
      fetch32(input, cur, v1),
      fetch32(input, cur + 4, v2),
      fetch32(input, cur + 8, v3),
      fetch32(input, cur + 12, v4),
    )
  } else {
    rotl(v1, 1) + rotl(v2, 7) + rotl(v3, 12) + rotl(v4, 18)
  }
}

fn h16bytes(input : Bytes, cur : Int, len : Int, seed : Int) -> Int {
  _h16bytes(
    input,
    cur,
    len,
    seed + gPRIME1 + gPRIME2,
    seed + gPRIME2,
    seed,
    seed - gPRIME1,
  )
}

`,stat:{type:1,mtime:17041777214595403e-4,ctime:17041777214595403e-4,size:2675}});var Td="moonbit",uy="Moonbit";var ly="moonbit-builtin";var Pd=class{constructor(){this._emmiter=new Zn.EventEmitter;this.onDidChangeFile=this._emmiter.event;this._disposable=Zn.workspace.registerFileSystemProvider(Pd.scheme,this,{isReadonly:!0})}dispose(){this._disposable.dispose()}watch(e,t){return new Zn.Disposable(()=>{})}stat(e){let t=St.get(e.fsPath);if(t===void 0)throw Zn.FileSystemError.FileNotFound(e);return t.stat}readDirectory(e){return[...St.entries()].map(([t,r])=>[t,r.stat.type])}createDirectory(e){}readFile(e){let t=St.get(e.fsPath);if(t===void 0)throw Zn.FileSystemError.FileNotFound(e);return new TextEncoder().encode(t.content)}writeFile(e,t,r){}delete(e,t){}rename(e,t,r){}},Zo=Pd;Zo.scheme=ly;var dy=new Zo;var He=$r(require("vscode"));function fy(n){try{return JSON.parse(n)}catch(e){console.error("parse moon.pkg.json",e);return}}function hy(n){return JSON.stringify(n,null,2)}async function OD(n){return await n.sendRequest(cy)}async function py(n){let e=await OD(n);await He.window.showInformationMessage(`Current version is ${e}`,"copy hash")==="copy hash"&&await He.env.clipboard.writeText(e)}var gy=async n=>await He.workspace.fs.stat(He.Uri.parse(n)),my=async n=>{let e=await He.workspace.fs.readFile(He.Uri.parse(n));return Array.from(e)},vy=async n=>await He.workspace.fs.readDirectory(He.Uri.parse(n));async function yy(n,e,t){let r=He.Uri.parse(n),i=async()=>{let h=He.workspace.textDocuments.find(y=>y.uri.toString(!0)===r.toString(!0));if(h!==void 0)return h.getText();let p=await He.workspace.fs.readFile(r);return new TextDecoder().decode(p)},s=async h=>{let p=He.workspace.textDocuments.find(y=>y.uri.toString(!0)===r.toString(!0));if(p!==void 0){let y=new He.WorkspaceEdit;y.set(r,[new He.TextEdit(new He.Range(p.positionAt(0),p.positionAt(p.getText().length)),h)]),await He.workspace.applyEdit(y);return}await He.workspace.fs.writeFile(r,new TextEncoder().encode(h))},o=await i(),a=fy(o);if(a===void 0||(a.import===void 0&&(a.import={}),a.import[e]!==void 0))return;a.import[e]=t;let u=hy(a);await s(u)}var by=require("child_process"),Id=require("path"),an=require("vscode");var Qo=$r(require("vscode"));async function _y(n){try{return(await Qo.workspace.fs.stat(n)).type===Qo.FileType.File}catch{return!1}}var Ed=class{constructor(e){this._process=(0,by.spawn)("moon",["check","--watch"],{cwd:e}),this._channel=an.window.createOutputChannel(`moon check --watch ${e}`),this._process.stdout?.on("data",t=>{this._channel.append(`${t}`)})}dispose(){this._channel.dispose(),this._process.kill()}},Yo=class{constructor(){this._watchProcesses=new Map}addModule(e){this._watchProcesses.has(e)||this._watchProcesses.set(e,new Ed(e))}deleteModule(e){let t=this._watchProcesses.get(e);t!==void 0&&(t.dispose(),this._watchProcesses.delete(e))}async initialize(){if(an.workspace.workspaceFolders===void 0)return;let e=an.workspace.workspaceFolders.map(t=>t.uri);for(;e.length>0;){let t=e.shift();if(t===void 0)return;if(await _y(an.Uri.joinPath(t,"moon.mod.json"))){this.addModule(t.fsPath);continue}let r=await an.workspace.fs.readDirectory(t);for(let[i,s]of r)s===an.FileType.Directory&&e.push(an.Uri.joinPath(t,i))}this._fsWatcher=an.workspace.createFileSystemWatcher("**/moon.mod.json",!1,!0,!1),this._fsWatcher.onDidCreate(t=>{this.addModule((0,Id.dirname)(t.fsPath))}),this._fsWatcher.onDidDelete(t=>{this.deleteModule((0,Id.dirname)(t.fsPath))})}dispose(){this._fsWatcher?.dispose();for(let[,e]of this._watchProcesses)e.dispose()}};async function LD(n){let e=n.asAbsolutePath(Cy.default.join("node","lsp-server.js")),t={run:{module:e,transport:cs.TransportKind.stdio},debug:{module:e,transport:cs.TransportKind.stdio}},r={documentSelector:[{language:Td}],synchronize:{fileEvents:[Ri.workspace.createFileSystemWatcher("{**/*.mbt,**/target/check/packages.json,**/target/check/**/*.mi}")]}},i=new cs.LanguageClient(Td,uy,t,r);if(i.onRequest(sy,gy),i.onRequest(oy,my),i.onRequest(ay,vy),n.subscriptions.push(i),n.subscriptions.push(Ri.commands.registerCommand("moonbit.packageAddImport",yy)),n.subscriptions.push(dy),Ri.workspace.getConfiguration("moonbit").get("autoMoonCheck.enable")===!0){let a=new Yo;await a.initialize(),n.subscriptions.push(a)}n.subscriptions.push(Ri.commands.registerCommand("moonbit.get-extension-version",async()=>{await py(i)})),await i.start()}0&&(module.exports={activate});
//# sourceMappingURL=extension.js.map
